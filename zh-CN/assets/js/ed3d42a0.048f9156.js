"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["129028"],{744869:function(e,t,n){n.r(t),n.d(t,{default:()=>d,frontMatter:()=>o,metadata:()=>s,assets:()=>l,toc:()=>r,contentTitle:()=>i});var s=JSON.parse('{"id":"lakehouse/best-practices/doris-maxcompute","title":"\u4ECE MaxCompute \u5230 Doris","description":"\u672C\u6587\u6863\u4ECB\u7ECD\u5982\u4F55\u901A\u8FC7 MaxCompute Catalog \u5C06\u963F\u91CC\u4E91 MaxCompute \u4E2D\u7684\u6570\u636E\u5FEB\u901F\u5BFC\u5165\u5230 Apache Doris \u4E2D\u3002","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs/version-2.1/lakehouse/best-practices/doris-maxcompute.md","sourceDirName":"lakehouse/best-practices","slug":"/lakehouse/best-practices/doris-maxcompute","permalink":"/zh-CN/docs/2.1/lakehouse/best-practices/doris-maxcompute","draft":false,"unlisted":false,"tags":[],"version":"2.1","frontMatter":{"title":"\u4ECE MaxCompute \u5230 Doris","language":"zh-CN"},"sidebar":"docs","previous":{"title":"Doris \u96C6\u6210\u963F\u91CC\u4E91 DLF Rest Catalog","permalink":"/zh-CN/docs/2.1/lakehouse/best-practices/doris-dlf-paimon"},"next":{"title":"\u5728 Hive/Iceberg \u4E0A\u6784\u5EFA TPC-H \u6570\u636E\u96C6","permalink":"/zh-CN/docs/2.1/lakehouse/best-practices/tpch"}}'),c=n("785893"),a=n("250065");let o={title:"\u4ECE MaxCompute \u5230 Doris",language:"zh-CN"},i=void 0,l={},r=[{value:"\u73AF\u5883\u51C6\u5907",id:"\u73AF\u5883\u51C6\u5907",level:2},{value:"01 \u5F00\u901A MaxCompute \u5F00\u653E\u5B58\u50A8 API",id:"01-\u5F00\u901A-maxcompute-\u5F00\u653E\u5B58\u50A8-api",level:3},{value:"02 \u5F00\u901A MaxCompute \u6743\u9650",id:"02-\u5F00\u901A-maxcompute-\u6743\u9650",level:3},{value:"03 \u786E\u8BA4 Doris \u548C MaxCompute \u7F51\u7EDC\u73AF\u5883",id:"03-\u786E\u8BA4-doris-\u548C-maxcompute-\u7F51\u7EDC\u73AF\u5883",level:3},{value:"\u5BFC\u5165 MaxCompute \u6570\u636E",id:"\u5BFC\u5165-maxcompute-\u6570\u636E",level:2},{value:"01 \u521B\u5EFA Catalog",id:"01-\u521B\u5EFA-catalog",level:3},{value:"02 \u5BFC\u5165 TPCH \u6570\u636E\u96C6",id:"02-\u5BFC\u5165-tpch-\u6570\u636E\u96C6",level:3},{value:"03 \u5BFC\u5165 Github Event \u6570\u636E\u96C6",id:"03-\u5BFC\u5165-github-event-\u6570\u636E\u96C6",level:3}];function p(e){let t={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,a.a)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(t.p,{children:["\u672C\u6587\u6863\u4ECB\u7ECD\u5982\u4F55\u901A\u8FC7 ",(0,c.jsx)(t.a,{href:"/zh-CN/docs/2.1/lakehouse/catalogs/maxcompute-catalog",children:"MaxCompute Catalog"})," \u5C06\u963F\u91CC\u4E91 MaxCompute \u4E2D\u7684\u6570\u636E\u5FEB\u901F\u5BFC\u5165\u5230 Apache Doris \u4E2D\u3002"]}),"\n",(0,c.jsx)(t.p,{children:"\u672C\u6587\u6863\u57FA\u4E8E Apache Doris 2.1.9 \u7248\u672C\u3002"}),"\n",(0,c.jsx)(t.h2,{id:"\u73AF\u5883\u51C6\u5907",children:"\u73AF\u5883\u51C6\u5907"}),"\n",(0,c.jsx)(t.h3,{id:"01-\u5F00\u901A-maxcompute-\u5F00\u653E\u5B58\u50A8-api",children:"01 \u5F00\u901A MaxCompute \u5F00\u653E\u5B58\u50A8 API"}),"\n",(0,c.jsxs)(t.p,{children:["\u5728 ",(0,c.jsx)(t.a,{href:"https://maxcompute.console.aliyun.com/",children:"MaxCompute \u63A7\u5236\u53F0"})," \u5DE6\u4FA7\u5BFC\u822A\u680F -> ",(0,c.jsx)(t.code,{children:"\u79DF\u6237\u7BA1\u7406"})," -> ",(0,c.jsx)(t.code,{children:"\u79DF\u6237\u5C5E\u6027"}),"  -> \u6253\u5F00 ",(0,c.jsx)(t.code,{children:"\u5F00\u653E\u5B58\u50A8(Storage API)\u5F00\u5173"})]}),"\n",(0,c.jsx)(t.h3,{id:"02-\u5F00\u901A-maxcompute-\u6743\u9650",children:"02 \u5F00\u901A MaxCompute \u6743\u9650"}),"\n",(0,c.jsx)(t.p,{children:"Doris \u4F7F\u7528 AK/SK \u8BBF\u95EE MaxCompute \u670D\u52A1\u3002\u8BF7\u786E\u4FDD AK/SK \u5BF9\u5E94\u7684 IAM \u7528\u6237\uFF0C\u62E5\u6709\u5BF9\u5E94 MaxCompute \u670D\u52A1\u7684\u4EE5\u4E0B\u89D2\u8272\u6216\u6743\u9650\uFF1A"}),"\n",(0,c.jsx)(t.pre,{children:(0,c.jsx)(t.code,{className:"language-json",children:'{\n    "Statement": [{\n            "Action": ["odps:List",\n                "odps:Usage"],\n            "Effect": "Allow",\n            "Resource": ["acs:odps:*:regions/*/quotas/pay-as-you-go"]}],\n    "Version": "1"\n}\n'})}),"\n",(0,c.jsx)(t.h3,{id:"03-\u786E\u8BA4-doris-\u548C-maxcompute-\u7F51\u7EDC\u73AF\u5883",children:"03 \u786E\u8BA4 Doris \u548C MaxCompute \u7F51\u7EDC\u73AF\u5883"}),"\n",(0,c.jsx)(t.p,{children:"\u5F3A\u70C8\u5EFA\u8BAE Doris \u96C6\u7FA4\u548C MaxCompute \u670D\u52A1\u5728\u540C\u4E00\u4E2A VPC \u4E2D\uFF0C\u5E76\u786E\u4FDD\u8BBE\u7F6E\u4E86\u6B63\u786E\u7684\u5B89\u5168\u7EC4\u3002"}),"\n",(0,c.jsx)(t.p,{children:"\u672C\u6587\u5B9E\u4F8B\u662F\u5728\u540C VPC \u7F51\u7EDC\u60C5\u51B5\u4E0B\u7684\u6D4B\u8BD5\u7ED3\u679C\u3002"}),"\n",(0,c.jsx)(t.h2,{id:"\u5BFC\u5165-maxcompute-\u6570\u636E",children:"\u5BFC\u5165 MaxCompute \u6570\u636E"}),"\n",(0,c.jsx)(t.h3,{id:"01-\u521B\u5EFA-catalog",children:"01 \u521B\u5EFA Catalog"}),"\n",(0,c.jsx)(t.pre,{children:(0,c.jsx)(t.code,{className:"language-sql",children:'CREATE CATALOG mc PROPERTIES (\n  "type" = "max_compute",\n  "mc.default.project" = "xxx",\n  "mc.access_key" = "AKxxxxx",\n  "mc.secret_key" = "SKxxxxx",\n  "mc.endpoint" = "xxxxx"\n);\n'})}),"\n",(0,c.jsx)(t.p,{children:"\u5982\u9700\u652F\u6301 Schema \u5C42\u7EA7\uFF083.1.3+\uFF09\uFF1A"}),"\n",(0,c.jsx)(t.pre,{children:(0,c.jsx)(t.code,{className:"language-sql",children:'CREATE CATALOG mc PROPERTIES (\n  "type" = "max_compute",\n  "mc.default.project" = "xxx",\n  "mc.access_key" = "AKxxxxx",\n  "mc.secret_key" = "SKxxxxx",\n  "mc.endpoint" = "xxxxx",\n  \'mc.enable.namespace.schema\' = \'true\'\n);\n'})}),"\n",(0,c.jsxs)(t.p,{children:["\u5177\u4F53\u8BF7\u53C2\u9605 ",(0,c.jsx)(t.a,{href:"/zh-CN/docs/2.1/lakehouse/catalogs/maxcompute-catalog",children:"MaxCompute Catalog"})," \u6587\u6863\u3002"]}),"\n",(0,c.jsx)(t.h3,{id:"02-\u5BFC\u5165-tpch-\u6570\u636E\u96C6",children:"02 \u5BFC\u5165 TPCH \u6570\u636E\u96C6"}),"\n",(0,c.jsxs)(t.p,{children:["\u6211\u4EEC\u4F7F\u7528 MaxCompute \u516C\u5F00\u6570\u636E\u96C6\u4E2D\u7684 TPCH 100 \u6570\u636E\u96C6\u4F5C\u4E3A\u793A\u4F8B\uFF08\u6570\u636E\u5DF2\u7ECF\u5BFC\u5165\u5230 MaxCompute \u4E2D\uFF09\uFF0C\u5E76\u4F7F\u7528 ",(0,c.jsx)(t.code,{children:"CREATE TABLE AS SELECT"})," \u8BED\u53E5\u5C06 MaxCompute \u7684\u6570\u636E\u5BFC\u5165\u5230 Doris \u4E2D\u3002"]}),"\n",(0,c.jsxs)(t.p,{children:["\u8BE5\u6570\u636E\u96C6\u6709 7 \u5F20\u8868\u3002\u5176\u4E2D\u6700\u5927\u7684 ",(0,c.jsx)(t.code,{children:"lineitem"})," \u8868\u6709 16 \u5217\uFF0C600037902 \u884C\u3002\u78C1\u76D8\u7A7A\u95F4\u5360\u7528\u7EA6\u4E3A 30GB\u3002"]}),"\n",(0,c.jsx)(t.pre,{children:(0,c.jsx)(t.code,{className:"language-sql",children:"-- switch catalog\nSWITCH internal;\n-- create database\nCREATE DATABASE tpch_100g;\n-- ingest data\nCREATE TABLE tpch_100g.lineitem AS SELECT * FROM mc.selectdb_test.lineitem;\nCREATE TABLE tpch_100g.nation AS SELECT * FROM mc.selectdb_test.nation;\nCREATE TABLE tpch_100g.orders AS SELECT * FROM mc.selectdb_test.orders;\nCREATE TABLE tpch_100g.part AS SELECT * FROM mc.selectdb_test.part;\nCREATE TABLE tpch_100g.partsupp AS SELECT * FROM mc.selectdb_test.partsupp;\nCREATE TABLE tpch_100g.region AS SELECT * FROM mc.selectdb_test.region;\nCREATE TABLE tpch_100g.supplier AS SELECT * FROM mc.selectdb_test.supplier;\n"})}),"\n",(0,c.jsx)(t.p,{children:"\u5728 Doris \u96C6\u7FA4\u5355 BE 16C 64G \u89C4\u683C\u4E0B\uFF0C\u4E0A\u8FF0\u64CD\u4F5C\u4E32\u884C\u6267\u884C\uFF0C\u8017\u65F6\u7EA6\u4E3A 6-7 \u5206\u949F\u3002"}),"\n",(0,c.jsx)(t.h3,{id:"03-\u5BFC\u5165-github-event-\u6570\u636E\u96C6",children:"03 \u5BFC\u5165 Github Event \u6570\u636E\u96C6"}),"\n",(0,c.jsxs)(t.p,{children:["\u6211\u4EEC\u4F7F\u7528 MaxCompute \u516C\u5F00\u6570\u636E\u96C6\u4E2D\u7684 Github Event \u6570\u636E\u96C6\u4F5C\u4E3A\u793A\u4F8B\uFF08\u6570\u636E\u5DF2\u7ECF\u5BFC\u5165\u5230 MaxCompute \u4E2D\uFF09\uFF0C\u5E76\u4F7F\u7528 ",(0,c.jsx)(t.code,{children:"CREATE TABLE AS SELECT"})," \u8BED\u53E5\u5C06 MaxCompute \u7684\u6570\u636E\u5BFC\u5165\u5230 Doris \u4E2D\u3002"]}),"\n",(0,c.jsxs)(t.p,{children:["\u8FD9\u91CC\u6211\u4EEC\u9009\u62E9 ",(0,c.jsx)(t.code,{children:"dwd_github_events_odps"})," \u8868\u7684 '2015-01-01' \u5230 '2016-01-01' \u5171 365 \u4E2A\u5206\u533A\u7684\u6570\u636E\u3002\u6570\u636E\u5171 32 \u5217\uFF0C212786803 \u884C\u3002\u78C1\u76D8\u7A7A\u95F4\u5360\u7528\u7EA6\u4E3A 10GB\u3002"]}),"\n",(0,c.jsx)(t.pre,{children:(0,c.jsx)(t.code,{className:"language-sql",children:"-- switch catalog\nSWITCH internal;\n-- create database\nCREATE DATABASE github_events;\n-- ingest data\nCREATE TABLE github_events.dwd_github_events_odps\nAS SELECT * FROM mc.github_events.dwd_github_events_odps\nWHERE ds BETWEEN '2015-01-01' AND '2016-01-01';\n"})}),"\n",(0,c.jsx)(t.p,{children:"\u5728 Doris \u96C6\u7FA4\u5355 BE 16C 64G \u89C4\u683C\u4E0B\uFF0C\u4E0A\u8FF0\u64CD\u4F5C\u8017\u65F6\u7EA6\u4E3A 2 \u5206\u949F\u3002"})]})}function d(e={}){let{wrapper:t}={...(0,a.a)(),...e.components};return t?(0,c.jsx)(t,{...e,children:(0,c.jsx)(p,{...e})}):p(e)}},250065:function(e,t,n){n.d(t,{Z:function(){return i},a:function(){return o}});var s=n(667294);let c={},a=s.createContext(c);function o(e){let t=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:o(e.components),s.createElement(a.Provider,{value:t},e.children)}}}]);