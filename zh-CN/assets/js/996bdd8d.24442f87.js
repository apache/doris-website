"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["188378"],{543827:function(n,e,s){s.r(e),s.d(e,{default:()=>p,frontMatter:()=>i,metadata:()=>a,assets:()=>c,toc:()=>t,contentTitle:()=>o});var a=JSON.parse('{"id":"lakehouse/best-practices/doris-dlf-paimon","title":"Doris \u96C6\u6210\u963F\u91CC\u4E91 DLF Rest Catalog","description":"\u963F\u91CC\u4E91\u6570\u636E\u6E56\u6784\u5EFA Data Lake Formation\uFF0CDLF \u4F5C\u4E3A\u4E91\u539F\u751F\u6570\u636E\u6E56\u67B6\u6784\u6838\u5FC3\u7EC4\u6210\u90E8\u5206\uFF0C\u5E2E\u52A9\u7528\u6237\u5FEB\u901F\u5730\u6784\u5EFA\u4E91\u539F\u751F\u6570\u636E\u6E56\u67B6\u6784\u3002\u6570\u636E\u6E56\u6784\u5EFA\u63D0\u4F9B\u6E56\u4E0A\u5143\u6570\u636E\u7EDF\u4E00\u7BA1\u7406\u3001\u4F01\u4E1A\u7EA7\u6743\u9650\u63A7\u5236\uFF0C\u5E76\u65E0\u7F1D\u5BF9\u63A5\u591A\u79CD\u8BA1\u7B97\u5F15\u64CE\uFF0C\u6253\u7834\u6570\u636E\u5B64\u5C9B\uFF0C\u6D1E\u5BDF\u4E1A\u52A1\u4EF7\u503C\u3002","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs/current/lakehouse/best-practices/doris-dlf-paimon.md","sourceDirName":"lakehouse/best-practices","slug":"/lakehouse/best-practices/doris-dlf-paimon","permalink":"/zh-CN/docs/dev/lakehouse/best-practices/doris-dlf-paimon","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Doris \u96C6\u6210\u963F\u91CC\u4E91 DLF Rest Catalog","language":"zh-CN"},"sidebar":"docs","previous":{"title":"Doris \u96C6\u6210 AWS S3 Tables","permalink":"/zh-CN/docs/dev/lakehouse/best-practices/doris-aws-s3tables"},"next":{"title":"\u4ECE MaxCompute \u5230 Doris","permalink":"/zh-CN/docs/dev/lakehouse/best-practices/doris-maxcompute"}}'),l=s("785893"),r=s("250065");let i={title:"Doris \u96C6\u6210\u963F\u91CC\u4E91 DLF Rest Catalog",language:"zh-CN"},o=void 0,c={},t=[{value:"\u4F7F\u7528\u6307\u5357",id:"\u4F7F\u7528\u6307\u5357",level:2},{value:"01 \u5F00\u901A DLF \u670D\u52A1",id:"01-\u5F00\u901A-dlf-\u670D\u52A1",level:3},{value:"02 \u4F7F\u7528 EMR Spark SQL \u8BBF\u95EE DLF",id:"02-\u4F7F\u7528-emr-spark-sql-\u8BBF\u95EE-dlf",level:3},{value:"03 \u4F7F\u7528 Doris \u94FE\u63A5 DLF",id:"03-\u4F7F\u7528-doris-\u94FE\u63A5-dlf",level:3}];function d(n){let e={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.a)(),...n.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(e.p,{children:["\u963F\u91CC\u4E91\u6570\u636E\u6E56\u6784\u5EFA ",(0,l.jsx)(e.a,{href:"https://cn.aliyun.com/product/bigdata/dlf",children:"Data Lake Formation\uFF0CDLF"})," \u4F5C\u4E3A\u4E91\u539F\u751F\u6570\u636E\u6E56\u67B6\u6784\u6838\u5FC3\u7EC4\u6210\u90E8\u5206\uFF0C\u5E2E\u52A9\u7528\u6237\u5FEB\u901F\u5730\u6784\u5EFA\u4E91\u539F\u751F\u6570\u636E\u6E56\u67B6\u6784\u3002\u6570\u636E\u6E56\u6784\u5EFA\u63D0\u4F9B\u6E56\u4E0A\u5143\u6570\u636E\u7EDF\u4E00\u7BA1\u7406\u3001\u4F01\u4E1A\u7EA7\u6743\u9650\u63A7\u5236\uFF0C\u5E76\u65E0\u7F1D\u5BF9\u63A5\u591A\u79CD\u8BA1\u7B97\u5F15\u64CE\uFF0C\u6253\u7834\u6570\u636E\u5B64\u5C9B\uFF0C\u6D1E\u5BDF\u4E1A\u52A1\u4EF7\u503C\u3002"]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:"\u7EDF\u4E00\u5143\u6570\u636E\u4E0E\u5B58\u50A8"}),"\n",(0,l.jsx)(e.p,{children:"\u5927\u6570\u636E\u8BA1\u7B97\u5F15\u64CE\u5171\u4EAB\u4E00\u5957\u6E56\u4E0A\u5143\u6570\u636E\u548C\u5B58\u50A8\uFF0C\u4E14\u6570\u636E\u53EF\u5728\u73AF\u6E56\u4EA7\u54C1\u95F4\u6D41\u52A8\u3002"}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:"\u7EDF\u4E00\u6743\u9650\u7BA1\u7406"}),"\n",(0,l.jsx)(e.p,{children:"\u5927\u6570\u636E\u8BA1\u7B97\u5F15\u64CE\u5171\u4EAB\u4E00\u5957\u6E56\u8868\u6743\u9650\u914D\u7F6E\uFF0C\u5B9E\u73B0\u4E00\u6B21\u914D\u7F6E\uFF0C\u591A\u5904\u751F\u6548\u3002"}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:"\u5B58\u50A8\u4F18\u5316"}),"\n",(0,l.jsx)(e.p,{children:"\u63D0\u4F9B\u5C0F\u6587\u4EF6\u5408\u5E76\u3001\u8FC7\u671F\u5FEB\u7167\u6E05\u7406\u3001\u5206\u533A\u6574\u7406\u53CA\u5E9F\u5F03\u6587\u4EF6\u6E05\u7406\u7B49\u4F18\u5316\u7B56\u7565\uFF0C\u63D0\u5347\u5B58\u50A8\u6548\u7387\u3002"}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:"\u5B8C\u5584\u7684\u4E91\u751F\u6001\u652F\u6301\u4F53\u7CFB"}),"\n",(0,l.jsx)(e.p,{children:"\u6DF1\u5EA6\u6574\u5408\u963F\u91CC\u4E91\u4EA7\u54C1\uFF0C\u5305\u62EC\u6D41\u6279\u8BA1\u7B97\u5F15\u64CE\uFF0C\u5B9E\u73B0\u5F00\u7BB1\u5373\u7528\uFF0C\u63D0\u5347\u7528\u6237\u4F53\u9A8C\u4E0E\u64CD\u4F5C\u4FBF\u6377\u6027\u3002"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.p,{children:"DLF 2.5 \u7248\u672C\u5F00\u59CB\u652F\u6301 Paimon Rest Catalog\u3002Doris \u81EA 3.1.0 \u7248\u672C\u5F00\u59CB\uFF0C\u652F\u6301\u96C6\u6210 DLF 2.5+ \u7248\u672C\u7684 Paimon Rest Catalog\uFF0C\u53EF\u4EE5\u65E0\u7F1D\u5BF9\u63A5 DLF\uFF0C\u8BBF\u95EE\u5E76\u5206\u6790 Paimon \u8868\u6570\u636E\u3002\u672C\u6587\u5C06\u6F14\u793A\u5982\u4F55\u4F7F\u7528 Apache Doris \u5BF9\u63A5 DLF 2.5+ \u7248\u672C\u5E76\u8FDB\u884C Paimon \u8868\u6570\u636E\u8BBF\u95EE\u3002"}),"\n",(0,l.jsx)(e.admonition,{type:"tip",children:(0,l.jsx)(e.p,{children:"\u8BE5\u529F\u80FD\u4ECE Doris 3.1 \u5F00\u59CB\u652F\u6301"})}),"\n",(0,l.jsx)(e.h2,{id:"\u4F7F\u7528\u6307\u5357",children:"\u4F7F\u7528\u6307\u5357"}),"\n",(0,l.jsx)(e.h3,{id:"01-\u5F00\u901A-dlf-\u670D\u52A1",children:"01 \u5F00\u901A DLF \u670D\u52A1"}),"\n",(0,l.jsx)(e.p,{children:"\u8BF7\u53C2\u8003 DLF \u5B98\u65B9\u6587\u6863\u5F00\u901A DLF \u670D\u52A1\uFF0C\u5E76\u521B\u5EFA\u76F8\u5E94\u7684 Catalog\u3001Database \u548C Table\u3002"}),"\n",(0,l.jsx)(e.h3,{id:"02-\u4F7F\u7528-emr-spark-sql-\u8BBF\u95EE-dlf",children:"02 \u4F7F\u7528 EMR Spark SQL \u8BBF\u95EE DLF"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:"\u8FDE\u63A5"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:"spark-sql --master yarn \\\n    --conf spark.driver.memory=5g \\\n    --conf spark.sql.defaultCatalog=paimon \\\n    --conf spark.sql.catalog.paimon=org.apache.paimon.spark.SparkCatalog \\\n    --conf spark.sql.catalog.paimon.metastore=rest \\\n    --conf spark.sql.extensions=org.apache.paimon.spark.extensions.PaimonSparkSessionExtensions \\\n    --conf spark.sql.catalog.paimon.uri=http://<region>-vpc.dlf.aliyuncs.com \\\n    --conf spark.sql.catalog.paimon.warehouse=<your-catalog-name> \\\n    --conf spark.sql.catalog.paimon.token.provider=dlf \\\n    --conf spark.sql.catalog.paimon.dlf.token-loader=ecs\n"})}),"\n",(0,l.jsxs)(e.blockquote,{children:["\n",(0,l.jsxs)(e.p,{children:["\u66FF\u6362\u5BF9\u5E94\u7684 ",(0,l.jsx)(e.code,{children:"warehouse"})," \u548C ",(0,l.jsx)(e.code,{children:"uri"})," \u5730\u5740\u3002"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:"\u5199\u5165\u6570\u636E"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:"USE <your-catalog-name>;\n\nCREATE TABLE users_samples\n(\n    user_id INT,             \n    age_level STRING,           \n    final_gender_code STRING,    \n    clk BOOLEAN\n);\n\nINSERT INTO users_samples VALUES\n(1, '25-34', 'M', true),\n(2, '18-24', 'F', false);\n\nINSERT INTO users_samples VALUES\n(3, '25-34', 'M', true),\n(4, '18-24', 'F', false);\n\nINSERT INTO users_samples VALUES\n(5, '25-34', 'M', true),\n(6, '18-24', 'F', false);\n"})}),"\n",(0,l.jsxs)(e.p,{children:["\u5982\u9047\u5230\u4EE5\u4E0B\u9519\u8BEF\uFF0C\u8BF7\u5C1D\u8BD5\u79FB\u9664 ",(0,l.jsx)(e.code,{children:"/opt/apps/PAIMON/paimon-dlf-2.5/lib/spark3"})," \u4E0B\u7684 ",(0,l.jsx)(e.code,{children:"paimon-jindo-x.y.z.jar"})," \u540E\u91CD\u542F Spark \u670D\u52A1\u5E76\u91CD\u8BD5\u3002"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"Ambiguous FileIO classes are:\norg.apache.paimon.jindo.JindoLoader\norg.apache.paimon.oss.OSSLoader\n"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.h3,{id:"03-\u4F7F\u7528-doris-\u94FE\u63A5-dlf",children:"03 \u4F7F\u7528 Doris \u94FE\u63A5 DLF"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:"\u521B\u5EFA Paimon Catalog"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:"CREATE CATALOG paimon_dlf_test PROPERTIES (\n    'type' = 'paimon',\n    'paimon.catalog.type' = 'rest',\n    'uri' = 'http://<region>-vpc.dlf.aliyuncs.com',\n    'warehouse' = '<your-catalog-name>',\n    'paimon.rest.token.provider' = 'dlf',\n    'paimon.rest.dlf.access-key-id' = '<ak>',\n    'paimon.rest.dlf.access-key-secret' = '<sk>'\n);\n"})}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"Doris \u4F1A\u4F7F\u7528 DLF \u8FD4\u56DE\u7684\u4E34\u65F6\u51ED\u8BC1\u8BBF\u95EE OSS \u5BF9\u8C61\u5B58\u50A8\uFF0C\u4E0D\u9700\u8981\u989D\u5916\u63D0\u4F9B OSS \u7684\u51ED\u8BC1\u4FE1\u606F\u3002"}),"\n",(0,l.jsx)(e.li,{children:"\u4EC5\u652F\u6301\u5728\u540C VPC \u5185\u8BBF\u95EE DLF\uFF0C\u6CE8\u610F\u63D0\u4F9B\u6B63\u786E\u7684 uri \u5730\u5740\u3002"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:"\u67E5\u8BE2\u6570\u636E"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:"SELECT * FROM users_samples ORDER BY user_id;\n+---------+-----------+-------------------+------+\n| user_id | age_level | final_gender_code | clk  |\n+---------+-----------+-------------------+------+\n|       1 | 25-34     | M                 |    1 |\n|       2 | 18-24     | F                 |    0 |\n|       3 | 25-34     | M                 |    1 |\n|       4 | 18-24     | F                 |    0 |\n|       5 | 25-34     | M                 |    1 |\n|       6 | 18-24     | F                 |    0 |\n+---------+-----------+-------------------+------+\n"})}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:"\u67E5\u8BE2\u7CFB\u7EDF\u8868"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:"SELECT snapshot_id, commit_time, total_record_count FROM users_samples$snapshots;\n+-------------+-------------------------+--------------------+\n| snapshot_id | commit_time             | total_record_count |\n+-------------+-------------------------+--------------------+\n|           1 | 2025-08-09 05:56:02.906 |                  2 |\n|           2 | 2025-08-13 03:41:32.732 |                  4 |\n|           3 | 2025-08-13 03:41:35.218 |                  6 |\n+-------------+-------------------------+--------------------+\n"})}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:"\u589E\u91CF\u8BFB\u53D6"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:"SELECT * FROM users_samples@incr('startSnapshotId'=1, 'endSnapshotId'=2) ORDER BY user_id;\n+---------+-----------+-------------------+------+\n| user_id | age_level | final_gender_code | clk  |\n+---------+-----------+-------------------+------+\n|       3 | 25-34     | M                 |    1 |\n|       4 | 18-24     | F                 |    0 |\n+---------+-----------+-------------------+------+\n"})}),"\n"]}),"\n"]})]})}function p(n={}){let{wrapper:e}={...(0,r.a)(),...n.components};return e?(0,l.jsx)(e,{...n,children:(0,l.jsx)(d,{...n})}):d(n)}},250065:function(n,e,s){s.d(e,{Z:function(){return o},a:function(){return i}});var a=s(667294);let l={},r=a.createContext(l);function i(n){let e=a.useContext(r);return a.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(l):n.components||l:i(n.components),a.createElement(r.Provider,{value:e},n.children)}}}]);