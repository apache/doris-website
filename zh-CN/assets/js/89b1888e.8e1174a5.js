"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["69073"],{335845:function(e,n,s){s.r(n),s.d(n,{default:()=>h,frontMatter:()=>c,metadata:()=>r,assets:()=>d,toc:()=>o,contentTitle:()=>a});var r=JSON.parse('{"id":"install/deploy-on-kubernetes/separating-storage-compute/config-fe","title":"\u914D\u7F6E\u90E8\u7F72 FE","description":"FE \u5728\u5B58\u7B97\u5206\u79BB\u6A21\u5F0F\u4E0B\u4E3B\u8981\u8D1F\u8D23\u67E5\u8BE2\u89E3\u6790\u548C\u89C4\u5212\u7B49\u76F8\u5173\u5DE5\u4F5C\u3002","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs/current/install/deploy-on-kubernetes/separating-storage-compute/config-fe.md","sourceDirName":"install/deploy-on-kubernetes/separating-storage-compute","slug":"/install/deploy-on-kubernetes/separating-storage-compute/config-fe","permalink":"/zh-CN/docs/dev/install/deploy-on-kubernetes/separating-storage-compute/config-fe","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"\u914D\u7F6E\u90E8\u7F72 FE","language":"zh-CN"},"sidebar":"docs","previous":{"title":"\u914D\u7F6E\u90E8\u7F72 MetaService","permalink":"/zh-CN/docs/dev/install/deploy-on-kubernetes/separating-storage-compute/config-ms"},"next":{"title":"\u914D\u7F6E\u8BA1\u7B97\u7EC4","permalink":"/zh-CN/docs/dev/install/deploy-on-kubernetes/separating-storage-compute/config-cg"}}'),l=s("785893"),i=s("250065");let c={title:"\u914D\u7F6E\u90E8\u7F72 FE",language:"zh-CN"},a=void 0,d={},o=[{value:"\u914D\u7F6E\u8BA1\u7B97\u8D44\u6E90",id:"\u914D\u7F6E\u8BA1\u7B97\u8D44\u6E90",level:2},{value:"\u914D\u7F6E Follower \u6570\u91CF",id:"\u914D\u7F6E-follower-\u6570\u91CF",level:2},{value:"\u81EA\u5B9A\u4E49\u542F\u52A8\u914D\u7F6E",id:"\u81EA\u5B9A\u4E49\u542F\u52A8\u914D\u7F6E",level:2},{value:"\u8BBF\u95EE\u914D\u7F6E",id:"\u8BBF\u95EE\u914D\u7F6E",level:2},{value:"ClusterIP \u6A21\u5F0F",id:"clusterip-\u6A21\u5F0F",level:3},{value:"\u7B2C 1 \u6B65\uFF1A\u914D\u7F6E ClusterIP",id:"\u7B2C-1-\u6B65\u914D\u7F6E-clusterip",level:4},{value:"\u7B2C 2 \u6B65\uFF1A\u83B7\u53D6 Service \u8BBF\u95EE\u5730\u5740",id:"\u7B2C-2-\u6B65\u83B7\u53D6-service-\u8BBF\u95EE\u5730\u5740",level:4},{value:"\u7B2C 3 \u6B65\uFF1A\u5728\u5BB9\u5668\u5185\u90E8\u8BBF\u95EE Doris",id:"\u7B2C-3-\u6B65\u5728\u5BB9\u5668\u5185\u90E8\u8BBF\u95EE-doris",level:4},{value:"NodePort",id:"nodeport",level:3},{value:"\u7B2C 1 \u6B65\uFF1A\u914D\u7F6E FE NodePort",id:"\u7B2C-1-\u6B65\u914D\u7F6E-fe-nodeport",level:4},{value:"\u7B2C 2 \u6B65\uFF1A\u83B7\u53D6 Service",id:"\u7B2C-2-\u6B65\u83B7\u53D6-service",level:4},{value:"\u7B2C 3 \u6B65\uFF1A\u4F7F\u7528 NodePort \u8BBF\u95EE Doris",id:"\u7B2C-3-\u6B65\u4F7F\u7528-nodeport-\u8BBF\u95EE-doris",level:4},{value:"LoadBalancer",id:"loadbalancer",level:3},{value:"\u7B2C 1 \u6B65\uFF1A\u914D\u7F6E LoadBalancer \u6A21\u5F0F",id:"\u7B2C-1-\u6B65\u914D\u7F6E-loadbalancer-\u6A21\u5F0F",level:4},{value:"\u7B2C 2 \u6B65\uFF1A\u83B7\u53D6 Service",id:"\u7B2C-2-\u6B65\u83B7\u53D6-service-1",level:4},{value:"\u7B2C 3 \u6B65\uFF1A\u4F7F\u7528 LoadBalancer \u8BBF\u95EE",id:"\u7B2C-3-\u6B65\u4F7F\u7528-loadbalancer-\u8BBF\u95EE",level:4},{value:"\u6301\u4E45\u5316\u5B58\u50A8",id:"\u6301\u4E45\u5316\u5B58\u50A8",level:2},{value:"\u4F7F\u7528\u5B58\u50A8\u6A21\u677F\u81EA\u52A8\u751F\u6210",id:"\u4F7F\u7528\u5B58\u50A8\u6A21\u677F\u81EA\u52A8\u751F\u6210",level:3},{value:"\u81EA\u5B9A\u4E49\u6302\u8F7D\u70B9\u914D\u7F6E",id:"\u81EA\u5B9A\u4E49\u6302\u8F7D\u70B9\u914D\u7F6E",level:3},{value:"\u4E0D\u6301\u4E45\u5316\u65E5\u5FD7",id:"\u4E0D\u6301\u4E45\u5316\u65E5\u5FD7",level:3}];function t(e){let n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.a)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.p,{children:"FE \u5728\u5B58\u7B97\u5206\u79BB\u6A21\u5F0F\u4E0B\u4E3B\u8981\u8D1F\u8D23\u67E5\u8BE2\u89E3\u6790\u548C\u89C4\u5212\u7B49\u76F8\u5173\u5DE5\u4F5C\u3002"}),"\n",(0,l.jsx)(n.h2,{id:"\u914D\u7F6E\u8BA1\u7B97\u8D44\u6E90",children:"\u914D\u7F6E\u8BA1\u7B97\u8D44\u6E90"}),"\n",(0,l.jsxs)(n.p,{children:["Doris-Operator \u4ED3\u5E93\u63D0\u4F9B\u7684",(0,l.jsx)(n.a,{href:"https://github.com/apache/doris-operator/blob/master/doc/examples/disaggregated/cluster/ddc-sample.yaml",children:"\u90E8\u7F72\u6837\u4F8B"}),"\u4E2D\uFF0CFE \u9ED8\u8BA4\u4E0D\u9650\u5236\u8D44\u6E90\u4F7F\u7528\u3002\u901A\u8FC7 Kubernetes \u7684 ",(0,l.jsx)(n.a,{href:"https://kubernetes.io/zh-cn/docs/concepts/configuration/manage-resources-containers/",children:"requests \u548C Limits"})," \u914D\u7F6E\u670D\u52A1\u7684\u8BA1\u7B97\u8D44\u6E90\u3002\u4F8B\u5982\uFF0C\u4E3A FE \u5206\u914D 8c 8Gi \u8BA1\u7B97\u8D44\u6E90\u914D\u7F6E\u5982\u4E0B\uFF1A"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"spec:\n  feSpec:\n    requests:\n      cpu: 8\n      memory: 8Gi\n    limits:\n      cpu: 8\n      memory: 8Gi\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u5C06\u4E0A\u8FF0\u914D\u7F6E\u4FE1\u606F\u66F4\u65B0\u5230",(0,l.jsxs)(n.a,{href:"/zh-CN/docs/dev/install/deploy-on-kubernetes/separating-storage-compute/install-doris-cluster#3-%E9%85%8D%E7%BD%AE-dorisdisaggregatedcluster-%E8%B5%84%E6%BA%90",children:["\u9700\u8981\u90E8\u7F72\u7684 ",(0,l.jsx)(n.code,{children:"DorisDisaggregatedCluster"})," \u8D44\u6E90"]}),"\u4E2D\u3002"]}),"\n",(0,l.jsx)(n.h2,{id:"\u914D\u7F6E-follower-\u6570\u91CF",children:"\u914D\u7F6E Follower \u6570\u91CF"}),"\n",(0,l.jsxs)(n.p,{children:["FE \u670D\u52A1\u6709 Follower \u548C Observer \u4E24\u79CD\u89D2\u8272\uFF0CFollower \u8D1F\u8D23 sql \u89E3\u6790\u4EFB\u52A1\u548C\u5143\u6570\u636E\u7684\u7BA1\u7406\u548C\u5B58\u50A8\u3002Observer \u4E3B\u8981\u8D1F\u8D23 sql \u89E3\u6790\u4EFB\u52A1\uFF0C\u5206\u62C5 Follower \u7684\u67E5\u8BE2\u548C\u5199\u5165\u8D1F\u8F7D\u4EFB\u52A1\u3002Doris \u4F7F\u7528 bdbje \u5B58\u50A8\u7CFB\u7EDF\u7BA1\u7406\u5143\u6570\u636E\uFF0Cbdbje \u5E95\u5C42\u5B9E\u73B0\u7C7B\u4F3C paxos \u534F\u8BAE\u7B97\u6CD5\u3002\n\u5206\u5E03\u5F0F\u90E8\u7F72\u4E2D\uFF0C\u9700\u8981\u914D\u7F6E\u591A\u4E2A Follower \u8282\u70B9\u53C2\u4E0E\u5206\u5E03\u5F0F\u73AF\u5883\u4E0B\u5143\u6570\u636E\u7BA1\u7406\u5DE5\u4F5C\u3002\n\u4F7F\u7528 ",(0,l.jsx)(n.code,{children:"DorisDisaggregatedCluster"})," \u8D44\u6E90\u90E8\u7F72 Doris \u5B58\u7B97\u5206\u79BB\u96C6\u7FA4\uFF0CFollower \u9ED8\u8BA4\u7684\u6570\u91CF\u4E3A 1\u3002\u53EF\u901A\u8FC7\u5982\u4E0B\u914D\u7F6E\u8BBE\u7F6E Follower \u8282\u70B9\u7684\u6570\u91CF\u3002\u8BBE\u7F6E Follower \u8282\u70B9\u6570\u91CF\u4E3A 3 \u7684\u914D\u7F6E\u793A\u4F8B\u5982\u4E0B\uFF1A"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"spec:\n  feSpec:\n    electionNumber: 3\n"})}),"\n",(0,l.jsx)(n.admonition,{title:"\u63D0\u793A",type:"tip",children:(0,l.jsxs)(n.p,{children:["\u5B58\u7B97\u5206\u79BB\u96C6\u7FA4\u90E8\u7F72\u540E\uFF0C",(0,l.jsx)(n.code,{children:"electionNumber"})," \u4E0D\u5141\u8BB8\u4FEE\u6539\u3002"]})}),"\n",(0,l.jsx)(n.h2,{id:"\u81EA\u5B9A\u4E49\u542F\u52A8\u914D\u7F6E",children:"\u81EA\u5B9A\u4E49\u542F\u52A8\u914D\u7F6E"}),"\n",(0,l.jsx)(n.p,{children:"Doris Operator \u901A\u8FC7 Kubernetes \u7684 ConfigMap \u6302\u8F7D FE \u542F\u52A8\u914D\u7F6E\u3002\u914D\u7F6E\u6B65\u9AA4\u5982\u4E0B\uFF1A"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"\u81EA\u5B9A\u4E49\u4E00\u4E2A\u5305\u542B FE \u542F\u52A8\u914D\u7F6E\u7684 ConfigMap\uFF0C\u6837\u4F8B\u5982\u4E0B\uFF1A"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: fe-configmap\n  namespace: default\n  labels:\n    app.kubernetes.io/component: fe\ndata:\n  fe.conf: |\n    CUR_DATE=`date +%Y%m%d-%H%M%S`\n    # Log dir\n    LOG_DIR = ${DORIS_HOME}/log\n    # For jdk 17, this JAVA_OPTS will be used as default JVM options\n    JAVA_OPTS_FOR_JDK_17="-Djavax.security.auth.useSubjectCredsOnly=false -Xmx8192m -Xms8192m -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=$LOG_DIR -Xlog:gc*:$LOG_DIR/fe.gc.log.$CUR_DATE:time,uptime:filecount=10,filesize=50M --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens java.base/jdk.internal.ref=ALL-UNNAMED"\n    # INFO, WARN, ERROR, FATAL\n    sys_log_level = INFO\n    # NORMAL, BRIEF, ASYNC\n    sys_log_mode = NORMAL\n    # Default dirs to put jdbc drivers,default value is ${DORIS_HOME}/jdbc_drivers\n    # jdbc_drivers_dir = ${DORIS_HOME}/jdbc_drivers\n    http_port = 8030\n    rpc_port = 9020\n    query_port = 9030\n    edit_log_port = 9010\n    enable_fqdn_mode=true\n    deploy_mode = cloud\n'})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:["\u901A\u8FC7\u5982\u4E0B\u547D\u4EE4\u90E8\u7F72 ",(0,l.jsx)(n.code,{children:"ConfigMap"})," \u5230 ",(0,l.jsx)(n.code,{children:"DorisDisaggregatedCluster"})," \u6240\u5728\u7684\u547D\u540D\u7A7A\u95F4\uFF1A"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"kubectl apply -n ${namespace} -f ${feConfigMapName}.yaml\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u5176\u4E2D\uFF0C",(0,l.jsx)(n.code,{children:"${namespace}"})," \u4E3A ",(0,l.jsx)(n.code,{children:"DorisDisaggregatedCluster"})," \u6240\u5728\u7684\u547D\u540D\u7A7A\u95F4\uFF0C${feConfigMapName} \u4E3A\u5305\u542B\u4E0A\u8FF0\u914D\u7F6E\u7684\u6587\u4EF6\u540D\u79F0\u3002"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:["\u66F4\u65B0 ",(0,l.jsxs)(n.a,{href:"/zh-CN/docs/dev/install/deploy-on-kubernetes/separating-storage-compute/install-doris-cluster#3-%E9%85%8D%E7%BD%AE-dorisdisaggregatedcluster-%E8%B5%84%E6%BA%90",children:[(0,l.jsx)(n.code,{children:"DorisDisaggregatedCluster"})," \u8D44\u6E90"]}),"\u4F7F\u7528ConfigMap\u3002\n\u5728 ",(0,l.jsx)(n.code,{children:"DorisDisaggregatedCluster"})," \u8D44\u6E90\u4E2D\uFF0C\u901A\u8FC7 ",(0,l.jsx)(n.code,{children:"feSpec.configMaps"})," \u6570\u7EC4\u6302\u8F7D ConfigMap\uFF0C \u793A\u4F8B\u5982\u4E0B\uFF1A"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"spec:\n  feSpec:\n    replicas: 2\n    configMaps:\n    - name: fe-configmap\n"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.admonition,{title:"\u63D0\u793A",type:"tip",children:(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["Kubernetes \u90E8\u7F72\u4E2D\uFF0C\u542F\u52A8\u914D\u7F6E\u4E2D\u65E0\u9700\u8981\u6DFB\u52A0 ",(0,l.jsx)(n.code,{children:"meta_service_endpoint"})," \u4EE5\u53CA ",(0,l.jsx)(n.code,{children:"cluster_id"})," \u914D\u7F6E\uFF0CDoris-Operator \u4F1A\u81EA\u52A8\u6DFB\u52A0\u76F8\u5173\u4FE1\u606F\u3002"]}),"\n",(0,l.jsxs)(n.li,{children:["Kubernetes \u90E8\u7F72\u4E2D\uFF0C\u81EA\u5B9A\u4E49\u542F\u52A8\u914D\u7F6E\u65F6\uFF0C\u5FC5\u987B\u8BBE\u5B9A ",(0,l.jsx)(n.code,{children:"enable_fqdn_mode=true"}),"\u3002"]}),"\n"]})}),"\n",(0,l.jsx)(n.h2,{id:"\u8BBF\u95EE\u914D\u7F6E",children:"\u8BBF\u95EE\u914D\u7F6E"}),"\n",(0,l.jsxs)(n.p,{children:["Doris-Operator \u4F7F\u7528 Kubernetes \u7684 Service \u63D0\u4F9B VIP \u548C\u8D1F\u8F7D\u5747\u8861\u5668\u7684\u80FD\u529B\uFF0C\u652F\u6301\u4EE5\u4E0B\u4E09\u79CD\u5BF9\u5916\u66B4\u6F0F\u6A21\u5F0F\uFF1A ",(0,l.jsx)(n.code,{children:"ClusterIP"})," \u3001 ",(0,l.jsx)(n.code,{children:"NodePort"})," \u3001 ",(0,l.jsx)(n.code,{children:"LoadBalancer"})," ."]}),"\n",(0,l.jsx)(n.h3,{id:"clusterip-\u6A21\u5F0F",children:"ClusterIP \u6A21\u5F0F"}),"\n",(0,l.jsxs)(n.p,{children:["\u5728 Kubernetes \u4E0A\u9ED8\u8BA4\u4F7F\u7528 ",(0,l.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/services-networking/service/#type-clusterip",children:"ClusterIP \u8BBF\u95EE\u6A21\u5F0F"}),"\u3002ClusterIP \u8BBF\u95EE\u6A21\u5F0F\u5728 Kubernetes \u96C6\u7FA4\u5185\u63D0\u4F9B\u4E86\u4E00\u4E2A\u5185\u90E8\u5730\u5740\uFF0C\u8BE5\u5730\u5740\u4F5C\u4E3A\u670D\u52A1\u5728 Kubernetes \u5185\u90E8\u7684\u3002"]}),"\n",(0,l.jsx)(n.h4,{id:"\u7B2C-1-\u6B65\u914D\u7F6E-clusterip",children:"\u7B2C 1 \u6B65\uFF1A\u914D\u7F6E ClusterIP"}),"\n",(0,l.jsx)(n.p,{children:"\u9ED8\u60C5\u51B5\u4E0B\uFF0CDoris \u5728 Kubernetes \u4E0A\u542F\u7528 ClusterIP \u8BBF\u95EE\u6A21\u5F0F\uFF0C\u7528\u6237\u65E0\u9700\u989D\u5916\u4FEE\u6539\u5373\u53EF\u4F7F\u7528\u8BE5\u6A21\u5F0F\u3002"}),"\n",(0,l.jsx)(n.h4,{id:"\u7B2C-2-\u6B65\u83B7\u53D6-service-\u8BBF\u95EE\u5730\u5740",children:"\u7B2C 2 \u6B65\uFF1A\u83B7\u53D6 Service \u8BBF\u95EE\u5730\u5740"}),"\n",(0,l.jsx)(n.p,{children:"\u90E8\u7F72\u96C6\u7FA4\u540E\uFF0C\u901A\u8FC7\u4EE5\u4E0B\u547D\u4EE4\u53EF\u4EE5\u67E5\u770B FE \u66B4\u9732\u7684 service\uFF1A"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"kubectl -n doris get svc\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u793A\u4F8B\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"NAME                              TYPE        CLUSTER-IP    EXTERNAL-IP   PORT(S)                               AGE\ndoriscluster-sample-fe-internal   ClusterIP   None          <none>        9030/TCP                              14m\ndoriscluster-sample-fe            ClusterIP   10.1.118.16   <none>        8030/TCP,9020/TCP,9030/TCP,9010/TCP   14m\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u5728\u4E0A\u8FF0\u7ED3\u679C\u4E2D\uFF0C\u4EE5 internal \u540E\u7F00\u7684 Service \u4EC5\u4F9B Doris \u5185\u90E8\u901A\u4FE1\u4F7F\u7528\uFF08\u5982\u5FC3\u8DF3\u548C\u6570\u636E\u4EA4\u6362\uFF09\u4E0D\u5BF9\u5916\u66B4\u6F0F\u3002 \u4E0D\u5E26 internal \u540E\u7F00\u7684 Service \u7528\u4E8E\u5916\u90E8\u8BBF\u95EE FE \u670D\u52A1\u3002"}),"\n",(0,l.jsx)(n.h4,{id:"\u7B2C-3-\u6B65\u5728\u5BB9\u5668\u5185\u90E8\u8BBF\u95EE-doris",children:"\u7B2C 3 \u6B65\uFF1A\u5728\u5BB9\u5668\u5185\u90E8\u8BBF\u95EE Doris"}),"\n",(0,l.jsx)(n.p,{children:"\u4F7F\u7528\u5982\u4E0B\u547D\u4EE4\u5728\u5F53\u524D\u7684 Kubernetes \u96C6\u7FA4\u4E2D\u521B\u5EFA\u4E00\u4E2A\u5305\u542B MySQL \u5BA2\u6237\u7AEF \u7684 Pod\uFF1A"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"kubectl run mysql-client --image=mysql:5.7 -it --rm --restart=Never --namespace=doris -- /bin/bash\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u5728\u5BB9\u5668\u5185\u90E8\uFF0C\u53EF\u4EE5\u901A\u8FC7\u8BBF\u95EE\u4E0D\u5E26\u6709 ",(0,l.jsx)(n.code,{children:"internal"})," \u540E\u7F00\u7684 Service \u540D\u79F0\u8FDE\u63A5 Doris \u96C6\u7FA4\uFF1A"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"mysql -uroot -P9030 -hdoriscluster-sample-fe-service\n"})}),"\n",(0,l.jsx)(n.h3,{id:"nodeport",children:"NodePort"}),"\n",(0,l.jsxs)(n.p,{children:["\u82E5\u9700\u4ECE Kubernetes \u96C6\u7FA4\u5916\u90E8\u8BBF\u95EE Doris\uFF0C\u53EF\u4F7F\u7528 ",(0,l.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/services-networking/service/#type-nodeport",children:"NodePort \u7684\u6A21\u5F0F"}),"\u3002NodePort \u6A21\u5F0F\u652F\u6301\u4E24\u79CD\u914D\u7F6E\u65B9\u5F0F\uFF1A\u9759\u6001\u5BBF\u4E3B\u673A\u7AEF\u53E3\u5206\u914D\u548C\u52A8\u6001\u5BBF\u4E3B\u673A\u7AEF\u53E3\u5206\u914D\u3002"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u52A8\u6001\u5BBF\u4E3B\u673A\u7AEF\u53E3\u5206\u914D"}),"\uFF1A\u5982\u679C\u672A\u663E\u793A\u8BBE\u7F6E\u7AEF\u53E3\u6620\u5C04\uFF0CKubernetes \u4F1A\u81EA\u52A8\u5206\u914D\u4E00\u4E2A\u5BBF\u4E3B\u673A\u672A\u88AB\u4F7F\u7528\u7684\u7AEF\u53E3\uFF08\u9ED8\u8BA4\u8303\u56F4\u4E3A 30000-32767\uFF09\u3002"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u9759\u6001\u5BBF\u4E3B\u673A\u7AEF\u53E3\u5206\u914D"}),"\uFF1A\u5982\u679C\u663E\u793A\u6307\u5B9A\u4E86\u7AEF\u53E3\u6620\u5C04\uFF0C\u5F53\u5BBF\u4E3B\u673A\u7AEF\u53E3\u672A\u88AB\u5360\u7528\u4E14\u65E0\u51B2\u7A81\u7684\u65F6\uFF0CKubernetes \u4F1A\u56FA\u5B9A\u5206\u914D\u8BE5\u7AEF\u53E3\u3002\n\u9759\u6001\u5206\u914D\u9700\u8981\u89C4\u5212\u7AEF\u53E3\u6620\u5C04\uFF0CDoris \u9ED8\u8BA4\u63D0\u4F9B\u4EE5\u4E0B\u7AEF\u53E3\u7528\u4E8E\u4E0E\u5916\u90E8\u4EA4\u4E92\uFF1A"]}),"\n"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"\u7AEF\u53E3\u540D\u79F0"}),(0,l.jsx)(n.th,{children:"\u9ED8\u8BA4\u7AEF\u53E3"}),(0,l.jsx)(n.th,{children:"\u7AEF\u53E3\u63CF\u8FF0"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Query Port"}),(0,l.jsx)(n.td,{children:"9030"}),(0,l.jsx)(n.td,{children:"\u7528\u4E8E\u901A\u8FC7 MySQL \u534F\u8BAE\u8BBF\u95EE Doris \u96C6\u7FA4"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"HTTP Port"}),(0,l.jsx)(n.td,{children:"8030"}),(0,l.jsx)(n.td,{children:"FE \u4E0A\u7684 http server \u7AEF\u53E3\uFF0C\u7528\u4E8E\u67E5\u770B FE \u7684\u4FE1\u606F"})]})]})]}),"\n",(0,l.jsx)(n.h4,{id:"\u7B2C-1-\u6B65\u914D\u7F6E-fe-nodeport",children:"\u7B2C 1 \u6B65\uFF1A\u914D\u7F6E FE NodePort"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"\u52A8\u6001\u5206\u914D\u914D\u7F6E\uFF1A"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"spec:\n  feSpec:\n    service:\n      type: NodePort\n"})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"\u9759\u6001\u5206\u914D\u914D\u7F6E\u793A\u4F8B\uFF1A"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"spec:\n  feSpec:\n    service:\n      type: NodePort\n      portMaps:\n      - nodePort: 31001\n        targetPort: 8030\n      - nodePort: 31002\n        targetPort: 9030\n"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"\u7B2C-2-\u6B65\u83B7\u53D6-service",children:"\u7B2C 2 \u6B65\uFF1A\u83B7\u53D6 Service"}),"\n",(0,l.jsxs)(n.p,{children:["\u96C6\u7FA4\u90E8\u7F72\u5B8C\u6210\u540E\uFF0C\u901A\u8FC7\u4EE5\u4E0B\u547D\u4EE4\u67E5\u770B ",(0,l.jsx)(n.code,{children:"Service"})," \uFF1A"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"kubectl get service\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"NAME                              TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)                                                       AGE\nkubernetes                        ClusterIP   10.152.183.1     <none>        443/TCP                                                       169d\ndoriscluster-sample-fe-internal   ClusterIP   None             <none>        9030/TCP                                                      2d\ndoriscluster-sample-fe            NodePort    10.152.183.58    <none>        8030:31041/TCP,9020:30783/TCP,9030:31545/TCP,9010:31610/TCP   2d\n"})}),"\n",(0,l.jsx)(n.h4,{id:"\u7B2C-3-\u6B65\u4F7F\u7528-nodeport-\u8BBF\u95EE-doris",children:"\u7B2C 3 \u6B65\uFF1A\u4F7F\u7528 NodePort \u8BBF\u95EE Doris"}),"\n",(0,l.jsx)(n.p,{children:"\u4EE5 MySQL \u8FDE\u63A5\u4E3A\u4F8B\uFF0CDoris \u7684 Query Port \u6620\u5C04\u5230\u5BBF\u4E3B\u673A\u7AEF\u53E3 31545\u3002\u9996\u5148\u83B7\u53D6\u5230 Kubernetes \u96C6\u7FA4\u4EFB\u4E00 node \u7684 IP \u5730\u5740\uFF0C\u4F8B\u5982\u901A\u8FC7\uFF1A"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"kubectl get nodes -owide\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u793A\u4F8B\u8FD4\u56DE\uFF1A"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"NAME   STATUS   ROLES           AGE   VERSION   INTERNAL-IP     EXTERNAL-IP   OS-IMAGE          KERNEL-VERSION          CONTAINER-RUNTIME\nr60    Ready    control-plane   14d   v1.28.2   192.168.88.60   <none>        CentOS Stream 8   4.18.0-294.el8.x86_64   containerd://1.6.22\nr61    Ready    <none>          14d   v1.28.2   192.168.88.61   <none>        CentOS Stream 8   4.18.0-294.el8.x86_64   containerd://1.6.22\nr62    Ready    <none>          14d   v1.28.2   192.168.88.62   <none>        CentOS Stream 8   4.18.0-294.el8.x86_64   containerd://1.6.22\nr63    Ready    <none>          14d   v1.28.2   192.168.88.63   <none>        CentOS Stream 8   4.18.0-294.el8.x86_64   containerd://1.6.22\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u4F7F\u7528\u5176\u4E2D\u4EFB\u4E00\u8282\u70B9\u7684 IP\uFF08\u5982 192.168.88.62\uFF09\uFF0C\u901A\u8FC7\u4EE5\u4E0B\u547D\u4EE4\u8FDE\u63A5 Doris \u96C6\u7FA4\uFF1A"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"mysql -h 192.168.88.62 -P 31545 -uroot\n"})}),"\n",(0,l.jsx)(n.h3,{id:"loadbalancer",children:"LoadBalancer"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/services-networking/service/#loadbalancer",children:"LoadBalancer"})," \u6A21\u5F0F\u9002\u7528\u4E8E\u4E91\u5E73\u53F0\u7684 Kubernetes \u73AF\u5883\uFF0C\u662F\u7531\u4E91\u670D\u52A1\u5546\u63D0\u4F9B\u7684\u8D1F\u8F7D\u5747\u8861\u5668\u3002"]}),"\n",(0,l.jsx)(n.h4,{id:"\u7B2C-1-\u6B65\u914D\u7F6E-loadbalancer-\u6A21\u5F0F",children:"\u7B2C 1 \u6B65\uFF1A\u914D\u7F6E LoadBalancer \u6A21\u5F0F"}),"\n",(0,l.jsxs)(n.p,{children:["\u5728 ",(0,l.jsx)(n.code,{children:"feSpec.service"})," \u4E2D\u8BBE\u7F6E\u7C7B\u578B\u4E3A LoadBalancer\uFF0C\u5982\u4E0B\u6240\u793A\uFF1A"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'spec:\n  feSpec:\n    service:\n      type: LoadBalancer\n      annotations:\n        service.beta.kubernetes.io/load-balancer-type: "external"\n'})}),"\n",(0,l.jsx)(n.h4,{id:"\u7B2C-2-\u6B65\u83B7\u53D6-service-1",children:"\u7B2C 2 \u6B65\uFF1A\u83B7\u53D6 Service"}),"\n",(0,l.jsxs)(n.p,{children:["\u5728\u90E8\u7F72\u96C6\u7FA4\u540E\uFF0C\u901A\u8FC7\u4EE5\u4E0B\u547D\u4EE4\u67E5\u770B ",(0,l.jsx)(n.code,{children:"Service"}),"\uFF1A"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"kubectl get service\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u793A\u4F8B\u8FD4\u56DE\u7ED3\u679C\uFF1A"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"NAME                              TYPE           CLUSTER-IP       EXTERNAL-IP                                                                     PORT(S)                                                       AGE\nkubernetes                        ClusterIP      10.152.183.1     <none>                                                                          443/TCP                                                       169d\ndoriscluster-sample-fe-internal   ClusterIP      None             <none>                                                                          9030/TCP                                                      2d\ndoriscluster-sample-fe            LoadBalancer   10.152.183.58    ac4828493dgrftb884g67wg4tb68gyut-1137856348.us-east-1.elb.amazonaws.com         8030:31041/TCP,9020:30783/TCP,9030:31545/TCP,9010:31610/TCP   2d\n"})}),"\n",(0,l.jsx)(n.h4,{id:"\u7B2C-3-\u6B65\u4F7F\u7528-loadbalancer-\u8BBF\u95EE",children:"\u7B2C 3 \u6B65\uFF1A\u4F7F\u7528 LoadBalancer \u8BBF\u95EE"}),"\n",(0,l.jsx)(n.p,{children:"\u4EE5 MySQL \u8FDE\u63A5\u4E3A\u4F8B\uFF0C\u5047\u8BBE Query Port \u7684\u76D1\u542C\u7AEF\u53E3\u4E3A 9030\uFF0C\u5219\u53EF\u4F7F\u7528\u5982\u4E0B\u547D\u4EE4\u8FDE\u63A5 Doris \u96C6\u7FA4\uFF1A"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"mysql -h ac4828493dgrftb884g67wg4tb68gyut-1137856348.us-east-1.elb.amazonaws.com -P 9030 -uroot\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u6301\u4E45\u5316\u5B58\u50A8",children:"\u6301\u4E45\u5316\u5B58\u50A8"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.a,{href:"https://github.com/apache/doris-operator/blob/master/doc/examples/disaggregated/cluster/ddc-sample.yaml",children:"\u9ED8\u8BA4\u90E8\u7F72"}),"\u4E2D\uFF0CFE \u670D\u52A1\u4F7F\u7528 Kubernetes \u7684 ",(0,l.jsx)(n.a,{href:"https://kubernetes.io/zh-cn/docs/concepts/storage/volumes/#emptydir",children:"EmptyDir"})," \u4F5C\u4E3A\u5143\u6570\u636E\u5B58\u50A8\u6A21\u5F0F\u3002\u7531\u4E8E ",(0,l.jsx)(n.code,{children:"EmptyDir"})," \u6A21\u5F0F\u662F\u975E\u6301\u4E45\u5316\u5B58\u50A8\u6A21\u5F0F\uFF0C\u670D\u52A1\u91CD\u542F\u540E\u5143\u6570\u636E\u4F1A\u4E22\u5931\u3002\n\u4E3A\u4E86\u4FDD\u8BC1 FE \u5143\u6570\u636E\u5728\u91CD\u542F\u540E\u4E0D\u4E22\u5931\uFF0C\u9700\u8981\u914D\u7F6E\u6301\u4E45\u5316\u5B58\u50A8\u3002"]}),"\n",(0,l.jsx)(n.h3,{id:"\u4F7F\u7528\u5B58\u50A8\u6A21\u677F\u81EA\u52A8\u751F\u6210",children:"\u4F7F\u7528\u5B58\u50A8\u6A21\u677F\u81EA\u52A8\u751F\u6210"}),"\n",(0,l.jsx)(n.p,{children:"\u4F7F\u7528\u5B58\u50A8\u6A21\u677F\u5BF9\u65E5\u5FD7\u548C\u5143\u6570\u636E\u8FDB\u884C\u6301\u4E45\u5316\u914D\u7F6E\uFF0C\u793A\u4F8B\u5982\u4E0B\uFF1A"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"spec:\n  feSpec:\n    persistentVolumes:\n    - persistentVolumeClaimSpec:\n      # storageClassName: ${storageclass_name}\n        accessModes:\n          - ReadWriteOnce\n        resources:\n          requests:\n            storage: 200Gi\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u4F7F\u7528\u5982\u4E0A\u914D\u7F6E\u90E8\u7F72\u96C6\u7FA4\u540E\uFF0CDoris Operator \u4F1A\u81EA\u52A8\u4E3A\u65E5\u5FD7\u76EE\u5F55\uFF08\u9ED8\u8BA4\u4E3A ",(0,l.jsx)(n.code,{children:"/opt/apache-doris/fe/log"}),"\uFF09\u4EE5\u53CA\u5143\u6570\u636E\u76EE\u5F55\uFF08\u9ED8\u8BA4\u4E3A ",(0,l.jsx)(n.code,{children:"/opt/apache-doris/fe/doris-meta"}),"\uFF09\u6302\u8F7D\u6301\u4E45\u5316\u5B58\u50A8\u3002 \u5982\u679C\u5728",(0,l.jsx)(n.a,{href:"#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%90%AF%E5%8A%A8%E9%85%8D%E7%BD%AE",children:"\u81EA\u5B9A\u4E49\u542F\u52A8\u914D\u7F6E"}),"\u4E2D\u663E\u793A\u6307\u5B9A\u4E86\u65E5\u5FD7\u6216\u5143\u6570\u636E\u76EE\u5F55\uFF0CDoris Operator \u4F1A\u81EA\u52A8\u89E3\u6790\u5E76\u8FDB\u884C\u6302\u8F7D\u3002\n\u6301\u4E45\u5316\u5B58\u50A8\u91C7\u7528 ",(0,l.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/storage/storage-classes/",children:"StorageClass \u6A21\u5F0F"}),"\uFF0C\u53EF\u4EE5\u901A\u8FC7 ",(0,l.jsx)(n.code,{children:"storageClassName"})," \u6307\u5B9A\u6240\u9700\u7684 StorageClass\u3002"]}),"\n",(0,l.jsx)(n.h3,{id:"\u81EA\u5B9A\u4E49\u6302\u8F7D\u70B9\u914D\u7F6E",children:"\u81EA\u5B9A\u4E49\u6302\u8F7D\u70B9\u914D\u7F6E"}),"\n",(0,l.jsx)(n.p,{children:"Doris Operator \u652F\u6301\u5BF9\u6302\u8F7D\u76EE\u5F55\u8FDB\u884C\u4E2A\u6027\u5316\u5B58\u50A8\u914D\u7F6E\u3002\u4E3A\u65E5\u5FD7\u76EE\u5F55\u4F7F\u7528\u81EA\u5B9A\u4E49\u5B58\u50A8\u914D\u7F6E\u6302\u8F7D 300Gi \u7684\u5B58\u50A8\u78C1\u76D8\uFF0C\u4E3A\u5143\u6570\u636E\u76EE\u5F55\u4F7F\u7528\u5B58\u50A8\u6A21\u677F\u6302\u8F7D 200Gi \u7684\u5B58\u50A8\u78C1\u76D8\uFF1A"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"spec:\n  feSpec:\n    persistentVolumes:\n    - mountPaths:\n      - /opt/apache-doris/fe/log\n      persistentVolumeClaimSpec:\n      # storageClassName: ${storageclass_name}\n        accessModes:\n          - ReadWriteOnce\n        resources:\n          requests:\n            storage: 300Gi\n    - persistentVolumeClaimSpec:\n      # storageClassName: ${storageclass_name}\n        accessModes:\n          - ReadWriteOnce\n        resources:\n          requests:\n            storage: 200Gi\n"})}),"\n",(0,l.jsx)(n.admonition,{title:"\u63D0\u793A",type:"tip",children:(0,l.jsxs)(n.p,{children:["\u82E5 ",(0,l.jsx)(n.code,{children:"mountPaths"})," \u6570\u7EC4\u4E3A\u7A7A\uFF0C\u5219\u8868\u793A\u5F53\u524D\u5B58\u50A8\u914D\u7F6E\u4E3A\u6A21\u677F\u914D\u7F6E\u3002"]})}),"\n",(0,l.jsx)(n.h3,{id:"\u4E0D\u6301\u4E45\u5316\u65E5\u5FD7",children:"\u4E0D\u6301\u4E45\u5316\u65E5\u5FD7"}),"\n",(0,l.jsx)(n.p,{children:"\u5982\u679C\u4E0D\u5E0C\u671B\u5C06\u65E5\u5FD7\u6301\u4E45\u5316\uFF0C\u800C\u4EC5\u8F93\u51FA\u5230\u6807\u51C6\u8F93\u51FA\uFF0C\u5219\u53EF\u914D\u7F6E\u5982\u4E0B\uFF1A"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"spec:\n  feSpec:\n    logNotStore: true\n"})})]})}function h(e={}){let{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(t,{...e})}):t(e)}},250065:function(e,n,s){s.d(n,{Z:function(){return a},a:function(){return c}});var r=s(667294);let l={},i=r.createContext(l);function c(e){let n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:c(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);