"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["48028"],{316051:function(e,n,i){i.r(n),i.d(n,{default:()=>d,frontMatter:()=>l,metadata:()=>s,assets:()=>o,toc:()=>m,contentTitle:()=>t});var s=JSON.parse('{"id":"query-acceleration/query-profile","title":"Profile \u5206\u6790\u6307\u5357","description":"Apache Doris \u63D0\u4F9B Query Profile \u7528\u4E8E\u5C55\u793A\u67E5\u8BE2\u6267\u884C\u7EC6\u8282\u3002\u672C\u6587\u4ECB\u7ECD Query Profile \u7684\u6574\u4F53\u67B6\u6784\u4E0E\u5E38\u7528\u5B9E\u8DF5\uFF0C\u4E3B\u8981\u5305\u62EC\uFF1A","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs/version-4.x/query-acceleration/query-profile.md","sourceDirName":"query-acceleration","slug":"/query-acceleration/query-profile","permalink":"/zh-CN/docs/4.x/query-acceleration/query-profile","draft":false,"unlisted":false,"tags":[],"version":"4.x","lastUpdatedAt":1770477659000,"frontMatter":{"title":"Profile \u5206\u6790\u6307\u5357","language":"zh-CN","description":"Apache Doris \u63D0\u4F9B Query Profile \u7528\u4E8E\u5C55\u793A\u67E5\u8BE2\u6267\u884C\u7EC6\u8282\u3002\u672C\u6587\u4ECB\u7ECD Query Profile \u7684\u6574\u4F53\u67B6\u6784\u4E0E\u5E38\u7528\u5B9E\u8DF5\uFF0C\u4E3B\u8981\u5305\u62EC\uFF1A"},"sidebar":"docs","previous":{"title":"\u5B57\u5178\u8868\uFF08\u5B9E\u9A8C\u6027\u529F\u80FD\uFF09","permalink":"/zh-CN/docs/4.x/query-acceleration/dictionary"},"next":{"title":"BITMAP \u7CBE\u51C6\u53BB\u91CD","permalink":"/zh-CN/docs/4.x/query-acceleration/distinct-counts/bitmap-precise-deduplication"}}'),r=i("785893"),a=i("250065");let l={title:"Profile \u5206\u6790\u6307\u5357",language:"zh-CN",description:"Apache Doris \u63D0\u4F9B Query Profile \u7528\u4E8E\u5C55\u793A\u67E5\u8BE2\u6267\u884C\u7EC6\u8282\u3002\u672C\u6587\u4ECB\u7ECD Query Profile \u7684\u6574\u4F53\u67B6\u6784\u4E0E\u5E38\u7528\u5B9E\u8DF5\uFF0C\u4E3B\u8981\u5305\u62EC\uFF1A"},t="\u6982\u8FF0",o={},m=[{value:"\u5F00\u542F Profile",id:"\u5F00\u542F-profile",level:2},{value:"enable_profile",id:"enable_profile",level:3},{value:"profile_level",id:"profile_level",level:3},{value:"auto_profile_threshold_ms",id:"auto_profile_threshold_ms",level:3},{value:"\u914D\u7F6E Profile \u5B58\u50A8",id:"\u914D\u7F6E-profile-\u5B58\u50A8",level:2},{value:"max_query_profile_num",id:"max_query_profile_num",level:3},{value:"max_spilled_profile_num",id:"max_spilled_profile_num",level:3},{value:"spilled_profile_storage_path",id:"spilled_profile_storage_path",level:3},{value:"spilled_profile_storage_limit_bytes",id:"spilled_profile_storage_limit_bytes",level:3},{value:"\u83B7\u53D6 Profile",id:"\u83B7\u53D6-profile",level:2},{value:"\u901A\u8FC7 FE Web UI \u83B7\u53D6",id:"\u901A\u8FC7-fe-web-ui-\u83B7\u53D6",level:3},{value:"\u901A\u8FC7\u547D\u4EE4\u884C\u83B7\u53D6",id:"\u901A\u8FC7\u547D\u4EE4\u884C\u83B7\u53D6",level:3},{value:"\u76F4\u63A5\u4ECE\u78C1\u76D8\u91CC\u83B7\u53D6 Profile \u6587\u4EF6",id:"\u76F4\u63A5\u4ECE\u78C1\u76D8\u91CC\u83B7\u53D6-profile-\u6587\u4EF6",level:3},{value:"Profile \u7ED3\u6784",id:"profile-\u7ED3\u6784",level:2},{value:"Profile \u89E3\u8BFB\u4F8B\u5B50",id:"profile-\u89E3\u8BFB\u4F8B\u5B50",level:2},{value:"Query &amp; Fragment &amp; PlanNode",id:"query--fragment--plannode",level:3},{value:"Pipeline &amp; Operator",id:"pipeline--operator",level:3},{value:"CommonCounters &amp; CustomCounters",id:"commoncounters--customcounters",level:3},{value:"HashJoin",id:"hashjoin",level:3},{value:"Aggregation",id:"aggregation",level:3}];function c(e){let n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"\u6982\u8FF0",children:"\u6982\u8FF0"})}),"\n",(0,r.jsx)(n.p,{children:"Apache Doris \u63D0\u4F9B Query Profile \u7528\u4E8E\u5C55\u793A\u67E5\u8BE2\u6267\u884C\u7EC6\u8282\u3002\u672C\u6587\u4ECB\u7ECD Query Profile \u7684\u6574\u4F53\u67B6\u6784\u4E0E\u5E38\u7528\u5B9E\u8DF5\uFF0C\u4E3B\u8981\u5305\u62EC\uFF1A"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u91C7\u96C6\u6D41\u7A0B\uFF1AProfile \u5982\u4F55\u4ECE\u5404 Backend \u6536\u96C6\u5E76\u5728 Frontend \u5B58\u50A8\u3002"}),"\n",(0,r.jsx)(n.li,{children:"\u91C7\u96C6\u76F8\u5173\u53C2\u6570\uFF1A\u5982\u4F55\u914D\u7F6E\u4EE5\u8FC7\u6EE4\u65E0\u7528\u4FE1\u606F\uFF0C\u4E13\u6CE8\u5173\u952E\u67E5\u8BE2\u7EC6\u8282\u3002"}),"\n",(0,r.jsx)(n.li,{children:"\u89E3\u8BFB\u65B9\u6CD5\uFF1A\u5982\u4F55\u5FEB\u901F\u5B9A\u4F4D\u5F71\u54CD\u67E5\u8BE2\u6027\u80FD\u7684\u7B97\u5B50\u3002"}),"\n"]}),"\n",(0,r.jsx)(n.h1,{id:"query-profile-\u7684\u6574\u4F53\u67B6\u6784",children:"Query Profile \u7684\u6574\u4F53\u67B6\u6784"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"alt text",src:i(954888).Z+"",width:"1280",height:"889"})}),"\n",(0,r.jsxs)(n.p,{children:["Query Profile \u7684\u6838\u5FC3\u7531\u4E24\u90E8\u5206\u7EC4\u6210\uFF1AFE \u7684 ",(0,r.jsx)(n.code,{children:"ProfileManager"})," \u4E0E BE \u7684 ",(0,r.jsx)(n.code,{children:"AsyncReportThreadPool"}),"\u3002"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\u7528\u6237\u53D1\u8D77\u67E5\u8BE2\u65F6\uFF0CFE \u5728\u67E5\u8BE2\u5F00\u59CB\u524D\u5C06 Profile \u76F8\u5173\u6570\u636E\u7ED3\u6784\u6CE8\u518C\u5230 ",(0,r.jsx)(n.code,{children:"ProfileManager"}),"\u3002"]}),"\n",(0,r.jsx)(n.li,{children:"BE \u7684\u6BCF\u4E2A\u67E5\u8BE2\u5B8C\u6210\u540E\uFF0C\u4F1A\u5C06\u81EA\u8EAB\u7684 Profile \u4F5C\u4E3A\u4EFB\u52A1\u6CE8\u518C\u5230\u7528\u4E8E\u5F02\u6B65\u4E0A\u62A5\u81F3 FE \u7684\u7EBF\u7A0B\u6C60\u3002"}),"\n",(0,r.jsxs)(n.li,{children:["BE \u7684 ",(0,r.jsx)(n.code,{children:"AsyncReportThreadPool"})," \u4EE5\u67E5\u8BE2\u4E3A\u7C92\u5EA6\u53D1\u8D77 RPC\uFF0C\u5C06 Profile \u6570\u636E\u53D1\u9001\u5230 FE\u3002"]}),"\n",(0,r.jsx)(n.li,{children:"FE \u4FA7\u540E\u53F0\u7EBF\u7A0B\u5904\u7406\u5E76\u7BA1\u7406\u6536\u96C6\u5230\u7684 Profile\uFF0C\u6309\u7B56\u7565\u51B3\u5B9A\u4FDD\u7559\u4E0E\u6DD8\u6C70\uFF0C\u5E76\u5C06\u5408\u9002\u7684 Profile \u538B\u7F29\u540E\u5199\u5165\u5B58\u50A8\u3002"}),"\n",(0,r.jsx)(n.li,{children:"\u7528\u6237\u901A\u8FC7 Web UI \u6216 curl \u53D1\u9001 HTTP \u8BF7\u6C42\u67E5\u770B Profile\u3002"}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ProfileManager"})," \u4F1A\u4ECE\u5185\u5B58\u6216\u5916\u90E8\u5B58\u50A8\u4E2D\u67E5\u627E Profile\uFF0C\u5E76\u4EE5\u6587\u672C\u5F62\u5F0F\u8FD4\u56DE\u3002"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"\u6574\u4E2A\u6536\u96C6\u6D41\u7A0B\u4E2D\uFF0C\u7B2C\u4E8C\u6B65\u7684\u5F02\u6B65\u6C47\u62A5\u4E0E\u7B2C\u56DB\u6B65\u7684 Profile \u6301\u4E45\u5316\u5BF9 Profile \u529F\u80FD\u5F71\u54CD\u6700\u5927\u3002"}),"\n",(0,r.jsxs)(n.p,{children:["\u5728\u96C6\u7FA4\u538B\u529B\u8F83\u5927\u65F6\uFF0C\u5F02\u6B65\u6C47\u62A5\u53EF\u80FD\u51FA\u73B0\u8D85\u65F6\u3002\u4E3A\u907F\u514D FE \u4FA7\u5360\u7528\u8FC7\u591A\u5185\u5B58\uFF0C",(0,r.jsx)(n.code,{children:"ProfileManager"})," \u4F1A\u5728\u7B49\u5F85\u4E00\u6BB5\u65F6\u95F4\u540E\u653E\u5F03\u8D85\u65F6\u7684 Profile\u3002\u53EF\u8C03\u6574 ",(0,r.jsx)(n.code,{children:"fe.conf"})," \u4E2D\u7684 ",(0,r.jsx)(n.code,{children:"profile_async_collect_expire_time_secs"})," \u63A7\u5236\u7B49\u5F85\u65F6\u957F\u3002\u82E5\u9891\u7E41\u8D85\u65F6\uFF0C\u5EFA\u8BAE\u4F18\u5148\u68C0\u67E5\u673A\u5668\u8D44\u6E90\u4F7F\u7528\u7387\uFF1B\u5FC5\u8981\u65F6\u53EF\u5173\u95ED\u5168\u5C40 Profile \u4EE5\u964D\u4F4E\u98CE\u9669\u3002"]}),"\n",(0,r.jsx)(n.p,{children:"ProfileManager \u628A Profile \u6301\u4E45\u5316\u5230\u78C1\u76D8\u540E\uFF0C\u53EF\u4EE5\u786E\u4FDD\uFF1A"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Profile \u4E0D\u518D\u5360\u636E FE \u7684\u5927\u91CF\u5185\u5B58"}),"\n",(0,r.jsx)(n.li,{children:"FE \u91CD\u542F\u540E\u4F9D\u7136\u80FD\u591F\u67E5\u8BE2\u5230\u4E4B\u524D\u7684 Profile"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"\u524D\u8005\u4F7F FE \u80FD\u591F\u4FDD\u7559\u6570\u5343\u4EFD\u5B8C\u6574 Profile\uFF0C\u540E\u8005\u4FBF\u4E8E\u5BF9\u6BD4\u96C6\u7FA4\u5347\u7EA7\u524D\u540E\u7684\u8868\u73B0\uFF0C\u4ECE\u800C\u9A8C\u8BC1\u7248\u672C\u5347\u7EA7\u662F\u5426\u63D0\u5347 Doris \u67E5\u8BE2\u6027\u80FD\u3002"}),"\n",(0,r.jsx)(n.h1,{id:"\u914D\u7F6Eprofile",children:"\u914D\u7F6EProfile"}),"\n",(0,r.jsx)(n.h2,{id:"\u5F00\u542F-profile",children:"\u5F00\u542F Profile"}),"\n",(0,r.jsx)(n.h3,{id:"enable_profile",children:"enable_profile"}),"\n",(0,r.jsx)(n.p,{children:"\u5F53\u8BE5\u53C2\u6570\u4E3A false \u65F6\uFF0C\u4E0D\u4F1A\u751F\u6210 Profile\u3002\u9ED8\u8BA4\u503C\u4E3A false\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"mysql> select 1;\n--------------\nselect 1\n--------------\n\n+------+\n| 1    |\n+------+\n|    1 |\n+------+\n1 row in set (0.00 sec)\n\nmysql> show query profile;\n--------------\nshow query profile\n--------------\n\n+-----------------------------------+-----------+---------------------+---------------------+-------+------------+------+-----------------+------------+---------------+\n| Profile ID                        | Task Type | Start Time          | End Time            | Total | Task State | User | Default Catalog | Default Db | Sql Statement |\n+-----------------------------------+-----------+---------------------+---------------------+-------+------------+------+-----------------+------------+---------------+\n| 74b9e30d6ba7491d-9dbf9289f6f5c208 | QUERY     | 2025-02-26 18:47:07 | 2025-02-26 18:47:07 | 4ms   | EOF        | root | internal        | tpcds      | select 1      |\n+-----------------------------------+-----------+---------------------+---------------------+-------+------------+------+-----------------+------------+---------------+\n1 row in set (0.01 sec)\n\nmysql> set enable_profile=false;\n--------------\nset enable_profile=false\n--------------\n\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> select 1;\n--------------\nselect 1\n--------------\n\n+------+\n| 1    |\n+------+\n|    1 |\n+------+\n1 row in set (0.01 sec)\n\nmysql> show query profile;\n--------------\nshow query profile\n--------------\n\n+-----------------------------------+-----------+---------------------+---------------------+-------+------------+------+-----------------+------------+---------------+\n| Profile ID                        | Task Type | Start Time          | End Time            | Total | Task State | User | Default Catalog | Default Db | Sql Statement |\n+-----------------------------------+-----------+---------------------+---------------------+-------+------------+------+-----------------+------------+---------------+\n| 74b9e30d6ba7491d-9dbf9289f6f5c208 | QUERY     | 2025-02-26 18:47:07 | 2025-02-26 18:47:07 | 4ms   | EOF        | root | internal        | tpcds      | select 1      |\n+-----------------------------------+-----------+---------------------+---------------------+-------+------------+------+-----------------+------------+---------------+\n1 row in set (0.00 sec)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"profile_level",children:"profile_level"}),"\n",(0,r.jsxs)(n.p,{children:["\u9ED8\u8BA4\u503C\u4E3A 1\u3002",(0,r.jsx)(n.strong,{children:"\u8BE5\u53C2\u6570\u5728 4.0 \u53CA master \u5206\u652F\u751F\u6548, \u4E0D\u8981\u5728 4.0 \u7248\u672C\u4E4B\u524D\u4F7F\u7528\u8BE5\u53C2\u6570\uFF0C4.0 \u4E4B\u524D\u6709\u4E0D\u540C\u7684\u8BED\u610F\u3002"})]}),"\n",(0,r.jsxs)(n.p,{children:["\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0CBE \u4EC5\u6C47\u62A5\u7CBE\u7B80\u7248 Profile\uFF08\u8DB3\u4EE5\u5728 FE \u805A\u5408\u4E3A MergedProfile\uFF09\u3002\u82E5\u9700\u8981\u66F4\u8BE6\u7EC6\u4FE1\u606F\u4E14\u5C3D\u91CF\u4E0D\u5F71\u54CD\u6027\u80FD\uFF0C\u53EF\u8BBE\u7F6E ",(0,r.jsx)(n.code,{children:"profile_level=2"}),"\u3002\u76EE\u524D\u6700\u5927\u4E3A 3\uFF0Clevel \u4E3A 3 \u65F6\uFF0C\u90E8\u5206 Counter \u7684\u91C7\u96C6\u53EF\u80FD\u5F71\u54CD\u67E5\u8BE2\u6027\u80FD\u3002"]}),"\n",(0,r.jsxs)(n.p,{children:["\u4F8B\uFF1A\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C",(0,r.jsx)(n.code,{children:"EXCHANGE_OPERATOR"})," \u7684 Counter \u5982\u4E0B\uFF1A"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"EXCHANGE_OPERATOR(id=1):\n     - InstanceID: ef33b72e30b84b68-82ad027edbee5910\n     - BlocksProduced: 1\n     - CloseTime: 4.243us\n     - ExecTime: 30.834us\n     - InitTime: 20.902us\n     - MemoryUsage: 0.00 \n     - MemoryUsagePeak: 36.00 KB\n     - OpenTime: 1.93us\n     - ProjectionTime: 0ns\n     - RowsProduced: 10\n     - WaitForDependencyTime: 0ns\n       - WaitForData0: 635.324us\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5F53 ",(0,r.jsx)(n.code,{children:"profile_level=2"})," \u65F6\uFF0C\u53EF\u4EE5\u770B\u5230\u66F4\u8BE6\u7EC6\u7684 Counter\uFF1A"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"EXCHANGE_OPERATOR(id=1):\n     - InstanceID: 514023de1b7b41a3-9e59e43c591103a2\n     - BlocksProduced: 1\n     - CloseTime: 3.523us\n     - CreateMergerTime: 0ns\n     - DataArrivalWaitTime: 0ns\n     - DecompressBytes: 0.00 \n     - DecompressTime: 0ns\n     - DeserializeRowBatchTimer: 0ns\n     - ExecTime: 28.439us\n     - FilterTime: 287ns\n     - FirstBatchArrivalWaitTime: 0ns\n     - GetDataFromRecvrTime: 3.482us\n     - InitTime: 18.258us\n     - LocalBytesReceived: 36.00 KB\n     - MaxFindRecvrTime(NS): 0\n     - MaxWaitForWorkerTime: 0\n     - MaxWaitToProcessTime: 0\n     - MemoryUsage: 0.00 \n     - MemoryUsagePeak: 36.00 KB\n     - OpenTime: 1.44us\n     - ProjectionTime: 0ns\n     - RemoteBytesReceived: 0.00 \n     - RowsProduced: 10\n     - SendersBlockedTotalTimer(*): 0ns\n     - WaitForDependencyTime: 0ns\n       - WaitForData0: 596.708us\n"})}),"\n",(0,r.jsx)(n.h3,{id:"auto_profile_threshold_ms",children:"auto_profile_threshold_ms"}),"\n",(0,r.jsx)(n.p,{children:"auto_profile_threshold_ms\uFF1A\u9ED8\u8BA4\u503C -1\u3002\u8BE5\u53C2\u6570\u5728 3.0 \u53CA\u4E4B\u540E\u7248\u672C\u751F\u6548\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u5168\u5C40\u5F00\u542F Profile \u4F1A\u4EA7\u751F\u5927\u91CF\u6570\u636E\uFF0C\u5360\u7528 FE CPU\u3001\u5185\u5B58\u4E0E\u78C1\u76D8\uFF0C\u5E76\u5F71\u54CD\u5BF9\u65F6\u5EF6\u654F\u611F\u7684\u5C0F\u67E5\u8BE2\uFF0C\u56E0\u6B64 FE \u4F1A\u5B9A\u671F\u6E05\u7406 Profile\u3002\u4E3A\u907F\u514D\u6162\u67E5\u8BE2\u7684 Profile \u88AB\u6E05\u7406\uFF0C\u53EF\u901A\u8FC7\u8BE5\u53C2\u6570\u9650\u5236\u4EC5\u5F53\u67E5\u8BE2\u8017\u65F6\u8D85\u8FC7\u9608\u503C\u65F6\u624D\u751F\u6210\u4E0E\u4FDD\u7559 Profile\u3002\u9ED8\u8BA4 -1\uFF0C\u8868\u793A\u6240\u6709\u67E5\u8BE2\u90FD\u4F1A\u751F\u6210 Profile\u3002\n\u6BD4\u5982\u5047\u8BBE\u6211\u4EEC\u5F00\u4E86\u5168\u5C40\u7684 profile\uFF0C\u6B64\u65F6\u6240\u6709\u67E5\u8BE2\u90FD\u4F1A\u751F\u6210 profile"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"mysql> show query profile;\n--------------\nshow query profile\n--------------\n\n+-----------------------------------+-----------+---------------------+---------------------+-------+------------+------+-----------------+------------+---------------+\n| Profile ID                        | Task Type | Start Time          | End Time            | Total | Task State | User | Default Catalog | Default Db | Sql Statement |\n+-----------------------------------+-----------+---------------------+---------------------+-------+------------+------+-----------------+------------+---------------+\n| d59b04f636e49c0-bf6b6b3011c40f67  | QUERY     | 2025-02-26 18:25:59 | 2025-02-26 18:25:59 | 3ms   | EOF        | root | internal        | tpcds      | select 1      |\n| f2ccb78011aa4526-9919ee76af1e57d7 | QUERY     | 2025-02-26 18:25:59 | 2025-02-26 18:25:59 | 4ms   | EOF        | root | internal        | tpcds      | select 1      |\n| a8464728ebf5481d-864e3016ad22f045 | QUERY     | 2025-02-26 18:25:58 | 2025-02-26 18:25:58 | 6ms   | EOF        | root | internal        | tpcds      | select 1      |\n| 912b09ea8f634c47-89e65d4fe354a94b | QUERY     | 2025-02-26 18:25:58 | 2025-02-26 18:25:58 | 4ms   | EOF        | root | internal        | tpcds      | select 1      |\n| e6e6f0a3a31640bc-ad5994de0334ae8d | QUERY     | 2025-02-26 18:25:57 | 2025-02-26 18:25:57 | 4ms   | EOF        | root | internal        | tpcds      | select 1      |\n| b28da27b4cc847a7-82e239320d6facc5 | QUERY     | 2025-02-26 18:25:57 | 2025-02-26 18:25:57 | 4ms   | EOF        | root | internal        | tpcds      | select 1      |\n| fec3cdcd4664408c-a38508ce3a2bbe32 | QUERY     | 2025-02-26 18:24:48 | 2025-02-26 18:24:48 | 6ms   | EOF        | root | internal        | tpcds      | select 1      |\n+-----------------------------------+-----------+---------------------+---------------------+-------+------------+------+-----------------+------------+---------------+\n7 rows in set (0.00 sec)\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u5982\u679C\u5E0C\u671B\u4E0D\u518D\u751F\u6210\u8FD9\u4E9B\u5C0F\u67E5\u8BE2\u7684 Profile\uFF0C\u53EF\u4EE5\u6309\u5982\u4E0B\u6B65\u9AA4\u64CD\u4F5C\uFF1A"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"mysql> clean all profile;\n--------------\nclean all profile\n--------------\n\nQuery OK, 0 rows affected (0.01 sec)\n\nmysql> set global auto_profile_threshold_ms=1000;\n--------------\nset global auto_profile_threshold_ms=1000\n--------------\n\nQuery OK, 0 rows affected (0.01 sec)\n\nmysql> select 1;\n--------------\nselect 1\n--------------\n\n+------+\n| 1    |\n+------+\n|    1 |\n+------+\n1 row in set (0.05 sec)\n\nmysql> select 1;\n--------------\nselect 1\n--------------\n\n+------+\n| 1    |\n+------+\n|    1 |\n+------+\n1 row in set (0.01 sec)\n\nmysql> show query profile;\n--------------\nshow query profile\n--------------\n\nEmpty set (0.00 sec)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u914D\u7F6E-profile-\u5B58\u50A8",children:"\u914D\u7F6E Profile \u5B58\u50A8"}),"\n",(0,r.jsxs)(n.p,{children:["Doris \u652F\u6301\u5C06 Profile \u6301\u4E45\u5316\u5230 FE \u672C\u5730\u78C1\u76D8\u4EE5\u4FDD\u5B58\u66F4\u591A\u8BB0\u5F55\u3002\u53EF\u5728 ",(0,r.jsx)(n.code,{children:"fe.conf"})," \u4E2D\u901A\u8FC7\u4EE5\u4E0B\u53C2\u6570\u8FDB\u884C\u63A7\u5236\uFF1A"]}),"\n",(0,r.jsx)(n.h3,{id:"max_query_profile_num",children:"max_query_profile_num"}),"\n",(0,r.jsx)(n.p,{children:"\u9ED8\u8BA4\u503C 500\u3002\u9650\u5236 FE \u5185\u5B58\u4E2D\u6700\u591A\u4FDD\u7559\u7684 Profile \u6570\u91CF\uFF0C\u8D85\u8FC7\u540E\u4ECE\u6700\u65E9\u7684\u5F00\u59CB\u6DD8\u6C70\u3002"}),"\n",(0,r.jsx)(n.h3,{id:"max_spilled_profile_num",children:"max_spilled_profile_num"}),"\n",(0,r.jsx)(n.p,{children:"\u9ED8\u8BA4\u503C 500\u3002\u9650\u5236\u78C1\u76D8\u4E0A\u6700\u591A\u4FDD\u5B58\u7684 Profile \u6570\u91CF\uFF0C\u8D85\u8FC7\u540E\u4ECE\u6700\u65E9\u7684\u5F00\u59CB\u5220\u9664\u3002"}),"\n",(0,r.jsx)(n.h3,{id:"spilled_profile_storage_path",children:"spilled_profile_storage_path"}),"\n",(0,r.jsx)(n.p,{children:"\u7528\u4E8E\u6307\u5B9A Profile \u5728\u672C\u5730\u7684\u5B58\u50A8\u76EE\u5F55\uFF0C\u9ED8\u8BA4\u5728 log \u76EE\u5F55\u7684 profile \u5B50\u76EE\u5F55\u3002"}),"\n",(0,r.jsx)(n.h3,{id:"spilled_profile_storage_limit_bytes",children:"spilled_profile_storage_limit_bytes"}),"\n",(0,r.jsx)(n.p,{children:"\u9ED8\u8BA4 1 GB\u3002\u9650\u5236\u78C1\u76D8\u4E0A\u4FDD\u7559\u7684 Profile \u7684\u603B\u5B58\u50A8\u7A7A\u95F4\u3002"}),"\n",(0,r.jsx)(n.h2,{id:"\u83B7\u53D6-profile",children:"\u83B7\u53D6 Profile"}),"\n",(0,r.jsx)(n.h3,{id:"\u901A\u8FC7-fe-web-ui-\u83B7\u53D6",children:"\u901A\u8FC7 FE Web UI \u83B7\u53D6"}),"\n",(0,r.jsxs)(n.p,{children:["\u5728\u6D4F\u89C8\u5668\u4E2D\u8BBF\u95EE FE \u7684 ",(0,r.jsx)(n.code,{children:"ip:http_port"}),"\uFF0C\u8F93\u5165\u7528\u6237\u540D\u4E0E\u5BC6\u7801\u8FDB\u5165 Web \u9875\u9762\u3002\u70B9\u51FB QueryProfile \u9875\u9762\u53EF\u67E5\u770B\u5F53\u524D FE \u4E2D\u6267\u884C\u7684\u6240\u6709\u67E5\u8BE2\u7684 Profile\uFF0C\u70B9\u51FB Profile ID \u67E5\u770B\u8BE6\u7EC6\u5185\u5BB9\u3002\n\u9700\u8981\u6CE8\u610F\u7684\u662F\uFF1A"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Profile \u4EC5\u5B58\u5728\u4E8E\u6267\u884C SQL \u7684 FE \u4E0A\uFF0C\u4E0D\u4F1A\u5728\u591A\u4E2A FE \u4E4B\u95F4\u540C\u6B65\uFF1B\u83B7\u53D6\u65F6\u9700\u8FDE\u63A5\u6267\u884C SQL \u7684 FE\u3002"}),"\n",(0,r.jsx)(n.li,{children:"\u6240\u6709\u5BFC\u5165\u4EFB\u52A1\u6700\u7EC8\u7531 FE Master \u6267\u884C\uFF0C\u56E0\u6B64\u5176 Profile \u9700\u4ECE Master FE \u83B7\u53D6\u3002"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"alt text",src:i(366826).Z+"",width:"1280",height:"312"})}),"\n",(0,r.jsx)(n.h3,{id:"\u901A\u8FC7\u547D\u4EE4\u884C\u83B7\u53D6",children:"\u901A\u8FC7\u547D\u4EE4\u884C\u83B7\u53D6"}),"\n",(0,r.jsxs)(n.p,{children:["\u5728\u67D0\u4E9B\u573A\u666F\uFF08\u5982\u5B89\u5168\u9650\u5236\uFF09\u4E0B\u65E0\u6CD5\u8BBF\u95EE FE \u7684 Web UI\uFF0C\u53EF\u4EE5\u901A\u8FC7\u547D\u4EE4\u884C\u83B7\u53D6 Profile\u3002\u9996\u5148\u4F7F\u7528 ",(0,r.jsx)(n.code,{children:"show query profile"})," \u83B7\u53D6\u6700\u8FD1 20 \u6761 Profile \u7684\u5143\u4FE1\u606F\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"mysql> show query profile;\n--------------\nshow query profile\n--------------\n\n+-----------------------------------+-----------+---------------------+---------------------+-------+------------+------+-----------------+------------+---------------+\n| Profile ID                        | Task Type | Start Time          | End Time            | Total | Task State | User | Default Catalog | Default Db | Sql Statement |\n+-----------------------------------+-----------+---------------------+---------------------+-------+------------+------+-----------------+------------+---------------+\n| c7f48291d62147f4-92b1a511f6fe3395 | QUERY     | 2025-02-26 19:35:15 | 2025-02-26 19:35:15 | 5ms   | EOF        | root | internal        | tpch       | select 20     |\n| 9c6cd24d2f354c6f-9652c097cae00b05 | QUERY     | 2025-02-26 19:35:12 | 2025-02-26 19:35:12 | 4ms   | EOF        | root | internal        | tpch       | select 19     |\n| b908f7b484084492-9c4dc48762c9cb89 | QUERY     | 2025-02-26 19:35:09 | 2025-02-26 19:35:09 | 5ms   | EOF        | root | internal        | tpch       | select 18     |\n| ef411c0eb00541dc-ba5a39677be3e117 | QUERY     | 2025-02-26 19:35:06 | 2025-02-26 19:35:06 | 5ms   | EOF        | root | internal        | tpch       | select 17     |\n| c89deefa85974da7-ad53cb3d6f4cad75 | QUERY     | 2025-02-26 19:35:03 | 2025-02-26 19:35:03 | 5ms   | EOF        | root | internal        | tpch       | select 16     |\n| dd97a36d2a1f4cbc-b23f13b975cd2dde | QUERY     | 2025-02-26 19:34:59 | 2025-02-26 19:34:59 | 6ms   | EOF        | root | internal        | tpch       | select 15     |\n| af75095f7a7c4d9f-9422d04d0604f904 | QUERY     | 2025-02-26 19:34:56 | 2025-02-26 19:34:56 | 8ms   | EOF        | root | internal        | tpch       | select 14     |\n| 2764a7aaf2cf446d-922b4c5b5f853788 | QUERY     | 2025-02-26 19:34:54 | 2025-02-26 19:34:54 | 10ms  | EOF        | root | internal        | tpch       | select 13     |\n| bf15d7d96b9c4f6b-8e6fe4c40b077ae8 | QUERY     | 2025-02-26 19:34:53 | 2025-02-26 19:34:53 | 9ms   | EOF        | root | internal        | tpch       | select 12     |\n| ebf2221627b0435e-9bafebbe46d7315d | QUERY     | 2025-02-26 19:34:51 | 2025-02-26 19:34:51 | 7ms   | EOF        | root | internal        | tpch       | select 11     |\n| 3309a4c57f61471c-9c863f6bb72a146b | QUERY     | 2025-02-26 19:34:50 | 2025-02-26 19:34:50 | 10ms  | EOF        | root | internal        | tpch       | select 10     |\n| cb764ed358f34312-a7c56cbf7f521761 | QUERY     | 2025-02-26 19:34:48 | 2025-02-26 19:34:48 | 10ms  | EOF        | root | internal        | tpch       | select 9      |\n| 38878f3344b649ff-a69f1c8cd0dc1960 | QUERY     | 2025-02-26 19:34:46 | 2025-02-26 19:34:46 | 9ms   | EOF        | root | internal        | tpch       | select 8      |\n| 1182dc4c8105407c-b77c50a993cc0cb1 | QUERY     | 2025-02-26 19:34:42 | 2025-02-26 19:34:42 | 14ms  | EOF        | root | internal        | tpch       | select 7      |\n| 8596d808d2814e8d-aefbac7d30a599d1 | QUERY     | 2025-02-26 19:34:40 | 2025-02-26 19:34:40 | 31ms  | EOF        | root | internal        | tpch       | select 6      |\n| 325a66e868844aa4-90fae17f3a98d3e6 | QUERY     | 2025-02-26 19:34:38 | 2025-02-26 19:34:38 | 40ms  | EOF        | root | internal        | tpch       | select 5      |\n| e30d1166a2674393-997246e064a7674c | QUERY     | 2025-02-26 19:34:36 | 2025-02-26 19:34:36 | 19ms  | EOF        | root | internal        | tpch       | select 4      |\n| 4dfb91db8b448db-a4eab023bc119cea  | QUERY     | 2025-02-26 19:34:33 | 2025-02-26 19:34:33 | 14ms  | EOF        | root | internal        | tpch       | select 3      |\n| 1453559772434cda-b64c2eae47ce6424 | QUERY     | 2025-02-26 19:34:31 | 2025-02-26 19:34:31 | 10ms  | EOF        | root | internal        | tpch       | select 2      |\n| cbf8bf829740488c-b6da653e391b13c6 | QUERY     | 2025-02-26 19:34:30 | 2025-02-26 19:34:30 | 20ms  | EOF        | root | internal        | tpch       | select 1      |\n+-----------------------------------+-----------+---------------------+---------------------+-------+------------+------+-----------------+------------+---------------+\n20 rows in set (0.00 sec)\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u968F\u540E\u53EF\u901A\u8FC7 curl \u8BBF\u95EE HTTP \u63A5\u53E3\u83B7\u53D6\u5177\u4F53 Profile\uFF0C\u4F8B\u5982\u83B7\u53D6 ID \u4E3A ",(0,r.jsx)(n.code,{children:"f7efdc4c092d4b14-95e0f7f7783974d3"})," \u7684 Profile\uFF1A"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"curl -uroot: http://127.0.0.1:5937/api/profile/text?query_id=f7efdc4c092d4b14-95e0f7f7783974d3 > f7efdc4c092d4b14-95e0f7f7783974d3.profile\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u83B7\u5F97\u7ED3\u679C\u4E0E Web UI \u4E00\u81F4\uFF1A"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"> head f7efdc4c092d4b14-95e0f7f7783974d3.profile -n 10\nSummary:\n   - Profile ID: f7efdc4c092d4b14-95e0f7f7783974d3\n   - Task Type: QUERY\n   - Start Time: 2025-02-26 19:31:27\n   - End Time: 2025-02-26 19:32:41\n   - Total: 1min14sec\n   - Task State: OK\n   - User: root\n   - Default Catalog: internal\n   - Default Db: tpch\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u76F4\u63A5\u4ECE\u78C1\u76D8\u91CC\u83B7\u53D6-profile-\u6587\u4EF6",children:"\u76F4\u63A5\u4ECE\u78C1\u76D8\u91CC\u83B7\u53D6 Profile \u6587\u4EF6"}),"\n",(0,r.jsx)(n.p,{children:"3.0 \u8D77\uFF0CProfile \u652F\u6301\u6301\u4E45\u5316\uFF0C\u9ED8\u8BA4\u4FDD\u5B58\u76EE\u5F55\u4E3A log/profile\u3002\u82E5\u9700\u66F4\u5FEB\u67E5\u770B\uFF0C\u53EF\u76F4\u63A5\u4F7F\u7528 unzip \u89E3\u538B\u76EE\u6807\u6587\u4EF6\u4EE5\u83B7\u5F97\u6587\u672C\u683C\u5F0F\u3002\u4F46\u9700\u6CE8\u610F\uFF1A"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Doris FE \u5BF9 log/profile \u76EE\u5F55\u6709\u4FDD\u62A4\uFF0C\u6240\u4EE5\u4E0D\u8981\u628A Profile \u6587\u4EF6\u89E3\u538B\u7F29\u540E\u7684\u8F93\u51FA\u7559\u5728 log/profile \u76EE\u5F55\u5185\uFF0C\u4E0D\u7136\u4F1A\u88AB\u5220\u9664\u3002"}),"\n",(0,r.jsxs)(n.li,{children:["Profile \u6587\u672C\u4E0E Web UI \u7684\u5C55\u793A\u7565\u6709\u4E0D\u540C\uFF1A",(0,r.jsx)(n.code,{children:"Summary"})," \u4EE5 JSON \u5F62\u5F0F\u4F5C\u4E3A meta \u4FDD\u5B58\uFF0C\u540E\u7EED\u90E8\u5206\u4E0E Web UI \u4E00\u81F4\u3002"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'[hezhiqiang@VM-10-2-centos log]$ unzip profile/1740745121714_33bf38e988ea4945-b585d2f74d1da3fd.zip\nArchive:  profile/1740745121714_33bf38e988ea4945-b585d2f74d1da3fd.zip\n  inflating: 33bf38e988ea4945-b585d2f74d1da3fd.profile\n[hezhiqiang@VM-10-2-centos log]$ head 33bf38e988ea4945-b585d2f74d1da3fd.profile -n 10\n\uFFFD{"summaryProfile":{"counterTotalTime":{"value":0,"type":5,"level":1},"localTimePercent":0.0,"infoStrings":{"Distributed Plan":"N/A","Task Type":"QUERY","User":"root","Default Catalog":"internal","Total":"9sec745ms","Default Db":"tpch","Profile ID":"33bf38e988ea4945-b585d2f74d1da3fd","Task State":"OK","Sql Statement":"SELECT      c.c_name,      COUNT(o.o_orderkey) AS total_orders,      SUM(o.o_totalprice) AS total_spent FROM      customer c JOIN      orders o ON c.c_custkey \\u003d o.o_custkey GROUP BY      c.c_name limit 20","Start Time":"2025-02-28 20:18:31","End Time":"2025-02-28 20:18:41"},"infoStringsDisplayOrder":["Profile ID","Task Type","Start Time","End Time","Total","Task State","User","Default Catalog","Default Db","Sql Statement","Distributed Plan"],"counterMap":{"TotalTime":{"value":0,"type":5,"level":1}},"childCounterMap":{},"childMap":{},"childList":[],"planNodeInfos":[],"name":"Summary","timestamp":-1,"isDone":false,"isCancel":false,"isSinkOperator":false,"nodeid":-1},"executionSummaryProfile":{"counterTotalTime":{"value":0,"type":5,"level":1},"localTimePercent":0.0,"infoStrings":{"Fragment RPC Count":"2","Analysis Time":"6ms","CreateSingleNode Time":"N/A","Get Table Version Count":"N/A","Parse SQL Time":"3ms","Get Partition Files Time":"N/A","Get Partition Version Time":"N/A","Nereids Optimize Time":"11ms","Nereids Lock Table Time":"6ms","Get Partitions Time":"N/A","Get Table Version Time":"N/A","Nereids GarbageCollect Time":"0ms","Wait and Fetch Result Time":"9sec643ms","Is Nereids":"Yes","Is Cached":"No","Workload Group":"normal","Finalize Scan Node Time":"N/A","Fetch Result Time":"9sec641ms","Instances Num Per BE":"10.16.10.2:8261:4","Plan Time":"26ms","Fragment RPC Phase1 Time":"28ms","Create Scan Range Time":"N/A","Fragment Assign Time":"3ms","Nereids BeFoldConst Time":"0ms","JoinReorder Time":"N/A","QueryDistributed Time":"N/A","Get Splits Time":"N/A","Fragment Compressed Size":"22.63 KB","Get Partition Version Count":"N/A","Fragment RPC Phase2 Time":"30ms","Schedule Time Of BE":"{\\"phase1\\":{\\"10.16.10.2: 8261\\":{\\"RPC Work Time\\":\\"17ms\\",\\"RPC Latency From FE To BE\\":\\"10ms\\",\\"RPC Work Queue Time\\":\\"0ms\\",\\"RPC Latency From BE To FE\\":\\"1ms\\"}},\\"phase2\\":{\\"10.16.10.2: 8261\\":{\\"RPC Work Time\\":\\"4ms\\",\\"RPC Latency From FE To BE\\":\\"3ms\\",\\"RPC Work Queue Time\\":\\"0ms\\",\\"RPC Latency From BE To FE\\":\\"23ms\\"}}}","Get Partition Version Count (hasData)":"N/A","Fragment Serialize Time":"9ms","Init Scan Node Time":"N/A","Trace ID":"","Nereids Rewrite Time":"10ms","Schedule Time":"70ms","Transaction Commit Time":"N/A","Nereids Translate Time":"2ms","Parallel Fragment Exec Instance Num":"48","Total Instances Num":"4","Doris Version":"e021a6a015","Nereids Distribute Time":"6ms","Nereids Analysis Time":"3ms","Write Result Time":"0ms","System Message":"N/A","Executed By Frontend":"N/A"},"infoStringsDisplayOrder":["Parse SQL Time","Nereids Lock Table Time","Nereids Analysis Time","Nereids Rewrite Time","Nereids Optimize Time","Nereids Translate Time","Nereids Distribute Time","Workload Group","Analysis Time","Plan Time","JoinReorder Time","CreateSingleNode Time","QueryDistributed Time","Init Scan Node Time","Finalize Scan Node Time","Get Splits Time","Get Partitions Time","Get Partition Files Time","Create Scan Range Time","Get Partition Version Time","Get Partition Version Count (hasData)","Get Partition Version Count","Get Table Version Time","Get Table Version Count","Schedule Time","Fragment Assign Time","Fragment Serialize Time","Fragment RPC Phase1 Time","Fragment RPC Phase2 Time","Fragment Compressed Size","Fragment RPC Count","Schedule Time Of BE","Wait and Fetch Result Time","Fetch Result Time","Write Result Time","Doris Version","Is Nereids","Is Cached","Total Instances Num","Instances Num Per BE","Parallel Fragment Exec Instance Num","Trace ID","Transaction Commit Time","System Message","Executed By Frontend","Nereids GarbageCollect Time","Nereids BeFoldConst Time"],"counterMap":{"TotalTime":{"value":0,"type":5,"level":1}},"childCounterMap":{},"childMap":{},"childList":[],"planNodeInfos":[],"name":"Execution Summary","timestamp":-1,"isDone":false,"isCancel":false,"isSinkOperator":false,"nodeid":-1},"parseSqlStartTime":1740745111965,"parseSqlFinishTime":1740745111968,"nereidsLockTableFinishTime":1740745111971,"nereidsAnalysisFinishTime":1740745111974,"nereidsRewriteFinishTime":1740745111984,"nereidsOptimizeFinishTime":1740745111995,"nereidsTranslateFinishTime":1740745111997,"nereidsGarbageCollectionTime":0,"nereidsBeFoldConstTime":0,"queryBeginTime":1740745111968,"queryAnalysisFinishTime":1740745111974,"queryJoinReorderFinishTime":-1,"queryCreateSingleNodeFinishTime":-1,"queryDistributedFinishTime":-1,"initScanNodeStartTime":-1,"initScanNodeFinishTime":-1,"finalizeScanNodeStartTime":-1,"finalizeScanNodeFinishTime":-1,"getSplitsStartTime":-1,"getPartitionsFinishTime":-1,"getPartitionFilesFinishTime":-1,"getSplitsFinishTime":-1,"createScanRangeFinishTime":-1,"queryPlanFinishTime":1740745112000,"assignFragmentTime":1740745112003,"fragmentSerializeTime":1740745112012,"fragmentSendPhase1Time":1740745112040,"fragmentSendPhase2Time":1740745112070,"fragmentCompressedSize":23173,"fragmentRpcCount":2,"queryScheduleFinishTime":1740745112070,"queryFetchResultFinishTime":1740745121713,"tempStarTime":1740745121713,"queryFetchResultConsumeTime":9641,"queryWriteResultConsumeTime":0,"getPartitionVersionTime":0,"getPartitionVersionCount":0,"getPartitionVersionByHasDataCount":0,"getTableVersionTime":0,"getTableVersionCount":0,"transactionCommitBeginTime":-1,"transactionCommitEndTime":-1,"filesystemOptTime":-1,"hmsAddPartitionTime":-1,"hmsAddPartitionCnt":0,"hmsUpdatePartitionTime":-1,"hmsUpdatePartitionCnt":0,"filesystemRenameFileCnt":0,"filesystemRenameDirCnt":0,"filesystemDeleteDirCnt":0,"filesystemDeleteFileCnt":0,"transactionType":"UNKNOWN"}\uFFFDU\nChanged Session Variables:\nVarName                       | CurrentValue | DefaultValue\n------------------------------|--------------|-------------\ninsert_visible_timeout_ms     | 10000        | 60000\nfetch_splits_max_wait_time_ms | 4000         | 1000\nexec_mem_limit                | 2147483648   | 100147483648\nprofile_level                 | 2            | 1\nauto_profile_threshold_ms     | 1            | -1\n'})}),"\n",(0,r.jsx)(n.h2,{id:"profile-\u7ED3\u6784",children:"Profile \u7ED3\u6784"}),"\n",(0,r.jsx)(n.p,{children:"Profile \u5185\u5BB9\u6574\u4F53\u5206\u4E3A\u4EE5\u4E0B\u51E0\u90E8\u5206\uFF1A"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Summary\n",(0,r.jsx)(n.code,{children:"SummaryProfile"})," \u4E3A Profile \u7684\u5143\u4FE1\u606F\uFF0C\u8BB0\u5F55\u7528\u4E8E\u68C0\u7D22\u7684\u5173\u952E\u5B57\u6BB5\uFF0C\u5982 ",(0,r.jsx)(n.code,{children:"Profile ID"}),"\u3001",(0,r.jsx)(n.code,{children:"Total"})," \u7B49\u3002"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"-  Profile  ID:  d4d281168bf7490a-a133623295744f85\n-  Task  Type:  QUERY\n-  Start  Time:  2025-02-28  19:23:14\n-  End  Time:  2025-02-28  19:23:16\n-  Total:  2sec420ms\n-  Task  State:  OK\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"ExecutionSummary\n\u4E3A\u6267\u884C\u8FC7\u7A0B\u603B\u7ED3\u3002\u5176\u4E2D\u4E0E Plan \u76F8\u5173\u7684\u5B57\u6BB5\u8BB0\u5F55 Planner \u7684\u8017\u65F6\u3002"}),"\n",(0,r.jsx)(n.li,{children:"ChangedSessionVariables\n\u8BB0\u5F55\u8BE5\u67E5\u8BE2\u6267\u884C\u671F\u95F4\u6539\u52A8\u7684 session \u53D8\u91CF\u3002"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"ChangedSessionVariables:\nVarName                       | CurrentValue | DefaultValue\n------------------------------|--------------|-------------\ninsert_visible_timeout_ms     | 10000        | 60000       \nfetch_splits_max_wait_time_ms | 4000         | 1000        \nexec_mem_limit                | 2147483648   | 100147483648\nprofile_level                 | 2            | 1           \nauto_profile_threshold_ms     | 1            | -1          \n"})}),"\n",(0,r.jsx)(n.p,{children:"\u4E0A\u8FF0\u8868\u683C\u8BF4\u660E\u8BE5\u67E5\u8BE2\u5728\u6267\u884C\u524D\u6539\u52A8\u4E86 5 \u4E2A session \u53D8\u91CF\u3002"}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsxs)(n.li,{children:["MergedProfile\n\u4E3A ",(0,r.jsx)(n.code,{children:"DetailProfile"})," \u7684\u805A\u5408\u7ED3\u679C\u3002MergedProfile \u4E3B\u8981\u4F5C\u7528\uFF1A"]}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u4FBF\u4E8E\u5FEB\u901F\u7406\u89E3\u67E5\u8BE2\u8BA1\u5212\u4E0E Pipeline \u7684\u7ED3\u6784\u3002"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Doris \u67E5\u8BE2\u8BA1\u5212\u5177\u6709 Query \u2192 Fragment \u2192 PlanNode \u7684\u5C42\u7EA7\u7ED3\u6784\uFF1B\u6267\u884C\u5C42\u4EE5 Pipeline \u4E3A\u5355\u4F4D\u8C03\u5EA6\uFF0C\u6BCF\u4E2A Pipeline \u7531\u4E00\u7EC4 Operator \u6784\u6210\u3002\u67E5\u8BE2\u8BA1\u5212\u5230 Pipeline \u4E4B\u95F4\u5B58\u5728\u8F6C\u6362\uFF0CMergedProfile \u80FD\u6E05\u6670\u5C55\u73B0\u8BE5\u7ED3\u6784\u3002\u7A0D\u540E\u793A\u4F8B\u5C06\u8BF4\u660E\u5982\u4F55\u636E\u6B64\u590D\u539F\u67E5\u8BE2\u8BA1\u5212\u4E0E Pipeline \u6D41\u6C34\u7EBF\u3002"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u4FBF\u4E8E\u5FEB\u901F\u627E\u5230\u6027\u80FD\u74F6\u9888\u7684\u7B97\u5B50\u3002"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u5B9A\u4F4D\u6027\u80FD\u95EE\u9898\u65F6\uFF0C\u901A\u5E38\u9700\u786E\u5B9A\u5177\u4F53\u7684\u74F6\u9888\u7B97\u5B50\u3002\u53EF\u5148\u5728 MergedProfile \u4E2D\u6839\u636E ",(0,r.jsx)(n.code,{children:"DependencyWaitTime"})," \u627E\u5230\u8017\u65F6\u6700\u5927\u7684\u7B97\u5B50\uFF0C\u518D\u5728 DetailProfile \u4E2D\u67E5\u770B\u5176\u8BE6\u7EC6\u4FE1\u606F\uFF0C\u8FDB\u4E00\u6B65\u5224\u65AD\u74F6\u9888\u3002"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u4FBF\u4E8E\u5BF9\u6BD4\u6570\u636E\u503E\u659C\u3002"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["MergedProfile \u8BB0\u5F55\u6570\u636E\u5728\u7B97\u5B50\u4E4B\u95F4\u7684\u6D41\u52A8\u7EC6\u8282\u3002\u5BF9\u6BD4 ",(0,r.jsx)(n.code,{children:"InputRows"})," \u4E0E ",(0,r.jsx)(n.code,{children:"RowsProduced"})," \u53EF\u5224\u65AD\u4E0D\u540C Backend \u4E0A\u7684\u6570\u636E\u662F\u5426\u5B58\u5728\u4E0D\u5747\u8861\u5206\u5E03\uFF0C\u6570\u636E\u5206\u5E03\u4E0D\u5747\u5E38\u5BFC\u81F4\u67E5\u8BE2\u53D8\u6162\u6216\u5931\u8D25\u3002"]}),"\n",(0,r.jsxs)(n.ol,{start:"5",children:["\n",(0,r.jsx)(n.li,{children:"DetailProfile"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u6267\u884C\u7684\u8BE6\u7EC6\u7EC6\u8282\u3002DetailProfile \u8BB0\u5F55\u67E5\u8BE2\u4E2D\u6BCF\u4E2A Fragment\u3001\u6BCF\u6761 Pipeline \u7684 ",(0,r.jsx)(n.code,{children:"PipelineTask"})," \u5728\u6240\u6709 Backend \u4E0A\u7684\u6267\u884C\u7EC6\u8282\u3002\u901A\u5E38\u5728\u901A\u8FC7 MergedProfile \u786E\u8BA4\u74F6\u9888\u70B9\u540E\uFF0C\u7ED3\u5408 DetailProfile \u8FDB\u884C\u6DF1\u5165\u5206\u6790\u3002"]}),"\n",(0,r.jsx)(n.h2,{id:"profile-\u89E3\u8BFB\u4F8B\u5B50",children:"Profile \u89E3\u8BFB\u4F8B\u5B50"}),"\n",(0,r.jsxs)(n.p,{children:["\u4E0B\u9762\u4EE5\u4E00\u4E2A\u5305\u542B Aggregation\u3001Join \u4E0E Scan \u7684\u5178\u578B\u67E5\u8BE2\u4E3A\u4F8B\u8BF4\u660E Profile \u7684\u89E3\u8BFB\u65B9\u6CD5\u3002\u9488\u5BF9 TPCH \u6570\u636E\u96C6\u7684 ",(0,r.jsx)(n.code,{children:"customer"})," \u4E0E ",(0,r.jsx)(n.code,{children:"orders"})," \u505A JOIN\uFF0C\u5E76\u5BF9\u7ED3\u679C\u505A\u805A\u5408\u3002SQL \u5982\u4E0B\uFF1A"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT c.c_name,\n       Count(o.o_orderkey) AS total_orders,\n       Sum(o.o_totalprice) AS total_spent\nFROM   customer c\n       JOIN orders o\n         ON c.c_custkey = o.o_custkey\nGROUP  BY c.c_name\nLIMIT  20 \n"})}),"\n",(0,r.jsx)(n.p,{children:"\u4E3A\u907F\u514D Profile \u8FC7\u4E8E\u5197\u957F\uFF0C\u6211\u4EEC\u9650\u5236\u67E5\u8BE2\u5E76\u884C\u5EA6\uFF1A"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"set parallel_pipeline_task_num=2;\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u6267\u884C\u4E0A\u8FF0\u67E5\u8BE2\u5E76\u901A\u8FC7 Web UI \u83B7\u53D6 Profile \u540E\uFF0C\u5148\u5173\u6CE8 MergedProfile\u3002\u4E3A\u4E13\u6CE8\u6574\u4F53\u7ED3\u6784\uFF0C\u4E0B\u6587\u4EC5\u4FDD\u7559\u5173\u952E\u5B57\u6BB5\uFF0C\u5176\u4ED6\u5B57\u6BB5\u542B\u4E49\u53EF\u53C2\u8003\u76F8\u5173\u6587\u6863\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"MergedProfile:\n     Fragments:\n       Fragment 0:\n         Pipeline 0(instance_num=1):\n           RESULT_SINK_OPERATOR(id=0):\n             CommonCounters:\n                - ExecTime: avg 176.545us, max 176.545us, min 176.545us\n                - InputRows: sum 20, avg 20, max 20, min 20\n                - WaitForDependency[RESULT_SINK_OPERATOR_DEPENDENCY]Time: avg 0ns, max 0ns, min 0ns\n             CustomCounters:\n           EXCHANGE_OPERATOR(id=8):\n             CommonCounters:\n                - ExecTime: avg 84.559us, max 84.559us, min 84.559us\n                - RowsProduced: sum 20, avg 20, max 20, min 20\n             CustomCounters:\n                - WaitForDependencyTime: avg 0ns, max 0ns, min 0ns\n                  - WaitForData0: avg 11sec450ms, max 11sec450ms, min 11sec450ms\n       Fragment 1:\n         Pipeline 0(instance_num=2):\n           DATA_STREAM_SINK_OPERATOR(dest_id=8):\n             CommonCounters:\n                - ExecTime: avg 31.515us, max 33.405us, min 29.626us\n                - InputRows: sum 20, avg 10, max 11, min 9\n                - WaitForDependencyTime: avg 0ns, max 0ns, min 0ns\n                  - WaitForRpcBufferQueue: avg 0ns, max 0ns, min 0ns\n             CustomCounters:\n                - BlocksProduced: sum 2, avg 1, max 1, min 1\n           SORT_OPERATOR(nereids_id=443)(id=7):\n             CommonCounters:\n                - ExecTime: avg 980ns, max 1.199us, min 762ns\n                - RowsProduced: sum 20, avg 10, max 11, min 9\n                - WaitForDependency[SORT_OPERATOR_DEPENDENCY]Time: avg 11sec450ms, max 11sec450ms, min 11sec450ms\n             CustomCounters:\n         Pipeline 1(instance_num=2):\n           SORT_SINK_OPERATOR(nereids_id=443)(id=7):\n             CommonCounters:\n                - ExecTime: avg 49.414us, max 54.802us, min 44.27us\n                - InputRows: sum 20, avg 10, max 11, min 9\n                - WaitForDependency[SORT_SINK_OPERATOR_DEPENDENCY]Time: avg 0ns, max 0ns, min 0ns\n             CustomCounters:\n           AGGREGATION_OPERATOR(nereids_id=438)(id=6):\n             CommonCounters:\n                - ExecTime: avg 34.521us, max 36.402us, min 32.640us\n                - RowsProduced: sum 20, avg 10, max 11, min 9\n                - WaitForDependency[AGGREGATION_OPERATOR_DEPENDENCY]Time: avg 11sec450ms, max 11sec450ms, min 11sec450ms\n             CustomCounters:\n         Pipeline 2(instance_num=2):\n           AGGREGATION_SINK_OPERATOR(nereids_id=438)(id=6):\n             CommonCounters:\n                - ExecTime: avg 109.89us, max 118.582us, min 99.596us\n                - InputRows: sum 40, avg 20, max 22, min 18z\n                - WaitForDependency[AGGREGATION_SINK_OPERATOR_DEPENDENCY]Time: avg 0ns, max 0ns, min 0ns\n             CustomCounters:\n           EXCHANGE_OPERATOR(id=5):\n             CommonCounters:\n                - ExecTime: avg 29.741us, max 34.521us, min 24.962us\n                - RowsProduced: sum 40, avg 20, max 22, min 18\n             CustomCounters:\n                - WaitForDependencyTime: avg 0ns, max 0ns, min 0ns\n                  - WaitForData0: avg 11sec450ms, max 11sec450ms, min 11sec450ms\n       Fragment 2:\n         Pipeline 0(instance_num=2):\n           DATA_STREAM_SINK_OPERATOR(dest_id=5):\n             CommonCounters:\n                - ExecTime: avg 71.148us, max 73.242us, min 69.54us\n                - InputRows: sum 40, avg 20, max 20, min 20\n                - WaitForDependencyTime: avg 0ns, max 0ns, min 0ns\n                  - WaitForRpcBufferQueue: avg 0ns, max 0ns, min 0ns\n             CustomCounters:\n           AGGREGATION_OPERATOR(nereids_id=428)(id=4):\n             CommonCounters:\n                - ExecTime: avg 350.431us, max 393.100us, min 307.762us\n                - RowsProduced: sum 40, avg 20, max 20, min 20\n                - WaitForDependency[AGGREGATION_OPERATOR_DEPENDENCY]Time: avg 11sec30ms, max 11sec450ms, min 10sec610ms\n             CustomCounters:\n         Pipeline 1(instance_num=2):\n           AGGREGATION_SINK_OPERATOR(nereids_id=428)(id=4):\n             CommonCounters:\n                - ExecTime: avg 442.308ms, max 449.109ms, min 435.506ms\n                - InputRows: sum 150.0M (150000000), avg 75.0M (75000000), max 75.000001M (75000001), min 74.999999M (74999999)\n                - MemoryUsage: sum 2.05 MB, avg 1.03 MB, max 1.03 MB, min 1.03 MB\n                - MemoryUsagePeak: sum 2.05 MB, avg 1.03 MB, max 1.03 MB, min 1.03 MB\n                - WaitForDependency[AGGREGATION_SINK_OPERATOR_DEPENDENCY]Time: avg 0ns, max 0ns, min 0ns\n             CustomCounters:\n                - MemoryUsageHashTable: sum 1.03 MB, avg 526.28 KB, max 526.28 KB, min 526.28 KB\n                - MemoryUsageSerializeKeyArena: sum 1.02 MB, avg 524.00 KB, max 524.00 KB, min 524.00 KB\n           HASH_JOIN_OPERATOR(nereids_id=418)(id=3):\n             CommonCounters:\n                - ExecTime: avg 9sec169ms, max 9sec582ms, min 8sec756ms\n                - RowsProduced: sum 150.0M (150000000), avg 75.0M (75000000), max 75.000001M (75000001), min 74.999999M (74999999)\n                - WaitForDependency[HASH_JOIN_OPERATOR_DEPENDENCY]Time: avg 949.860ms, max 962.978ms, min 936.743ms\n             CustomCounters:\n                - ProbeRows: sum 150.0M (150000000), avg 75.0M (75000000), max 75.000001M (75000001), min 74.999999M (74999999)\n           OLAP_SCAN_OPERATOR(nereids_id=397. table_name=orders(orders))(id=2):\n             CommonCounters:\n                - ExecTime: avg 396.233ms, max 410.306ms, min 382.160ms\n                - RowsProduced: sum 150.0M (150000000), avg 75.0M (75000000), max 75.000001M (75000001), min 74.999999M (74999999)\n             CustomCounters:\n                - WaitForDependency[OLAP_SCAN_OPERATOR_DEPENDENCY]Time: avg 0ns, max 0ns, min 0ns\n         Pipeline 2(instance_num=2):\n           HASH_JOIN_SINK_OPERATOR(nereids_id=418)(id=3):\n             CommonCounters:\n                - ExecTime: avg 445.146ms, max 890.258ms, min 34.635us\n                - InputRows: sum 15.0M (15000000), avg 7.5M (7500000), max 15.0M (15000000), min 0\n                - WaitForDependency[HASH_JOIN_SINK_OPERATOR_DEPENDENCY]Time: avg 482.355ms, max 964.711ms, min 0ns\n             CustomCounters:\n                - MemoryUsageHashTable: sum 185.22 MB, avg 92.61 MB, max 185.22 MB, min 0.00 \n           EXCHANGE_OPERATOR(id=1):\n             CommonCounters:\n                - ExecTime: avg 10.131ms, max 20.243ms, min 19.26us\n                - RowsProduced: sum 15.0M (15000000), avg 7.5M (7500000), max 15.0M (15000000), min 0\n             CustomCounters:\n                - WaitForDependencyTime: avg 0ns, max 0ns, min 0ns\n                  - WaitForData0: avg 47.582ms, max 47.582ms, min 47.582ms\n       Fragment 3:\n         Pipeline 0(instance_num=2):\n           DATA_STREAM_SINK_OPERATOR(dest_id=1):\n             CommonCounters:\n                - ExecTime: avg 3.269ms, max 3.281ms, min 3.258ms\n                - InputRows: sum 15.0M (15000000), avg 7.5M (7500000), max 7.500001M (7500001), min 7.499999M (7499999)\n                - WaitForDependencyTime: avg 0ns, max 0ns, min 0ns\n                  - WaitForLocalExchangeBuffer0: avg 142.859ms, max 285.713ms, min 6.733us\n                  - WaitForRpcBufferQueue: avg 0ns, max 0ns, min 0ns\n             CustomCounters:\n           OLAP_SCAN_OPERATOR(nereids_id=403. table_name=customer(customer))(id=0):\n             CommonCounters:\n                - ExecTime: avg 77.435ms, max 78.752ms, min 76.118ms\n                - RowsProduced: sum 15.0M (15000000), avg 7.5M (7500000), max 7.500001M (7500001), min 7.499999M (7499999)\n             CustomCounters:\n                - WaitForDependency[OLAP_SCAN_OPERATOR_DEPENDENCY]Time: avg 49.690ms, max 50.522ms, min 48.858ms\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u4E0A\u9762\u7684\u662F\u7CBE\u7B80\u8FC7\u7684 MergedProfile\u3002Doris \u7684\u67E5\u8BE2\u8BA1\u5212\u6709 Query - Fragment - PlanNode \u7684\u4E09\u7EA7\u7ED3\u6784\uFF0C\u800C Backend \u4E0A\u7684\u6267\u884C\u5F15\u64CE\u8FD8\u4F1A\u5728\u6B64\u57FA\u7840\u4E0A\u518D\u589E\u52A0 Pipeline - Operator \u4E24\u5C42\u3002\n\u6211\u4EEC\u5148\u7528\u4E00\u5F20\u56FE\u6765\u8BF4\u660E\u4E0A\u8FF0\u67E5\u8BE2\u4ECE\u67E5\u8BE2\u8BA1\u5212\u7684\u89D2\u5EA6\u6765\u770B\u5982\u4F55\u5206\u6210\u4E09\u7EA7\u3002"}),"\n",(0,r.jsx)(n.h3,{id:"query--fragment--plannode",children:"Query & Fragment & PlanNode"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"alt text",src:i(417352).Z+"",width:"710",height:"1404"})}),"\n",(0,r.jsx)(n.p,{children:"\u56FE\u4E2D\u7684\u7BAD\u5934\u8868\u793A\u6570\u636E\u7684\u6D41\u5411\u3002\u4ECE\u4E0A\u56FE\u53EF\u4EE5\u770B\u5230\u6574\u4E2A Query \u7684\u67E5\u8BE2\u8BA1\u5212\u88AB\u5206\u4E3A\u4E86 4 \u4E2A Fragment\uFF08\u4E0A\u56FE\u5DE6\u4FA7\u7684\u56DB\u4E2A\u65B9\u5757\uFF09\u548C\u591A\u4E2A PlanNode (Fragment \u548C\u5C5E\u4E8E\u4ED6\u7684 PlanNode \u5728\u540C\u4E00\u4E2A\u6C34\u5E73\u7EBF\u4E0A\uFF09\uFF0CPlanNode \u4E2D\u5305\u542B\u4E86\u4E24\u4E2A SCAN_NODE\uFF0C\u5206\u522B\u8BFB\u53D6 customer \u548C orders \u8FD9\u4E24\u5F20\u8868\uFF0C\u591A\u4E2A DATA_STREAM_SINK \u548C EXCHANGE\uFF0C\u7528\u4E8E\u5728\u4E0D\u540C\u7684 Fragment \u4E4B\u95F4\u4F20\u9012\u6570\u636E\uFF0CHASH_JOIN \u7528\u6765\u5BF9 SCAN \u8BFB\u4E0A\u6765\u7684\u6570\u636E\u8FDB\u884C\u8FDE\u63A5\u64CD\u4F5C\uFF0C\u805A\u5408\u64CD\u4F5C\u88AB\u5206\u4E3A\u4E86\u4E24\u9636\u6BB5\uFF0C\u7B2C\u4E00\u9636\u6BB5 AGGREGATION \u548C\u7B2C\u4E8C\u9636\u6BB5 AGGREGATION(MERGE)\uFF0CRESULT_SINK \u7528\u4E8E\u5411 FE \u8FD4\u56DE\u7ED3\u679C\uFF0C\u800C\u5728\u4ED6\u4E4B\u524D\u8FD8\u6709\u4E2A TOP-N \u7B97\u5B50\uFF0C\u7528\u6765\u9650\u5236\u7ED3\u679C\u7684\u884C\u6570\u3002"}),"\n",(0,r.jsx)(n.h3,{id:"pipeline--operator",children:"Pipeline & Operator"}),"\n",(0,r.jsx)(n.p,{children:"\u4E0A\u8FF0\u7684 QueryPlan \u5982\u4F55\u8F6C\u5316\u4E3A\u6267\u884C\u5F15\u64CE\u7684 Pipeline \u4E0E Operator\uFF1F\u6211\u4EEC\u4EE5\u5305\u542B AGGREGATION \u4E0E HASH_JOIN \u8FD9\u4E24\u4E2A\u7B97\u5B50\u7684 Fragment 1 \u548C Fragment 2 \u4E3A\u4F8B\u3002"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"alt text",src:i(461308).Z+"",width:"755",height:"1280"})}),"\n",(0,r.jsx)(n.p,{children:"\u53EF\u4EE5\u770B\u5230\uFF0CDoris \u7684\u6267\u884C\u5F15\u64CE\u5728\u6267\u884C\u65F6\u4F1A\u5C06\u4E00\u4E9B PlanNode \u62C6\u5206\u6210\u4E00\u4E2A\u6216\u8005\u591A\u4E2A Operator\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u6BD4\u5982 DATA_STREAM_SINK \u88AB\u8F6C\u6362\u6210\u4E86\u4E00\u4E2A DATA_STREAM_SINK_OPERATOR\uFF0C\u8BE5\u8282\u70B9\u662F Fragment \u5411\u5916\u8F93\u51FA\u6570\u636E\u7684\u7B97\u5B50\uFF0C\u672C\u8EAB\u6CA1\u6709 OperatorId\uFF0C\u53EA\u6709\u4ED6\u7684\u76EE\u6807 OperatorId\uFF0Cdest_id=5 \u8868\u793A\u8BE5\u7B97\u5B50\u628A\u6570\u636E\u53D1\u9001\u5230 id=5 \u7684 EXCHANGE_OPERATOR\u3002"}),"\n",(0,r.jsx)(n.p,{children:"PlanNodeId \u7B49\u4E8E 3 \u7684 HASH_JOIN \u5C31\u88AB\u62C6\u6210\u4E86\u4E24\u4E2A Operator\uFF0C\u5206\u522B\u662F HASH_JOIN_SINK_OPERATOR \u4E0E HASH_JOIN_OPERATOR\uFF0C\u4ED6\u4FE9\u7684 Operator Id \u90FD\u4E3A 3\uFF0C\u7B49\u4E8E\u4ED6\u4EEC\u7684 PlanNodeId\u3002\n\u7B2C\u4E00\u9636\u6BB5\u7684 AGGREGATION \u4E0E \u7B2C\u4E8C\u9636\u6BB5\u7684 AGGREGATION(MERGE) \u4E5F\u5404\u81EA\u90FD\u88AB\u62C6\u5206\u6210\u4E86\u4E00\u5BF9 SINK \u4E0E SORCE \u7B97\u5B50\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u5F53 PlanNode \u88AB\u62C6\u6210 Operator \u4E4B\u540E\uFF0C\u6267\u884C\u5F15\u64CE\u4F1A\u628A\u4E00\u4E9B Operator \u8FDE\u63A5\u8D77\u6765\u7EC4\u6210 Pipeline\uFF0C\u4E0A\u56FE\u4E2D\u53EF\u4EE5\u770B\u5230\uFF0CFragment 1 \u4E0E Fragment 2 \u5185\u90E8\u5404\u81EA\u6709 3 \u6761 Pipeline\u3002Pipeline \u5185\u90E8\u7684\u7B97\u5B50\u4E4B\u95F4\u7684\u6570\u636E\u6D41\u52A8\u662F\u4E0D\u4F1A\u963B\u585E\u7684\uFF0C\u76F8\u53CD\uFF0C\u7528\u4E8E\u8FDE\u63A5 Pipeline \u7684\u7B97\u5B50\u76F8\u4E92\u4E4B\u95F4\u5219\u6709\u963B\u585E\u5173\u7CFB\uFF0C\u8FD9\u79CD\u963B\u585E\u5173\u7CFB\u5305\u62EC\u6709\u8BA1\u7B97\u903B\u8F91\u4E0A\u7684\u4F9D\u8D56\u5BFC\u81F4\u7684\u963B\u585E\uFF08\u6BD4\u5982 HashJoin \u7684 Probe \u4FA7\u9700\u8981\u7B49\u5F85 HashJoin \u7684 Build \u4FA7\u6784\u5EFA\u5B8C Hash \u8868\u624D\u80FD\u6267\u884C\uFF09\u8FD8\u5305\u62EC\u8BA1\u7B97\u673A\u7CFB\u7EDF\u7269\u7406\u73AF\u5883\u5BFC\u81F4\u7684\u963B\u585E\uFF08\u6BD4\u5982 EXCHANGE_OPERATOR \u9700\u8981\u7B49\u5F85 DATA_STREAM_SINK_OPERATOR \u901A\u8FC7\u7F51\u7EDC\u628A\u6570\u636E\u4F20\u8F93\u8FC7\u6765\uFF0C\u5929\u7136\u5F62\u6210\u963B\u585E\uFF09\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u901A\u8FC7 Pipeline \u628A\u4E0D\u963B\u585E\u7684\u7B97\u5B50\u8FDE\u63A5\u5230\u4E00\u8D77\u8C03\u5EA6\u6267\u884C\u53EF\u4EE5\u4F7F\u5F97\u8D44\u6E90\u5229\u7528\u7387\u548C\u7F13\u5B58\u547D\u4E2D\u7387\u66F4\u9AD8\u3002"}),"\n",(0,r.jsx)(n.h3,{id:"commoncounters--customcounters",children:"CommonCounters & CustomCounters"}),"\n",(0,r.jsx)(n.p,{children:"CommonCounters \u662F\u6240\u6709\u7684 Operator \u90FD\u5FC5\u987B\u6709\u7684 Counter\u3002\u76EE\u524D doris \u4E2D\u8981\u6C42\u6BCF\u4E2A\u7B97\u5B50\u90FD\u5FC5\u987B\u6709\u7684 Counter \u5305\u542B\uFF1A"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"ExecTime: \u5F53\u524D Operator \u6267\u884C\u82B1\u8D39\u7684\u65F6\u95F4\uFF0C\u6CE8\u610F\u4E0D\u5305\u62EC\u5F53\u524D\u7B97\u5B50\u7684\u4E0A\u6E38\u7B97\u5B50\u7684\u6267\u884C\u65F6\u95F4\u3002"}),"\n",(0,r.jsx)(n.li,{children:"RowsProduced\uFF08\u975ESinkOperator\uFF09: \u9664\u4E86SinkOperator \u4E4B\u5916\uFF0C\u6240\u6709\u7684 Source \u7B97\u5B50\u90FD\u6709 RowsProduced\uFF0C\u8BB0\u5F55\u5F53\u524D\u7B97\u5B50\u8F93\u51FA\u4E86\u591A\u5C11\u884C\u3002"}),"\n",(0,r.jsx)(n.li,{children:"InputRows(SinkOperator): \u6240\u6709\u7684 Sink \u7B97\u5B50\u90FD\u6709 InputRows\uFF0C\u8868\u793A\u5F53\u524D\u7B97\u5B50\u7684\u8F93\u5165\u662F\u591A\u5C11\u884C\u3002"}),"\n",(0,r.jsx)(n.li,{children:"MemoryUsage & MemoryUsagePeak: \u7B97\u5B50\u5F53\u524D\u7684\u5185\u5B58\u4F7F\u7528\u91CF\u4EE5\u53CA\u5185\u5B58\u4F7F\u7528\u7684\u5CF0\u503C\u3002"}),"\n",(0,r.jsx)(n.li,{children:"WaitForDepencency: \u7B49\u5F85\u5B83\u7684\u4F9D\u8D56\u6267\u884C\u7ED3\u675F\u82B1\u8D39\u7684\u65F6\u95F4\u3002"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"CustomCounter \u5219\u662F Operator \u7279\u6709\u7684 Counter\u3002\u53C2\u8003\u6587\u7AE0 Doris\u7B97\u5B50Profile\u68B3\u7406\uFF0C\u91CC\u9762\u8BE6\u7EC6\u4ECB\u7ECD\u4E86\u6BCF\u4E2A\u7B97\u5B50\u7684 CustomCounter \u7684\u542B\u4E49\u3002"}),"\n",(0,r.jsx)(n.h3,{id:"hashjoin",children:"HashJoin"}),"\n",(0,r.jsx)(n.p,{children:"\u5F53\u6211\u4EEC\u68B3\u7406\u51FA\u6765 Doris \u6267\u884C\u65F6\u7684\u57FA\u672C\u6982\u5FF5\u4E4B\u540E\uFF0C\u6211\u4EEC\u518D\u56DE\u8FC7\u5934\u6765\u770B\u4E00\u4E0B\u4E4B\u524D\u7684\u67E5\u8BE2\uFF0C\u901A\u8FC7 MergedProfile \u6211\u4EEC\u6765\u590D\u539F\u4E00\u4E0B Join \u7684\u6267\u884C\u7EC6\u8282\u3002"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"alt text",src:i(182586).Z+"",width:"766",height:"688"})}),"\n",(0,r.jsx)(n.p,{children:"\u8BB0\u4F4F\u6211\u4EEC\u5728\u6267\u884C SQL \u4E4B\u524D\u8BBE\u7F6E\u4E86\u67E5\u8BE2 Pipeline \u7684\u5E76\u884C\u5EA6\u4E3A 2\uFF0C\u6240\u4EE5\u867D\u7136\u4E0A\u56FE\u4E2D\u53EA\u663E\u793A\u4E86\u4E00\u7EC4 \u8FDE\u63A5\u7684 Pipeline 1 \u548C Pipeline 2\uFF0C\u4F46\u662F\u5728\u5B9E\u9645\u6267\u884C\u65F6\u4ED6\u4EEC\u5E94\u8BE5\u662F\u6709 4 \u4E2A Pipeline Task\uFF0C\u6BCF\u6761 Pipeline \u90FD\u6709\u4E24\u4E2A Pipeline Task\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Pipeline 0(instance_num=2)\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u6BCF\u6761 Pipeline \u7684\u540E\u9762\u6709\u4E00\u4E2A\u62EC\u53F7\uFF0C\u62EC\u53F7\u5185\u8BB0\u5F55\u7684 instance_num \u7B49\u4E8E\u8BE5 Pipeline \u5728\u6240\u6709 BE \u4E0A\u7684 PipelineTask \u6570\u91CF\u4E4B\u548C\uFF0C\u6211\u4EEC\u6784\u5EFA\u7684 \u96C6\u7FA4\u53EA\u6709 1 BE\uFF0C\u6240\u4EE5\u8FD9\u91CC\u770B\u5230\u7684 instance_num \u5C31\u7B49\u4E8E 1 * parallel_pipeline_task_num = 2\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u76F8\u540C\u989C\u8272\u7684\u8868\u793A\u5728\u540C\u4E00\u6761 Pipeline \u5185\uFF0CPipeline 2 \u7684\u4E24\u4E2A PipelineTask \u7D2F\u8BA1\u5904\u7406\u4E86 15M \u884C\u6570\u636E\u7528\u4E8E\u6784\u5EFA HashTable\uFF0C\u800C\u6784\u5EFA HashTable \u8FD9\u4E00\u6B65\u7684\u5E73\u5747\u6267\u884C\u65F6\u95F4\u662F 445.146 ms\u3002\u8FD8\u8BB0\u5F97\u524D\u9762\u63D0\u5230\u7684 Pipeline \u7684\u4F9D\u8D56\u5173\u7CFB\u4E48\uFF0CPipeline 1 \u7684\u6267\u884C\u524D\u63D0\u662F Pipeline 2 \u5B8C\u6210\u4E86\u6784\u5EFA HashTable \u7684\u64CD\u4F5C\uFF0C\u800C\u8FD9\u91CC\u7684\u7684\u7B49\u5F85\u65F6\u95F4\u5C31\u53CD\u6620\u5728 WaitForDependency \u4E0A\uFF0Cavg \u4E3A 949.860 ms\uFF0C\u4F46\u662F\u6784\u5EFA HashTable \u7684\u5E73\u5747\u65F6\u95F4\u53EA\u6709 445.146 ms\uFF0C\u95EE\u9898\u51FA\u5728\u54EA\u91CC\uFF1F\u5728\u8FD9\u4E2A case \u4E2D\uFF0CFE \u89C4\u5212\u7684 JOIN \u7C7B\u578B\u4E3A BROADCAST_JOIN\uFF0C\u6B64\u65F6\u4E24\u4E2A\u8FDB\u884C JOIN Build \u64CD\u4F5C\u7684 PipelineTask \u4E2D\u53EA\u4F1A\u9009\u4E00\u4E2A\u6765\u771F\u6B63\u8FDB\u884C BuildHash \u8868\u7684\u64CD\u4F5C"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"HASH_JOIN_SINK_OPERATOR(nereids_id=418)(id=3):\n CommonCounters:\n    - ExecTime: avg 445.146ms, max 890.258ms, min 34.635us\n    - InputRows: sum 15.0M (15000000), avg 7.5M (7500000), max 15.0M (15000000), min 0\n    - WaitForDependency[HASH_JOIN_SINK_OPERATOR_DEPENDENCY]Time: avg 482.355ms, max 964.711ms, min 0ns\n CustomCounters:\n    - MemoryUsageHashTable: sum 185.22 MB, avg 92.61 MB, max 185.22 MB, min 0.00 \n"})}),"\n",(0,r.jsx)(n.p,{children:"\u4ECE HASH_JOIN_SINK_OPERATOR \u7684 MergedProfile \u4E2D\u53EF\u4EE5\u770B\u5230\uFF0C\u5E76\u884C\u5EA6\u4E3A 2 \u7684 HASH_JOIN_SINK_OPERATOR \u867D\u7136\u5E73\u5747\u6267\u884C\u65F6\u95F4\u4E3A 445.146 ms\uFF0C\u4F46\u662F\u5176\u4E2D\u6700\u6162\u7684 PipelineTask \u8017\u65F6\u662F 890.258 ms\uFF0C\u800C\u6700\u5FEB\u7684\u4E3A 34.625 us\uFF0C\u4ED4\u7EC6\u770B InputRows \u7684\u5206\u5E03\uFF0C\u8BF4\u660E\u6240\u6709\u7684\u6570\u636E\u90FD\u662F\u4E00\u4E2A PipelineTask \u5904\u7406\u7684\uFF0C\u53E6\u4E00\u4E2A PipelineTask \u6CA1\u6709\u505A\u4E8B\u3002\u56E0\u6B64"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"- WaitForDependency[HASH_JOIN_OPERATOR_DEPENDENCY]Time: avg 949.860ms, max 962.978ms, min 936.743ms\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u8FD9\u91CC\u7684\u65F6\u95F4\u4E5F\u5C31\u8BF4\u7684\u901A\u4E86\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u7EE7\u7EED\u770B HASH_JOIN_OPERATOR\uFF0C\u5B83\u5728\u7B49\u5F85\u4E86\u5E73\u5747 949.860 ms\u540E\uFF0C\u5F00\u59CB\u6267\u884C JOIN \u7684 Probe \u4FA7\uFF0C\u4E24\u4E2A id=2 \u7684 OLAP_SCAN_OPERATOR \u4ECE\u5B58\u50A8\u4E2D\u8BFB\u51FA\u4E86 150M \u884C\uFF0C\u8FD9 150 M \u88AB HASH_JOIN_OPERATOR \u7B97\u5B50\u5904\u7406\u4E4B\u540E\uFF0C\u4E00\u884C\u6CA1\u5269\u4E0B\uFF0C\u5168\u90E8\u5F80\u4E0A\u7ED9\u4E86 AGGREGATION_SINK_OPERATOR\uFF0C\u8BE5\u7B97\u5B50\u5C06\u4F1A\u5BF9\u8FD9 150M \u6784\u5EFA HASH \u8868\uFF0C\u7EE7\u7EED\u8FDB\u884C\u805A\u5408\u8FD0\u7B97\u3002"}),"\n",(0,r.jsx)(n.h3,{id:"aggregation",children:"Aggregation"}),"\n",(0,r.jsxs)(n.p,{children:["\u67E5\u8BE2\u4E2D\u6D89\u53CA\u5230\u7684\u805A\u5408\u64CD\u4F5C\u662F ",(0,r.jsx)(n.code,{children:"Count(o.o_orderkey) AS total_orders, Sum(o.o_totalprice) AS total_spent"})," \u548C ",(0,r.jsx)(n.code,{children:"GROUP BY c.c_name"}),"\n",(0,r.jsx)(n.img,{alt:"alt text",src:i(303777).Z+"",width:"842",height:"1248"})]}),"\n",(0,r.jsx)(n.p,{children:"\u5BF9\u4E8E\u8FD9\u4E2A\u67E5\u8BE2\uFF0CDoris \u4F7F\u7528\u4E24\u9636\u6BB5\u7684Aggregation\u3002\n\u7B2C\u4E00\u9636\u6BB5\u7684 Aggregation \u5728 id=4 \u7684\u4E00\u5BF9 AGGREGATION \u7B97\u5B50\u91CC\u5B8C\u6210\uFF0CAGGREGATION_SINK_OPERATOR(id=4) \u7684\u8F93\u5165\u4E00\u5171\u662F 150M \u884C\uFF0C\u7136\u540E\u5BF9 GROUP BY \u5217\u6784\u5EFA Hash \u8868\uFF0C\u540C\u65F6\u66F4\u65B0\u6BCF\u4E00\u4E2A\u805A\u5408\u7ED3\u679C\u7684 AggregationData\u3002\n\u7B2C\u4E00\u9636\u6BB5\u7ED3\u675F\u540E\uFF0C\u628A AggregationData \u901A\u8FC7 EXCHANGE \u53D1\u9001\u7ED9\u7B2C\u4E8C\u9636\u6BB5\u6267\u884C\uFF0C\u7B2C\u4E00\u9636\u6BB5\u6267\u884C\u65F6\u4E0D\u540C\u7684 PipelineTask \u53EF\u80FD\u4F1A\u5904\u7406\u76F8\u540C\u7684 GROUP BY \u7684 \u5217\uFF0C\u56E0\u6B64\u5728 EXCHANGE \u9636\u6BB5\u4F1A\u6839\u636E name \u5217\u8FDB\u884C HASH \u5206\u533A\u540E\uFF0C\u628A\u76F8\u540C\u7684 name \u884C\u53D1\u9001\u5230\u76F8\u540C\u7684 \u7B2C\u4E8C\u9636\u6BB5\u7684\u7B97\u5B50\u3002\n\u6211\u4EEC\u770B\u5230 AGGREGATION_OPERATOR(id=4)\u7684\u8F93\u51FA\u4E00\u5171\u662F 40 \u884C\uFF0C\u8BF4\u660E\u6211\u4EEC\u5728\u7B2C\u4E00\u9636\u6BB5\u6784\u5EFA\u7684 Hash \u8868\u603B\u5171\u4E3A 40 \u884C\u3002\u7B2C\u4E8C\u9636\u6BB5\u7684 AGGREGATION_SINK_OPERATOR(id=6) \u628A\u7B2C\u4E00\u9636\u6BB5\u7684\u7ED3\u679C\u8FDB\u884C\u53CD\u5E8F\u5217\u5316\u6210 AggregationData\uFF0C\u7136\u540E\u518D\u8FDB\u884C Merge \u64CD\u4F5C\uFF0C\u7ED3\u679C\u7531 AGGREGATION_OPERATOR(id=6) \u53D1\u9001\u7ED9\u4E0B\u6E38\u7684 TOP-N\uFF0C\u7531\u4E8E\u6211\u4EEC\u7684\u67E5\u8BE2\u5E26\u4E86 limit 20\uFF0C\u5F53 TOP-N\u7B97\u5B50\u6536\u96C6\u5230 20 \u884C\u6570\u636E\u540E\u5C31\u63D0\u524D\u7ED3\u675F\u4E86\u672C\u6B21\u6267\u884C\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u6574\u4F53\u6765\u770B\uFF0C\u672C\u6B21\u67E5\u8BE2\u6700\u8017\u65F6\u7684\u64CD\u4F5C\u662F\u5728 HASH_JOIN_OPERATOR(id=3)\uFF0C\u5B9A\u4F4D\u5230\u8FD9\u91CC\u540E\uFF0C\u6211\u4EEC\u53EF\u4EE5\u7EE7\u7EED\u770B DetailProfile \u4E2D HASH_JOIN_OPERATOR(id=3) \u7684\u66F4\u7EC6\u7C92\u5EA6\u7684 Counter\u3002\u5173\u4E8E\u66F4\u7EC6\u7C92\u5EA6\u7684 Counter \u53EF\u4EE5\u53C2\u8003\u6BCF\u4E2A\u7B97\u5B50\u7684\u6587\u6863\uFF0C\u8BE6\u7EC6\u89E3\u91CA\u4E86\u6BCF\u4E2ACounter\u7684\u542B\u4E49\u3002"})]})}function d(e={}){let{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},954888:function(e,n,i){i.d(n,{Z:function(){return s}});let s=i.p+"assets/images/profile-image-0-18d56920287086f1c6cedf3a4e5e7354.png"},366826:function(e,n,i){i.d(n,{Z:function(){return s}});let s=i.p+"assets/images/profile-image-1-e7f06dc86ca9dd077e3fb20e42b94256.png"},417352:function(e,n,i){i.d(n,{Z:function(){return s}});let s=i.p+"assets/images/profile-image-2-88f9b581f4b4fd675c5bb76311febf53.png"},461308:function(e,n,i){i.d(n,{Z:function(){return s}});let s=i.p+"assets/images/profile-image-3-2f8e896342272495698ff8d7ec49ecf5.png"},182586:function(e,n,i){i.d(n,{Z:function(){return s}});let s=i.p+"assets/images/profile-image-4-7e36ac331d91ad84121ad4ed5190f189.png"},303777:function(e,n,i){i.d(n,{Z:function(){return s}});let s=i.p+"assets/images/profile-image-5-fe06e847d5be3a978ab97a8ccb0d0c08.png"},250065:function(e,n,i){i.d(n,{Z:function(){return t},a:function(){return l}});var s=i(667294);let r={},a=s.createContext(r);function l(e){let n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);