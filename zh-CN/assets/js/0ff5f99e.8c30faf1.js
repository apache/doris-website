"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["383563"],{231042:function(e,n,l){l.r(n),l.d(n,{default:()=>h,frontMatter:()=>r,metadata:()=>c,assets:()=>d,toc:()=>t,contentTitle:()=>i});var c=JSON.parse('{"id":"sql-manual/basic-element/sql-data-types/semi-structured/MAP","title":"MAP","description":"\u7C7B\u578B\u63CF\u8FF0","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs/current/sql-manual/basic-element/sql-data-types/semi-structured/MAP.md","sourceDirName":"sql-manual/basic-element/sql-data-types/semi-structured","slug":"/sql-manual/basic-element/sql-data-types/semi-structured/MAP","permalink":"/zh-CN/docs/dev/sql-manual/basic-element/sql-data-types/semi-structured/MAP","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"MAP","language":"zh-CN"},"sidebar":"docs","previous":{"title":"GEO","permalink":"/zh-CN/docs/dev/sql-manual/basic-element/sql-data-types/semi-structured/GEO"},"next":{"title":"STRUCT","permalink":"/zh-CN/docs/dev/sql-manual/basic-element/sql-data-types/semi-structured/STRUCT"}}'),a=l("785893"),s=l("250065");let r={title:"MAP",language:"zh-CN"},i=void 0,d={},t=[{value:"\u7C7B\u578B\u63CF\u8FF0",id:"\u7C7B\u578B\u63CF\u8FF0",level:2},{value:"\u8BED\u6CD5",id:"\u8BED\u6CD5",level:3},{value:"\u7C7B\u578B\u7EA6\u675F",id:"\u7C7B\u578B\u7EA6\u675F",level:2},{value:"\u7C7B\u578B\u6784\u9020",id:"\u7C7B\u578B\u6784\u9020",level:2},{value:"\u4FEE\u6539\u7C7B\u578B",id:"\u4FEE\u6539\u7C7B\u578B",level:2},{value:"\u5143\u7D20\u8BBF\u95EE",id:"\u5143\u7D20\u8BBF\u95EE",level:2},{value:"\u793A\u4F8B",id:"\u793A\u4F8B",level:2}];function A(e){let n={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h2,{id:"\u7C7B\u578B\u63CF\u8FF0",children:"\u7C7B\u578B\u63CF\u8FF0"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"MAP<key_type, value_type>"}),"\u7C7B\u578B\u7528\u4E8E\u8868\u793A\u952E\u503C\u5BF9\u96C6\u5408\u7684\u590D\u5408\u7C7B\u578B,\u6BCF\u4E2A\u952E\uFF08key\uFF09\u552F\u4E00\u5730\u5BF9\u5E94\u4E00\u4E2A\u503C\uFF08value\uFF09\u3002\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"key_type"})," \u8868\u5F81\u952E\u7684\u7C7B\u578B\uFF0C\u652F\u6301\u7684\u7C7B\u578B\u4E3A",(0,a.jsx)(n.code,{children:"BOOLEAN, TINYINT, SMALLINT, INT, BIGINT, LARGEINT, FLOAT, DOUBLE, DECIMAL, DATE, DATETIME, CHAR, VARCHAR, STRING\uFF0CIPTV4, IPV6"}),"\uFF0Ckey\u503C\u662FNullable\u7684\uFF0C\u4E0D\u652F\u6301\u6307\u5B9ANOT NULL\u3002"]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"value_type"})," \u8868\u5F81\u503C\u7684\u7C7B\u578B\uFF0C\u652F\u6301 ",(0,a.jsx)(n.code,{children:"BOOLEAN, TINYINT, SMALLINT, INT, BIGINT, LARGEINT, FLOAT, DOUBLE, DECIMAL, DATE, DATETIME, CHAR, VARCHAR, STRING\uFF0CIPV4, IPV6, ARRAY, MAP, STRUCT"}),"\uFF0C\u503C\u662F Nullable \u7684\uFF0C\u4E0D\u652F\u6301\u6307\u5B9A NOT NULL\u3002"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"\u8BED\u6CD5",children:"\u8BED\u6CD5"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.code,{children:"MAP<K, V>"})}),"\n",(0,a.jsx)(n.h2,{id:"\u7C7B\u578B\u7EA6\u675F",children:"\u7C7B\u578B\u7EA6\u675F"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"MAP<key_type, value_type>"}),"\u7C7B\u578B\u5141\u8BB8\u7684\u6700\u5927\u5D4C\u5957\u6DF1\u5EA6\u662F9\u3002"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"MAP<key_type, value_type>"})," \u7684",(0,a.jsx)(n.strong,{children:"Key\u53EF\u4EE5\u662F NULL\uFF0C\u5E76\u4E14\u5141\u8BB8\u76F8\u540C\u7684Key\uFF08NULL\u548CNULL\u4E5F\u88AB\u8BA4\u4E3A\u662F\u76F8\u540C\u7684Key\uFF09"}),"\u3002"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"MAP<key_type, value_type>"})," \u7C7B\u578B\u4E4B\u95F4\u7684\u8F6C\u6362\u53D6\u51B3\u4E8E",(0,a.jsx)(n.code,{children:"key_type"}),"\u4E4B\u95F4\u4EE5\u53CA",(0,a.jsx)(n.code,{children:"value_type"}),"\u4E4B\u95F4\u662F\u5426\u80FD\u8F6C\u6362\uFF0C",(0,a.jsx)(n.code,{children:"MAP<key_type, value_type>"}),"\u7C7B\u578B\u4E0D\u80FD\u8F6C\u6210\u5176\u4ED6\u7C7B\u578B\u3002\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\u4F8B\u5982: ",(0,a.jsx)(n.code,{children:"MAP<INT,INT>"}),"\u53EF\u4EE5\u8F6C\u6362\u4E3A",(0,a.jsx)(n.code,{children:"MAP<BIGINT,BIGINT>"}),"\uFF0C\u56E0\u4E3A",(0,a.jsx)(n.code,{children:"INT"}),"\u548C",(0,a.jsx)(n.code,{children:"BIGINT"}),"\u53EF\u4EE5\u8F6C\u6362\u3002"]}),"\n",(0,a.jsxs)(n.li,{children:["\u5B57\u7B26\u4E32\u7C7B\u578B\u53EF\u4EE5\u8F6C\u6362\u6210",(0,a.jsx)(n.code,{children:"MAP<key_type, value_type>"}),"\u7C7B\u578B\uFF08\u901A\u8FC7\u89E3\u6790\u7684\u5F62\u5F0F\uFF0C\u89E3\u6790\u5931\u8D25\u8FD4\u56DE NULL\uFF09\u3002"]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"MAP<key_type, value_type>"})," \u7C7B\u578B\u5728",(0,a.jsx)(n.code,{children:"AGGREGATE"}),"\u8868\u6A21\u578B\u4E2D\u53EA\u652F\u6301",(0,a.jsx)(n.code,{children:"REPLACE"}),"\u548C",(0,a.jsx)(n.code,{children:"REPLACE_IF_NOT_NULL"}),"\uFF0C",(0,a.jsxs)(n.strong,{children:["\u5728\u4EFB\u4F55\u8868\u6A21\u578B\u4E2D\u90FD\u65E0\u6CD5\u4F5C\u4E3A",(0,a.jsx)(n.code,{children:"Key"}),"\u5217\uFF0C\u65E0\u6CD5\u4F5C\u4E3A\u5206\u533A\u5206\u6876\u5217"]}),"\u3002"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"MAP<key_type, value_type>"}),"\u7C7B\u578B\u7684\u5217\u4E0D\u652F\u6301\u6BD4\u8F83\u6216\u8005\u7B97\u6570\u8FD0\u7B97\uFF0C",(0,a.jsxs)(n.strong,{children:["\u4E0D\u652F\u6301",(0,a.jsx)(n.code,{children:"ORDER BY"}),"\u548C",(0,a.jsx)(n.code,{children:"GROUP BY"}),"\u64CD\u4F5C\uFF0C\u4E0D\u652F\u6301\u4F5C\u4E3A",(0,a.jsx)(n.code,{children:"JOIN KEY"}),"\uFF0C\u4E0D\u652F\u6301\u5728",(0,a.jsx)(n.code,{children:"DELETE"}),"\u8BED\u53E5\u4E2D\u4F7F\u7528"]}),"\u3002"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"MAP<key_type, value_type>"}),"\u7C7B\u578B\u7684\u5217\u4E0D\u652F\u6301\u5EFA\u7ACB\u4EFB\u4F55\u7D22\u5F15\u3002"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"\u7C7B\u578B\u6784\u9020",children:"\u7C7B\u578B\u6784\u9020"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"MAP()"})," \u51FD\u6570\u53EF\u4EE5\u8FD4\u56DE\u4E00\u4E2A",(0,a.jsx)(n.code,{children:"MAP"}),"\u7C7B\u578B\u7684\u503C\u3002"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-SQL",children:"SELECT MAP('Alice', 21, 'Bob', 23);\n\n+-----------------------------+\n| map('Alice', 21, 'Bob', 23) |\n+-----------------------------+\n| {\"Alice\":21, \"Bob\":23}      |\n+-----------------------------+\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"{}"}),"\u53EF\u4EE5\u6784\u9020\u4E00\u4E2A",(0,a.jsx)(n.code,{children:"MAP"}),"\u7C7B\u578B\u7684\u503C\u3002"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-SQL",children:"SELECT {'Alice': 20};\n\n+---------------+\n| {'Alice': 20} |\n+---------------+\n| {\"Alice\":20}  |\n+---------------+\n"})}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"\u4FEE\u6539\u7C7B\u578B",children:"\u4FEE\u6539\u7C7B\u578B"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["\u5F53",(0,a.jsx)(n.code,{children:"MAP<key_type, value_type>"}),"\u7684",(0,a.jsx)(n.code,{children:"key_type"}),"\u6216",(0,a.jsx)(n.code,{children:"value_type"}),"\u4E3A",(0,a.jsx)(n.code,{children:"VARCHAR"}),"\u65F6\uFF0C\u624D\u5141\u8BB8\u8FDB\u884C\u4FEE\u6539\u3002"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\u53EA\u5141\u8BB8\u5C06",(0,a.jsx)(n.code,{children:"VARCHAR"}),"\u7684\u53C2\u6570\u4ECE\u5C0F\u6539\u5230\u5927\u3002\u53CD\u4E4B\u4E0D\u884C\u3002"]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-SQL",children:'CREATE TABLE `map_table` (\n  `k` INT NOT NULL,\n  `map_varchar_int` MAP<VARCHAR(10), INT>,\n  `map_int_varchar` MAP<INT, VARCHAR(10)>,\n  `map_varchar_varchar` MAP<VARCHAR(10), VARCHAR(10)>\n) ENGINE=OLAP\nDUPLICATE KEY(`k`)\nDISTRIBUTED BY HASH(`k`) BUCKETS 1\nPROPERTIES (\n    "replication_num" = "1"\n);\n\nALTER TABLE map_table MODIFY COLUMN map_varchar_int MAP<VARCHAR(20), INT>;\n\nALTER TABLE map_table MODIFY COLUMN map_int_varchar MAP<INT, VARCHAR(20)>;\n\nALTER TABLE map_table MODIFY COLUMN map_varchar_varchar MAP<VARCHAR(20), VARCHAR(20)>;\n'})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"MAP<key_type, value_type>"}),"\u7C7B\u578B\u7684\u5217\u9ED8\u8BA4\u503C\u53EA\u80FD\u6307\u5B9A\u4E3ANULL\uFF0C\u5982\u679C\u6307\u5B9A\u540E\u4E0D\u80FD\u4FEE\u6539\u3002"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"\u5143\u7D20\u8BBF\u95EE",children:"\u5143\u7D20\u8BBF\u95EE"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["\u4F7F\u7528",(0,a.jsx)(n.code,{children:"[key]"}),"\u7684\u65B9\u5F0F\u8BBF\u95EE",(0,a.jsx)(n.code,{children:"MAP"}),"\u7684",(0,a.jsx)(n.code,{children:"Key"}),"\u5BF9\u5E94\u7684",(0,a.jsx)(n.code,{children:"Value"}),"\u3002"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-SQL",children:"SELECT {'Alice': 20}['Alice'];\n\n+------------------------+\n| {'Alice': 20}['Alice'] |\n+------------------------+\n|                     20 |\n+------------------------+`\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["\u4F7F\u7528 ",(0,a.jsx)(n.code,{children:"ELEMENT_AT(MAP, Key) "}),"\u7684\u65B9\u5F0F\u8BBF\u95EE ",(0,a.jsx)(n.code,{children:"MAP"}),"\u7684",(0,a.jsx)(n.code,{children:"Key"}),"\u5BF9\u5E94\u7684",(0,a.jsx)(n.code,{children:"Value"}),"\u3002"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-SQL",children:"SELECT ELEMENT_AT({'Alice': 20}, 'Alice');\n\n+------------------------------------+\n| ELEMENT_AT({'Alice': 20}, 'Alice') |\n+------------------------------------+\n|                                 20 |\n+------------------------------------+\n"})}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"\u793A\u4F8B",children:"\u793A\u4F8B"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["\u591A\u5C42",(0,a.jsx)(n.code,{children:"MAP"}),"\u5D4C\u5957"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-SQL",children:"-- \u5EFA\u8868\nCREATE TABLE IF NOT EXISTS map_table (\n    id INT,\n    map_nested MAP<STRING, MAP<STRING, INT>>\n) ENGINE=OLAP\nDUPLICATE KEY(id)\nDISTRIBUTED BY HASH(id) BUCKETS 1\nPROPERTIES (\n    \"replication_allocation\" = \"tag.location.default: 1\"\n);\n\n--\u63D2\u5165\nINSERT INTO map_table VALUES (1, MAP('key1', MAP('key2', 1, 'key3', 2)));\nINSERT INTO map_table VALUES (2, MAP('key1', MAP('key2', 3, 'key3', 4)));\n\n-- \u67E5\u8BE2\nSELECT map_nested['key1']['key2'] FROM map_table order by id;\n+----------------------------+\n| map_nested['key1']['key2'] |\n+----------------------------+\n|                          1 |\n|                          3 |\n+----------------------------+\n\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"\u590D\u6742\u7C7B\u578B\u5D4C\u5957"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-SQL",children:"-- \u5EFA\u8868\nCREATE TABLE IF NOT EXISTS map_table (\n    id INT,\n    map_array MAP<STRING, ARRAY<INT>>\n) ENGINE=OLAP\nDUPLICATE KEY(id)\nDISTRIBUTED BY HASH(id) BUCKETS 1\nPROPERTIES (\n    \"replication_allocation\" = \"tag.location.default: 1\"\n);\n\n-- \u63D2\u5165\nINSERT INTO map_table VALUES (1, MAP('key1', [1, 2, 3])), (2, MAP('key1', [4, 5, 6]));\n\n-- \u67E5\u8BE2\nSELECT map_array['key1'][1] FROM map_table order by id;\n+----------------------+\n| map_array['key1'][1] |\n+----------------------+\n|                    1 |\n|                    4 |\n+----------------------+\n\n-- \u5EFA\u8868\nCREATE TABLE IF NOT EXISTS map_table (\n    id INT,\n    map_struct MAP<STRING, STRUCT<id: INT, name: STRING>>\n) ENGINE=OLAP\nDUPLICATE KEY(id)\nDISTRIBUTED BY HASH(id) BUCKETS 1\nPROPERTIES (\n    \"replication_allocation\" = \"tag.location.default: 1\"\n);\n\n-- \u63D2\u5165\nINSERT INTO map_table VALUES (1, MAP('key1', STRUCT(1, 'John'), 'key2', STRUCT(3, 'Jane')));\n\n-- \u67E5\u8BE2\nSELECT STRUCT_ELEMENT(map_struct['key1'], 1), STRUCT_ELEMENT(map_struct['key1'], 'name') FROM map_table order by id;\n+---------------------------------------+--------------------------------------------+\n| STRUCT_ELEMENT(map_struct['key1'], 1) | STRUCT_ELEMENT(map_struct['key1'], 'name') |\n+---------------------------------------+--------------------------------------------+\n|                                     1 | John                                       |\n+---------------------------------------+--------------------------------------------+\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"\u4FEE\u6539\u7C7B\u578B"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-SQL",children:'-- \u5EFA\u8868\nCREATE TABLE `map_table` (\n  `k` INT NOT NULL,\n  `map_varchar_int` MAP<VARCHAR(10), INT>,\n  `map_int_varchar` MAP<INT, VARCHAR(10)>,\n  `map_varchar_varchar` MAP<VARCHAR(10), VARCHAR(10)>\n) ENGINE=OLAP\nDUPLICATE KEY(`k`)\nDISTRIBUTED BY HASH(`k`) BUCKETS 1\nPROPERTIES (\n    "replication_num" = "1"\n);\n\n-- \u4FEE\u6539 KEY\nALTER TABLE map_table MODIFY COLUMN map_varchar_int MAP<VARCHAR(20), INT>;\n\n-- \u4FEE\u6539 VALUE\nALTER TABLE map_table MODIFY COLUMN map_int_varchar MAP<INT, VARCHAR(20)>;\n\n-- \u4FEE\u6539 KEY VALUE\nALTER TABLE map_table MODIFY COLUMN map_varchar_varchar MAP<VARCHAR(20), VARCHAR(20)>;\n\n-- \u67E5\u770B\u5217\u7C7B\u578B\nDESC map_table;\n+---------------------+------------------------------+------+-------+---------+-------+\n| Field               | Type                         | Null | Key   | Default | Extra |\n+---------------------+------------------------------+------+-------+---------+-------+\n| k                   | int                          | No   | true  | NULL    |       |\n| map_varchar_int     | map<varchar(20),int>         | Yes  | false | NULL    | NONE  |\n| map_int_varchar     | map<int,varchar(20)>         | Yes  | false | NULL    | NONE  |\n| map_varchar_varchar | map<varchar(20),varchar(20)> | Yes  | false | NULL    | NONE  |\n+---------------------+------------------------------+------+-------+---------+-------+\n'})}),"\n"]}),"\n"]})]})}function h(e={}){let{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(A,{...e})}):A(e)}},250065:function(e,n,l){l.d(n,{Z:function(){return i},a:function(){return r}});var c=l(667294);let a={},s=c.createContext(a);function r(e){let n=c.useContext(s);return c.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),c.createElement(s.Provider,{value:n},e.children)}}}]);