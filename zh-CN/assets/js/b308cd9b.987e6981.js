"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["708303"],{875826:function(n,e,i){i.r(e),i.d(e,{default:()=>h,frontMatter:()=>t,metadata:()=>l,assets:()=>c,toc:()=>o,contentTitle:()=>d});var l=JSON.parse('{"id":"table-design/storage-format","title":"\u5B58\u50A8\u683C\u5F0F V3","description":"\x3c!--","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs/version-4.x/table-design/storage-format.md","sourceDirName":"table-design","slug":"/table-design/storage-format","permalink":"/zh-CN/docs/4.x/table-design/storage-format","draft":false,"unlisted":false,"tags":[],"version":"4.x","lastUpdatedAt":1770477659000,"frontMatter":{"title":"\u5B58\u50A8\u683C\u5F0F V3","language":"zh-CN"},"sidebar":"docs","previous":{"title":"\u6570\u636E\u538B\u7F29","permalink":"/zh-CN/docs/4.x/table-design/column-compression"},"next":{"title":"\u7D22\u5F15\u6982\u8FF0","permalink":"/zh-CN/docs/4.x/table-design/index/index-overview"}}'),r=i("785893"),s=i("250065");let t={title:"\u5B58\u50A8\u683C\u5F0F V3",language:"zh-CN"},d=void 0,c={},o=[{value:"\u6838\u5FC3\u4F18\u5316\u70B9",id:"\u6838\u5FC3\u4F18\u5316\u70B9",level:2},{value:"\u5916\u90E8\u5217\u5143\u6570\u636E (External Column Meta)",id:"\u5916\u90E8\u5217\u5143\u6570\u636E-external-column-meta",level:3},{value:"\u6570\u503C\u7C7B\u578B Plain \u7F16\u7801\u6A21\u5F0F (Integer Type Plain Encoding)",id:"\u6570\u503C\u7C7B\u578B-plain-\u7F16\u7801\u6A21\u5F0F-integer-type-plain-encoding",level:3},{value:"\u4E8C\u8FDB\u5236 Plain \u7F16\u7801 V2 (Binary Plain Encoding V2)",id:"\u4E8C\u8FDB\u5236-plain-\u7F16\u7801-v2-binary-plain-encoding-v2",level:3},{value:"\u8BBE\u8BA1\u54F2\u5B66",id:"\u8BBE\u8BA1\u54F2\u5B66",level:2},{value:"\u4F7F\u7528\u573A\u666F",id:"\u4F7F\u7528\u573A\u666F",level:2},{value:"\u4F7F\u7528\u65B9\u5F0F",id:"\u4F7F\u7528\u65B9\u5F0F",level:2},{value:"\u521B\u5EFA\u65B0\u8868\u65F6\u542F\u7528",id:"\u521B\u5EFA\u65B0\u8868\u65F6\u542F\u7528",level:3}];function a(n){let e={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.p,{children:"Apache Doris \u5B58\u50A8\u683C\u5F0F V3 \u662F\u5728 Segment V2 \u683C\u5F0F\u57FA\u7840\u4E0A\u8FDB\u884C\u7684\u91CD\u5927\u6F14\u8FDB\u3002\u5B83\u901A\u8FC7\u5143\u6570\u636E\u89E3\u8026\u4E0E\u7F16\u7801\u7B56\u7565\u4F18\u5316\uFF0C\u4E13\u95E8\u9488\u5BF9\u5927\u5BBD\u8868\u3001\u590D\u6742\u6570\u636E\u7C7B\u578B\uFF08\u5982 Variant\uFF09\u4EE5\u53CA\u4E91\u539F\u751F\u5B58\u7B97\u5206\u79BB\u573A\u666F\u63D0\u5347\u6027\u80FD\u3002"}),"\n",(0,r.jsx)(e.h2,{id:"\u6838\u5FC3\u4F18\u5316\u70B9",children:"\u6838\u5FC3\u4F18\u5316\u70B9"}),"\n",(0,r.jsx)(e.h3,{id:"\u5916\u90E8\u5217\u5143\u6570\u636E-external-column-meta",children:"\u5916\u90E8\u5217\u5143\u6570\u636E (External Column Meta)"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u4F18\u5316\u80CC\u666F"}),"\uFF1A\u5728 Segment V2 \u4E2D\uFF0C\u6240\u6709\u5217\u7684\u5143\u6570\u636E\uFF08",(0,r.jsx)(e.code,{children:"ColumnMetaPB"}),"\uFF09\u90FD\u5B58\u50A8\u5728 Segment \u6587\u4EF6\u7684 Footer \u4E2D\u3002\u5BF9\u4E8E\u62E5\u6709\u6570\u5343\u5217\u7684\u5927\u5BBD\u8868\u6216\u81EA\u52A8\u6269\u5BB9\u7684 Variant \u573A\u666F\uFF0CFooter \u53EF\u80FD\u4F1A\u81A8\u80C0\u5230\u51E0 MB\u3002"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u4F18\u5316\u601D\u8DEF"}),"\uFF1AV3 \u5C06 ",(0,r.jsx)(e.code,{children:"ColumnMetaPB"})," \u4ECE Footer \u4E2D\u5265\u79BB\uFF0C\u8F6C\u800C\u5B58\u50A8\u5728\u6587\u4EF6\u5185\u7684\u72EC\u7ACB\u533A\u57DF\uFF08External Column Meta Area\uFF09\u3002"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u6536\u76CA"}),"\uFF1A\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u6781\u901F\u5143\u6570\u636E\u52A0\u8F7D"}),"\uFF1A\u663E\u8457\u51CF\u5C0F Segment Footer \u4F53\u79EF\uFF0C\u52A0\u5FEB\u6587\u4EF6\u521D\u6B21\u6253\u5F00\u901F\u5EA6\u3002"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u6309\u9700\u52A0\u8F7D"}),"\uFF1A\u5143\u6570\u636E\u53EF\u4EE5\u6309\u9700\u4ECE\u72EC\u7ACB\u533A\u57DF\u52A0\u8F7D\uFF0C\u964D\u4F4E\u5185\u5B58\u5360\u7528\uFF0C\u63D0\u5347\u5BF9\u8C61\u5B58\u50A8\uFF08\u5982 S3/OSS\uFF09\u4E0A\u7684\u51B7\u542F\u52A8\u67E5\u8BE2\u6027\u80FD\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"\u6570\u503C\u7C7B\u578B-plain-\u7F16\u7801\u6A21\u5F0F-integer-type-plain-encoding",children:"\u6570\u503C\u7C7B\u578B Plain \u7F16\u7801\u6A21\u5F0F (Integer Type Plain Encoding)"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u4F18\u5316\u601D\u8DEF"}),"\uFF1AV3 \u9ED8\u8BA4\u5C06\u6570\u503C\u7C7B\u578B\uFF08\u5982 ",(0,r.jsx)(e.code,{children:"INT"}),", ",(0,r.jsx)(e.code,{children:"BIGINT"}),"\uFF09\u5207\u6362\u4E3A ",(0,r.jsx)(e.code,{children:"PLAIN_ENCODING"}),"\uFF08\u539F\u59CB\u4E8C\u8FDB\u5236\u5B58\u50A8\uFF09\uFF0C\u800C\u975E\u4F20\u7EDF\u7684 BitShuffle\u3002"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u6536\u76CA"}),"\uFF1A\u914D\u5408 LZ4/ZSTD \u538B\u7F29\u65F6\uFF0C",(0,r.jsx)(e.code,{children:"PLAIN_ENCODING"})," \u63D0\u4F9B\u4E86\u66F4\u9AD8\u7684\u8BFB\u53D6\u541E\u5410\u91CF\u548C\u66F4\u4F4E\u7684 CPU \u5F00\u9500\u3002\u5728\u73B0\u4EE3\u9AD8\u901F IO \u73AF\u5883\u4E0B\uFF0C\u8FD9\u79CD\u201C\u89E3\u538B\u6362\u6027\u80FD\u201D\u7684\u7B56\u7565\u5728\u626B\u63CF\u5927\u4F53\u91CF\u6570\u636E\u65F6\u4F18\u52BF\u660E\u663E\u3002"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"\u4E8C\u8FDB\u5236-plain-\u7F16\u7801-v2-binary-plain-encoding-v2",children:"\u4E8C\u8FDB\u5236 Plain \u7F16\u7801 V2 (Binary Plain Encoding V2)"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u4F18\u5316\u601D\u8DEF"}),"\uFF1A\u5F15\u5165 ",(0,r.jsx)(e.code,{children:"BINARY_PLAIN_ENCODING_V2"}),"\uFF0C\u91C7\u7528 ",(0,r.jsx)(e.code,{children:"[\u957F\u5EA6(varuint)][\u539F\u59CB\u6570\u636E]"})," \u7684\u6D41\u5F0F\u5E03\u5C40\uFF0C\u53D6\u4EE3\u4E86\u4F9D\u8D56\u672B\u5C3E\u504F\u79FB\u8868\uFF08Offsets\uFF09\u7684\u65E7\u683C\u5F0F\u3002"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u6536\u76CA"}),"\uFF1A\u6D88\u9664\u4E86\u672B\u5C3E\u5E9E\u5927\u7684\u504F\u79FB\u8868\uFF0C\u6570\u636E\u5B58\u50A8\u66F4\u52A0\u7D27\u51D1\uFF0C\u6709\u6548\u964D\u4F4E\u4E86\u5B57\u7B26\u4E32\u548C JSONB \u7C7B\u578B\u7684\u5B58\u50A8\u7A7A\u95F4\u5360\u7528\u3002"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"\u8BBE\u8BA1\u54F2\u5B66",children:"\u8BBE\u8BA1\u54F2\u5B66"}),"\n",(0,r.jsxs)(e.p,{children:["V3 \u7684\u8BBE\u8BA1\u54F2\u5B66\u53EF\u4EE5\u603B\u7ED3\u4E3A\uFF1A",(0,r.jsx)(e.strong,{children:"\u201C\u5143\u6570\u636E\u89E3\u8026\u3001\u7F16\u7801\u7B80\u5316\u3001\u6D41\u5F0F\u5E03\u5C40\u201D"}),"\u3002\u901A\u8FC7\u51CF\u5C11\u5143\u6570\u636E\u5904\u7406\u74F6\u9888\u548C\u5229\u7528\u73B0\u4EE3 CPU \u5BF9\u7B80\u5355\u7F16\u7801\u7684\u9AD8\u5904\u7406\u6548\u7387\uFF0C\u5B9E\u73B0\u5728\u590D\u6742\u6A21\u5F0F\u4E0B\u7684\u9AD8\u6027\u80FD\u5206\u6790\u3002"]}),"\n",(0,r.jsx)(e.h2,{id:"\u4F7F\u7528\u573A\u666F",children:"\u4F7F\u7528\u573A\u666F"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u5927\u5BBD\u8868"}),"\uFF1A\u5B57\u6BB5\u6570\u91CF\u8D85\u8FC7 2000 \u4E2A\u4EE5\u4E0A\uFF0C\u6216\u5B57\u6BB5\u540D\u5197\u957F\u3002"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u534A\u7ED3\u6784\u5316\u6570\u636E"}),"\uFF1A\u5927\u91CF\u4F7F\u7528 ",(0,r.jsx)(e.code,{children:"VARIANT"}),"\uFF0C \u4E14\u7269\u5316\u5217\u6570\u8D85\u8FC72000\u5217\u3002"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u51B7\u70ED\u5206\u79BB/\u4E91\u539F\u751F"}),"\uFF1A\u5BF9\u5BF9\u8C61\u5B58\u50A8\u52A0\u8F7D\u5EF6\u8FDF\u654F\u611F\u7684\u573A\u666F\u3002"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u9AD8\u6027\u80FD\u626B\u63CF"}),"\uFF1A\u5BF9 Scan \u541E\u5410\u91CF\u6709\u6781\u81F4\u8981\u6C42\u7684\u5206\u6790\u4EFB\u52A1\u3002"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"\u4F7F\u7528\u65B9\u5F0F",children:"\u4F7F\u7528\u65B9\u5F0F"}),"\n",(0,r.jsx)(e.h3,{id:"\u521B\u5EFA\u65B0\u8868\u65F6\u542F\u7528",children:"\u521B\u5EFA\u65B0\u8868\u65F6\u542F\u7528"}),"\n",(0,r.jsxs)(e.p,{children:["\u5728\u5EFA\u8868\u8BED\u53E5\u7684 ",(0,r.jsx)(e.code,{children:"PROPERTIES"})," \u4E2D\u6307\u5B9A ",(0,r.jsx)(e.code,{children:"storage_format"})," \u4E3A ",(0,r.jsx)(e.code,{children:"V3"}),"\uFF1A"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:'CREATE TABLE table_v3 (\n    id BIGINT,\n    data VARIANT\n)\nDISTRIBUTED BY HASH(id) BUCKETS 32\nPROPERTIES (\n    "storage_format" = "V3"\n);\n'})})]})}function h(n={}){let{wrapper:e}={...(0,s.a)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(a,{...n})}):a(n)}},250065:function(n,e,i){i.d(e,{Z:function(){return d},a:function(){return t}});var l=i(667294);let r={},s=l.createContext(r);function t(n){let e=l.useContext(s);return l.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:t(n.components),l.createElement(s.Provider,{value:e},n.children)}}}]);