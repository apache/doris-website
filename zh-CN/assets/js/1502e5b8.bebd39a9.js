"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["753120"],{342080:function(e,n,s){s.r(n),s.d(n,{default:()=>o,frontMatter:()=>c,metadata:()=>l,assets:()=>d,toc:()=>a,contentTitle:()=>t});var l=JSON.parse('{"id":"lakehouse/file-analysis","title":"\u5206\u6790 S3/HDFS \u4E0A\u7684\u6587\u4EF6","description":"\u901A\u8FC7 Table Value Function \u529F\u80FD\uFF0CDoris \u53EF\u4EE5\u76F4\u63A5\u5C06\u5BF9\u8C61\u5B58\u50A8\u6216 HDFS \u4E0A\u7684\u6587\u4EF6\u4F5C\u4E3A Table \u8FDB\u884C\u67E5\u8BE2\u5206\u6790\u3002\u5E76\u4E14\u652F\u6301\u81EA\u52A8\u7684\u5217\u7C7B\u578B\u63A8\u65AD\u3002","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs/current/lakehouse/file-analysis.md","sourceDirName":"lakehouse","slug":"/lakehouse/file-analysis","permalink":"/zh-CN/docs/dev/lakehouse/file-analysis","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"\u5206\u6790 S3/HDFS \u4E0A\u7684\u6587\u4EF6","language":"zh-CN"},"sidebar":"docs","previous":{"title":"Oceanbase JDBC Catalog","permalink":"/zh-CN/docs/dev/lakehouse/catalogs/jdbc-oceanbase-catalog"},"next":{"title":"Hive Metastore","permalink":"/zh-CN/docs/dev/lakehouse/metastores/hive-metastore"}}'),i=s("785893"),r=s("250065");let c={title:"\u5206\u6790 S3/HDFS \u4E0A\u7684\u6587\u4EF6",language:"zh-CN"},t=void 0,d={},a=[{value:"\u57FA\u7840\u4F7F\u7528",id:"\u57FA\u7840\u4F7F\u7528",level:2},{value:"\u67E5\u8BE2",id:"\u67E5\u8BE2",level:3},{value:"\u591A\u6587\u4EF6\u5BFC\u5165",id:"\u591A\u6587\u4EF6\u5BFC\u5165",level:3},{value:"\u81EA\u52A8\u63A8\u65AD\u6587\u4EF6\u5217\u7C7B\u578B",id:"\u81EA\u52A8\u63A8\u65AD\u6587\u4EF6\u5217\u7C7B\u578B",level:3},{value:"\u9002\u7528\u573A\u666F",id:"\u9002\u7528\u573A\u666F",level:2},{value:"\u67E5\u8BE2\u5206\u6790",id:"\u67E5\u8BE2\u5206\u6790",level:3},{value:"\u6570\u636E\u5BFC\u5165",id:"\u6570\u636E\u5BFC\u5165",level:3},{value:"\u6CE8\u610F\u4E8B\u9879",id:"\u6CE8\u610F\u4E8B\u9879",level:2}];function h(e){let n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"\u901A\u8FC7 Table Value Function \u529F\u80FD\uFF0CDoris \u53EF\u4EE5\u76F4\u63A5\u5C06\u5BF9\u8C61\u5B58\u50A8\u6216 HDFS \u4E0A\u7684\u6587\u4EF6\u4F5C\u4E3A Table \u8FDB\u884C\u67E5\u8BE2\u5206\u6790\u3002\u5E76\u4E14\u652F\u6301\u81EA\u52A8\u7684\u5217\u7C7B\u578B\u63A8\u65AD\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u66F4\u591A\u4F7F\u7528\u65B9\u5F0F\u53EF\u53C2\u9605 Table Value Function \u6587\u6863\uFF1A"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"/zh-CN/docs/dev/sql-manual/sql-functions/table-valued-functions/s3",children:"S3"}),"\uFF1A\u652F\u6301 S3 \u517C\u5BB9\u7684\u5BF9\u8C61\u5B58\u50A8\u4E0A\u7684\u6587\u4EF6\u5206\u6790\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"/zh-CN/docs/dev/sql-manual/sql-functions/table-valued-functions/hdfs",children:"HDFS"}),"\uFF1A\u652F\u6301 HDFS \u4E0A\u7684\u6587\u4EF6\u5206\u6790\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"/zh-CN/docs/dev/sql-manual/sql-functions/table-valued-functions/file",children:"FILE"}),"\uFF1A\u7EDF\u4E00\u8868\u51FD\u6570\uFF0C\u53EF\u4EE5\u540C\u65F6\u652F\u6301 S3/HDFS/Local \u6587\u4EF6\u7684\u8BFB\u53D6\u3002\uFF08\u81EA 3.1.0 \u7248\u672C\u652F\u6301\u3002\uFF09"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u57FA\u7840\u4F7F\u7528",children:"\u57FA\u7840\u4F7F\u7528"}),"\n",(0,i.jsx)(n.p,{children:"\u8FD9\u91CC\u6211\u4EEC\u901A\u8FC7 S3 Table Value Function \u4E3E\u4F8B\u8BF4\u660E\u5982\u4F55\u5BF9\u5BF9\u8C61\u5B58\u50A8\u4E0A\u7684\u6587\u4EF6\u8FDB\u884C\u5206\u6790\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"\u67E5\u8BE2",children:"\u67E5\u8BE2"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM S3 (\n    'uri' = 's3://bucket/path/to/tvf_test/test.parquet',\n    'format' = 'parquet',\n    's3.endpoint' = 'https://s3.us-east-1.amazonaws.com',\n    's3.region' = 'us-east-1',\n    's3.access_key' = 'ak',\n    's3.secret_key'='sk'\n)\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u5176\u4E2D ",(0,i.jsx)(n.code,{children:"S3(...)"}),"\u662F\u4E00\u4E2A TVF\uFF08Table Value Function\uFF09\u3002Table Value Function \u672C\u8D28\u4E0A\u662F\u4E00\u5F20\u8868\uFF0C\u56E0\u6B64\u4ED6\u53EF\u4EE5\u51FA\u73B0\u5728\u4EFB\u610F SQL \u8BED\u53E5\u4E2D\u201C\u8868\u201D\u53EF\u4EE5\u51FA\u73B0\u7684\u4F4D\u7F6E\u4E0A\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"TVF \u7684\u5C5E\u6027\u5305\u62EC\u8981\u5206\u6790\u7684\u6587\u4EF6\u8DEF\u5F84\uFF0C\u6587\u4EF6\u683C\u5F0F\u3001\u5BF9\u8C61\u5B58\u50A8\u7684\u8FDE\u63A5\u4FE1\u606F\u7B49\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"\u591A\u6587\u4EF6\u5BFC\u5165",children:"\u591A\u6587\u4EF6\u5BFC\u5165"}),"\n",(0,i.jsxs)(n.p,{children:["\u5728\u5BFC\u5165\u65F6\uFF0C\u6587\u4EF6\u8DEF\u5F84\uFF08URI\uFF09\u652F\u6301\u4F7F\u7528\u901A\u914D\u7B26\u8FDB\u884C\u5339\u914D\u3002Doris \u7684\u6587\u4EF6\u8DEF\u5F84\u5339\u914D\u91C7\u7528",(0,i.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Glob_(programming)#:~:text=glob%20%28%29%20%28%2F%20%C9%A1l%C9%92b%20%2F%29%20is%20a%20libc,into%20a%20list%20of%20names%20matching%20that%20pattern.",children:"Glob\u5339\u914D\u6A21\u5F0F"}),"\uFF0C\u5E76\u5728\u6B64\u57FA\u7840\u4E0A\u8FDB\u884C\u4E86\u4E00\u4E9B\u6269\u5C55\uFF0C\u652F\u6301\u66F4\u7075\u6D3B\u7684\u6587\u4EF6\u9009\u62E9\u65B9\u5F0F\u3002"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"file_{1..3}"}),"\uFF1A\u5339\u914D\u6587\u4EF6",(0,i.jsx)(n.code,{children:"file_1"}),"\u3001",(0,i.jsx)(n.code,{children:"file_2"}),"\u3001",(0,i.jsx)(n.code,{children:"file_3"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"file_{1,3}_{1,2}"}),"\uFF1A\u5339\u914D\u6587\u4EF6",(0,i.jsx)(n.code,{children:"file_1_1"}),"\u3001",(0,i.jsx)(n.code,{children:"file_1_2"}),"\u3001",(0,i.jsx)(n.code,{children:"file_3_1"}),"\u3001",(0,i.jsx)(n.code,{children:"file_1_2"})," \uFF08\u652F\u6301\u548C",(0,i.jsx)(n.code,{children:"{n..m}"}),"\u65B9\u5F0F\u6DF7\u7528\uFF0C\u7528\u9017\u53F7\u9694\u5F00\uFF09"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"file_*"}),"\uFF1A\u5339\u914D\u6240\u6709",(0,i.jsx)(n.code,{children:"file_"}),"\u5F00\u5934\u7684\u6587\u4EF6"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"*.parquet"}),"\uFF1A\u5339\u914D\u6240\u6709",(0,i.jsx)(n.code,{children:".parquet"}),"\u540E\u7F00\u7684\u6587\u4EF6"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"tvf_test/*"}),"\uFF1A\u5339\u914D",(0,i.jsx)(n.code,{children:"tvf_test"}),"\u76EE\u5F55\u4E0B\u7684\u6240\u6709\u6587\u4EF6"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"*test*"}),"\uFF1A\u5339\u914D\u6587\u4EF6\u540D\u4E2D\u5305\u542B ",(0,i.jsx)(n.code,{children:"test"}),"\u7684\u6587\u4EF6"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u6CE8\u610F"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"{1..3}"}),"\u7684\u5199\u6CD5\u4E2D\u987A\u5E8F\u53EF\u4EE5\u98A0\u5012\uFF0C",(0,i.jsx)(n.code,{children:"{3..1}"}),"\u4E5F\u662F\u53EF\u4EE5\u7684\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"file_{-1..2}"}),"\u3001",(0,i.jsx)(n.code,{children:"file_{a..4}"}),"\u8FD9\u79CD\u5199\u6CD5\u4E0D\u7B26\u5408\u89C4\u5B9A\uFF0C\u4E0D\u652F\u6301\u4F7F\u7528\u8D1F\u6570\u6216\u8005\u5B57\u6BCD\u4F5C\u4E3A\u679A\u4E3E\u7AEF\u70B9\uFF0C\u4F46\u662F",(0,i.jsx)(n.code,{children:"file_{1..3,11}"}),"\u662F\u5141\u8BB8\u7684\uFF0C\u4F1A\u5339\u914D\u5230\u6587\u4EF6",(0,i.jsx)(n.code,{children:"file_1"}),"\u3001",(0,i.jsx)(n.code,{children:"file_2"}),"\u3001",(0,i.jsx)(n.code,{children:"file_3"}),"\u3001",(0,i.jsx)(n.code,{children:"file_11"}),"\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:["doris\u5C3D\u91CF\u8BA9\u80FD\u591F\u5BFC\u5165\u7684\u6587\u4EF6\u5BFC\u5165\u6210\u529F\uFF0C\u5982\u679C\u662F",(0,i.jsx)(n.code,{children:"file_{a..b,-1..3,4..5}"}),"\u8FD9\u6837\u5305\u542B\u4E86\u9519\u8BEF\u5199\u6CD5\u7684\u8DEF\u5F84\uFF0C\u6211\u4EEC\u4F1A\u5339\u914D\u5230\u6587\u4EF6",(0,i.jsx)(n.code,{children:"file_4"}),"\u548C",(0,i.jsx)(n.code,{children:"file_5"}),"\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"{1..4,5}"}),"\u91C7\u7528\u9017\u53F7\u6DFB\u52A0\u7684\u53EA\u5141\u8BB8\u662F\u6570\u5B57\uFF0C\u800C\u4E0D\u5141\u8BB8\u5982",(0,i.jsx)(n.code,{children:"{1..4,a}"}),"\u8FD9\u6837\u7684\u5199\u6CD5\uFF0C\u540E\u8005\u4F1A\u5FFD\u7565\u6389",(0,i.jsx)(n.code,{children:"{a}"})]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"\u81EA\u52A8\u63A8\u65AD\u6587\u4EF6\u5217\u7C7B\u578B",children:"\u81EA\u52A8\u63A8\u65AD\u6587\u4EF6\u5217\u7C7B\u578B"}),"\n",(0,i.jsxs)(n.p,{children:["\u53EF\u4EE5\u901A\u8FC7 ",(0,i.jsx)(n.code,{children:"DESC FUNCTION"})," \u8BED\u6CD5\u53EF\u4EE5\u67E5\u770B TVF \u7684 Schema\uFF1A"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:'DESC FUNCTION s3 (\n    "URI" = "s3://bucket/path/to/tvf_test/test.parquet",\n    "s3.access_key"= "ak",\n    "s3.secret_key" = "sk",\n    "format" = "parquet",\n    "use_path_style"="true"\n);\n+---------------+--------------+------+-------+---------+-------+\n| Field         | Type         | Null | Key   | Default | Extra |\n+---------------+--------------+------+-------+---------+-------+\n| p_partkey     | INT          | Yes  | false | NULL    | NONE  |\n| p_name        | TEXT         | Yes  | false | NULL    | NONE  |\n| p_mfgr        | TEXT         | Yes  | false | NULL    | NONE  |\n| p_brand       | TEXT         | Yes  | false | NULL    | NONE  |\n| p_type        | TEXT         | Yes  | false | NULL    | NONE  |\n| p_size        | INT          | Yes  | false | NULL    | NONE  |\n| p_container   | TEXT         | Yes  | false | NULL    | NONE  |\n| p_retailprice | DECIMAL(9,0) | Yes  | false | NULL    | NONE  |\n| p_comment     | TEXT         | Yes  | false | NULL    | NONE  |\n+---------------+--------------+------+-------+---------+-------+\n'})}),"\n",(0,i.jsx)(n.p,{children:"Doris \u6839\u636E\u4EE5\u4E0B\u89C4\u5219\u63A8\u65AD Schema\uFF1A"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"\u5BF9\u4E8E Parquet\u3001ORC \u683C\u5F0F\uFF0CDoris \u4F1A\u6839\u636E\u6587\u4EF6\u5143\u4FE1\u606F\u83B7\u53D6 Schema\u3002"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"\u5BF9\u4E8E\u5339\u914D\u591A\u4E2A\u6587\u4EF6\u7684\u60C5\u51B5\uFF0C\u4F1A\u4F7F\u7528\u7B2C\u4E00\u4E2A\u6587\u4EF6\u7684 Schema \u4F5C\u4E3A TVF \u7684 Schema\u3002"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["\u5BF9\u4E8E CSV\u3001JSON \u683C\u5F0F\uFF0CDoris \u4F1A\u6839\u636E\u5B57\u6BB5\u3001\u5206\u9694\u7B26\u7B49\u5C5E\u6027\uFF0C\u89E3\u6790",(0,i.jsx)(n.strong,{children:"\u7B2C\u4E00\u884C\u6570\u636E"}),"\u83B7\u53D6 Schema\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:["\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u6240\u6709\u5217\u7C7B\u578B\u5747\u4E3A ",(0,i.jsx)(n.code,{children:"string"}),"\u3002\u53EF\u4EE5\u901A\u8FC7 ",(0,i.jsx)(n.code,{children:"csv_schema"})," \u5C5E\u6027\u5355\u72EC\u6307\u5B9A\u5217\u540D\u548C\u5217\u7C7B\u578B\u3002Doris \u4F1A\u4F7F\u7528\u6307\u5B9A\u7684\u5217\u7C7B\u578B\u8FDB\u884C\u6587\u4EF6\u8BFB\u53D6\u3002\u683C\u5F0F\u5982\u4E0B\uFF1A",(0,i.jsx)(n.code,{children:"name1:type1;name2:type2;..."}),"\u3002\u5982\uFF1A"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"S3 (\n    'uri' = 's3://bucket/path/to/tvf_test/test.parquet',\n    's3.endpoint' = 'https://s3.us-east-1.amazonaws.com',\n    's3.region' = 'us-east-1',\n    's3.access_key' = 'ak'\n    's3.secret_key'='sk',\n    'format' = 'csv',\n    'column_separator' = '|',\n    'csv_schema' = 'k1:int;k2:int;k3:int;k4:decimal(38,10)'\n)\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u5F53\u524D\u652F\u6301\u7684\u5217\u7C7B\u578B\u540D\u79F0\u5982\u4E0B\uFF1A"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.th,{children:"\u5217\u7C7B\u578B\u540D\u79F0"})})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.td,{children:"tinyint"})}),(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.td,{children:"smallint"})}),(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.td,{children:"int"})}),(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.td,{children:"bigint"})}),(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.td,{children:"largeint"})}),(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.td,{children:"float"})}),(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.td,{children:"double"})}),(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.td,{children:"decimal(p,s)"})}),(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.td,{children:"date"})}),(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.td,{children:"datetime"})}),(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.td,{children:"char"})}),(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.td,{children:"varchar"})}),(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.td,{children:"string"})}),(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.td,{children:"boolean"})})]})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["\u5BF9\u4E8E\u683C\u5F0F\u4E0D\u5339\u914D\u7684\u5217\uFF08\u6BD4\u5982\u6587\u4EF6\u4E2D\u4E3A\u5B57\u7B26\u4E32\uFF0C\u7528\u6237\u5B9A\u4E49\u4E3A ",(0,i.jsx)(n.code,{children:"int"}),"\uFF1B\u6216\u8005\u5176\u4ED6\u6587\u4EF6\u548C\u7B2C\u4E00\u4E2A\u6587\u4EF6\u7684 Schema \u4E0D\u76F8\u540C\uFF09\uFF0C\u6216\u7F3A\u5931\u5217\uFF08\u6BD4\u5982\u6587\u4EF6\u4E2D\u6709 4 \u5217\uFF0C\u7528\u6237\u5B9A\u4E49\u4E86 5 \u5217\uFF09\uFF0C\u5219\u8FD9\u4E9B\u5217\u5C06\u8FD4\u56DE ",(0,i.jsx)(n.code,{children:"null"}),"\u3002"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u9002\u7528\u573A\u666F",children:"\u9002\u7528\u573A\u666F"}),"\n",(0,i.jsx)(n.h3,{id:"\u67E5\u8BE2\u5206\u6790",children:"\u67E5\u8BE2\u5206\u6790"}),"\n",(0,i.jsx)(n.p,{children:"TVF \u975E\u5E38\u9002\u7528\u4E8E\u5BF9\u5B58\u50A8\u7CFB\u7EDF\u4E0A\u7684\u72EC\u7ACB\u6587\u4EF6\u8FDB\u884C\u76F4\u63A5\u5206\u6790\uFF0C\u800C\u65E0\u9700\u4E8B\u5148\u5C06\u6570\u636E\u5BFC\u5165\u5230 Doris \u4E2D\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u53EF\u4EE5\u4F7F\u7528\u4EFB\u610F\u7684 SQL \u8BED\u53E5\u8FDB\u884C\u6587\u4EF6\u5206\u6790\uFF0C\u5982\uFF1A"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM s3(\n    'uri' = 's3://bucket/path/to/tvf_test/test.parquet',\n    'format' = 'parquet',\n    's3.endpoint' = 'https://s3.us-east-1.amazonaws.com',\n    's3.region' = 'us-east-1',\n    's3.access_key' = 'ak',\n    's3.secret_key'='sk'\n)\nORDER BY p_partkey LIMIT 5;\n+-----------+------------------------------------------+----------------+----------+-------------------------+--------+-------------+---------------+---------------------+\n| p_partkey | p_name                                   | p_mfgr         | p_brand  | p_type                  | p_size | p_container | p_retailprice | p_comment           |\n+-----------+------------------------------------------+----------------+----------+-------------------------+--------+-------------+---------------+---------------------+\n|         1 | goldenrod lavender spring chocolate lace | Manufacturer#1 | Brand#13 | PROMO BURNISHED COPPER  |      7 | JUMBO PKG   |           901 | ly. slyly ironi     |\n|         2 | blush thistle blue yellow saddle         | Manufacturer#1 | Brand#13 | LARGE BRUSHED BRASS     |      1 | LG CASE     |           902 | lar accounts amo    |\n|         3 | spring green yellow purple cornsilk      | Manufacturer#4 | Brand#42 | STANDARD POLISHED BRASS |     21 | WRAP CASE   |           903 | egular deposits hag |\n|         4 | cornflower chocolate smoke green pink    | Manufacturer#3 | Brand#34 | SMALL PLATED BRASS      |     14 | MED DRUM    |           904 | p furiously r       |\n|         5 | forest brown coral puff cream            | Manufacturer#3 | Brand#32 | STANDARD POLISHED TIN   |     15 | SM PKG      |           905 |  wake carefully     |\n+-----------+------------------------------------------+----------------+----------+-------------------------+--------+-------------+---------------+---------------------+\n"})}),"\n",(0,i.jsxs)(n.p,{children:["TVF \u53EF\u4EE5\u51FA\u73B0\u5728 SQL \u4E2D\uFF0CTable \u80FD\u51FA\u73B0\u7684\u4EFB\u610F\u4F4D\u7F6E\u3002\u5982 ",(0,i.jsx)(n.code,{children:"CTE"})," \u7684 ",(0,i.jsx)(n.code,{children:"WITH"})," \u5B50\u53E5\u4E2D\uFF0C",(0,i.jsx)(n.code,{children:"FROM"})," \u5B50\u53E5\u4E2D\u7B49\u7B49\u3002\u8FD9\u6837\uFF0C\u60A8\u53EF\u4EE5\u628A\u6587\u4EF6\u5F53\u505A\u4E00\u5F20\u666E\u901A\u7684\u8868\u8FDB\u884C\u4EFB\u610F\u5206\u6790\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:["\u60A8\u4E5F\u53EF\u4EE5\u7528\u8FC7 ",(0,i.jsx)(n.code,{children:"CREATE VIEW"})," \u8BED\u53E5\u4E3A TVF \u521B\u5EFA\u4E00\u4E2A\u903B\u8F91\u89C6\u56FE\u3002\u4E4B\u540E\uFF0C\u53EF\u4EE5\u50CF\u5176\u4ED6\u89C6\u56FE\u4E00\u6837\uFF0C\u5BF9\u8FD9\u4E2A TVF \u8FDB\u884C\u8BBF\u95EE\u3001\u6743\u9650\u7BA1\u7406\u7B49\u64CD\u4F5C\uFF0C\u4E5F\u53EF\u4EE5\u8BA9\u5176\u4ED6\u7528\u6237\u8BBF\u95EE\u8FD9\u4E2A View\uFF0C\u800C\u65E0\u9700\u91CD\u590D\u4E66\u5199\u8FDE\u63A5\u4FE1\u606F\u7B49\u5C5E\u6027\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"-- Create a view based on a TVF\nCREATE VIEW tvf_view AS \nSELECT * FROM s3(\n    'uri' = 's3://bucket/path/to/tvf_test/test.parquet',\n    'format' = 'parquet',\n    's3.endpoint' = 'https://s3.us-east-1.amazonaws.com',\n    's3.region' = 'us-east-1',\n    's3.access_key' = 'ak',\n    's3.secret_key'='sk'\n);\n\n-- Describe the view as usual\nDESC tvf_view;\n\n-- Query the view as usual\nSELECT * FROM tvf_view;\n\n-- Grant SELECT priv to other user on this view\nGRANT SELECT_PRIV ON db.tvf_view TO other_user;\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u6570\u636E\u5BFC\u5165",children:"\u6570\u636E\u5BFC\u5165"}),"\n",(0,i.jsxs)(n.p,{children:["TVF \u53EF\u4EE5\u4F5C\u4E3A Doris \u6570\u636E\u5BFC\u5165\u65B9\u5F0F\u7684\u4E00\u79CD\u3002\u914D\u5408 ",(0,i.jsx)(n.code,{children:"INSERT INTO SELECT"})," \u8BED\u6CD5\uFF0C\u6211\u4EEC\u53EF\u4EE5\u5F88\u65B9\u4FBF\u7684\u5C06\u6587\u4EF6\u5BFC\u5165\u5230 Doris \u4E2D\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"-- Create a Doris table\nCREATE TABLE IF NOT EXISTS test_table\n(\n    id int,\n    name varchar(50),\n    age int\n)\nDISTRIBUTED BY HASH(id) BUCKETS 4\nPROPERTIES(\"replication_num\" = \"1\");\n\n-- 2. Load data into table from TVF\nINSERT INTO test_table (id,name,age)\nSELECT cast(id as INT) as id, name, cast (age as INT) as age\nFROM s3(\n    'uri' = 's3://bucket/path/to/tvf_test/test.parquet',\n    'format' = 'parquet',\n    's3.endpoint' = 'https://s3.us-east-1.amazonaws.com',\n    's3.region' = 'us-east-1',\n    's3.access_key' = 'ak',\n    's3.secret_key'='sk'\n);\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u6CE8\u610F\u4E8B\u9879",children:"\u6CE8\u610F\u4E8B\u9879"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["\u5982\u679C\u6307\u5B9A\u7684 ",(0,i.jsx)(n.code,{children:"uri"})," \u5339\u914D\u4E0D\u5230\u6587\u4EF6\uFF0C\u6216\u8005\u5339\u914D\u5230\u7684\u6240\u6709\u6587\u4EF6\u90FD\u662F\u7A7A\u6587\u4EF6\uFF0C\u90A3\u4E48 TVF \u5C06\u4F1A\u8FD4\u56DE\u7A7A\u7ED3\u679C\u96C6\u3002\u5728\u8FD9\u79CD\u60C5\u51B5\u4E0B\u4F7F\u7528",(0,i.jsx)(n.code,{children:"DESC FUNCTION"}),"\u67E5\u770B\u8FD9\u4E2A TVF \u7684 Schema\uFF0C\u4F1A\u5F97\u5230\u4E00\u5217\u865A\u62DF\u7684\u5217",(0,i.jsx)(n.code,{children:"__dummy_col"}),"\uFF0C\u8BE5\u5217\u65E0\u610F\u4E49\uFF0C\u4EC5\u4F5C\u4E3A\u5360\u4F4D\u7B26\u4F7F\u7528\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["\u5982\u679C\u6307\u5B9A\u7684\u6587\u4EF6\u683C\u5F0F\u4E3A ",(0,i.jsx)(n.code,{children:"csv"}),"\uFF0C\u6240\u8BFB\u6587\u4EF6\u4E0D\u4E3A\u7A7A\u6587\u4EF6\u4F46\u6587\u4EF6\u7B2C\u4E00\u884C\u4E3A\u7A7A\uFF0C\u5219\u4F1A\u63D0\u793A\u9519\u8BEF",(0,i.jsx)(n.code,{children:"The first line is empty, can not parse column numbers"}),"\uFF0C\u8FD9\u662F\u56E0\u4E3A\u65E0\u6CD5\u901A\u8FC7\u8BE5\u6587\u4EF6\u7684\u7B2C\u4E00\u884C\u89E3\u6790\u51FA Schema\u3002"]}),"\n"]}),"\n"]})]})}function o(e={}){let{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},250065:function(e,n,s){s.d(n,{Z:function(){return t},a:function(){return c}});var l=s(667294);let i={},r=l.createContext(i);function c(e){let n=l.useContext(r);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),l.createElement(r.Provider,{value:n},e.children)}}}]);