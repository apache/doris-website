"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["719639"],{652237:function(e,n,i){i.r(n),i.d(n,{default:()=>g,frontMatter:()=>t,metadata:()=>r,assets:()=>c,toc:()=>l,contentTitle:()=>o});var r=JSON.parse('{"id":"lakehouse/best-practices/doris-gravitino","title":"\u96C6\u6210 Apache Gravitino","description":"\u968F\u7740\u6570\u636E\u6E56\u6280\u672F\u7684\u5FEB\u901F\u53D1\u5C55\uFF0C\u5982\u4F55\u6784\u5EFA\u7EDF\u4E00\u3001\u5B89\u5168\u3001\u9AD8\u6548\u7684\u6E56\u4ED3\u4E00\u4F53\u5316\u6570\u636E\u67B6\u6784\u6210\u4E3A\u4F01\u4E1A\u6570\u5B57\u5316\u8F6C\u578B\u7684\u6838\u5FC3\u6311\u6218\u3002Apache Gravitino \u4F5C\u4E3A\u65B0\u4E00\u4EE3\u7EDF\u4E00\u5143\u6570\u636E\u7BA1\u7406\u5E73\u53F0\uFF0C\u4E3A\u591A\u4E91\u3001\u591A\u5F15\u64CE\u73AF\u5883\u4E0B\u7684\u6570\u636E\u6CBB\u7406\u63D0\u4F9B\u4E86\u5B8C\u6574\u7684\u89E3\u51B3\u65B9\u6848\u3002\u5B83\u4E0D\u4EC5\u652F\u6301\u591A\u79CD\u6570\u636E\u6E90\u548C\u8BA1\u7B97\u5F15\u64CE\u7684\u7EDF\u4E00\u7BA1\u7406\uFF0C","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs/current/lakehouse/best-practices/doris-gravitino.md","sourceDirName":"lakehouse/best-practices","slug":"/lakehouse/best-practices/doris-gravitino","permalink":"/zh-CN/docs/dev/lakehouse/best-practices/doris-gravitino","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1770477659000,"frontMatter":{"title":"\u96C6\u6210 Apache Gravitino","language":"zh-CN","description":"\u968F\u7740\u6570\u636E\u6E56\u6280\u672F\u7684\u5FEB\u901F\u53D1\u5C55\uFF0C\u5982\u4F55\u6784\u5EFA\u7EDF\u4E00\u3001\u5B89\u5168\u3001\u9AD8\u6548\u7684\u6E56\u4ED3\u4E00\u4F53\u5316\u6570\u636E\u67B6\u6784\u6210\u4E3A\u4F01\u4E1A\u6570\u5B57\u5316\u8F6C\u578B\u7684\u6838\u5FC3\u6311\u6218\u3002Apache Gravitino \u4F5C\u4E3A\u65B0\u4E00\u4EE3\u7EDF\u4E00\u5143\u6570\u636E\u7BA1\u7406\u5E73\u53F0\uFF0C\u4E3A\u591A\u4E91\u3001\u591A\u5F15\u64CE\u73AF\u5883\u4E0B\u7684\u6570\u636E\u6CBB\u7406\u63D0\u4F9B\u4E86\u5B8C\u6574\u7684\u89E3\u51B3\u65B9\u6848\u3002\u5B83\u4E0D\u4EC5\u652F\u6301\u591A\u79CD\u6570\u636E\u6E90\u548C\u8BA1\u7B97\u5F15\u64CE\u7684\u7EDF\u4E00\u7BA1\u7406\uFF0C"},"sidebar":"docs","previous":{"title":"\u96C6\u6210 Apache Polaris","permalink":"/zh-CN/docs/dev/lakehouse/best-practices/doris-polaris"},"next":{"title":"\u96C6\u6210 Microsoft OneLake","permalink":"/zh-CN/docs/dev/lakehouse/best-practices/doris-onelake"}}'),a=i("785893"),s=i("250065");let t={title:"\u96C6\u6210 Apache Gravitino",language:"zh-CN",description:"\u968F\u7740\u6570\u636E\u6E56\u6280\u672F\u7684\u5FEB\u901F\u53D1\u5C55\uFF0C\u5982\u4F55\u6784\u5EFA\u7EDF\u4E00\u3001\u5B89\u5168\u3001\u9AD8\u6548\u7684\u6E56\u4ED3\u4E00\u4F53\u5316\u6570\u636E\u67B6\u6784\u6210\u4E3A\u4F01\u4E1A\u6570\u5B57\u5316\u8F6C\u578B\u7684\u6838\u5FC3\u6311\u6218\u3002Apache Gravitino \u4F5C\u4E3A\u65B0\u4E00\u4EE3\u7EDF\u4E00\u5143\u6570\u636E\u7BA1\u7406\u5E73\u53F0\uFF0C\u4E3A\u591A\u4E91\u3001\u591A\u5F15\u64CE\u73AF\u5883\u4E0B\u7684\u6570\u636E\u6CBB\u7406\u63D0\u4F9B\u4E86\u5B8C\u6574\u7684\u89E3\u51B3\u65B9\u6848\u3002\u5B83\u4E0D\u4EC5\u652F\u6301\u591A\u79CD\u6570\u636E\u6E90\u548C\u8BA1\u7B97\u5F15\u64CE\u7684\u7EDF\u4E00\u7BA1\u7406\uFF0C"},o=void 0,c={},l=[{value:"Hands-on Guide",id:"hands-on-guide",level:2},{value:"1. AWS \u73AF\u5883\u51C6\u5907",id:"1-aws-\u73AF\u5883\u51C6\u5907",level:3},{value:"1.1 \u521B\u5EFA S3 \u5B58\u50A8\u6876",id:"11-\u521B\u5EFA-s3-\u5B58\u50A8\u6876",level:3},{value:"1.2 \u8BBE\u8BA1 IAM \u89D2\u8272\u67B6\u6784",id:"12-\u8BBE\u8BA1-iam-\u89D2\u8272\u67B6\u6784",level:3},{value:"2. Gravitino \u90E8\u7F72\u4E0E\u914D\u7F6E",id:"2-gravitino-\u90E8\u7F72\u4E0E\u914D\u7F6E",level:2},{value:"2.1 \u4E0B\u8F7D\u548C\u5B89\u88C5 Gravitino",id:"21-\u4E0B\u8F7D\u548C\u5B89\u88C5-gravitino",level:3},{value:"2.2 \u5B89\u88C5\u5FC5\u8981\u7684\u4F9D\u8D56\u7EC4\u4EF6",id:"22-\u5B89\u88C5\u5FC5\u8981\u7684\u4F9D\u8D56\u7EC4\u4EF6",level:3},{value:"2.3 \u914D\u7F6E Gravitino \u670D\u52A1",id:"23-\u914D\u7F6E-gravitino-\u670D\u52A1",level:3},{value:"2.4 \u521B\u5EFA Gravitino \u5143\u6570\u636E\u7ED3\u6784",id:"24-\u521B\u5EFA-gravitino-\u5143\u6570\u636E\u7ED3\u6784",level:3},{value:"3. Doris \u8FDE\u63A5 Gravitino",id:"3-doris-\u8FDE\u63A5-gravitino",level:2},{value:"3.1 \u4F7F\u7528 Vended Credentials",id:"31-\u4F7F\u7528-vended-credentials",level:3},{value:"3.2 \u9A8C\u8BC1\u8FDE\u63A5\u548C\u6570\u636E\u64CD\u4F5C",id:"32-\u9A8C\u8BC1\u8FDE\u63A5\u548C\u6570\u636E\u64CD\u4F5C",level:3},{value:"\u603B\u7ED3",id:"\u603B\u7ED3",level:2}];function d(e){let n={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.p,{children:"\u968F\u7740\u6570\u636E\u6E56\u6280\u672F\u7684\u5FEB\u901F\u53D1\u5C55\uFF0C\u5982\u4F55\u6784\u5EFA\u7EDF\u4E00\u3001\u5B89\u5168\u3001\u9AD8\u6548\u7684\u6E56\u4ED3\u4E00\u4F53\u5316\u6570\u636E\u67B6\u6784\u6210\u4E3A\u4F01\u4E1A\u6570\u5B57\u5316\u8F6C\u578B\u7684\u6838\u5FC3\u6311\u6218\u3002Apache Gravitino \u4F5C\u4E3A\u65B0\u4E00\u4EE3\u7EDF\u4E00\u5143\u6570\u636E\u7BA1\u7406\u5E73\u53F0\uFF0C\u4E3A\u591A\u4E91\u3001\u591A\u5F15\u64CE\u73AF\u5883\u4E0B\u7684\u6570\u636E\u6CBB\u7406\u63D0\u4F9B\u4E86\u5B8C\u6574\u7684\u89E3\u51B3\u65B9\u6848\u3002\u5B83\u4E0D\u4EC5\u652F\u6301\u591A\u79CD\u6570\u636E\u6E90\u548C\u8BA1\u7B97\u5F15\u64CE\u7684\u7EDF\u4E00\u7BA1\u7406\uFF0C\u8FD8\u901A\u8FC7\u51ED\u8BC1\u7BA1\u7406\u673A\u5236\uFF08Credential Vending\uFF09\u786E\u4FDD\u4E86\u6570\u636E\u8BBF\u95EE\u7684\u5B89\u5168\u6027\u548C\u53EF\u63A7\u6027\u3002"}),"\n",(0,a.jsx)(n.p,{children:"\u672C\u6587\u5C06\u6DF1\u5165\u4ECB\u7ECD\u5982\u4F55\u5C06 Apache Doris \u4E0E Apache Gravitino \u8FDB\u884C\u6DF1\u5EA6\u96C6\u6210\uFF0C\u6784\u5EFA\u57FA\u4E8E Iceberg REST Catalog \u7684\u73B0\u4EE3\u5316\u6E56\u4ED3\u67B6\u6784\u3002\u901A\u8FC7 Gravitino \u7684\u7EDF\u4E00\u5143\u6570\u636E\u7BA1\u7406\u548C\u52A8\u6001\u51ED\u8BC1\u5206\u53D1\u80FD\u529B\uFF0C\u5B9E\u73B0\u5BF9 S3 \u4E0A Iceberg \u6570\u636E\u7684\u9AD8\u6548\u3001\u5B89\u5168\u8BBF\u95EE\u3002"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"\u901A\u8FC7\u672C\u6587\u6863\uFF0C\u4F60\u5C06\u53EF\u4EE5\u5FEB\u901F\u4E86\u89E3\uFF1A"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"AWS \u73AF\u5883\u51C6\u5907"}),"\uFF1A\u5982\u4F55\u5728 AWS \u4E2D\u521B\u5EFA S3 \u5B58\u50A8\u6876\u548C IAM \u89D2\u8272\uFF0C\u4E3A Gravitino \u914D\u7F6E\u5B89\u5168\u7684\u51ED\u8BC1\u7BA1\u7406\u4F53\u7CFB\uFF0C\u5B9E\u73B0\u4E34\u65F6\u51ED\u8BC1\u7684\u52A8\u6001\u5206\u53D1\u673A\u5236\u3002"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Gravitino \u90E8\u7F72\u4E0E\u914D\u7F6E"}),"\uFF1A\u5982\u4F55\u5FEB\u901F\u90E8\u7F72 Gravitino \u670D\u52A1\uFF0C\u914D\u7F6E Iceberg REST Catalog\uFF0C\u5E76\u542F\u7528 vended-credentials \u529F\u80FD\u3002"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Doris \u8FDE\u63A5 Gravitino"}),"\uFF1A\u8BE6\u7EC6\u8BF4\u660E Doris \u5982\u4F55\u901A\u8FC7 Gravitino \u7684 REST API \u8BBF\u95EE Iceberg \u6570\u636E\u3002"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"hands-on-guide",children:"Hands-on Guide"}),"\n",(0,a.jsx)(n.h3,{id:"1-aws-\u73AF\u5883\u51C6\u5907",children:"1. AWS \u73AF\u5883\u51C6\u5907"}),"\n",(0,a.jsx)(n.p,{children:"\u5728\u5F00\u59CB\u4E4B\u524D\uFF0C\u6211\u4EEC\u9700\u8981\u5728 AWS \u4E0A\u51C6\u5907\u597D\u5B8C\u6574\u7684\u57FA\u7840\u8BBE\u65BD\uFF0C\u5305\u62EC S3 \u5B58\u50A8\u6876\u548C\u7CBE\u5FC3\u8BBE\u8BA1\u7684 IAM \u89D2\u8272\u4F53\u7CFB\uFF0C\u8FD9\u662F\u6784\u5EFA\u5B89\u5168\u53EF\u9760\u7684\u6E56\u4ED3\u67B6\u6784\u7684\u57FA\u77F3\u3002"}),"\n",(0,a.jsx)(n.h3,{id:"11-\u521B\u5EFA-s3-\u5B58\u50A8\u6876",children:"1.1 \u521B\u5EFA S3 \u5B58\u50A8\u6876"}),"\n",(0,a.jsx)(n.p,{children:"\u9996\u5148\u521B\u5EFA\u4E00\u4E2A\u4E13\u7528\u7684 S3 \u5B58\u50A8\u6876\u6765\u5B58\u653E Iceberg \u6570\u636E\uFF1A"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# \u521B\u5EFA S3 \u5B58\u50A8\u6876\naws s3 mb s3://gravitino-iceberg-demo --region us-west-2\n# \u9A8C\u8BC1\u5B58\u50A8\u6876\u521B\u5EFA\u6210\u529F\naws s3 ls | grep gravitino-iceberg-demo\n"})}),"\n",(0,a.jsx)(n.h3,{id:"12-\u8BBE\u8BA1-iam-\u89D2\u8272\u67B6\u6784",children:"1.2 \u8BBE\u8BA1 IAM \u89D2\u8272\u67B6\u6784"}),"\n",(0,a.jsx)(n.p,{children:"\u4E3A\u4E86\u5B9E\u73B0\u5B89\u5168\u7684\u51ED\u8BC1\u7BA1\u7406\uFF0C\u6211\u4EEC\u9700\u8981\u521B\u5EFA\u4E00\u4E2A IAM \u89D2\u8272\u4F9B Gravitino \u901A\u8FC7 STS AssumeRole \u673A\u5236\u4F7F\u7528\u3002\u8FD9\u4E2A\u8BBE\u8BA1\u9075\u5FAA\u4E86\u6700\u5C0F\u6743\u9650\u539F\u5219\u548C\u804C\u8D23\u5206\u79BB\u7684\u5B89\u5168\u6700\u4F73\u5B9E\u8DF5\u3002"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"\u521B\u5EFA\u6570\u636E\u8BBF\u95EE\u89D2\u8272"})}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"\u521B\u5EFA\u4FE1\u4EFB\u7B56\u7565\u6587\u4EF6"}),"\n",(0,a.jsxs)(n.p,{children:["\u521B\u5EFA ",(0,a.jsx)(n.code,{children:"gravitino-trust-policy.json"})," \u6587\u4EF6\uFF1A"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n    "Version": "2012-10-17",\n    "Statement": [\n        {\n            "Effect": "Allow",\n            "Principal": {\n                "AWS": [\n                    "arn:aws:iam::YOUR_ACCOUNT_ID:root"\n                ]\n            },\n            "Action": "sts:AssumeRole"\n        }\n    ]\n}\n'})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"\u521B\u5EFA IAM \u89D2\u8272"}),"\n",(0,a.jsx)(n.p,{children:"\u4E3A\u7B80\u5316\u6F14\u793A\uFF0C\u6211\u4EEC\u76F4\u63A5\u4F7F\u7528 AWS \u7BA1\u7406\u7B56\u7565\u3002\u751F\u4EA7\u73AF\u5883\u5EFA\u8BAE\u521B\u5EFA\u66F4\u7CBE\u7EC6\u7684\u6743\u9650\u63A7\u5236\u3002"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'# \u521B\u5EFA IAM \u89D2\u8272\naws iam create-role \\\n    --role-name gravitino-iceberg-access \\\n    --assume-role-policy-document file://gravitino-trust-policy.json \\\n    --description "Gravitino Iceberg data access role"\n\n# \u9644\u52A0 S3 \u5B8C\u6574\u8BBF\u95EE\u6743\u9650\uFF08\u6D4B\u8BD5\u7528\uFF0C\u751F\u4EA7\u73AF\u5883\u8BF7\u4F7F\u7528\u7CBE\u7EC6\u5316\u6743\u9650\uFF09\naws iam attach-role-policy \\\n    --role-name gravitino-iceberg-access \\\n    --policy-arn arn:aws:iam::aws:policy/AmazonS3FullAccess\n'})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"\u9A8C\u8BC1 IAM \u914D\u7F6E"}),"\n",(0,a.jsx)(n.p,{children:"\u9A8C\u8BC1\u89D2\u8272\u914D\u7F6E\u662F\u5426\u6B63\u786E\uFF1A"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# \u6D4B\u8BD5\u89D2\u8272\u627F\u62C5\u529F\u80FD\naws sts assume-role \\\n    --role-arn arn:aws:iam::YOUR_ACCOUNT_ID:role/gravitino-iceberg-access \\\n    --role-session-name gravitino-test\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u6210\u529F\u54CD\u5E94\u793A\u4F8B\uFF1A"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n    "Credentials": {\n        "AccessKeyId": "ASIA***************",\n        "SecretAccessKey": "***************************",\n        "SessionToken": "IQoJb3JpZ2luX2VjEOj...",\n        "Expiration": "2025-07-23T08:33:30+00:00"\n    }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"2-gravitino-\u90E8\u7F72\u4E0E\u914D\u7F6E",children:"2. Gravitino \u90E8\u7F72\u4E0E\u914D\u7F6E"}),"\n",(0,a.jsx)(n.h3,{id:"21-\u4E0B\u8F7D\u548C\u5B89\u88C5-gravitino",children:"2.1 \u4E0B\u8F7D\u548C\u5B89\u88C5 Gravitino"}),"\n",(0,a.jsx)(n.p,{children:"\u6211\u4EEC\u4F7F\u7528 Gravitino \u7684\u9884\u7F16\u8BD1\u7248\u672C\u6765\u5FEB\u901F\u642D\u5EFA\u73AF\u5883\uFF1A"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# \u521B\u5EFA\u5DE5\u4F5C\u76EE\u5F55\nmkdir gravitino-deployment && cd gravitino-deployment\n\n# \u4E0B\u8F7D Gravitino \u4E3B\u7A0B\u5E8F\nwget https://github.com/apache/gravitino/releases/download/v0.9.1/gravitino-0.9.1-bin.tar.gz\n\n# \u4E0B\u8F7D Iceberg REST \u670D\u52A1\u5668\u7EC4\u4EF6\nwget https://github.com/apache/gravitino/releases/download/v0.9.1/gravitino-iceberg-rest-server-0.9.1-bin.tar.gz\n\n# \u89E3\u538B\u5B89\u88C5\ntar -xzf gravitino-0.9.1-bin.tar.gz\ncd gravitino-0.9.1-bin\ntar -xzf ../gravitino-iceberg-rest-server-0.9.1-bin.tar.gz --strip-components=1\n"})}),"\n",(0,a.jsx)(n.h3,{id:"22-\u5B89\u88C5\u5FC5\u8981\u7684\u4F9D\u8D56\u7EC4\u4EF6",children:"2.2 \u5B89\u88C5\u5FC5\u8981\u7684\u4F9D\u8D56\u7EC4\u4EF6"}),"\n",(0,a.jsx)(n.p,{children:"\u4E3A\u4E86\u652F\u6301 AWS S3 \u548C\u51ED\u8BC1\u7BA1\u7406\u529F\u80FD\uFF0C\u9700\u8981\u5B89\u88C5\u989D\u5916\u7684 JAR \u5305\uFF1A"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# \u521B\u5EFA\u5FC5\u8981\u7684\u76EE\u5F55\u7ED3\u6784\nmkdir -p catalogs/lakehouse-iceberg/libs\nmkdir -p iceberg-rest-server/libs\nmkdir -p logs\nmkdir -p /tmp/gravitino\n\n# \u4E0B\u8F7D Iceberg AWS bundle\nwget https://repo1.maven.org/maven2/org/apache/iceberg/iceberg-aws-bundle/1.6.1/iceberg-aws-bundle-1.6.1.jar \\\n  -P catalogs/lakehouse-iceberg/libs/\n\n# \u4E0B\u8F7D Gravitino AWS \u652F\u6301\u5305\uFF08vended-credentials \u529F\u80FD\u6838\u5FC3\uFF09\nwget https://repo1.maven.org/maven2/org/apache/gravitino/gravitino-aws/0.9.1/gravitino-aws-0.9.1.jar \\\n  -P iceberg-rest-server/libs/\n\n# \u5206\u53D1 JAR \u5305\u5230\u5404\u4E2A\u76EE\u5F55\ncp catalogs/lakehouse-iceberg/libs/iceberg-aws-bundle-1.6.1.jar iceberg-rest-server/libs/\ncp catalogs/lakehouse-iceberg/libs/iceberg-aws-bundle-1.6.1.jar libs/\ncp iceberg-rest-server/libs/gravitino-aws-0.9.1.jar libs/\n"})}),"\n",(0,a.jsx)(n.h3,{id:"23-\u914D\u7F6E-gravitino-\u670D\u52A1",children:"2.3 \u914D\u7F6E Gravitino \u670D\u52A1"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"\u4E3B\u670D\u52A1\u914D\u7F6E"}),"\n",(0,a.jsxs)(n.p,{children:["\u521B\u5EFA\u6216\u7F16\u8F91 ",(0,a.jsx)(n.code,{children:"conf/gravitino.conf"})," \u6587\u4EF6\uFF1A"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-properties",children:"# Gravitino \u670D\u52A1\u5668\u57FA\u7840\u914D\u7F6E\ngravitino.server.webserver.host = 0.0.0.0\ngravitino.server.webserver.httpPort = 8090\n\n# \u5143\u6570\u636E\u5B58\u50A8\u914D\u7F6E\uFF08\u751F\u4EA7\u73AF\u5883\u5EFA\u8BAE\u4F7F\u7528 PostgreSQL/MySQL\uFF09\ngravitino.entity.store = relational\ngravitino.entity.store.relational = JDBCBackend\ngravitino.entity.store.relational.jdbcUrl = jdbc:h2:file:/tmp/gravitino/gravitino.db;DB_CLOSE_DELAY=-1;MODE=MYSQL\ngravitino.entity.store.relational.jdbcDriver = org.h2.Driver\ngravitino.entity.store.relational.jdbcUser = gravitino\ngravitino.entity.store.relational.jdbcPassword = gravitino\n\n# \u542F\u7528 Iceberg REST \u670D\u52A1\ngravitino.auxService.names = iceberg-rest\n\n# Iceberg REST \u670D\u52A1\u8BE6\u7EC6\u914D\u7F6E\ngravitino.iceberg-rest.classpath = iceberg-rest-server/libs, iceberg-rest-server/conf\ngravitino.iceberg-rest.host = 0.0.0.0\ngravitino.iceberg-rest.httpPort = 9001\n\n# Iceberg catalog \u540E\u7AEF\u914D\u7F6E\ngravitino.iceberg-rest.catalog-backend = jdbc\ngravitino.iceberg-rest.uri = jdbc:h2:file:/tmp/gravitino/catalog_iceberg.db;DB_CLOSE_DELAY=-1;MODE=MYSQL\ngravitino.iceberg-rest.jdbc-driver = org.h2.Driver\ngravitino.iceberg-rest.jdbc-user = iceberg\ngravitino.iceberg-rest.jdbc-password = iceberg123\ngravitino.iceberg-rest.jdbc-initialize = true\ngravitino.iceberg-rest.warehouse = s3://gravitino-iceberg-demo/warehouse\ngravitino.iceberg-rest.io-impl = org.apache.iceberg.aws.s3.S3FileIO\ngravitino.iceberg-rest.s3-region = us-west-2\n\n# \u542F\u7528 Vended-Credentials \u529F\u80FD\n# \u8BF4\u660E\uFF1AGravitino \u4F7F\u7528\u8FD9\u4E9B AK/SK \u8C03\u7528 STS AssumeRole\uFF0C\u83B7\u53D6\u4E34\u65F6\u51ED\u8BC1\u5206\u53D1\u7ED9\u5BA2\u6237\u7AEF\ngravitino.iceberg-rest.credential-providers = s3-token\ngravitino.iceberg-rest.s3-access-key-id = YOUR_AWS_ACCESS_KEY_ID\ngravitino.iceberg-rest.s3-secret-access-key = YOUR_AWS_SECRET_ACCESS_KEY\ngravitino.iceberg-rest.s3-role-arn = arn:aws:iam::YOUR_ACCOUNT_ID:role/gravitino-iceberg-access\ngravitino.iceberg-rest.s3-region = us-west-2\ngravitino.iceberg-rest.s3-token-expire-in-secs = 3600\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"\u542F\u52A8\u670D\u52A1"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# \u542F\u52A8 Gravitino \u670D\u52A1\n./bin/gravitino.sh start\n\n# \u68C0\u67E5\u670D\u52A1\u72B6\u6001\n./bin/gravitino.sh status\n\n# \u67E5\u770B\u65E5\u5FD7\ntail -f logs/gravitino-server.log\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"\u9A8C\u8BC1\u670D\u52A1\u72B6\u6001"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# \u9A8C\u8BC1\u4E3B\u670D\u52A1\ncurl -v http://localhost:8090/api/version\n\n# \u9A8C\u8BC1 Iceberg REST \u670D\u52A1\ncurl -v http://localhost:9001/iceberg/v1/config\n"})}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"24-\u521B\u5EFA-gravitino-\u5143\u6570\u636E\u7ED3\u6784",children:"2.4 \u521B\u5EFA Gravitino \u5143\u6570\u636E\u7ED3\u6784"}),"\n",(0,a.jsx)(n.p,{children:"\u901A\u8FC7 REST API \u521B\u5EFA\u5FC5\u8981\u7684\u5143\u6570\u636E\u7ED3\u6784\uFF1A"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'# \u521B\u5EFA MetaLake\ncurl -X POST -H "Accept: application/vnd.gravitino.v1+json" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "name": "lakehouse",\n    "comment": "Gravitino lakehouse for Doris integration",\n    "properties": {}\n  }\' http://localhost:8090/api/metalakes\n\n# \u521B\u5EFA Iceberg Catalog\ncurl -X POST -H "Accept: application/vnd.gravitino.v1+json" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "name": "iceberg_catalog",\n    "type": "RELATIONAL",\n    "provider": "lakehouse-iceberg",\n    "comment": "Iceberg catalog with S3 storage and vended credentials",\n    "properties": {\n      "catalog-backend": "jdbc",\n      "uri": "jdbc:h2:file:/tmp/gravitino/catalog_iceberg.db;DB_CLOSE_DELAY=-1;MODE=MYSQL",\n      "jdbc-user": "iceberg",\n      "jdbc-password": "iceberg123",\n      "jdbc-driver": "org.h2.Driver",\n      "jdbc-initialize": "true",\n      "warehouse": "s3://gravitino-iceberg-demo/warehouse",\n      "io-impl": "org.apache.iceberg.aws.s3.S3FileIO",\n      "s3-region": "us-west-2"\n    }\n  }\' http://localhost:8090/api/metalakes/lakehouse/catalogs\n'})}),"\n",(0,a.jsx)(n.h2,{id:"3-doris-\u8FDE\u63A5-gravitino",children:"3. Doris \u8FDE\u63A5 Gravitino"}),"\n",(0,a.jsx)(n.h3,{id:"31-\u4F7F\u7528-vended-credentials",children:"3.1 \u4F7F\u7528 Vended Credentials"}),"\n",(0,a.jsx)(n.p,{children:"Gravitino \u4F1A\u52A8\u6001\u751F\u6210\u4E34\u65F6\u51ED\u8BC1\u5E76\u5206\u53D1\u7ED9 Doris\uFF1A"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"-- \u521B\u5EFA\u52A8\u6001\u51ED\u8BC1\u6A21\u5F0F\u7684 Catalog\nCREATE CATALOG gravitino_vending PROPERTIES (\n    'type' = 'iceberg',\n    'warehouse' = 'warehouse',\n    'iceberg.catalog.type' = 'rest',\n    'iceberg.rest.uri' = 'http://127.0.0.1:9001/iceberg/',\n    'iceberg.rest.vended-credentials-enabled' = 'true'\n);\n"})}),"\n",(0,a.jsx)(n.h3,{id:"32-\u9A8C\u8BC1\u8FDE\u63A5\u548C\u6570\u636E\u64CD\u4F5C",children:"3.2 \u9A8C\u8BC1\u8FDE\u63A5\u548C\u6570\u636E\u64CD\u4F5C"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"-- \u9A8C\u8BC1\u8FDE\u63A5\nSHOW DATABASES FROM gravitino_vending;\n\n-- \u5207\u6362\u5230 vended credentials catalog\nSWITCH gravitino_vending;\n\n-- \u521B\u5EFA\u6570\u636E\u5E93\u548C\u8868\nCREATE DATABASE demo;\nUSE gravitino_vending.demo;\n\nCREATE TABLE gravitino_table (\n    id INT,\n    name STRING\n)\nPROPERTIES (\n    'write-format' = 'parquet'\n);\n\n-- \u63D2\u5165\u6D4B\u8BD5\u6570\u636E\nINSERT INTO gravitino_table VALUES (1, 'Doris'), (2, 'Gravitino');\n\n-- \u67E5\u8BE2\u9A8C\u8BC1\nSELECT * FROM gravitino_table;\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u603B\u7ED3",children:"\u603B\u7ED3"}),"\n",(0,a.jsx)(n.p,{children:"\u901A\u8FC7\u672C\u6307\u5357\uFF0C\u4F60\u5E94\u8BE5\u80FD\u591F\u6210\u529F\u6784\u5EFA\u4E00\u4E2A\u57FA\u4E8E Gravitino \u548C Doris \u7684\u73B0\u4EE3\u5316\u6E56\u4ED3\u67B6\u6784\u3002\u8FD9\u4E2A\u67B6\u6784\u4E0D\u4EC5\u5177\u5907\u9AD8\u6027\u80FD\u548C\u9AD8\u53EF\u7528\u6027\uFF0C\u8FD8\u901A\u8FC7\u5148\u8FDB\u7684\u5B89\u5168\u673A\u5236\u786E\u4FDD\u4E86\u6570\u636E\u8BBF\u95EE\u7684\u5B89\u5168\u6027\u548C\u5408\u89C4\u6027\u3002\u968F\u7740\u6570\u636E\u89C4\u6A21\u7684\u589E\u957F\u548C\u4E1A\u52A1\u9700\u6C42\u7684\u53D8\u5316\uFF0C\u8FD9\u4E2A\u67B6\u6784\u53EF\u4EE5\u7075\u6D3B\u6269\u5C55\u4EE5\u6EE1\u8DB3\u4F01\u4E1A\u7EA7\u7684\u5404\u79CD\u9700\u6C42\u3002"})]})}function g(e={}){let{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},250065:function(e,n,i){i.d(n,{Z:function(){return o},a:function(){return t}});var r=i(667294);let a={},s=r.createContext(a);function t(e){let n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:t(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);