"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["887459"],{634115:function(n,e,r){r.r(e),r.d(e,{default:()=>h,frontMatter:()=>d,metadata:()=>l,assets:()=>t,toc:()=>c,contentTitle:()=>o});var l=JSON.parse('{"id":"query-acceleration/materialized-view/async-materialized-view/functions-and-demands","title":"\u521B\u5EFA\u3001\u67E5\u8BE2\u4E0E\u7EF4\u62A4\u5F02\u6B65\u7269\u5316\u89C6\u56FE","description":"\u672C\u6587\u5C06\u8BE6\u7EC6\u8BF4\u660E\u7269\u5316\u89C6\u56FE\u521B\u5EFA\u3001\u7269\u5316\u89C6\u56FE\u76F4\u67E5\u3001\u67E5\u8BE2\u6539\u5199\u548C\u7269\u5316\u89C6\u56FE\u5E38\u89C1\u8FD0\u7EF4\u3002","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs/current/query-acceleration/materialized-view/async-materialized-view/functions-and-demands.md","sourceDirName":"query-acceleration/materialized-view/async-materialized-view","slug":"/query-acceleration/materialized-view/async-materialized-view/functions-and-demands","permalink":"/zh-CN/docs/dev/query-acceleration/materialized-view/async-materialized-view/functions-and-demands","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1770477659000,"frontMatter":{"title":"\u521B\u5EFA\u3001\u67E5\u8BE2\u4E0E\u7EF4\u62A4\u5F02\u6B65\u7269\u5316\u89C6\u56FE","language":"zh-CN","description":"\u672C\u6587\u5C06\u8BE6\u7EC6\u8BF4\u660E\u7269\u5316\u89C6\u56FE\u521B\u5EFA\u3001\u7269\u5316\u89C6\u56FE\u76F4\u67E5\u3001\u67E5\u8BE2\u6539\u5199\u548C\u7269\u5316\u89C6\u56FE\u5E38\u89C1\u8FD0\u7EF4\u3002"},"sidebar":"docs","previous":{"title":"\u5F02\u6B65\u7269\u5316\u89C6\u56FE\u6982\u8FF0","permalink":"/zh-CN/docs/dev/query-acceleration/materialized-view/async-materialized-view/overview"},"next":{"title":"\u6700\u4F73\u5B9E\u8DF5","permalink":"/zh-CN/docs/dev/query-acceleration/materialized-view/async-materialized-view/use-guide"}}'),i=r("785893"),s=r("250065");let d={title:"\u521B\u5EFA\u3001\u67E5\u8BE2\u4E0E\u7EF4\u62A4\u5F02\u6B65\u7269\u5316\u89C6\u56FE",language:"zh-CN",description:"\u672C\u6587\u5C06\u8BE6\u7EC6\u8BF4\u660E\u7269\u5316\u89C6\u56FE\u521B\u5EFA\u3001\u7269\u5316\u89C6\u56FE\u76F4\u67E5\u3001\u67E5\u8BE2\u6539\u5199\u548C\u7269\u5316\u89C6\u56FE\u5E38\u89C1\u8FD0\u7EF4\u3002"},o=void 0,t={},c=[{value:"\u7269\u5316\u89C6\u56FE\u521B\u5EFA",id:"\u7269\u5316\u89C6\u56FE\u521B\u5EFA",level:2},{value:"\u6743\u9650\u8BF4\u660E",id:"\u6743\u9650\u8BF4\u660E",level:3},{value:"\u521B\u5EFA\u8BED\u6CD5",id:"\u521B\u5EFA\u8BED\u6CD5",level:3},{value:"\u5237\u65B0\u914D\u7F6E",id:"\u5237\u65B0\u914D\u7F6E",level:3},{value:"build_mode \u5237\u65B0\u65F6\u673A",id:"build_mode-\u5237\u65B0\u65F6\u673A",level:4},{value:"refresh_method \u5237\u65B0\u65B9\u5F0F",id:"refresh_method-\u5237\u65B0\u65B9\u5F0F",level:4},{value:"refresh_trigger \u89E6\u53D1\u65B9\u5F0F",id:"refresh_trigger-\u89E6\u53D1\u65B9\u5F0F",level:4},{value:"\u793A\u4F8B\u5982\u4E0B",id:"\u793A\u4F8B\u5982\u4E0B",level:4},{value:"\u5237\u65B0\u673A\u5236\u793A\u4F8B\u4E00",id:"\u5237\u65B0\u673A\u5236\u793A\u4F8B\u4E00",level:4},{value:"\u5237\u65B0\u673A\u5236\u793A\u4F8B\u4E8C",id:"\u5237\u65B0\u673A\u5236\u793A\u4F8B\u4E8C",level:4},{value:"\u5237\u65B0\u673A\u5236\u793A\u4F8B\u4E09",id:"\u5237\u65B0\u673A\u5236\u793A\u4F8B\u4E09",level:4},{value:"\u5206\u533A\u914D\u7F6E",id:"\u5206\u533A\u914D\u7F6E",level:3},{value:"\u57FA\u8868\u6709\u591A\u5217\u5206\u533A",id:"\u57FA\u8868\u6709\u591A\u5217\u5206\u533A",level:4},{value:"\u4F7F\u7528\u57FA\u8868\u90E8\u5206\u5206\u533A",id:"\u4F7F\u7528\u57FA\u8868\u90E8\u5206\u5206\u533A",level:4},{value:"\u5206\u533A\u4E0A\u5377",id:"\u5206\u533A\u4E0A\u5377",level:4},{value:"\u5206\u533A\u591A\u7AEF\u5237\u65B0",id:"\u5206\u533A\u591A\u7AEF\u5237\u65B0",level:4},{value:"SQL \u5B9A\u4E49",id:"sql-\u5B9A\u4E49",level:3},{value:"\u76F4\u67E5\u7269\u5316\u89C6\u56FE",id:"\u76F4\u67E5\u7269\u5316\u89C6\u56FE",level:2},{value:"\u67E5\u8BE2\u900F\u660E\u6539\u5199",id:"\u67E5\u8BE2\u900F\u660E\u6539\u5199",level:2},{value:"\u6761\u4EF6\u8865\u507F",id:"\u6761\u4EF6\u8865\u507F",level:3},{value:"JOIN \u6539\u5199",id:"join-\u6539\u5199",level:3},{value:"JOIN \u884D\u751F",id:"join-\u884D\u751F",level:3},{value:"\u805A\u5408\u6539\u5199",id:"\u805A\u5408\u6539\u5199",level:3},{value:"\u805A\u5408\u6539\u5199\uFF08\u4E0A\u5377\uFF09",id:"\u805A\u5408\u6539\u5199\u4E0A\u5377",level:3},{value:"\u591A\u7EF4\u805A\u5408\u6539\u5199",id:"\u591A\u7EF4\u805A\u5408\u6539\u5199",level:3},{value:"\u5206\u533A\u8865\u507F\u6539\u5199",id:"\u5206\u533A\u8865\u507F\u6539\u5199",level:3},{value:"\u5D4C\u5957\u7269\u5316\u89C6\u56FE\u6539\u5199",id:"\u5D4C\u5957\u7269\u5316\u89C6\u56FE\u6539\u5199",level:3},{value:"\u805A\u5408\u67E5\u8BE2\u4F7F\u7528\u975E\u805A\u5408\u7269\u5316\u89C6\u56FE\u6539\u5199",id:"\u805A\u5408\u67E5\u8BE2\u4F7F\u7528\u975E\u805A\u5408\u7269\u5316\u89C6\u56FE\u6539\u5199",level:3},{value:"\u7A97\u53E3\u51FD\u6570\u6539\u5199",id:"\u7A97\u53E3\u51FD\u6570\u6539\u5199",level:3},{value:"Limit \u548C TopN \u6539\u5199",id:"limit-\u548C-topn-\u6539\u5199",level:3},{value:"Explain \u67E5\u8BE2\u900F\u660E\u6539\u5199\u60C5\u51B5",id:"explain-\u67E5\u8BE2\u900F\u660E\u6539\u5199\u60C5\u51B5",level:3},{value:"\u7EF4\u62A4\u7269\u5316\u89C6\u56FE",id:"\u7EF4\u62A4\u7269\u5316\u89C6\u56FE",level:2},{value:"\u6743\u9650\u8BF4\u660E",id:"\u6743\u9650\u8BF4\u660E-1",level:3},{value:"\u7269\u5316\u89C6\u56FE\u4FEE\u6539",id:"\u7269\u5316\u89C6\u56FE\u4FEE\u6539",level:3},{value:"\u4FEE\u6539\u7269\u5316\u89C6\u56FE\u5C5E\u6027",id:"\u4FEE\u6539\u7269\u5316\u89C6\u56FE\u5C5E\u6027",level:4},{value:"\u7269\u5316\u89C6\u56FE\u91CD\u547D\u540D\uFF0C\u5373\u7269\u5316\u89C6\u56FE\u539F\u5B50\u66FF\u6362",id:"\u7269\u5316\u89C6\u56FE\u91CD\u547D\u540D\u5373\u7269\u5316\u89C6\u56FE\u539F\u5B50\u66FF\u6362",level:4},{value:"\u7269\u5316\u89C6\u56FE\u5220\u9664",id:"\u7269\u5316\u89C6\u56FE\u5220\u9664",level:3},{value:"\u67E5\u770B\u7269\u5316\u89C6\u56FE\u521B\u5EFA\u8BED\u53E5",id:"\u67E5\u770B\u7269\u5316\u89C6\u56FE\u521B\u5EFA\u8BED\u53E5",level:3},{value:"\u6682\u505C\u7269\u5316\u89C6\u56FE",id:"\u6682\u505C\u7269\u5316\u89C6\u56FE",level:3},{value:"\u542F\u7528\u7269\u5316\u89C6\u56FE",id:"\u542F\u7528\u7269\u5316\u89C6\u56FE",level:3},{value:"\u53D6\u6D88\u7269\u5316\u89C6\u56FE\u5237\u65B0\u4EFB\u52A1",id:"\u53D6\u6D88\u7269\u5316\u89C6\u56FE\u5237\u65B0\u4EFB\u52A1",level:3},{value:"\u67E5\u8BE2\u7269\u5316\u89C6\u56FE\u4FE1\u606F",id:"\u67E5\u8BE2\u7269\u5316\u89C6\u56FE\u4FE1\u606F",level:3},{value:"\u67E5\u8BE2\u5237\u65B0\u4EFB\u52A1 TASK \u4FE1\u606F",id:"\u67E5\u8BE2\u5237\u65B0\u4EFB\u52A1-task-\u4FE1\u606F",level:3},{value:"\u67E5\u8BE2\u7269\u5316\u89C6\u56FE\u5BF9\u5E94\u7684 JOB",id:"\u67E5\u8BE2\u7269\u5316\u89C6\u56FE\u5BF9\u5E94\u7684-job",level:3},{value:"\u67E5\u8BE2\u7269\u5316\u89C6\u56FE\u7684\u5206\u533A\u4FE1\u606F\uFF1A",id:"\u67E5\u8BE2\u7269\u5316\u89C6\u56FE\u7684\u5206\u533A\u4FE1\u606F",level:3},{value:"\u67E5\u770B\u7269\u5316\u89C6\u56FE\u8868\u7ED3\u6784",id:"\u67E5\u770B\u7269\u5316\u89C6\u56FE\u8868\u7ED3\u6784",level:3},{value:"\u76F8\u5173\u914D\u7F6E",id:"\u76F8\u5173\u914D\u7F6E",level:3},{value:"Session Variables \u5F00\u5173",id:"session-variables-\u5F00\u5173",level:4},{value:"fe.conf \u914D\u7F6E",id:"feconf-\u914D\u7F6E",level:4}];function a(n){let e={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.a)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.p,{children:"\u672C\u6587\u5C06\u8BE6\u7EC6\u8BF4\u660E\u7269\u5316\u89C6\u56FE\u521B\u5EFA\u3001\u7269\u5316\u89C6\u56FE\u76F4\u67E5\u3001\u67E5\u8BE2\u6539\u5199\u548C\u7269\u5316\u89C6\u56FE\u5E38\u89C1\u8FD0\u7EF4\u3002"}),"\n",(0,i.jsx)(e.h2,{id:"\u7269\u5316\u89C6\u56FE\u521B\u5EFA",children:"\u7269\u5316\u89C6\u56FE\u521B\u5EFA"}),"\n",(0,i.jsx)(e.h3,{id:"\u6743\u9650\u8BF4\u660E",children:"\u6743\u9650\u8BF4\u660E"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u521B\u5EFA\u7269\u5316\u89C6\u56FE\uFF1A\u9700\u8981\u5177\u6709\u7269\u5316\u89C6\u56FE\u7684\u521B\u5EFA\u6743\u9650\uFF08\u4E0E\u5EFA\u8868\u6743\u9650\u76F8\u540C\uFF09\u4EE5\u53CA\u521B\u5EFA\u7269\u5316\u89C6\u56FE\u67E5\u8BE2\u8BED\u53E5\u7684\u67E5\u8BE2\u6743\u9650\uFF08\u4E0E SELECT \u6743\u9650\u76F8\u540C\uFF09\u3002"}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"\u521B\u5EFA\u8BED\u6CD5",children:"\u521B\u5EFA\u8BED\u6CD5"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW \n[ IF NOT EXISTS ] <materialized_view_name>\n    [ (<columns_definition>) ] \n    [ BUILD <build_mode> ]\n    [ REFRESH <refresh_method> [refresh_trigger]]\n    [ [DUPLICATE] KEY (<key_cols>) ]\n    [ COMMENT '<table_comment>' ]\n    [ PARTITION BY (\n        { <partition_col> \n            | DATE_TRUNC(<partition_col>, <partition_unit>) }\n                    )]\n    [ DISTRIBUTED BY { HASH (<distribute_cols>) | RANDOM }\n        [ BUCKETS { <bucket_count> | AUTO } ]\n    ]               \n    [ PROPERTIES (\n          -- Table property\n          <table_property>\n          -- Additional table properties\n          [ , ... ]) \n    ]\n    AS <query>\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u5237\u65B0\u914D\u7F6E",children:"\u5237\u65B0\u914D\u7F6E"}),"\n",(0,i.jsx)(e.h4,{id:"build_mode-\u5237\u65B0\u65F6\u673A",children:"build_mode \u5237\u65B0\u65F6\u673A"}),"\n",(0,i.jsx)(e.p,{children:"\u7269\u5316\u89C6\u56FE\u521B\u5EFA\u5B8C\u6210\u662F\u5426\u7ACB\u5373\u5237\u65B0\u3002"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"IMMEDIATE\uFF1A\u7ACB\u5373\u5237\u65B0\uFF0C\u9ED8\u8BA4\u65B9\u5F0F\u3002"}),"\n",(0,i.jsx)(e.li,{children:"DEFERRED\uFF1A\u5EF6\u8FDF\u5237\u65B0\u3002"}),"\n"]}),"\n",(0,i.jsx)(e.h4,{id:"refresh_method-\u5237\u65B0\u65B9\u5F0F",children:"refresh_method \u5237\u65B0\u65B9\u5F0F"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"COMPLETE\uFF1A\u5237\u65B0\u6240\u6709\u5206\u533A\u3002"}),"\n",(0,i.jsx)(e.li,{children:"AUTO\uFF1A\u5C3D\u91CF\u589E\u91CF\u5237\u65B0\uFF0C\u53EA\u5237\u65B0\u81EA\u4E0A\u6B21\u7269\u5316\u5237\u65B0\u540E\u6570\u636E\u53D8\u5316\u7684\u5206\u533A\uFF0C\u5982\u679C\u4E0D\u80FD\u611F\u77E5\u6570\u636E\u53D8\u5316\u7684\u5206\u533A\uFF0C\u53EA\u80FD\u9000\u5316\u6210\u5168\u91CF\u5237\u65B0\uFF0C\u5237\u65B0\u6240\u6709\u5206\u533A\u3002"}),"\n"]}),"\n",(0,i.jsx)(e.h4,{id:"refresh_trigger-\u89E6\u53D1\u65B9\u5F0F",children:"refresh_trigger \u89E6\u53D1\u65B9\u5F0F"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsxs)(e.strong,{children:[(0,i.jsx)(e.code,{children:"ON MANUAL"})," \u624B\u52A8\u89E6\u53D1"]})}),"\n",(0,i.jsx)(e.p,{children:"\u7528\u6237\u901A\u8FC7 SQL \u8BED\u53E5\u89E6\u53D1\u7269\u5316\u89C6\u56FE\u7684\u5237\u65B0\uFF0C\u7B56\u7565\u5982\u4E0B"}),"\n",(0,i.jsx)(e.p,{children:"\u68C0\u6D4B\u57FA\u8868\u7684\u5206\u533A\u6570\u636E\u81EA\u4E0A\u6B21\u5237\u65B0\u540E\u662F\u5426\u6709\u53D8\u5316\uFF0C\u5237\u65B0\u6570\u636E\u53D8\u5316\u7684\u5206\u533A\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"REFRESH MATERIALIZED VIEW mvName AUTO;\n"})}),"\n",(0,i.jsx)(e.admonition,{title:"\u63D0\u793A",type:"tip",children:(0,i.jsxs)(e.p,{children:["\u5982\u679C\u7269\u5316\u89C6\u56FE\u5B9A\u4E49 SQL \u4F7F\u7528\u7684\u57FA\u8868\u662F JDBC \u8868\uFF0CDoris \u65E0\u6CD5\u611F\u77E5\u8868\u6570\u636E\u53D8\u5316\uFF0C\u5237\u65B0\u7269\u5316\u89C6\u56FE\u65F6\u9700\u8981\u6307\u5B9A ",(0,i.jsx)(e.code,{children:"COMPLETE"}),"\u3002\n\u5982\u679C\u6307\u5B9A\u4E86 AUTO\uFF0C\u4F1A\u5BFC\u81F4\u57FA\u8868\u6709\u6570\u636E\uFF0C\u4F46\u662F\u5237\u65B0\u540E\u7269\u5316\u89C6\u56FE\u6CA1\u6570\u636E\u3002\n\u5237\u65B0\u7269\u5316\u89C6\u56FE\u65F6\uFF0C\u76EE\u524D Doris \u53EA\u80FD\u611F\u77E5\u5185\u8868\u548C Hive \u6570\u636E\u6E90\u8868\u6570\u636E\u53D8\u5316\uFF0C\u5176\u4ED6\u6570\u636E\u6E90\u9010\u6B65\u652F\u6301\u4E2D\u3002"]})}),"\n",(0,i.jsx)(e.p,{children:"\u4E0D\u6821\u9A8C\u57FA\u8868\u7684\u5206\u533A\u6570\u636E\u81EA\u4E0A\u6B21\u5237\u65B0\u540E\u662F\u5426\u6709\u53D8\u5316\uFF0C\u76F4\u63A5\u5237\u65B0\u7269\u5316\u89C6\u56FE\u7684\u6240\u6709\u5206\u533A\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"REFRESH MATERIALIZED VIEW mvName COMPLETE;\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u53EA\u5237\u65B0\u6307\u5B9A\u7684\u5206\u533A\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"REFRESH MATERIALIZED VIEW mvName partitions(partitionName1,partitionName2);\n"})}),"\n",(0,i.jsx)(e.admonition,{title:"\u63D0\u793A",type:"tip",children:(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"partitionName"})," \u53EF\u4EE5\u901A\u8FC7 ",(0,i.jsx)(e.code,{children:"SHOW PARTITIONS FROM mvName"})," \u83B7\u53D6\u3002\n\u4ECE 2.1.3 \u7248\u672C\u5F00\u59CB\u652F\u6301 Hive \u68C0\u6D4B\u57FA\u8868\u7684\u5206\u533A\u6570\u636E\u81EA\u4E0A\u6B21\u5237\u65B0\u540E\u662F\u5426\u6709\u53D8\u5316\uFF0C\u5176\u4ED6\u5916\u8868\u6682\u65F6\u8FD8\u4E0D\u652F\u6301\u3002\u5185\u8868\u4E00\u76F4\u652F\u6301\u3002"]})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsxs)(e.strong,{children:[(0,i.jsx)(e.code,{children:"ON SCHEDULE"})," \u5B9A\u65F6\u89E6\u53D1"]})}),"\n",(0,i.jsx)(e.p,{children:"\u901A\u8FC7\u7269\u5316\u89C6\u56FE\u7684\u521B\u5EFA\u8BED\u53E5\u6307\u5B9A\u95F4\u9694\u591A\u4E45\u5237\u65B0\u4E00\u6B21\u6570\u636E\uFF0CrefreshUnit(\u5237\u65B0\u65F6\u95F4\u95F4\u9694\u5355\u4F4D)\u53EF\u4EE5\u662F minute\uFF0C hour\uFF0Cday\uFF0Cweek \u7B49\u3002"}),"\n",(0,i.jsxs)(e.p,{children:["\u5982\u4E0B\uFF0C\u8981\u6C42\u5168\u91CF\u5237\u65B0 (",(0,i.jsx)(e.code,{children:"REFRESH COMPLETE"}),")\uFF0C\u7269\u5316\u89C6\u56FE\u6BCF 10 \u5C0F\u65F6\u5237\u65B0\u4E00\u6B21\uFF0C\u5E76\u4E14\u5237\u65B0\u7269\u5316\u89C6\u56FE\u7684\u6240\u6709\u5206\u533A\u3002"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv_6\nREFRESH COMPLETE ON SCHEDULE EVERY 10 hour\nAS\nSELECT * FROM lineitem;\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5982\u4E0B\uFF0C\u5C3D\u91CF\u589E\u91CF\u5237\u65B0 (",(0,i.jsx)(e.code,{children:"REFRESH AUTO"}),")\uFF0C\u53EA\u5237\u65B0\u81EA\u4E0A\u6B21\u7269\u5316\u5237\u65B0\u540E\u6570\u636E\u53D8\u5316\u7684\u5206\u533A\uFF0C\u5982\u679C\u4E0D\u80FD\u589E\u91CF\u5237\u65B0\uFF0C\u5C31\u5237\u65B0\u6240\u6709\u5206\u533A\uFF0C\u7269\u5316\u89C6\u56FE\u6BCF 10 \u5C0F\u65F6\u5237\u65B0\u4E00\u6B21\uFF08\u4ECE 2.1.3 \u7248\u672C\u5F00\u59CB\u80FD\u81EA\u52A8\u8BA1\u7B97 Hive \u9700\u8981\u5237\u65B0\u7684\u5206\u533A\uFF09\u3002"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv_7\nREFRESH AUTO ON SCHEDULE EVERY 10 hour\nPARTITION by(l_shipdate)\nAS\nSELECT * FROM lineitem;\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsxs)(e.strong,{children:[(0,i.jsx)(e.code,{children:"ON COMMIT"})," \u81EA\u52A8\u89E6\u53D1"]})}),"\n",(0,i.jsx)(e.admonition,{title:"\u63D0\u793A",type:"tip",children:(0,i.jsx)(e.p,{children:"\u81EA Apache Doris 2.1.4 \u7248\u672C\u8D77\u652F\u6301\u6B64\u529F\u80FD\u3002"})}),"\n",(0,i.jsx)(e.p,{children:'\u57FA\u8868\u6570\u636E\u53D1\u751F\u53D8\u66F4\u540E\uFF0C\u81EA\u52A8\u89E6\u53D1\u76F8\u5173\u7269\u5316\u89C6\u56FE\u5237\u65B0\uFF0C\u5237\u65B0\u7684\u5206\u533A\u8303\u56F4\u4E0E"\u5B9A\u65F6\u89E6\u53D1"\u4E00\u81F4\u3002'}),"\n",(0,i.jsxs)(e.p,{children:["\u5982\u679C\u7269\u5316\u89C6\u56FE\u7684\u521B\u5EFA\u8BED\u53E5\u5982\u4E0B\uFF0C\u90A3\u4E48\u5F53 \u57FA\u8868 ",(0,i.jsx)(e.code,{children:"lineitem"})," \u7684 ",(0,i.jsx)(e.code,{children:"t1"})," \u5206\u533A\u6570\u636E\u53D1\u751F\u53D8\u5316\u65F6\uFF0C\u4F1A\u81EA\u52A8\u89E6\u53D1\u7269\u5316\u89C6\u56FE\u7684\u5BF9\u5E94\u5206\u533A\u5237\u65B0\u3002"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv_8\nREFRESH AUTO ON COMMIT\nPARTITION by(l_shipdate)\nAS\nSELECT * FROM lineitem;\n"})}),"\n",(0,i.jsx)(e.admonition,{title:"\u6CE8\u610F",type:"caution",children:(0,i.jsx)(e.p,{children:"\u5982\u679C\u57FA\u8868\u7684\u6570\u636E\u9891\u7E41\u53D8\u66F4\uFF0C\u4E0D\u592A\u9002\u5408\u4F7F\u7528\u6B64\u79CD\u89E6\u53D1\u65B9\u5F0F\uFF0C\u56E0\u4E3A\u4F1A\u9891\u7E41\u6784\u5EFA\u7269\u5316\u5237\u65B0\u4EFB\u52A1\uFF0C\u6D88\u8017\u8FC7\u591A\u8D44\u6E90\u3002"})}),"\n",(0,i.jsxs)(e.p,{children:["\u8BE6\u60C5\u53C2\u8003 ",(0,i.jsx)(e.a,{href:"../../../sql-manual/sql-statements/table-and-view/async-materialized-view/REFRESH-MATERIALIZED-VIEW",children:"REFRESH MATERIALIZED VIEW"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h4,{id:"\u793A\u4F8B\u5982\u4E0B",children:"\u793A\u4F8B\u5982\u4E0B"}),"\n",(0,i.jsx)(e.p,{children:"\u5EFA\u8868\u8BED\u53E5"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"CREATE TABLE IF NOT EXISTS lineitem (\n    l_orderkey    integer not null,\n    l_partkey     integer not null,\n    l_suppkey     integer not null,\n    l_linenumber  integer not null,\n    l_quantity    decimalv3(15,2) not null,\n    l_extendedprice  decimalv3(15,2) not null,\n    l_discount    decimalv3(15,2) not null,\n    l_tax         decimalv3(15,2) not null,\n    l_returnflag  char(1) not null,\n    l_linestatus  char(1) not null,\n    l_shipdate    date not null,\n    l_commitdate  date not null,\n    l_receiptdate date not null,\n    l_shipinstruct char(25) not null,\n    l_shipmode     char(10) not null,\n    l_comment      varchar(44) not null\n    )\n    DUPLICATE KEY(l_orderkey, l_partkey, l_suppkey, l_linenumber)\n    PARTITION BY RANGE(l_shipdate)\n    (FROM ('2023-10-17') TO ('2023-11-01') INTERVAL 1 DAY)\n    DISTRIBUTED BY HASH(l_orderkey) BUCKETS 3;\n\nINSERT INTO lineitem VALUES\n(1, 2, 3, 4, 5.5, 6.5, 7.5, 8.5, 'o', 'k', '2023-10-17', '2023-10-17', '2023-10-17', 'a', 'b', 'yyyyyyyyy'),\n(2, 4, 3, 4, 5.5, 6.5, 7.5, 8.5, 'o', 'k', '2023-10-18', '2023-10-18', '2023-10-18', 'a', 'b', 'yyyyyyyyy'),\n(3, 2, 4, 4, 5.5, 6.5, 7.5, 8.5, 'o', 'k', '2023-10-19', '2023-10-19', '2023-10-19', 'a', 'b', 'yyyyyyyyy');\n\nCREATE TABLE IF NOT EXISTS orders  (\n    o_orderkey       integer not null,\n    o_custkey        integer not null,\n    o_orderstatus    char(1) not null,\n    o_totalprice     decimalv3(15,2) not null,\n    o_orderdate      date not null,\n    o_orderpriority  char(15) not null,\n    o_clerk          char(15) not null,\n    o_shippriority   integer not null,\n    o_comment        varchar(79) not null\n    )\nDUPLICATE KEY(o_orderkey, o_custkey)\nPARTITION BY RANGE(o_orderdate)(\nFROM ('2023-10-17') TO ('2023-11-01') INTERVAL 1 DAY)\nDISTRIBUTED BY HASH(o_orderkey) BUCKETS 3;\n\nINSERT INTO orders VALUES\n(1, 1, 'o', 9.5, '2023-10-17', 'a', 'b', 1, 'yy'),\n(1, 1, 'o', 10.5, '2023-10-18', 'a', 'b', 1, 'yy'),\n(2, 1, 'o', 11.5, '2023-10-19', 'a', 'b', 1, 'yy'),\n(3, 1, 'o', 12.5, '2023-10-19', 'a', 'b', 1, 'yy');\n    \nCREATE TABLE IF NOT EXISTS partsupp (\n      ps_partkey     INTEGER NOT NULL,\n      ps_suppkey     INTEGER NOT NULL,\n      ps_availqty    INTEGER NOT NULL,\n      ps_supplycost  DECIMALV3(15,2)  NOT NULL,\n      ps_comment     VARCHAR(199) NOT NULL \n    )\nDUPLICATE KEY(ps_partkey, ps_suppkey)\nDISTRIBUTED BY HASH(ps_partkey) BUCKETS 3;\n\nINSERT INTO partsupp VALUES\n(2, 3, 9, 10.01, 'supply1'),\n(4, 3, 10, 11.01, 'supply2'),\n(2, 3, 10, 11.01, 'supply3');\n"})}),"\n",(0,i.jsx)(e.h4,{id:"\u5237\u65B0\u673A\u5236\u793A\u4F8B\u4E00",children:"\u5237\u65B0\u673A\u5236\u793A\u4F8B\u4E00"}),"\n",(0,i.jsxs)(e.p,{children:["\u5982\u4E0B\uFF0C\u5237\u65B0\u65F6\u673A\u662F\u521B\u5EFA\u5B8C\u7ACB\u5373\u5237\u65B0 ",(0,i.jsx)(e.code,{children:"BUILD IMMEDIATE"}),"\uFF0C\u5237\u65B0\u65B9\u5F0F\u5C3D\u91CF\u589E\u91CF\u5237\u65B0 ",(0,i.jsx)(e.code,{children:"REFRESH AUTO"}),"\uFF0C\n\u53EA\u5237\u65B0\u81EA\u4E0A\u6B21\u7269\u5316\u5237\u65B0\u540E\u6570\u636E\u53D8\u5316\u7684\u5206\u533A\uFF0C\u5982\u679C\u4E0D\u80FD\u589E\u91CF\u5237\u65B0\uFF0C\u5C31\u5237\u65B0\u6240\u6709\u5206\u533A\u3002\n\u89E6\u53D1\u65B9\u5F0F\u662F\u624B\u52A8 ",(0,i.jsx)(e.code,{children:"ON MANUAL"}),"\u3002\u5BF9\u4E8E\u975E\u5206\u533A\u5168\u91CF\u7269\u5316\u89C6\u56FE\uFF0C\u53EA\u6709\u4E00\u4E2A\u5206\u533A\uFF0C\u5982\u679C\u57FA\u8868\u6570\u636E\u53D1\u751F\u53D8\u5316\uFF0C\u610F\u5473\u7740\u8981\u5168\u91CF\u5237\u65B0\u3002"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv_1_0\nBUILD IMMEDIATE \nREFRESH AUTO\nON MANUAL    \nDISTRIBUTED BY RANDOM BUCKETS 2   \nAS   \nSELECT   \n  l_linestatus,   \n  to_date(o_orderdate) as date_alias,   \n  o_shippriority   \nFROM   \n  orders   \n  LEFT JOIN lineitem ON l_orderkey = o_orderkey;\n"})}),"\n",(0,i.jsx)(e.h4,{id:"\u5237\u65B0\u673A\u5236\u793A\u4F8B\u4E8C",children:"\u5237\u65B0\u673A\u5236\u793A\u4F8B\u4E8C"}),"\n",(0,i.jsxs)(e.p,{children:["\u5982\u4E0B\uFF0C\u5237\u65B0\u65F6\u673A\u662F\u5EF6\u8FDF\u5237\u65B0 ",(0,i.jsx)(e.code,{children:"BUILD DEFERRED"}),"\uFF0C\u5237\u65B0\u65B9\u5F0F\u662F\u5168\u91CF\u5237\u65B0 ",(0,i.jsx)(e.code,{children:"REFRESH COMPLETE"}),"\uFF0C\n\u89E6\u53D1\u65F6\u673A\u662F\u5B9A\u65F6\u5237\u65B0 ",(0,i.jsx)(e.code,{children:"ON SCHEDULE"}),"\uFF0C\u9996\u6B21\u5237\u65B0\u65F6\u95F4\u662F ",(0,i.jsx)(e.code,{children:"2024-12-01 20:30:00"}),", \u5E76\u4E14\u6BCF\u9694\u4E00\u5929\u5237\u65B0\u4E00\u6B21\u3002\n\u5982\u679C ",(0,i.jsx)(e.code,{children:"BUILD DEFERRED"})," \u6307\u5B9A\u4E3A ",(0,i.jsx)(e.code,{children:"BUILD IMMEDIATE"}),"\uFF0C\u521B\u5EFA\u5B8C\u7269\u5316\u89C6\u56FE\u4F1A\u7ACB\u5373\u5237\u65B0\u4E00\u6B21\u3002\u4E4B\u540E\u4ECE ",(0,i.jsx)(e.code,{children:"2024-12-01 20:30:00"})," \u6BCF\u9694\u4E00\u5929\u5237\u65B0\u4E00\u6B21\u3002"]}),"\n",(0,i.jsx)(e.admonition,{title:"\u63D0\u793A",type:"tip",children:(0,i.jsx)(e.p,{children:"STARTS \u7684\u65F6\u95F4\u8981\u665A\u4E8E\u5F53\u524D\u7684\u65F6\u95F4"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv_1_1\nBUILD DEFERRED\nREFRESH COMPLETE\nON SCHEDULE EVERY 1 DAY STARTS '2024-12-01 20:30:00'  \nPROPERTIES ('replication_num' = '1')   \nAS   \nSELECT   \nl_linestatus,   \nto_date(o_orderdate) as date_alias,   \no_shippriority   \nFROM   \norders   \nLEFT JOIN lineitem ON l_orderkey = o_orderkey;\n"})}),"\n",(0,i.jsx)(e.h4,{id:"\u5237\u65B0\u673A\u5236\u793A\u4F8B\u4E09",children:"\u5237\u65B0\u673A\u5236\u793A\u4F8B\u4E09"}),"\n",(0,i.jsxs)(e.p,{children:["\u5982\u4E0B\uFF0C\u5237\u65B0\u65F6\u673A\u662F\u521B\u5EFA\u5B8C\u7ACB\u5373\u5237\u65B0 ",(0,i.jsx)(e.code,{children:"BUILD IMMEDIATE"}),"\uFF0C\u5237\u65B0\u65B9\u5F0F\u662F\u5168\u91CF\u5237\u65B0 ",(0,i.jsx)(e.code,{children:"REFRESH COMPLETE"}),"\uFF0C\n\u89E6\u53D1\u65B9\u5F0F\u662F\u89E6\u53D1\u5237\u65B0 ",(0,i.jsx)(e.code,{children:"ON COMMIT"}),"\uFF0C\u5F53 orders \u6216\u8005 lineitem \u8868\u6570\u636E\u53D1\u751F\u53D8\u5316\u7684\u65F6\u5019\uFF0C\u4F1A\u81EA\u52A8\u89E6\u53D1\u7269\u5316\u89C6\u56FE\u7684\u5237\u65B0\u3002"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv_1_1\nBUILD IMMEDIATE\nREFRESH COMPLETE\nON COMMIT\nPROPERTIES ('replication_num' = '1')   \nAS   \nSELECT   \nl_linestatus,   \nto_date(o_orderdate) as date_alias,   \no_shippriority   \nFROM   \norders   \nLEFT JOIN lineitem ON l_orderkey = o_orderkey;\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u5206\u533A\u914D\u7F6E",children:"\u5206\u533A\u914D\u7F6E"}),"\n",(0,i.jsxs)(e.p,{children:["\u5982\u4E0B\uFF0C\u521B\u5EFA\u5206\u533A\u7269\u5316\u89C6\u56FE\u65F6\uFF0C\u9700\u8981\u6307\u5B9A ",(0,i.jsx)(e.code,{children:"PARTITION BY"}),"\uFF0C\u5BF9\u4E8E\u5206\u533A\u5B57\u6BB5\u5F15\u7528\u7684\u8868\u8FBE\u5F0F\uFF0C\u4EC5\u5141\u8BB8\u4F7F\u7528 ",(0,i.jsx)(e.code,{children:"date_trunc"})," \u51FD\u6570\u548C\u6807\u8BC6\u7B26\u3002\n\u4EE5\u4E0B\u8BED\u53E5\u662F\u7B26\u5408\u8981\u6C42\u7684\uFF1A\n\u5206\u533A\u5B57\u6BB5\u5F15\u7528\u7684\u5217\u4EC5\u4F7F\u7528\u4E86 ",(0,i.jsx)(e.code,{children:"date_trunc"})," \u51FD\u6570\u3002\u5206\u533A\u7269\u5316\u89C6\u56FE\u7684\u5237\u65B0\u65B9\u5F0F\u4E00\u822C\u662F ",(0,i.jsx)(e.code,{children:"AUTO"}),"\uFF0C\u5373\u5C3D\u91CF\u589E\u91CF\u5237\u65B0\uFF0C\u53EA\u5237\u65B0\u81EA\u4E0A\u6B21\u7269\u5316\u5237\u65B0\u540E\u6570\u636E\u53D8\u5316\u7684\u5206\u533A\uFF0C\u5982\u679C\u4E0D\u80FD\u589E\u91CF\u5237\u65B0\uFF0C\u5C31\u5237\u65B0\u6240\u6709\u5206\u533A\u3002"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv_2_0 \nBUILD IMMEDIATE\nREFRESH AUTO\nON MANUAL   \nPARTITION BY (order_date_month)   \nDISTRIBUTED BY RANDOM BUCKETS 2   \nAS   \nSELECT   \n  l_linestatus,\n  date_trunc(o_orderdate, 'month') as order_date_month,   \n  o_shippriority   \nFROM   \n  orders   \nLEFT JOIN lineitem ON l_orderkey = o_orderkey;\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5982\u4E0B\u8BED\u53E5\u521B\u5EFA\u5206\u533A\u7269\u5316\u89C6\u56FE\u4F1A\u5931\u8D25\uFF0C\u56E0\u4E3A\u5206\u533A\u5B57\u6BB5 ",(0,i.jsx)(e.code,{children:"order_date_month"})," \u4F7F\u7528\u4E86 ",(0,i.jsx)(e.code,{children:"date_add()"})," \u51FD\u6570\uFF0C\u62A5\u9519 ",(0,i.jsx)(e.code,{children:"because column to check use invalid implicit expression, invalid expression is days_add(o_orderdate#4, 2)"}),"\u3002"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv_2_1 BUILD IMMEDIATE REFRESH AUTO ON MANUAL   \nPARTITION BY (order_date_month)   \nDISTRIBUTED BY RANDOM BUCKETS 2   \nAS   \nSELECT   \n  l_linestatus,\n  date_trunc(date_add(o_orderdate, INTERVAL 2 DAY), 'month') as order_date_month,   \n  o_shippriority   \nFROM   \n  orders   \nLEFT JOIN lineitem ON l_orderkey = o_orderkey;\n"})}),"\n",(0,i.jsx)(e.h4,{id:"\u57FA\u8868\u6709\u591A\u5217\u5206\u533A",children:"\u57FA\u8868\u6709\u591A\u5217\u5206\u533A"}),"\n",(0,i.jsx)(e.p,{children:"\u76EE\u524D\u4EC5\u652F\u6301 Hive \u5916\u8868\u6709\u591A\u5217\u5206\u533A\u3002Hive \u5916\u8868\u6709\u5F88\u591A\u591A\u7EA7\u5206\u533A\u7684\u60C5\u51B5\uFF0C\u4F8B\u5982\u4E00\u7EA7\u5206\u533A\u6309\u7167\u65E5\u671F\uFF0C\u4E8C\u7EA7\u5206\u533A\u6309\u7167\u533A\u57DF\u3002\u7269\u5316\u89C6\u56FE\u53EF\u4EE5\u9009\u62E9 Hive \u7684\u67D0\u4E00\u7EA7\u5206\u533A\u5217\u4F5C\u4E3A\u7269\u5316\u89C6\u56FE\u7684\u5206\u533A\u5217\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u4F8B\u5982\uFF0CHive \u7684\u5EFA\u8868\u8BED\u53E5\u5982\u4E0B\uFF1A"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:'CREATE TABLE hive1 (\n`k1` int)\nPARTITIONED BY (\n`year` int,\n`region` string)\nSTORED AS ORC;\n\nalter table hive1 add if not exists\npartition(year=2020,region="bj")\npartition(year=2020,region="sh")\npartition(year=2021,region="bj")\npartition(year=2021,region="sh")\npartition(year=2022,region="bj")\npartition(year=2022,region="sh")\n'})}),"\n",(0,i.jsxs)(e.p,{children:["\u5F53\u7269\u5316\u89C6\u56FE\u7684\u521B\u5EFA\u8BED\u53E5\u5982\u4E0B\u65F6\uFF0C\u7269\u5316\u89C6\u56FE",(0,i.jsx)(e.code,{children:"mv_hive"}),"\u5C06\u6709\u4E09\u4E2A\u5206\u533A\uFF1A",(0,i.jsx)(e.code,{children:"('2020')\uFF0C('2021')\uFF0C('2022')"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv_hive\nBUILD DEFERRED REFRESH AUTO ON MANUAL\npartition by(`year`)\nDISTRIBUTED BY RANDOM BUCKETS 2\nAS\nSELECT k1,year,region FROM hive1;\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5F53\u7269\u5316\u89C6\u56FE\u7684\u5EFA\u8868\u8BED\u53E5\u5982\u4E0B\u65F6\uFF0C\u90A3\u4E48\u7269\u5316\u89C6\u56FE",(0,i.jsx)(e.code,{children:"mv_hive2"}),"\u5C06\u6709\u5982\u4E0B\u4E24\u4E2A\u5206\u533A\uFF1A",(0,i.jsx)(e.code,{children:"('bj')"}),"\uFF0C",(0,i.jsx)(e.code,{children:"('sh')"}),"\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv_hive2\nBUILD DEFERRED REFRESH AUTO ON MANUAL\npartition by(`region`)\nDISTRIBUTED BY RANDOM BUCKETS 2\nAS\nSELECT k1,year,region FROM hive1;\n"})}),"\n",(0,i.jsx)(e.h4,{id:"\u4F7F\u7528\u57FA\u8868\u90E8\u5206\u5206\u533A",children:"\u4F7F\u7528\u57FA\u8868\u90E8\u5206\u5206\u533A"}),"\n",(0,i.jsx)(e.p,{children:'\u6709\u4E9B\u57FA\u8868\u6709\u5F88\u591A\u5206\u533A\uFF0C\u4F46\u662F\u7269\u5316\u89C6\u56FE\u53EA\u5173\u6CE8\u6700\u8FD1\u4E00\u6BB5\u65F6\u95F4\u7684"\u70ED"\u6570\u636E\uFF0C\u90A3\u4E48\u53EF\u4EE5\u4F7F\u7528\u6B64\u529F\u80FD\u3002'}),"\n",(0,i.jsx)(e.p,{children:"\u57FA\u8868\u7684\u5EFA\u8868\u8BED\u53E5\u5982\u4E0B\uFF1A"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:'CREATE TABLE t1 (\n    `k1` INT,\n    `k2` DATE NOT NULL\n) ENGINE=OLAP\nDUPLICATE KEY(`k1`)\nCOMMENT \'OLAP\'\nPARTITION BY range(`k2`)\n(\nPARTITION p26 VALUES [("2024-03-26"),("2024-03-27")),\nPARTITION p27 VALUES [("2024-03-27"),("2024-03-28")),\nPARTITION p28 VALUES [("2024-03-28"),("2024-03-29"))\n)\nDISTRIBUTED BY HASH(`k1`) BUCKETS 2;\n'})}),"\n",(0,i.jsxs)(e.p,{children:["\u7269\u5316\u89C6\u56FE\u7684\u521B\u5EFA\u8BED\u53E5\u5982\u4EE5\u4E0B\uFF0C\u4EE3\u8868\u7269\u5316\u89C6\u56FE\u53EA\u5173\u6CE8\u6700\u8FD1\u4E00\u5929\u7684\u6570\u636E\u3002\u82E5\u5F53\u524D\u65F6\u95F4\u4E3A 2024-03-28 xx:xx:xx\uFF0C\u8FD9\u6837\u7269\u5316\u89C6\u56FE\u4F1A\u4EC5\u6709\u4E00\u4E2A\u5206\u533A ",(0,i.jsx)(e.code,{children:'[("2024-03-28"),("2024-03-29")]'}),"\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv1\nBUILD DEFERRED REFRESH AUTO ON MANUAL\npartition by(`k2`)\nDISTRIBUTED BY RANDOM BUCKETS 2\nPROPERTIES (\n'partition_sync_limit'='1',\n'partition_sync_time_unit'='DAY'\n)\nAS\nSELECT * FROM t1;\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u82E5\u65F6\u95F4\u53C8\u8FC7\u4E86\u4E00\u5929\uFF0C\u5F53\u524D\u65F6\u95F4\u4E3A",(0,i.jsx)(e.code,{children:" 2024-03-29 xx:xx:xx"}),"\uFF0C",(0,i.jsx)(e.code,{children:"t1"}),"\u5219\u4F1A\u65B0\u589E\u4E00\u4E2A\u5206\u533A ",(0,i.jsx)(e.code,{children:'[("2024-03-29"),("2024-03-30")]'}),"\uFF0C\u82E5\u6B64\u65F6\u5237\u65B0\u7269\u5316\u89C6\u56FE\uFF0C\u5237\u65B0\u5B8C\u6210\u540E\uFF0C\u7269\u5316\u89C6\u56FE\u4F1A\u4EC5\u6709\u4E00\u4E2A\u5206\u533A ",(0,i.jsx)(e.code,{children:'[("2024-03-29"),("2024-03-30")]'}),"\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u6B64\u5916\uFF0C\u5206\u533A\u5B57\u6BB5\u662F\u5B57\u7B26\u4E32\u7C7B\u578B\u65F6\uFF0C\u53EF\u4EE5\u8BBE\u7F6E\u7269\u5316\u89C6\u56FE\u5C5E\u6027 ",(0,i.jsx)(e.code,{children:"partition_date_format"}),"\uFF0C\u4F8B\u5982 ",(0,i.jsx)(e.code,{children:"%Y-%m-%d"})," \u3002"]}),"\n",(0,i.jsx)(e.h4,{id:"\u5206\u533A\u4E0A\u5377",children:"\u5206\u533A\u4E0A\u5377"}),"\n",(0,i.jsx)(e.admonition,{title:"\u63D0\u793A",type:"tip",children:(0,i.jsx)(e.p,{children:"\u81EA Doris 2.1.5 \u7248\u672C\u8D77\u652F\u6301 Range \u5206\u533A"})}),"\n",(0,i.jsx)(e.p,{children:"\u5F53\u57FA\u8868\u6570\u636E\u7ECF\u8FC7\u805A\u5408\u5904\u7406\u540E\uFF0C\u5404\u5206\u533A\u7684\u6570\u636E\u91CF\u53EF\u80FD\u4F1A\u663E\u8457\u51CF\u5C11\u3002\u5728\u8FD9\u79CD\u60C5\u51B5\u4E0B\uFF0C\u53EF\u4EE5\u91C7\u7528\u5206\u533A\u4E0A\u5377\u7B56\u7565\uFF0C\u4EE5\u964D\u4F4E\u7269\u5316\u89C6\u56FE\u7684\u5206\u533A\u6570\u91CF\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u5047\u8BBE\u57FA\u8868\u7684\u5EFA\u8868\u8BED\u53E5\u5982\u4E0B\uFF1A"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:'    CREATE TABLE `t1` (\n    `k1` LARGEINT NOT NULL,\n    `k2` DATE NOT NULL\n    ) ENGINE=OLAP\n    DUPLICATE KEY(`k1`)\n    COMMENT \'OLAP\'\n    PARTITION BY range(`k2`)\n    (\n    PARTITION p_20200101 VALUES [("2020-01-01"),("2020-01-02")),\n    PARTITION p_20200102 VALUES [("2020-01-02"),("2020-01-03")),\n    PARTITION p_20200201 VALUES [("2020-02-01"),("2020-02-02"))\n    )\n    DISTRIBUTED BY HASH(`k1`) BUCKETS 2;\n'})}),"\n",(0,i.jsxs)(e.p,{children:["\u82E5\u7269\u5316\u89C6\u56FE\u7684\u521B\u5EFA\u8BED\u53E5\u5982\u4E0B\uFF0C\u5219\u8BE5\u7269\u5316\u89C6\u56FE\u5C06\u5305\u542B\u4E24\u4E2A\u5206\u533A\uFF1A",(0,i.jsx)(e.code,{children:'[("2020-01-01","2020-02-01")] '}),"\u548C",(0,i.jsx)(e.code,{children:' [("2020-02-01","2020-03-01")]'})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"    CREATE MATERIALIZED VIEW mv_3\n    BUILD DEFERRED REFRESH AUTO ON MANUAL\n    partition by (date_trunc(`k2`,'month'))\n    DISTRIBUTED BY RANDOM BUCKETS 2\n    AS\n    SELECT * FROM t1;\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u82E5\u7269\u5316\u89C6\u56FE\u7684\u521B\u5EFA\u8BED\u53E5\u5982\u4E0B\uFF0C\u5219\u8BE5\u7269\u5316\u89C6\u56FE\u5C06\u53EA\u5305\u542B\u4E00\u4E2A\u5206\u533A\uFF1A",(0,i.jsx)(e.code,{children:'[("2020-01-01","2021-01-01")]'})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"    CREATE MATERIALIZED VIEW mv_4\n    BUILD DEFERRED REFRESH AUTO ON MANUAL\n    partition by (date_trunc(`k2`,'year'))\n    DISTRIBUTED BY RANDOM BUCKETS 2\n    AS\n    SELECT * FROM t1;\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u6B64\u5916\uFF0C\u5982\u679C\u5206\u533A\u5B57\u6BB5\u4E3A\u5B57\u7B26\u4E32\u7C7B\u578B\uFF0C\u53EF\u4EE5\u901A\u8FC7\u8BBE\u7F6E\u7269\u5316\u89C6\u56FE\u7684 ",(0,i.jsx)(e.code,{children:"partition_date_format"})," \u5C5E\u6027\u6765\u6307\u5B9A\u65E5\u671F\u683C\u5F0F\uFF0C\u4F8B\u5982 ",(0,i.jsx)(e.code,{children:"'%Y-%m-%d'"}),"\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u8BE6\u60C5\u53C2\u8003 ",(0,i.jsx)(e.a,{href:"../../../sql-manual/sql-statements/table-and-view/async-materialized-view/CREATE-ASYNC-MATERIALIZED-VIEW",children:"CREATE ASYNC MATERIALIZED VIEW"})]}),"\n",(0,i.jsx)(e.h4,{id:"\u5206\u533A\u591A\u7AEF\u5237\u65B0",children:"\u5206\u533A\u591A\u7AEF\u5237\u65B0"}),"\n",(0,i.jsx)(e.p,{children:"\u201C\u591A\u7AEF\u5237\u65B0\u201D \u5141\u8BB8\u5F02\u6B65\u7269\u5316\u89C6\u56FE\u6709\u591A\u4E2A\u5206\u533A\u8FFD\u8E2A\u8868\uFF0C\u5373\u5141\u8BB8\u591A\u4E2A\u8868\u7684\u6570\u636E\u53D1\u751F\u53D8\u5316\uFF0C\u7269\u5316\u89C6\u56FE\u90FD\u53EA\u8FDB\u884C\u5206\u533A\u5237\u65B0\uFF0C\u800C\u4E0D\u662F\u5168\u91CF\u5237\u65B0\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u8BE5\u7279\u6027\u5728\u4F7F\u7528\u4E2D\u5B58\u5728\u4EE5\u4E0B\u9650\u5236\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u4EC5\u652F\u6301\u57FA\u4E8E INNER JOIN \u6216 UNION (\u5305\u62EC UNION ALL) \u6240\u6784\u5EFA\u7684\u7269\u5316\u89C6\u56FE\u3002"}),"\n",(0,i.jsx)(e.li,{children:"\u5F53\u7269\u5316\u89C6\u56FE\u4F7F\u7528 UNION \u64CD\u4F5C\u65F6\uFF0C\u6240\u6709\u53C2\u4E0E\u8054\u5408\u7684\u90E8\u5206\u90FD\u5FC5\u987B\u652F\u6301\u5206\u533A\u53D8\u5316\u8FFD\u8E2A\uFF08PCT\uFF09\u3002 \u4F8B\u5982\u7269\u5316\u89C6\u56FE\u7684 sql \u5B9A\u4E49\u4E3A\uFF1Aq1 union all q2, \u90A3\u4E48\u8981\u6C42\u5355\u72EC\u4F7F\u7528 q1 \u6216 q2 \u521B\u5EFA\u7269\u5316\u89C6\u56FE\u90FD\u80FD\u8FDB\u884C\u5206\u533A\u5237\u65B0\uFF0C\u4E14\u63A8\u5BFC\u51FA\u7684\u5206\u533A\u5B57\u6BB5\u7684\u987A\u5E8F\u4E00\u81F4\u3002"}),"\n",(0,i.jsxs)(e.li,{children:["\u591A PCT \u8868\u95F4\u7684\u5206\u533A\u7C92\u5EA6\u8981\u5BF9\u9F50\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5141\u8BB8\u7684\u793A\u4F8B\uFF1A"}),"\n",(0,i.jsx)(e.p,{children:"\u57FA\u8868 t1 \u7684\u5206\u533A\uFF1A[2020-01-01, 2020-01-02), [2020-01-02, 2020-01-03)"}),"\n",(0,i.jsx)(e.p,{children:"\u57FA\u8868 t2 \u7684\u5206\u533A\uFF1A[2020-01-02, 2020-01-03), [2020-01-03, 2020-01-04)"}),"\n",(0,i.jsx)(e.p,{children:"\u591A\u4E2A\u57FA\u8868\u7684\u5206\u533A\u4E0D\u5B8C\u5168\u4E00\u81F4\uFF0C\u4F46\u662F\u6CA1\u6709\u4EA4\u53C9"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4E0D\u5141\u8BB8\u7684\u793A\u4F8B\uFF1A"}),"\n",(0,i.jsx)(e.p,{children:"\u57FA\u8868 t1 \u7684\u5206\u533A\uFF1A[2020-01-01, 2020-01-03), [2020-01-03, 2020-01-05)"}),"\n",(0,i.jsx)(e.p,{children:"\u57FA\u8868 t2 \u7684\u5206\u533A\uFF1A[2020-01-01, 2020-01-02), [2020-01-03, 2020-01-05)"}),"\n",(0,i.jsx)(e.p,{children:"[2020-01-01, 2020-01-03) \u548C [2020-01-01, 2020-01-02) \u6709\u4EA4\u53C9\u53C8\u4E0D\u5B8C\u5168\u4E00\u6837"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"sql-\u5B9A\u4E49",children:"SQL \u5B9A\u4E49"}),"\n",(0,i.jsx)(e.p,{children:"\u5F02\u6B65\u7269\u5316\u89C6\u56FE\u652F\u6301\u57FA\u4E8E\u5185\u90E8\u89C6\u56FE\uFF08View\uFF09\u8FDB\u884C\u521B\u5EFA\uFF0C\u4F46\u4E0D\u652F\u6301\u57FA\u4E8E\u5916\u90E8\u6570\u636E\u6E90\u4E2D\u7684\u89C6\u56FE\u6784\u5EFA\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u9700\u8981\u6CE8\u610F\u7684\u662F\uFF0C\u5F53\u6240\u4F9D\u8D56\u7684\u5185\u90E8\u89C6\u56FE\u53D1\u751F\u4FEE\u6539\u6216\u91CD\u5EFA\u65F6\uFF0C\u4F1A\u5BFC\u81F4\u5F02\u6B65\u7269\u5316\u89C6\u56FE\u4E0E\u57FA\u8868\u4E4B\u95F4\u7684\u6570\u636E\u4E0D\u4E00\u81F4\u3002\u6B64\u65F6\uFF0C\u867D\u7136\u7269\u5316\u89C6\u56FE\u4E2D\u7684\u6570\u636E\u4ECD\u7136\u5B58\u5728\uFF0C\u4F46\u65E0\u6CD5\u652F\u6301\u67E5\u8BE2\u7684\u900F\u660E\u6539\u5199\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u6B64\u5916\uFF0C\u5982\u679C\u7ED3\u6784\u53D8\u66F4\u5F71\u54CD\u4E86\u5F02\u6B65\u7269\u5316\u89C6\u56FE\u6240\u4F9D\u8D56\u7684\u5206\u533A\u8FFD\u8E2A\u8868\u6216\u5B57\u6BB5\uFF0C\u6216\u4F7F\u5176 Schema \u53D1\u751F\u53D8\u5316\uFF0C\u8BE5\u7269\u5316\u89C6\u56FE\u5C06\u65E0\u6CD5\u5237\u65B0\u6210\u529F\u3002\u82E5\u53D8\u66F4\u672A\u5F71\u54CD\u4E0A\u8FF0\u5143\u7D20\uFF0C\u5219\u5237\u65B0\u7269\u5316\u89C6\u56FE\u540E\uFF0C\u5373\u53EF\u6062\u590D\u6B63\u5E38\u4F7F\u7528\u3002"}),"\n",(0,i.jsx)(e.h2,{id:"\u76F4\u67E5\u7269\u5316\u89C6\u56FE",children:"\u76F4\u67E5\u7269\u5316\u89C6\u56FE"}),"\n",(0,i.jsx)(e.p,{children:"\u7269\u5316\u89C6\u56FE\u53EF\u4EE5\u770B\u4F5C\u662F\u8868\uFF0C\u53EF\u4EE5\u5BF9\u7269\u5316\u89C6\u56FE\u6DFB\u52A0\u8FC7\u6EE4\u6761\u4EF6\u548C\u805A\u5408\u7B49\uFF0C\u8FDB\u884C\u76F4\u63A5\u67E5\u8BE2\u3002"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7269\u5316\u89C6\u56FE\u7684\u5B9A\u4E49\uFF1A"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv_5\nBUILD IMMEDIATE REFRESH AUTO ON SCHEDULE EVERY 1 hour\nDISTRIBUTED BY RANDOM BUCKETS 3\nAS\nSELECT t1.l_linenumber,\n       o_custkey,\n       o_orderdate\nFROM (SELECT * FROM lineitem WHERE l_linenumber > 1) t1\nLEFT OUTER JOIN orders\nON l_orderkey = o_orderkey;\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u539F\u67E5\u8BE2\u5982\u4E0B"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"SELECT t1.l_linenumber,\n       o_custkey,\n       o_orderdate\nFROM (SELECT * FROM lineitem WHERE l_linenumber > 1) t1\nLEFT OUTER JOIN orders\nON l_orderkey = o_orderkey\nWHERE o_orderdate = '2023-10-18';\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u7B49\u4EF7\u7684\u76F4\u67E5\u7269\u5316\u8BED\u53E5\u5982\u4E0B"}),"\uFF0C\u7528\u6237\u9700\u8981\u624B\u52A8\u4FEE\u6539\u67E5\u8BE2"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"SELECT\nl_linenumber,\no_custkey\nFROM mv_5\nWHERE l_linenumber > 1 and o_orderdate = '2023-10-18';\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u67E5\u8BE2\u900F\u660E\u6539\u5199",children:"\u67E5\u8BE2\u900F\u660E\u6539\u5199"}),"\n",(0,i.jsx)(e.p,{children:"\u900F\u660E\u6539\u5199\u6307\u5728\u5904\u7406\u67E5\u8BE2\u65F6\uFF0C\u7528\u6237\u65E0\u9700\u624B\u52A8\u4FEE\u6539\u67E5\u8BE2\uFF0C\u7CFB\u7EDF\u4F1A\u81EA\u52A8\u4F18\u5316\u5E76\u6539\u5199\u67E5\u8BE2\u3002\nDoris \u5F02\u6B65\u7269\u5316\u89C6\u56FE\u91C7\u7528\u57FA\u4E8E SPJG\uFF08SELECT-PROJECT-JOIN-GROUP-BY\uFF09\u6A21\u5F0F\u7684\u900F\u660E\u6539\u5199\u7B97\u6CD5\u3002\n\u8BE5\u7B97\u6CD5\u80FD\u591F\u5206\u6790 SQL \u7684\u7ED3\u6784\u4FE1\u606F\uFF0C\u81EA\u52A8\u5BFB\u627E\u5408\u9002\u7684\u7269\u5316\u89C6\u56FE\u8FDB\u884C\u900F\u660E\u6539\u5199\uFF0C\u5E76\u9009\u62E9\u6700\u4F18\u7684\u7269\u5316\u89C6\u56FE\u6765\u54CD\u5E94\u67E5\u8BE2 SQL\u3002\nDoris \u63D0\u4F9B\u4E86\u4E30\u5BCC\u4E14\u5168\u9762\u7684\u900F\u660E\u6539\u5199\u80FD\u529B\u3002\u4F8B\u5982\u4E0B\u9762\u8FD9\u4E9B\u80FD\u529B\uFF1A"}),"\n",(0,i.jsx)(e.h3,{id:"\u6761\u4EF6\u8865\u507F",children:"\u6761\u4EF6\u8865\u507F"}),"\n",(0,i.jsx)(e.p,{children:"\u67E5\u8BE2\u548C\u7269\u5316\u89C6\u56FE\u7684\u6761\u4EF6\u4E0D\u5FC5\u5B8C\u5168\u76F8\u540C\uFF0C\u901A\u8FC7\u5728\u7269\u5316\u89C6\u56FE\u4E0A\u8865\u507F\u6761\u4EF6\u6765\u8868\u8FBE\u67E5\u8BE2\uFF0C\u53EF\u4EE5\u6700\u5927\u9650\u5EA6\u5730\u590D\u7528\u7269\u5316\u89C6\u56FE\uFF0C\u4E0D\u7528\u91CD\u590D\u6784\u5EFA\u7269\u5316\u89C6\u56FE\u3002"}),"\n",(0,i.jsxs)(e.p,{children:["\u5F53\u7269\u5316\u89C6\u56FE\u548C\u67E5\u8BE2\u7684 ",(0,i.jsx)(e.code,{children:"where"})," \u6761\u4EF6\u662F\u901A\u8FC7 ",(0,i.jsx)(e.code,{children:"and"})," \u8FDE\u63A5\u7684\u8868\u8FBE\u5F0F\u65F6\uFF1A"]}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5F53\u67E5\u8BE2\u7684\u8868\u8FBE\u5F0F\u5305\u542B\u7269\u5316\u89C6\u56FE\u7684\u8868\u8FBE\u5F0F\u65F6\uFF1A"})}),"\n",(0,i.jsx)(e.p,{children:"\u53EF\u4EE5\u8FDB\u884C\u6761\u4EF6\u8865\u507F\u3002"}),"\n",(0,i.jsxs)(e.p,{children:["\u4F8B\u5982\uFF0C\u67E5\u8BE2\u662F ",(0,i.jsx)(e.code,{children:"a > 5 and b > 10 and c = 7"}),"\uFF0C\u7269\u5316\u7684\u6761\u4EF6\u662F ",(0,i.jsx)(e.code,{children:"a > 5 and b > 10"}),"\uFF0C\u7269\u5316\u89C6\u56FE\u7684\u6761\u4EF6\u662F\u67E5\u8BE2\u6761\u4EF6\u7684\u5B50\u96C6\uFF0C\u90A3\u4E48\u53EA\u9700\u8865\u507F ",(0,i.jsx)(e.code,{children:"c = 7"})," \u6761\u4EF6\u5373\u53EF\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5F53\u67E5\u8BE2\u7684\u8868\u8FBE\u5F0F\u4E0D\u5B8C\u5168\u5305\u542B\u7269\u5316\u89C6\u56FE\u7684\u8868\u8FBE\u5F0F\u65F6\uFF1A"})}),"\n",(0,i.jsxs)(e.p,{children:["\u67E5\u8BE2\u7684\u6761\u4EF6\u53EF\u4EE5\u63A8\u5BFC\u51FA\u7269\u5316\u89C6\u56FE\u7684\u6761\u4EF6\u65F6\uFF08\u5E38\u89C1\u7684\u662F\u6BD4\u8F83\u548C\u8303\u56F4\u8868\u8FBE\u5F0F\uFF0C\u5982 ",(0,i.jsx)(e.code,{children:">"}),"\u3001",(0,i.jsx)(e.code,{children:"<"}),"\u3001",(0,i.jsx)(e.code,{children:"="}),"\u3001",(0,i.jsx)(e.code,{children:"in"})," \u7B49\uFF09\uFF0C\u4E5F\u53EF\u4EE5\u8FDB\u884C\u6761\u4EF6\u8865\u507F\u3002\u8865\u507F\u7ED3\u679C\u5C31\u662F\u67E5\u8BE2\u6761\u4EF6\u672C\u8EAB\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u4F8B\u5982\uFF0C\u67E5\u8BE2\u662F ",(0,i.jsx)(e.code,{children:"a > 5 and b = 10"}),"\uFF0C\u7269\u5316\u89C6\u56FE\u662F ",(0,i.jsx)(e.code,{children:"a > 1 and b > 8"}),"\uFF0C\u53EF\u89C1\u7269\u5316\u7684\u6761\u4EF6\u5305\u542B\u4E86\u67E5\u8BE2\u7684\u6761\u4EF6\uFF0C\u67E5\u8BE2\u7684\u6761\u4EF6\u53EF\u4EE5\u63A8\u5BFC\u51FA\u7269\u5316\u89C6\u56FE\u7684\u6761\u4EF6\uFF0C\u8FD9\u6837\u4E5F\u53EF\u4EE5\u8FDB\u884C\u8865\u507F\uFF0C\u8865\u507F\u7ED3\u679C\u5C31\u662F ",(0,i.jsx)(e.code,{children:"a > 5 and b = 10"}),"\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u6761\u4EF6\u8865\u507F\u4F7F\u7528\u9650\u5236\uFF1A"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u5BF9\u4E8E\u901A\u8FC7 ",(0,i.jsx)(e.code,{children:"or"})," \u8FDE\u63A5\u7684\u8868\u8FBE\u5F0F\uFF0C\u4E0D\u80FD\u8FDB\u884C\u6761\u4EF6\u8865\u507F\uFF0C\u5FC5\u987B\u4E00\u6837\u624D\u53EF\u4EE5\u6539\u5199\u6210\u529F\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u5BF9\u4E8E ",(0,i.jsx)(e.code,{children:"like"})," \u8FD9\u79CD\u975E\u6BD4\u8F83\u548C\u8303\u56F4\u8868\u8FBE\u5F0F\uFF0C\u4E0D\u80FD\u8FDB\u884C\u6761\u4EF6\u8865\u507F\uFF0C\u5FC5\u987B\u4E00\u6837\u624D\u53EF\u4EE5\u6539\u5199\u6210\u529F\u3002"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u4F8B\u5982"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7269\u5316\u89C6\u56FE\u5B9A\u4E49\uFF1A"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv1\nBUILD IMMEDIATE REFRESH AUTO ON SCHEDULE EVERY 1 hour\nDISTRIBUTED BY RANDOM BUCKETS 3\nAS\nSELECT t1.l_linenumber,\n       o_custkey,\n       o_orderdate\nFROM (SELECT * FROM lineitem WHERE l_linenumber > 1) t1\nLEFT OUTER JOIN orders\nON l_orderkey = o_orderkey;\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5982\u4E0B\u67E5\u8BE2\u90FD\u53EF\u4EE5\u547D\u4E2D\u7269\u5316\u89C6\u56FE\uFF0C\u591A\u4E2A\u67E5\u8BE2\u901A\u8FC7\u900F\u660E\u6539\u5199\u53EF\u4EE5\u590D\u7528\u4E00\u4E2A\u7269\u5316\u89C6\u56FE\uFF0C\n\u51CF\u5C11\u67E5\u8BE2\u6539\u5199\u65F6\u95F4\uFF0C\u8282\u7701\u7269\u5316\u89C6\u56FE\u6784\u5EFA\u6210\u672C\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"SELECT l_linenumber,\n       o_custkey,\n       o_orderdate\nFROM lineitem\nLEFT OUTER JOIN orders\nON l_orderkey = o_orderkey\nWHERE l_linenumber > 2;\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"SELECT l_linenumber,\n       o_custkey,\n       o_orderdate\nFROM lineitem\nLEFT OUTER JOIN orders\nON l_orderkey = o_orderkey\nWHERE l_linenumber > 2 and o_orderdate = '2023-10-19';\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"join-\u6539\u5199",children:"JOIN \u6539\u5199"}),"\n",(0,i.jsxs)(e.p,{children:["JOIN \u6539\u5199\u6307\u7684\u662F\u67E5\u8BE2\u548C\u7269\u5316\u4F7F\u7528\u7684\u8868\u76F8\u540C\uFF0C\u53EF\u4EE5\u5728\u7269\u5316\u89C6\u56FE\u548C\u67E5\u8BE2\u7684 JOIN \u8F93\u5165\u6216\u8005 JOIN \u7684\u5916\u5C42\u5199 ",(0,i.jsx)(e.code,{children:"where"}),"\uFF0C\u4F18\u5316\u5668\u5BF9\u6B64\u6A21\u5F0F\u7684\u67E5\u8BE2\u4F1A\u5C1D\u8BD5\u8FDB\u884C\u900F\u660E\u6539\u5199\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u652F\u6301\u591A\u8868 JOIN\uFF0C\u652F\u6301\u7684 JOIN \u7C7B\u578B\u4E3A\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"INNER JOIN"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"LEFT OUTER JOIN"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"RIGHT OUTER JOIN"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"FULL OUTER JOIN"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"LEFT SEMI JOIN"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"RIGHT SEMI JOIN"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"LEFT ANTI JOIN"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"RIGHT ANTI JOIN"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u4F8B\u5982\uFF1A"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7269\u5316\u89C6\u56FE\u5B9A\u4E49\uFF1A"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv2\nBUILD IMMEDIATE REFRESH AUTO ON SCHEDULE EVERY 1 hour\nDISTRIBUTED BY RANDOM BUCKETS 3\nAS\nSELECT t1.l_linenumber,\n       o_custkey,\n       o_orderdate\nFROM (SELECT * FROM lineitem WHERE l_linenumber > 1) t1\nLEFT OUTER JOIN orders\nON l_orderkey = o_orderkey;\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5982\u4E0B\u67E5\u8BE2\u53EF\u8FDB\u884C\u900F\u660E\u6539\u5199\uFF0C\u6761\u4EF6 ",(0,i.jsx)(e.code,{children:"l_linenumber > 1"})," \u53EF\u4EE5\u4E0A\u62C9\uFF0C\u4ECE\u800C\u8FDB\u884C\u900F\u660E\u6539\u5199\uFF0C\u4F7F\u7528\u7269\u5316\u89C6\u56FE\u7684\u9884\u8BA1\u7B97\u7ED3\u679C\u6765\u8868\u8FBE\u67E5\u8BE2\u3002\n\u547D\u4E2D\u7269\u5316\u89C6\u56FE\u540E\uFF0C\u53EF\u4EE5\u8282\u7701 join \u8BA1\u7B97\u3002"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u67E5\u8BE2\u8BED\u53E5\uFF1A"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"SELECT l_linenumber,\n       o_custkey\nFROM lineitem\nLEFT OUTER JOIN orders\nON l_orderkey = o_orderkey\nWHERE l_linenumber > 1 and o_orderdate = '2023-10-18';\n"})}),"\n",(0,i.jsx)(e.h3,{id:"join-\u884D\u751F",children:"JOIN \u884D\u751F"}),"\n",(0,i.jsx)(e.p,{children:"\u5F53\u67E5\u8BE2\u548C\u7269\u5316\u89C6\u56FE\u7684 JOIN \u7C7B\u578B\u4E0D\u4E00\u81F4\u65F6\uFF0C\u5982\u679C\u7269\u5316\u89C6\u56FE\u80FD\u591F\u63D0\u4F9B\u67E5\u8BE2\u6240\u9700\u7684\u6240\u6709\u6570\u636E\uFF0C\u90A3\u4E48\u901A\u8FC7\u5728 JOIN \u7684\u5916\u90E8\u8865\u507F\u8C13\u8BCD\uFF0C\u4E5F\u53EF\u4EE5\u8FDB\u884C\u900F\u660E\u6539\u5199\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u4F8B\u5982"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7269\u5316\u89C6\u56FE\u5B9A\u4E49\uFF1A"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv3\nBUILD IMMEDIATE REFRESH AUTO ON SCHEDULE EVERY 1 hour\nDISTRIBUTED BY RANDOM BUCKETS 3\nAS\nSELECT\n    l_shipdate, l_suppkey, o_orderdate,\n    sum(o_totalprice) AS sum_total,\n    max(o_totalprice) AS max_total,\n    min(o_totalprice) AS min_total,\n    count(*) AS count_all,\n    count(distinct CASE WHEN o_shippriority > 1 AND o_orderkey IN (1, 3) THEN o_custkey ELSE null END) AS bitmap_union_basic\nFROM lineitem\nLEFT OUTER JOIN orders ON lineitem.l_orderkey = orders.o_orderkey AND l_shipdate = o_orderdate\nGROUP BY\nl_shipdate,\nl_suppkey,\no_orderdate;\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u67E5\u8BE2\u8BED\u53E5\uFF1A"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"SELECT\n    l_shipdate, l_suppkey, o_orderdate,\n    sum(o_totalprice) AS sum_total,\n    max(o_totalprice) AS max_total,\n    min(o_totalprice) AS min_total,\n    count(*) AS count_all,\n    count(distinct CASE WHEN o_shippriority > 1 AND o_orderkey IN (1, 3) THEN o_custkey ELSE null END) AS bitmap_union_basic\nFROM lineitem\nINNER JOIN orders ON lineitem.l_orderkey = orders.o_orderkey AND l_shipdate = o_orderdate\nWHERE o_orderdate = '2023-10-18' AND l_suppkey = 3\nGROUP BY\nl_shipdate,\nl_suppkey,\no_orderdate;\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u805A\u5408\u6539\u5199",children:"\u805A\u5408\u6539\u5199"}),"\n",(0,i.jsx)(e.p,{children:"\u5F53\u67E5\u8BE2\u548C\u7269\u5316\u89C6\u56FE\u5B9A\u4E49\u4E2D\u7684 group \u7EF4\u5EA6\u4E00\u81F4\u65F6\uFF0C\u5982\u679C\u7269\u5316\u89C6\u56FE\u4F7F\u7528\u7684 group by \u7EF4\u5EA6\u548C\u67E5\u8BE2\u7684 group by \u7EF4\u5EA6\u76F8\u540C\uFF0C\u5E76\u4E14\u67E5\u8BE2\u4F7F\u7528\u7684\u805A\u5408\u51FD\u6570\u53EF\u4EE5\u4F7F\u7528\u7269\u5316\u89C6\u56FE\u7684\u805A\u5408\u51FD\u6570\u6765\u8868\u793A\uFF0C\u90A3\u4E48\u53EF\u4EE5\u8FDB\u884C\u900F\u660E\u6539\u5199\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u4F8B\u5982"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7269\u5316\u89C6\u56FE\u5B9A\u4E49"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv4\nBUILD IMMEDIATE REFRESH AUTO ON SCHEDULE EVERY 1 hour\nDISTRIBUTED BY RANDOM BUCKETS 3\nAS\nSELECT\n    o_shippriority, o_comment,\n    count(distinct CASE WHEN o_shippriority > 1 AND o_orderkey IN (1, 3) THEN o_custkey ELSE null END) AS cnt_1,\n    count(distinct CASE WHEN O_SHIPPRIORITY > 2 AND o_orderkey IN (2) THEN o_custkey ELSE null END) AS cnt_2,\n    sum(o_totalprice),\n    max(o_totalprice),\n    min(o_totalprice),\n    count(*)\nFROM orders\nGROUP BY\no_shippriority,\no_comment;\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5982\u4E0B\u67E5\u8BE2\u53EF\u4EE5\u8FDB\u884C\u900F\u660E\u6539\u5199\uFF0C\u56E0\u4E3A\u67E5\u8BE2\u548C\u7269\u5316\u89C6\u56FE\u4F7F\u7528\u7684\u805A\u5408\u7EF4\u5EA6\u4E00\u81F4\uFF0C\u53EF\u4EE5\u4F7F\u7528\u7269\u5316\u89C6\u56FE ",(0,i.jsx)(e.code,{children:"o_shippriority"})," \u5B57\u6BB5\u8FDB\u884C\u8FC7\u6EE4\u7ED3\u679C\u3002\u67E5\u8BE2\u4E2D\u7684 group by \u7EF4\u5EA6\u548C\u805A\u5408\u51FD\u6570\u53EF\u4EE5\u4F7F\u7528\u7269\u5316\u89C6\u56FE\u7684 group by \u7EF4\u5EA6\u548C\u805A\u5408\u51FD\u6570\u6765\u6539\u5199\u3002\n\u547D\u4E2D\u805A\u5408\u7269\u5316\u89C6\u56FE\u540E\uFF0C\u53EF\u4EE5\u51CF\u5C11\u805A\u5408\u8BA1\u7B97\u3002"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u67E5\u8BE2\u8BED\u53E5\uFF1A"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"SELECT \n    o_shippriority, o_comment,\n    count(distinct CASE WHEN o_shippriority > 1 AND o_orderkey IN (1, 3) THEN o_custkey ELSE null END) AS cnt_1,\n    count(distinct CASE WHEN O_SHIPPRIORITY > 2 AND o_orderkey IN (2) THEN o_custkey ELSE null END) AS cnt_2,\n    sum(o_totalprice),\n    max(o_totalprice),\n    min(o_totalprice),\n    count(*)\nFROM orders\nWHERE o_shippriority in (1, 2)\nGROUP BY\no_shippriority,\no_comment;\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u805A\u5408\u6539\u5199\u4E0A\u5377",children:"\u805A\u5408\u6539\u5199\uFF08\u4E0A\u5377\uFF09"}),"\n",(0,i.jsxs)(e.p,{children:["\u5728\u67E5\u8BE2\u548C\u7269\u5316\u89C6\u56FE\u5B9A\u4E49\u4E2D\uFF0C\u5373\u4F7F\u805A\u5408\u7684\u7EF4\u5EA6\u4E0D\u4E00\u81F4\uFF0C\u4E5F\u53EF\u4EE5\u8FDB\u884C\u6539\u5199\u3002\u7269\u5316\u89C6\u56FE\u4F7F\u7528\u7684 ",(0,i.jsx)(e.code,{children:"group by"})," \u7EF4\u5EA6\u9700\u8981\u5305\u542B\u67E5\u8BE2\u7684 ",(0,i.jsx)(e.code,{children:"group by"})," \u7EF4\u5EA6\uFF0C\u800C\u67E5\u8BE2\u53EF\u4EE5\u6CA1\u6709 ",(0,i.jsx)(e.code,{children:"group by"}),"\u3002\u5E76\u4E14\uFF0C\u67E5\u8BE2\u4F7F\u7528\u7684\u805A\u5408\u51FD\u6570\u53EF\u4EE5\u7528\u7269\u5316\u89C6\u56FE\u7684\u805A\u5408\u51FD\u6570\u6765\u8868\u793A\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u4F8B\u5982"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7269\u5316\u89C6\u56FE\u5B9A\u4E49\uFF1A"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv5\nBUILD IMMEDIATE REFRESH AUTO ON SCHEDULE EVERY 1 hour\nDISTRIBUTED BY RANDOM BUCKETS 3\nAS\nSELECT\n    l_shipdate, o_orderdate, l_partkey, l_suppkey,\n    sum(o_totalprice) AS sum_total,\n    max(o_totalprice) AS max_total,\n    min(o_totalprice) AS min_total,\n    count(*) AS count_all,\n    bitmap_union(to_bitmap(CASE WHEN o_shippriority > 1 AND o_orderkey IN (1, 3) THEN o_custkey ELSE null END)) AS bitmap_union_basic\nFROM lineitem\nLEFT OUTER JOIN orders ON lineitem.l_orderkey = orders.o_orderkey AND l_shipdate = o_orderdate\nGROUP BY\nl_shipdate,\no_orderdate,\nl_partkey,\nl_suppkey;\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u4EE5\u4E0B\u67E5\u8BE2\u53EF\u4EE5\u8FDB\u884C\u900F\u660E\u6539\u5199\u3002\u67E5\u8BE2\u548C\u7269\u5316\u89C6\u56FE\u4F7F\u7528\u7684\u805A\u5408\u7EF4\u5EA6\u4E0D\u4E00\u81F4\uFF0C\u4F46\u7269\u5316\u89C6\u56FE\u4F7F\u7528\u7684\u7EF4\u5EA6\u5305\u542B\u4E86\u67E5\u8BE2\u7684\u7EF4\u5EA6\u3002\u67E5\u8BE2\u53EF\u4EE5\u4F7F\u7528\u7EF4\u5EA6\u4E2D\u7684\u5B57\u6BB5\u5BF9\u7ED3\u679C\u8FDB\u884C\u8FC7\u6EE4\u3002\u67E5\u8BE2\u4F1A\u5C1D\u8BD5\u4F7F\u7528\u7269\u5316\u89C6\u56FE ",(0,i.jsx)(e.code,{children:"SELECT"})," \u540E\u7684\u51FD\u6570\u8FDB\u884C\u4E0A\u5377\uFF0C\n\u4F8B\u5982\uFF0C\u7269\u5316\u89C6\u56FE\u7684 ",(0,i.jsx)(e.code,{children:"bitmap_union"})," \u6700\u540E\u4F1A\u4E0A\u5377\u6210 ",(0,i.jsx)(e.code,{children:"bitmap_union_count"}),"\uFF0C\u8FD9\u548C\u67E5\u8BE2\u4E2D\u7684 ",(0,i.jsx)(e.code,{children:"count(distinct)"})," \u7684\u8BED\u4E49\u4FDD\u6301\u4E00\u81F4\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u901A\u8FC7\u805A\u5408\u4E0A\u5377\uFF0C\u540C\u4E00\u4E2A\u7269\u5316\u89C6\u56FE\u53EF\u4EE5\u88AB\u591A\u4E2A\u67E5\u8BE2\u590D\u7528\uFF0C\u8282\u7701\u7269\u5316\u89C6\u56FE\u6784\u5EFA\u6210\u672C\u3002"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u67E5\u8BE2\u8BED\u53E5\uFF1A"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"SELECT\n    l_shipdate, l_suppkey,\n    sum(o_totalprice) AS sum_total,\n    max(o_totalprice) AS max_total,\n    min(o_totalprice) AS min_total,\n    count(*) AS count_all,\n    count(distinct CASE WHEN o_shippriority > 1 AND o_orderkey IN (1, 3) THEN o_custkey ELSE null END) AS bitmap_union_basic\nFROM lineitem\nLEFT OUTER JOIN orders ON lineitem.l_orderkey = orders.o_orderkey AND l_shipdate = o_orderdate\nWHERE o_orderdate = '2023-10-18' AND l_partkey = 3\nGROUP BY\nl_shipdate,\nl_suppkey;\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u76EE\u524D\u652F\u6301\u7684\u805A\u5408\u4E0A\u5377\u51FD\u6570\u5217\u8868\u5982\u4E0B\uFF1A"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u67E5\u8BE2\u4E2D\u51FD\u6570"}),(0,i.jsx)(e.th,{children:"\u7269\u5316\u89C6\u56FE\u4E2D\u51FD\u6570"}),(0,i.jsx)(e.th,{children:"\u51FD\u6570\u4E0A\u5377\u540E"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"max"}),(0,i.jsx)(e.td,{children:"max"}),(0,i.jsx)(e.td,{children:"max"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"min"}),(0,i.jsx)(e.td,{children:"min"}),(0,i.jsx)(e.td,{children:"min"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"sum"}),(0,i.jsx)(e.td,{children:"sum"}),(0,i.jsx)(e.td,{children:"sum"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"count"}),(0,i.jsx)(e.td,{children:"count"}),(0,i.jsx)(e.td,{children:"sum"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"count(distinct)"}),(0,i.jsx)(e.td,{children:"bitmap_union"}),(0,i.jsx)(e.td,{children:"bitmap_union_count"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"bitmap_union"}),(0,i.jsx)(e.td,{children:"bitmap_union"}),(0,i.jsx)(e.td,{children:"bitmap_union"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"bitmap_union_count"}),(0,i.jsx)(e.td,{children:"bitmap_union"}),(0,i.jsx)(e.td,{children:"bitmap_union_count"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"hll_union_agg, approx_count_distinct, hll_cardinality"}),(0,i.jsx)(e.td,{children:"hll_union \u6216\u8005 hll_raw_agg"}),(0,i.jsx)(e.td,{children:"hll_union_agg"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"any_value"}),(0,i.jsx)(e.td,{children:"any_value \u6216\u8005 select \u540E\u6709 any_value \u4F7F\u7528\u7684\u5217"}),(0,i.jsx)(e.td,{children:"any_value"})]})]})]}),"\n",(0,i.jsx)(e.h3,{id:"\u591A\u7EF4\u805A\u5408\u6539\u5199",children:"\u591A\u7EF4\u805A\u5408\u6539\u5199"}),"\n",(0,i.jsxs)(e.p,{children:["\u652F\u6301\u591A\u7EF4\u805A\u5408\u7684\u900F\u660E\u6539\u5199\uFF0C\u5373\u5982\u679C\u7269\u5316\u89C6\u56FE\u4E2D\u6CA1\u6709\u4F7F\u7528 ",(0,i.jsx)(e.code,{children:"GROUPING SETS"}),", ",(0,i.jsx)(e.code,{children:"CUBE"}),", ",(0,i.jsx)(e.code,{children:"ROLLUP"}),"\uFF0C\u800C\u67E5\u8BE2\u4E2D\u6709\u591A\u7EF4\u805A\u5408\uFF0C\u5E76\u4E14\u7269\u5316\u89C6\u56FE ",(0,i.jsx)(e.code,{children:"group by"})," \u540E\u7684\u5B57\u6BB5\u5305\u542B\u67E5\u8BE2\u4E2D\u591A\u7EF4\u805A\u5408\u7684\u6240\u6709\u5B57\u6BB5\uFF0C\u90A3\u4E48\u4E5F\u53EF\u4EE5\u8FDB\u884C\u900F\u660E\u6539\u5199\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u4F8B\u5982"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7269\u5316\u89C6\u56FE\u5B9A\u4E49\uFF1A"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv5_1\nBUILD IMMEDIATE REFRESH AUTO ON SCHEDULE EVERY 1 hour\nDISTRIBUTED BY RANDOM BUCKETS 3\nAS\nselect o_orderstatus, o_orderdate, o_orderpriority,\n       sum(o_totalprice) as sum_total,\n       max(o_totalprice) as max_total,\n       min(o_totalprice) as min_total,\n       count(*) as count_all\nfrom orders\ngroup by\no_orderstatus, o_orderdate, o_orderpriority;\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5982\u4E0B\u67E5\u8BE2\u53EF\u4EE5\u547D\u4E2D\u7269\u5316\u89C6\u56FE\uFF0C\u590D\u7528\u4E86\u7269\u5316\u89C6\u56FE\u7684\u805A\u5408\u7ED3\u679C\uFF0C\u8282\u7701\u8BA1\u7B97"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u67E5\u8BE2\u8BED\u53E5\uFF1A"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"select o_orderstatus, o_orderdate, o_orderpriority,\n       sum(o_totalprice),\n       max(o_totalprice),\n       min(o_totalprice),\n       count(*)\nfrom orders\ngroup by\nGROUPING SETS ((o_orderstatus, o_orderdate), (o_orderpriority), (o_orderstatus), ());\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u5206\u533A\u8865\u507F\u6539\u5199",children:"\u5206\u533A\u8865\u507F\u6539\u5199"}),"\n",(0,i.jsxs)(e.p,{children:["\u5F53\u5206\u533A\u7269\u5316\u89C6\u56FE\u4E0D\u8DB3\u4EE5\u63D0\u4F9B\u67E5\u8BE2\u7684\u6240\u6709\u6570\u636E\u65F6\uFF0C\u53EF\u4EE5\u4F7F\u7528 ",(0,i.jsx)(e.code,{children:"union all"})," \u7684\u65B9\u5F0F\uFF0C\u5C06\u67E5\u8BE2\u539F\u8868\u548C\u7269\u5316\u89C6\u56FE\u7684\u6570\u636E ",(0,i.jsx)(e.code,{children:"union all"})," \u4F5C\u4E3A\u6700\u7EC8\u8FD4\u56DE\u7ED3\u679C\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u4F8B\u5982"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7269\u5316\u89C6\u56FE\u5B9A\u4E49\uFF1A"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv7\nBUILD IMMEDIATE REFRESH AUTO ON MANUAL\npartition by(l_shipdate)\nDISTRIBUTED BY RANDOM BUCKETS 2\nas\nselect l_shipdate, o_orderdate, l_partkey,\n       l_suppkey, sum(o_totalprice) as sum_total\nfrom lineitem\nleft join orders on lineitem.l_orderkey = orders.o_orderkey and l_shipdate = o_orderdate\ngroup by\n    l_shipdate,\n    o_orderdate,\n    l_partkey,\n    l_suppkey;\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5F53\u57FA\u8868\u65B0\u589E\u5206\u533A ",(0,i.jsx)(e.code,{children:"2023-10-21"})," \u65F6\uFF0C\u5E76\u4E14\u7269\u5316\u89C6\u56FE\u8FD8\u672A\u5237\u65B0\u65F6\uFF0C\u53EF\u4EE5\u901A\u8FC7\u7269\u5316\u89C6\u56FE ",(0,i.jsx)(e.code,{children:"union all"})," \u539F\u8868\u7684\u65B9\u5F0F\u8FD4\u56DE\u7ED3\u679C\u3002"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"insert into lineitem values\n(1, 2, 3, 4, 5.5, 6.5, 7.5, 8.5, 'o', 'k', '2023-10-21', '2023-10-21', '2023-10-21', 'a', 'b', 'yyyyyyyyy');\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u67E5\u8BE2\u8BED\u53E5\uFF1A"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"select l_shipdate, o_orderdate, l_partkey, l_suppkey, sum(o_totalprice) as sum_total\nfrom lineitem\nleft join orders on lineitem.l_orderkey = orders.o_orderkey and l_shipdate = o_orderdate\ngroup by\n    l_shipdate,\n    o_orderdate,\n    l_partkey,\n    l_suppkey;\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u67E5\u8BE2\u53EF\u4EE5\u90E8\u5206\u4F7F\u7528\u7269\u5316\u9884\u8BA1\u7B97\u7684\u7ED3\u679C\uFF0C\u8282\u7701\u4E86\u8FD9\u90E8\u5206\u7684\u8BA1\u7B97\u3002"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u6539\u5199\u7ED3\u679C\u793A\u610F\uFF1A"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"SELECT *\nFROM mv7\nunion all\nselect t1.l_shipdate, o_orderdate, t1.l_partkey, t1.l_suppkey, sum(o_totalprice) as sum_total\nfrom (select * from lineitem where l_shipdate = '2023-10-21') t1\nleft join orders on t1.l_orderkey = orders.o_orderkey and t1.l_shipdate = o_orderdate\ngroup by\n    t1.l_shipdate,\n    o_orderdate,\n    t1.l_partkey,\n    t1.l_suppkey;\n"})}),"\n",(0,i.jsxs)(e.admonition,{title:"\u6CE8\u610F",type:"caution",children:[(0,i.jsxs)(e.p,{children:["\u76EE\u524D\u652F\u6301\u5206\u533A\u8865\u507F\uFF0C\u6682\u65F6\u4E0D\u652F\u6301\u5E26\u6761\u4EF6\u7684 ",(0,i.jsx)(e.code,{children:"UNION ALL"})," \u8865\u507F\u3002"]}),(0,i.jsxs)(e.p,{children:["\u6BD4\u5982\uFF0C\u5982\u679C\u7269\u5316\u89C6\u56FE\u5E26\u6709 ",(0,i.jsx)(e.code,{children:"where"})," \u6761\u4EF6\uFF0C\u4EE5\u4E0A\u8FF0\u4E3A\u4F8B\uFF0C\u5982\u679C\u6784\u5EFA\u7269\u5316\u7684\u8FC7\u6EE4\u6761\u4EF6\u52A0\u4E0A ",(0,i.jsx)(e.code,{children:" WHERE l_shipdate > '2023-10-19'"}),"\uFF0C\u800C\u67E5\u8BE2\u662F ",(0,i.jsx)(e.code,{children:"WHERE l_shipdate > '2023-10-18'"}),"\uFF0C\u76EE\u524D\u8FD9\u79CD\u8FD8\u65E0\u6CD5\u901A\u8FC7 ",(0,i.jsx)(e.code,{children:"UNION ALL"})," \u8865\u507F\uFF0C\u5F85\u652F\u6301\u3002"]})]}),"\n",(0,i.jsx)(e.admonition,{title:"\u5907\u6CE8",type:"info",children:(0,i.jsx)(e.p,{children:"\u4ECE 3.1.0 \u7248\u672C\u5F00\u59CB\n\u5206\u533A\u8865\u507F\u6539\u5199\u529F\u80FD\u652F\u6301\u4EE5\u4E0B\u7C7B\u578B\u7684\u5206\u533A\u8868\uFF1A\u5185\u8868\u3001Hive\u3001Iceberg \u4E0E Paimon\u3002\u8FD9\u610F\u5473\u7740\uFF0C\u4EC5\u5F53\u5206\u533A\u7269\u5316\u89C6\u56FE\u662F\u57FA\u4E8E\u4E0A\u8FF0\u7C7B\u578B\u7684\u5206\u533A\u8868\u6784\u5EFA\u65F6\uFF0C\u624D\u80FD\u89E6\u53D1\u5206\u533A\u8865\u507F\u6539\u5199\u673A\u5236\u3002"})}),"\n",(0,i.jsx)(e.h3,{id:"\u5D4C\u5957\u7269\u5316\u89C6\u56FE\u6539\u5199",children:"\u5D4C\u5957\u7269\u5316\u89C6\u56FE\u6539\u5199"}),"\n",(0,i.jsx)(e.p,{children:"\u7269\u5316\u89C6\u56FE\u7684\u5B9A\u4E49 SQL \u53EF\u4EE5\u4F7F\u7528\u7269\u5316\u89C6\u56FE\uFF0C\u6B64\u7269\u5316\u89C6\u56FE\u79F0\u4E3A\u5D4C\u5957\u7269\u5316\u89C6\u56FE\u3002\n\u5D4C\u5957\u7684\u5C42\u6570\u7406\u8BBA\u4E0A\u6CA1\u6709\u9650\u5236\uFF0C\u6B64\u7269\u5316\u89C6\u56FE\u65E2\u53EF\u4EE5\u76F4\u67E5\uFF0C\u4E5F\u53EF\u4EE5\u8FDB\u884C\u900F\u660E\u6539\u5199\u3002\u5D4C\u5957\u7269\u5316\u89C6\u56FE\u540C\u6837\u53EF\u4EE5\u53C2\u4E0E\u900F\u660E\u6539\u5199\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u4F8B\u5982"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsxs)(e.strong,{children:["\u521B\u5EFA\u5185\u5C42\u7269\u5316\u89C6\u56FE ",(0,i.jsx)(e.code,{children:"mv8_0_inner_mv"}),"\uFF1A"]})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv8_0_inner_mv\nBUILD IMMEDIATE REFRESH COMPLETE ON MANUAL\nDISTRIBUTED BY RANDOM BUCKETS 2\nAS\nselect\nl_linenumber,\no_custkey,\no_orderkey,\no_orderstatus,\nl_partkey,\nl_suppkey,\nl_orderkey\nfrom lineitem\ninner join orders on lineitem.l_orderkey = orders.o_orderkey;\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsxs)(e.strong,{children:["\u521B\u5EFA\u5916\u5C42\u7269\u5316\u89C6\u56FE ",(0,i.jsx)(e.code,{children:"mv8_0"}),"\uFF1A"]})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv8_0\nBUILD IMMEDIATE REFRESH COMPLETE ON MANUAL\nDISTRIBUTED BY RANDOM BUCKETS 2\nAS\nselect\nl_linenumber,\no_custkey,\no_orderkey,\no_orderstatus,\nl_partkey,\nl_suppkey,\nl_orderkey,\nps_availqty\nfrom mv8_0_inner_mv\ninner join partsupp on l_partkey = ps_partkey AND l_suppkey = ps_suppkey;\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5BF9\u4E8E\u4EE5\u4E0B\u67E5\u8BE2\uFF0C",(0,i.jsx)(e.code,{children:"mv8_0_inner_mv"})," \u548C ",(0,i.jsx)(e.code,{children:"mv8_0"})," \u90FD\u4F1A\u6210\u529F\u8FDB\u884C\u6539\u5199\uFF0C\u6700\u7EC8\u4EE3\u4EF7\u6A21\u578B\u4F1A\u9009\u62E9 ",(0,i.jsx)(e.code,{children:"mv8_0"}),"\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u5D4C\u5957\u7269\u5316\u89C6\u56FE\u5E38\u7528\u4E8E\u6570\u636E\u5EFA\u6A21\u548C\u7279\u522B\u590D\u6742\u7684\u67E5\u8BE2\uFF0C\u5982\u679C\u5355\u72EC\u6784\u5EFA\u4E00\u4E2A\u7269\u5316\u89C6\u56FE\u65E0\u6CD5\u900F\u660E\u6539\u5199\uFF0C\u53EF\u4EE5\u5C06\u590D\u6742\u7684\u67E5\u8BE2\u62C6\u5206\uFF0C\u6784\u5EFA\u5D4C\u5957\u7269\u5316\u89C6\u56FE\uFF0C\u900F\u660E\u6539\u5199\u4F1A\u5C1D\u8BD5\u4F7F\u7528\u5D4C\u5957\u7269\u5316\u89C6\u56FE\u6539\u5199\uFF0C\n\u5982\u679C\u6539\u5199\u6210\u529F\uFF0C\u4F1A\u8282\u7701\u8BA1\u7B97\uFF0C\u63D0\u9AD8\u67E5\u8BE2\u6027\u80FD\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"select lineitem.l_linenumber\nfrom lineitem\ninner join orders on l_orderkey = o_orderkey\ninner join partsupp on  l_partkey = ps_partkey AND l_suppkey = ps_suppkey\nwhere o_orderstatus = 'o'\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6CE8\u610F\uFF1A"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5D4C\u5957\u7269\u5316\u89C6\u56FE\u7684\u5C42\u6570\u8D8A\u591A\uFF0C\u900F\u660E\u6539\u5199\u7684\u8017\u65F6\u4F1A\u76F8\u5E94\u589E\u52A0\u3002\u5EFA\u8BAE\u5D4C\u5957\u7269\u5316\u89C6\u56FE\u5C42\u6570\u4E0D\u8981\u8D85\u8FC7 3 \u5C42\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5D4C\u5957\u7269\u5316\u89C6\u56FE\u900F\u660E\u6539\u5199\u9ED8\u8BA4\u5173\u95ED\uFF0C\u5F00\u542F\u65B9\u5F0F\u89C1\u4E0B\u9762\u7684\u76F8\u5173\u8BBE\u7F6E\u3002"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"\u805A\u5408\u67E5\u8BE2\u4F7F\u7528\u975E\u805A\u5408\u7269\u5316\u89C6\u56FE\u6539\u5199",children:"\u805A\u5408\u67E5\u8BE2\u4F7F\u7528\u975E\u805A\u5408\u7269\u5316\u89C6\u56FE\u6539\u5199"}),"\n",(0,i.jsx)(e.p,{children:"\u5982\u679C\u67E5\u8BE2\u662F\u805A\u5408\u67E5\u8BE2\uFF0C\u7269\u5316\u89C6\u56FE\u4E0D\u5305\u542B\u805A\u5408\uFF0C\u4F46\u662F\u7269\u5316\u89C6\u56FE\u53EF\u4EE5\u63D0\u4F9B\u67E5\u8BE2\u4F7F\u7528\u7684\u6240\u6709\u5217\uFF0C\u90A3\u4E48\u4E5F\u53EF\u4EE5\u6539\u5199\uFF0C\u6BD4\u5982\u67E5\u8BE2\u5148\u662F join\n\u8FDE\u63A5\uFF0C\u4E4B\u540E\u662F group by \u805A\u5408\uFF0C\u547D\u4E2D\u5305\u542B join \u8FDE\u63A5\u7684\u7269\u5316\u89C6\u56FE\uFF0C\u90A3\u4E48\u4E5F\u662F\u6709\u6536\u76CA\u7684\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv10_0\nBUILD IMMEDIATE REFRESH AUTO ON MANUAL\nDISTRIBUTED BY RANDOM BUCKETS 2\nas\nselect l_shipdate, o_orderdate, l_partkey,\n       l_suppkey, o_totalprice\nfrom lineitem\nleft join orders on lineitem.l_orderkey = orders.o_orderkey and l_shipdate = o_orderdate;\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5982\u4E0B\u67E5\u8BE2\u53EF\u4EE5\u547D\u4E2D mv10_0 \u7684\u7269\u5316\u89C6\u56FE\uFF0C\u8282\u7701\u4E86 ",(0,i.jsx)(e.code,{children:"lineitem join orders"})," \u8FDE\u63A5\u7684\u8BA1\u7B97"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"select l_shipdate, o_orderdate, l_partkey,\n       l_suppkey, sum(o_totalprice) as sum_total\nfrom lineitem\nleft join orders on lineitem.l_orderkey = orders.o_orderkey and l_shipdate = o_orderdate\ngroup by\n    l_shipdate,\n    o_orderdate,\n    l_partkey,\n    l_suppkey;\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u7A97\u53E3\u51FD\u6570\u6539\u5199",children:"\u7A97\u53E3\u51FD\u6570\u6539\u5199"}),"\n",(0,i.jsx)(e.p,{children:"\u5F53\u67E5\u8BE2\u548C\u7269\u5316\u89C6\u56FE\u90FD\u5305\u542B\u7A97\u53E3\u51FD\u6570\u65F6\uFF0C\u5982\u679C\u7A97\u53E3\u51FD\u6570\u7684\u5B9A\u4E49\u5B8C\u5168\u5339\u914D\uFF0C\u53EF\u4EE5\u8FDB\u884C\u900F\u660E\u6539\u5199\u3002\n\u7A97\u53E3\u51FD\u6570\u6539\u5199\u80FD\u591F\u590D\u7528\u7269\u5316\u89C6\u56FE\u4E2D\u9884\u8BA1\u7B97\u7684\u7A97\u53E3\u51FD\u6570\u7ED3\u679C,\u663E\u8457\u63D0\u5347\u5305\u542B\u590D\u6742\u7A97\u53E3\u8BA1\u7B97\u7684\u67E5\u8BE2\u6027\u80FD\u3002\n\u76EE\u524D\u652F\u6301\u6240\u6709\u7A97\u53E3\u51FD\u6570\u7684\u900F\u660E\u6539\u5199\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv11_0\nBUILD IMMEDIATE REFRESH AUTO ON MANUAL\nDISTRIBUTED BY RANDOM BUCKETS 2\nas\nselect *\nfrom (\n  select \n  o_orderkey,\n  FIRST_VALUE(o_custkey) OVER (\n        PARTITION BY o_orderdate \n        ORDER BY o_totalprice NULLS LAST\n        RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n    ) AS first_value,\n  RANK() OVER (\n        PARTITION BY o_orderdate, o_orderstatus \n        ORDER BY o_totalprice NULLS LAST\n        RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n    ) AS rank_value\n  from \n  orders\n) t\nwhere o_orderkey > 1;\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5982\u4E0B\u67E5\u8BE2\u53EF\u4EE5\u547D\u4E2D mv11_0 \u7684\u7269\u5316\u89C6\u56FE\uFF0C\u8282\u7701\u4E86\u7A97\u53E3\u51FD\u6570\u7684\u8BA1\u7B97\uFF0C\u53EF\u4EE5\u770B\u5230\u67E5\u8BE2\u4E2D\u7684\u6761\u4EF6 ",(0,i.jsx)(e.code,{children:"o_orderkey > 2"})," \u548C\u7269\u5316\u89C6\u56FE\u4E0D\u4E00\u81F4\uFF0C\u4E5F\u53EF\u4EE5\u6539\u5199\u6210\u529F"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"select *\nfrom (\n  select \n  o_orderkey,\n  FIRST_VALUE(o_custkey) OVER (\n        PARTITION BY o_orderdate \n        ORDER BY o_totalprice NULLS LAST\n        RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n    ) AS first_value,\n  RANK() OVER (\n        PARTITION BY o_orderdate, o_orderstatus \n        ORDER BY o_totalprice NULLS LAST\n        RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n    ) AS rank_value\n  from \n  orders\n) t\nwhere o_orderkey > 2;\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u53E6\u4E00\u4E2A\u4F8B\u5B50"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv11_1\nBUILD IMMEDIATE REFRESH AUTO ON MANUAL\nDISTRIBUTED BY RANDOM BUCKETS 2\nas\nselect \no_orderkey,\no_orderdate,\nFIRST_VALUE(o_custkey) OVER (\n        PARTITION BY o_orderdate \n        ORDER BY o_totalprice NULLS LAST\n        RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n    ) AS first_value,\nRANK() OVER (\n        PARTITION BY o_orderdate, o_orderstatus \n        ORDER BY o_totalprice NULLS LAST\n        RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n    ) AS rank_value\nfrom \norders\nwhere o_orderdate > '2023-12-09';\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5982\u4E0B\u67E5\u8BE2\u53EF\u4EE5\u547D\u4E2D ",(0,i.jsx)(e.code,{children:"mv11_1"})," \u7684\u7269\u5316\u89C6\u56FE\uFF0C\u8282\u7701\u4E86\u7A97\u53E3\u51FD\u6570\u7684\u8BA1\u7B97\uFF0C\u53EF\u4EE5\u770B\u5230\u67E5\u8BE2\u4E2D\u7684\u6761\u4EF6 ",(0,i.jsx)(e.code,{children:"o_orderdate > '2023-12-10'"})," \u548C\u7269\u5316\u89C6\u56FE\u5B9A\u4E49\u4E0D\u4E00\u81F4\u3002\n",(0,i.jsx)(e.code,{children:"o_orderdate"})," \u5C5E\u4E8E\u7A97\u53E3\u51FD\u6570\u7684 partition by \u5B57\u6BB5\uFF0C\u8FD9\u79CD\u60C5\u51B5\u4E0B\uFF0C\u867D\u7136\u67E5\u8BE2\u6761\u4EF6 ",(0,i.jsx)(e.code,{children:"o_orderdate > '2023-12-10'"})," \u65E9\u4E8E\nwindow \u51FD\u6570\u6267\u884C\uFF0C\u4E5F\u53EF\u4EE5\u8FDB\u884C\u900F\u660E\u6539\u5199\u3002"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"select \no_orderdate,\nFIRST_VALUE(o_custkey) OVER (\n        PARTITION BY o_orderdate \n        ORDER BY o_totalprice NULLS LAST\n        RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n    ) AS first_value,\nRANK() OVER (\n        PARTITION BY o_orderdate, o_orderstatus \n        ORDER BY o_totalprice NULLS LAST\n        RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n    ) AS rank_value\nfrom \norders\nwhere o_orderdate > '2023-12-10';\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u7528\u4F8B\u4E2D\u4F7F\u7528\u7684\u662F\u5355\u8868\uFF0C\u591A\u8868 join \u573A\u666F\u4E0B\uFF0C\u7A97\u53E3\u51FD\u6570\u6539\u5199\u540C\u6837\u9002\u7528\u3002"}),"\n",(0,i.jsx)(e.h3,{id:"limit-\u548C-topn-\u6539\u5199",children:"Limit \u548C TopN \u6539\u5199"}),"\n",(0,i.jsx)(e.p,{children:"\u5F53\u67E5\u8BE2\u5305\u542B ORDER BY \u6216 LIMIT \u5B50\u53E5\uFF0C\u6216\u8005\u4E24\u8005\u90FD\u6709\uFF08\u5373 Top-N \u67E5\u8BE2\uFF09\u65F6\uFF0C\u5982\u679C\u7269\u5316\u89C6\u56FE\u80FD\u591F\u63D0\u4F9B\u8DB3\u591F\u7684\u6570\u636E\u6765\u6EE1\u8DB3\u67E5\u8BE2\u7684 ORDER BY \u548C LIMIT \u8981\u6C42\uFF0C\n\u4F18\u5316\u5668\u53EF\u4EE5\u5229\u7528\u8BE5\u7269\u5316\u89C6\u56FE\u8FDB\u884C\u900F\u660E\u6539\u5199\u3002\u8FD9\u79CD\u6539\u5199\u80FD\u591F\u663E\u8457\u52A0\u901F\u5E38\u89C1\u7684 Top-N \u5206\u6790\u573A\u666F\u3002"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u6539\u5199\u6761\u4EF6"})}),"\n",(0,i.jsx)(e.p,{children:"ORDER BY \u6821\u9A8C\uFF1A\u67E5\u8BE2\u7684 ORDER BY \u5B50\u53E5\u5FC5\u987B\u4E0E\u7269\u5316\u89C6\u56FE\u7684 ORDER BY \u5B50\u53E5\u517C\u5BB9\u6216\u5B8C\u5168\u76F8\u540C\u3002"}),"\n",(0,i.jsx)(e.p,{children:"LIMIT \u6821\u9A8C\uFF1A\n\u5982\u679C\u7269\u5316\u89C6\u56FE\u6CA1\u6709 LIMIT\uFF0C\u4EFB\u4F55\u5E26 LIMIT \u7684\u67E5\u8BE2\u90FD\u53EF\u4EE5\u5C1D\u8BD5\u6539\u5199\u3002\n\u5982\u679C\u7269\u5316\u89C6\u56FE\u6709 LIMIT N\uFF0C\u90A3\u4E48\u67E5\u8BE2\u7684 LIMIT M \u5FC5\u987B\u6EE1\u8DB3 M <= N\uFF0C\n\u5982\u679C\u7269\u5316\u89C6\u56FE\u6709 LIMIT N OFFSET L\uFF0C\u90A3\u4E48\u67E5\u8BE2\u7684 LIMIT M OFFSET O \u5FC5\u987B\u6EE1\u8DB3 O >= L\uFF0C\u4E14 M + O <= N + L\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u7269\u5316\u89C6\u56FE\u548C\u67E5\u8BE2\u7684\u5176\u4ED6 where \u6761\u4EF6\u5E94\u8BE5\u76F8\u540C\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv11_0\nBUILD IMMEDIATE REFRESH AUTO ON MANUAL\nDISTRIBUTED BY RANDOM BUCKETS 2\nas\nselect\no_orderdate,\ncount(o_shippriority),\ncount(o_comment),\nl_orderkey,\ncount(l_partkey)\nfrom\norders\nleft join\nlineitem on l_orderkey = o_orderkey\nleft join partsupp on ps_partkey = l_partkey and l_suppkey = ps_suppkey\ngroup by o_orderdate, l_orderkey\nlimit 8 offset 1;\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5982\u4E0B\u67E5\u8BE2\u53EF\u4EE5\u547D\u4E2D mv11_0 \u7684\u7269\u5316\u89C6\u56FE\uFF0C \u6EE1\u8DB3\u4E0A\u8FF0\u7684\u6821\u9A8C\u6761\u4EF6"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"select\no_orderdate,\ncount(o_shippriority),\ncount(o_comment),\nl_orderkey,\ncount(l_partkey)\nfrom\norders\nleft join lineitem on l_orderkey = o_orderkey\nleft join partsupp on ps_partkey = l_partkey and l_suppkey = ps_suppkey\ngroup by o_orderdate, l_orderkey\nlimit 4 offset 2;\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5982\u4E0B\u67E5\u8BE2\u4E0D\u53EF\u4EE5\u547D\u4E2D mv11_0 \u7684\u7269\u5316\u89C6\u56FE\uFF0C \u56E0\u4E3A\u591A\u4E86\u4E00\u4E2A ",(0,i.jsx)(e.code,{children:"o_orderdate > '2023-12-08'"})," \u6761\u4EF6\uFF0C\u5982\u679C mv11_0 \u7269\u5316\u89C6\u56FE\u4E5F\u6709\n",(0,i.jsx)(e.code,{children:"where o_orderdate > '2023-12-08'"}),"\u6761\u4EF6\uFF0C\u90A3\u4E48\u53EF\u4EE5\u547D\u4E2D\u7269\u5316\u89C6\u56FE"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"select\no_orderdate,\ncount(o_shippriority),\ncount(o_comment),\nl_orderkey,\ncount(l_partkey)\nfrom\norders\nleft join lineitem on l_orderkey = o_orderkey\nleft join partsupp on ps_partkey = l_partkey and l_suppkey = ps_suppkey\nwhere o_orderdate > '2023-12-08'\ngroup by o_orderdate, l_orderkey\nlimit 4 offset 2;\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u53E6\u4E00\u4E2A\u4F8B\u5B50"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv11_1\nBUILD IMMEDIATE REFRESH AUTO ON MANUAL\nDISTRIBUTED BY RANDOM BUCKETS 2\nas\nselect\no_orderdate,\no_shippriority,\no_comment,\nl_orderkey,\nl_partkey,\no_orderkey\nfrom\norders left\njoin lineitem on l_orderkey = o_orderkey\nleft join partsupp on ps_partkey = l_partkey and l_suppkey = ps_suppkey\nwhere o_orderdate > '2023-12-08'\norder by o_orderkey\nlimit 4 offset 2;\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5982\u4E0B\u67E5\u8BE2\u4E2D order by + limit \u4F1A\u8F6C\u5316\u6210 topN\uFF0C\u53EF\u4EE5\u547D\u4E2D mv11_1 \u7684\u7269\u5316\u89C6\u56FE\uFF0C \u6EE1\u8DB3\u4E0A\u8FF0\u7684\u6821\u9A8C\u6761\u4EF6"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"select\no_orderdate,\no_shippriority,\no_comment,\nl_orderkey,\nl_partkey\nfrom\norders left\njoin lineitem on l_orderkey = o_orderkey\nleft join partsupp on ps_partkey = l_partkey and l_suppkey = ps_suppkey\nwhere o_orderdate > '2023-12-08'\norder by o_orderkey\nlimit 2 offset 3;\n"})}),"\n",(0,i.jsx)(e.h3,{id:"explain-\u67E5\u8BE2\u900F\u660E\u6539\u5199\u60C5\u51B5",children:"Explain \u67E5\u8BE2\u900F\u660E\u6539\u5199\u60C5\u51B5"}),"\n",(0,i.jsx)(e.p,{children:"\u67E5\u8BE2\u900F\u660E\u6539\u5199\u547D\u4E2D\u60C5\u51B5\uFF0C\u7528\u4E8E\u67E5\u770B\u548C\u8C03\u8BD5\u3002"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5982\u679C\u9700\u8981\u67E5\u770B\u7269\u5316\u89C6\u56FE\u7684\u900F\u660E\u6539\u5199\u547D\u4E2D\u60C5\u51B5\uFF0C\u8BE5\u8BED\u53E5\u4F1A\u5C55\u793A\u67E5\u8BE2\u900F\u660E\u6539\u5199\u7684\u7B80\u8981\u8FC7\u7A0B\u4FE1\u606F\u3002"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"explain <query_sql> \n"})}),"\n",(0,i.jsx)(e.p,{children:"\u8FD4\u56DE\u7684\u4FE1\u606F\u5982\u4E0B\uFF0C\u6B64\u5904\u622A\u53D6\u4E86\u4E0E\u7269\u5316\u89C6\u56FE\u76F8\u5173\u7684\u4FE1\u606F\uFF1A"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"| MaterializedView                                                                                                                                                                                                                                      |\n| MaterializedViewRewriteSuccessAndChose:                                                                                                                                                                                                               |\n|   Names: mv5                                                                                                                                                                                                                                          |\n| MaterializedViewRewriteSuccessButNotChose:                                                                                                                                                                                                            |\n|                                                                                                                                                                                                                                                       |\n| MaterializedViewRewriteFail:                                                                                                                                                                                                                          |\n|   Name: mv4                                                                                                                                                                                                                                           |\n|   FailSummary: Match mode is invalid, View struct info is invalid                                                                                                                                                                                     |\n|   Name: mv3                                                                                                                                                                                                                                           |\n|   FailSummary: Match mode is invalid, Rewrite compensate predicate by view fail, View struct info is invalid                                                                                                                                          |\n|   Name: mv1                                                                                                                                                                                                                                           |\n|   FailSummary: The columns used by query are not in view, View struct info is invalid                                                                                                                                                                 |\n|   Name: mv2                                                                                                                                                                                                                                           |\n|   FailSummary: The columns used by query are not in view, View struct info is invalid\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["MaterializedViewRewriteSuccessAndChose\uFF1A\u8868\u793A\u900F\u660E\u6539\u5199\u6210\u529F\uFF0C\u5E76\u4E14 CBO\uFF08Cost-Based Optimizer\uFF09\u9009\u62E9\u7684\u7269\u5316\u89C6\u56FE\u540D\u79F0\u5217\u8868\u3002\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"MaterializedViewRewriteSuccessButNotChose\uFF1A\u8868\u793A\u900F\u660E\u6539\u5199\u6210\u529F\uFF0C\u4F46\u662F\u6700\u7EC8 CBO \u6CA1\u6709\u9009\u62E9\u7684\u7269\u5316\u89C6\u56FE\u540D\u79F0\u5217\u8868\u3002"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:"MaterializedViewRewriteFail\uFF1A\u5217\u4E3E\u900F\u660E\u6539\u5199\u5931\u8D25\u7684\u60C5\u51B5\u53CA\u539F\u56E0\u6458\u8981\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.ol,{start:"2",children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5982\u679C\u60F3\u4E86\u89E3\u7269\u5316\u89C6\u56FE\u7684\u5019\u9009\u3001\u6539\u5199\u4EE5\u53CA\u6700\u7EC8\u9009\u62E9\u60C5\u51B5\u7684\u8BE6\u7EC6\u8FC7\u7A0B\u4FE1\u606F\uFF0C\u53EF\u4EE5\u6267\u884C\u5982\u4E0B\u8BED\u53E5\uFF1A"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"explain memo plan <query_sql>\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"\u7EF4\u62A4\u7269\u5316\u89C6\u56FE",children:"\u7EF4\u62A4\u7269\u5316\u89C6\u56FE"}),"\n",(0,i.jsx)(e.h3,{id:"\u6743\u9650\u8BF4\u660E-1",children:"\u6743\u9650\u8BF4\u660E"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5220\u9664\u7269\u5316\u89C6\u56FE\uFF1A\u9700\u8981\u5177\u6709\u7269\u5316\u89C6\u56FE\u7684\u5220\u9664\u6743\u9650\uFF08\u4E0E\u5220\u9664\u8868\u6743\u9650\u76F8\u540C\uFF09\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4FEE\u6539\u7269\u5316\u89C6\u56FE\uFF1A\u9700\u8981\u5177\u6709\u7269\u5316\u89C6\u56FE\u7684\u4FEE\u6539\u6743\u9650\uFF08\u4E0E\u4FEE\u6539\u8868\u6743\u9650\u76F8\u540C\uFF09\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6682\u505C/\u6062\u590D/\u53D6\u6D88/\u5237\u65B0\u7269\u5316\u89C6\u56FE\uFF1A\u9700\u8981\u5177\u6709\u7269\u5316\u89C6\u56FE\u7684\u521B\u5EFA\u6743\u9650\u3002"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"\u7269\u5316\u89C6\u56FE\u4FEE\u6539",children:"\u7269\u5316\u89C6\u56FE\u4FEE\u6539"}),"\n",(0,i.jsx)(e.h4,{id:"\u4FEE\u6539\u7269\u5316\u89C6\u56FE\u5C5E\u6027",children:"\u4FEE\u6539\u7269\u5316\u89C6\u56FE\u5C5E\u6027"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:'ALTER MATERIALIZED VIEW mv_1\nSET(\n  "grace_period" = "10"\n);\n'})}),"\n",(0,i.jsx)(e.h4,{id:"\u7269\u5316\u89C6\u56FE\u91CD\u547D\u540D\u5373\u7269\u5316\u89C6\u56FE\u539F\u5B50\u66FF\u6362",children:"\u7269\u5316\u89C6\u56FE\u91CD\u547D\u540D\uFF0C\u5373\u7269\u5316\u89C6\u56FE\u539F\u5B50\u66FF\u6362"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"\nCREATE MATERIALIZED VIEW mv9_0\nBUILD IMMEDIATE REFRESH COMPLETE ON MANUAL\nDISTRIBUTED BY RANDOM BUCKETS 2\nPROPERTIES ('replication_num' = '1') \nAS\nselect\n  l_linenumber,\n  o_custkey,\n  o_orderkey,\n  o_orderstatus,\n  l_partkey,\n  l_suppkey,\n  l_orderkey\nfrom lineitem\ninner join orders on lineitem.l_orderkey = orders.o_orderkey;\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u4F7F\u7528 mv9_0 \u7684\u7269\u5316\u89C6\u56FE\u66FF\u6362 mv7\uFF0C\u5E76\u4E14\u5220\u9664 mv7\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"ALTER MATERIALIZED VIEW mv7\nREPLACE WITH MATERIALIZED VIEW mv9_0\nPROPERTIES('swap' = 'false');\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u7269\u5316\u89C6\u56FE\u5220\u9664",children:"\u7269\u5316\u89C6\u56FE\u5220\u9664"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"DROP MATERIALIZED VIEW mv_1;\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u8BE6\u60C5\u53C2\u8003 ",(0,i.jsx)(e.a,{href:"../../../sql-manual/sql-statements/table-and-view/async-materialized-view/DROP-ASYNC-MATERIALIZED-VIEW",children:"DROP ASYNC MATERIALIZED VIEW"})]}),"\n",(0,i.jsx)(e.h3,{id:"\u67E5\u770B\u7269\u5316\u89C6\u56FE\u521B\u5EFA\u8BED\u53E5",children:"\u67E5\u770B\u7269\u5316\u89C6\u56FE\u521B\u5EFA\u8BED\u53E5"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"SHOW CREATE MATERIALIZED VIEW mv_1;\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u8BE6\u60C5\u53C2\u8003 ",(0,i.jsx)(e.a,{href:"../../../sql-manual/sql-statements/table-and-view/sync-materialized-view/SHOW-CREATE-MATERIALIZED-VIEW",children:"SHOW CREATE MATERIALIZED VIEW"})]}),"\n",(0,i.jsx)(e.h3,{id:"\u6682\u505C\u7269\u5316\u89C6\u56FE",children:"\u6682\u505C\u7269\u5316\u89C6\u56FE"}),"\n",(0,i.jsxs)(e.p,{children:["\u8BE6\u60C5\u53C2\u8003 ",(0,i.jsx)(e.a,{href:"../../../sql-manual/sql-statements/table-and-view/async-materialized-view/PAUSE-MATERIALIZED-VIEW-JOB",children:"PAUSE MATERIALIZED VIEW"})]}),"\n",(0,i.jsx)(e.h3,{id:"\u542F\u7528\u7269\u5316\u89C6\u56FE",children:"\u542F\u7528\u7269\u5316\u89C6\u56FE"}),"\n",(0,i.jsxs)(e.p,{children:["\u8BE6\u60C5\u53C2\u8003 ",(0,i.jsx)(e.a,{href:"../../../sql-manual/sql-statements/table-and-view/async-materialized-view/RESUME-MATERIALIZED-VIEW-JOB",children:"RESUME MATERIALIZED VIEW"})]}),"\n",(0,i.jsx)(e.h3,{id:"\u53D6\u6D88\u7269\u5316\u89C6\u56FE\u5237\u65B0\u4EFB\u52A1",children:"\u53D6\u6D88\u7269\u5316\u89C6\u56FE\u5237\u65B0\u4EFB\u52A1"}),"\n",(0,i.jsxs)(e.p,{children:["\u8BE6\u60C5\u53C2\u8003 ",(0,i.jsx)(e.a,{href:"../../../sql-manual/sql-statements/table-and-view/async-materialized-view/CANCEL-MATERIALIZED-VIEW-TASK",children:"CANCEL MATERIALIZED VIEW TASK"})]}),"\n",(0,i.jsx)(e.h3,{id:"\u67E5\u8BE2\u7269\u5316\u89C6\u56FE\u4FE1\u606F",children:"\u67E5\u8BE2\u7269\u5316\u89C6\u56FE\u4FE1\u606F"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"SELECT * \nFROM mv_infos('database'='db_name')\nWHERE Name = 'mv_name' \\G \n"})}),"\n",(0,i.jsx)(e.p,{children:"\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"*************************** 1. row ***************************\n                Id: 139570\n              Name: mv11\n           JobName: inner_mtmv_139570\n             State: NORMAL\nSchemaChangeDetail: \n      RefreshState: SUCCESS\n       RefreshInfo: BUILD IMMEDIATE REFRESH AUTO ON MANUAL\n          QuerySql: SELECT l_shipdate, l_orderkey, O_ORDERDATE, count(*)\nFROM lineitem  \nLEFT OUTER JOIN orders on l_orderkey = o_orderkey\nGROUP BY l_shipdate, l_orderkey, O_ORDERDATE\n           EnvInfo: EnvInfo{ctlId='0', dbId='16813'}\n      MvProperties: {}\n   MvPartitionInfo: MTMVPartitionInfo{partitionType=FOLLOW_BASE_TABLE, relatedTable=lineitem, relatedCol='l_shipdate', partitionCol='l_shipdate'}\nSyncWithBaseTables: 1\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"SyncWithBaseTables\uFF1A"})," \u8868\u793A\u7269\u5316\u89C6\u56FE\u548C\u57FA\u8868\u7684\u6570\u636E\u662F\u5426\u4E00\u81F4\u3002"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5BF9\u4E8E\u5168\u91CF\u6784\u5EFA\u7684\u7269\u5316\u89C6\u56FE\uFF0C\u6B64\u5B57\u6BB5\u4E3A 1\uFF0C\u8868\u660E\u6B64\u7269\u5316\u89C6\u56FE\u53EF\u7528\u4E8E\u900F\u660E\u6539\u5199\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u5BF9\u4E8E\u5206\u533A\u589E\u91CF\u7684\u7269\u5316\u89C6\u56FE\uFF0C\u5206\u533A\u7269\u5316\u89C6\u56FE\u662F\u5426\u53EF\u7528\uFF0C\u662F\u4EE5\u5206\u533A\u7C92\u5EA6\u53BB\u770B\u7684\u3002\u4E5F\u5C31\u662F\u8BF4\uFF0C\u5373\u4F7F\u7269\u5316\u89C6\u56FE\u7684\u90E8\u5206\u5206\u533A\u4E0D\u53EF\u7528\uFF0C\u4F46\u53EA\u8981\u67E5\u8BE2\u7684\u662F\u6709\u6548\u5206\u533A\uFF0C\u90A3\u4E48\u6B64\u7269\u5316\u89C6\u56FE\u4F9D\u65E7\u53EF\u7528\u4E8E\u900F\u660E\u6539\u5199\u3002\u662F\u5426\u80FD\u900F\u660E\u6539\u5199\uFF0C\u4E3B\u8981\u770B\u67E5\u8BE2\u6240\u7528\u5206\u533A\u7684 ",(0,i.jsx)(e.code,{children:"SyncWithBaseTables"})," \u5B57\u6BB5\u662F\u5426\u4E00\u81F4\u3002\u5982\u679C ",(0,i.jsx)(e.code,{children:"SyncWithBaseTables"})," \u662F 1\uFF0C\u6B64\u5206\u533A\u53EF\u7528\u4E8E\u900F\u660E\u6539\u5199\uFF1B\u5982\u679C\u662F 0\uFF0C\u5219\u4E0D\u80FD\u7528\u4E8E\u900F\u660E\u6539\u5199\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"JobName\uFF1A"})," \u7269\u5316\u89C6\u56FE\u6784\u5EFA Job \u7684\u540D\u79F0\uFF0C\u6BCF\u4E2A\u7269\u5316\u89C6\u56FE\u6709\u4E00\u4E2A Job\uFF0C\u6BCF\u6B21\u5237\u65B0\u4F1A\u6709\u4E00\u4E2A\u65B0\u7684 Task\uFF0CJob \u548C Task \u662F 1:n \u7684\u5173\u7CFB"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"State\uFF1A"})," \u5982\u679C\u53D8\u4E3A SCHEMA_CHANGE\uFF0C\u4EE3\u8868\u57FA\u8868\u7684 Schema \u53D1\u751F\u4E86\u53D8\u5316\uFF0C\u6B64\u65F6\u7269\u5316\u89C6\u56FE\u5C06\u4E0D\u80FD\u7528\u6765\u900F\u660E\u6539\u5199 (\u4F46\u662F\u4E0D\u5F71\u54CD\u76F4\u63A5\u67E5\u8BE2\u7269\u5316\u89C6\u56FE)\uFF0C\u4E0B\u6B21\u5237\u65B0\u4EFB\u52A1\u5982\u679C\u6267\u884C\u6210\u529F\uFF0C\u5C06\u6062\u590D\u4E3A NORMAL\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"SchemaChangeDetail\uFF1A"})," \u8868\u793A SCHEMA_CHANGE \u53D1\u751F\u7684\u539F\u56E0\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"RefreshState\uFF1A"})," \u7269\u5316\u89C6\u56FE\u6700\u540E\u4E00\u6B21\u4EFB\u52A1\u5237\u65B0\u7684\u72B6\u6001\u3002\u5982\u679C\u4E3A FAIL\uFF0C\u4EE3\u8868\u6267\u884C\u5931\u8D25\uFF0C\u53EF\u4EE5\u901A\u8FC7 ",(0,i.jsx)(e.code,{children:"tasks() "}),"\u547D\u4EE4\u8FDB\u4E00\u6B65\u5B9A\u4F4D\u5931\u8D25\u539F\u56E0\u3002Task \u547D\u4EE4\u89C1\u672C\u6587[\u67E5\u8BE2\u5237\u65B0\u4EFB\u52A1 TASK \u4FE1\u606F](### \u67E5\u8BE2\u5237\u65B0\u4EFB\u52A1 TASK \u4FE1\u606F)\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"SyncWithBaseTables\uFF1A"})," \u662F\u5426\u548C\u57FA\u8868\u6570\u636E\u540C\u6B65\u30021 \u4E3A\u540C\u6B65\uFF0C0 \u4E3A\u4E0D\u540C\u6B65\u3002\u5982\u679C\u4E0D\u540C\u6B65\uFF0C\u53EF\u901A\u8FC7 ",(0,i.jsx)(e.code,{children:"show partitions"})," \u8FDB\u4E00\u6B65\u5224\u65AD\u54EA\u4E2A\u5206\u533A\u4E0D\u540C\u6B65\u3002",(0,i.jsx)(e.code,{children:"show partitions"})," \u89C1\u4E0B\u6587\u5206\u533A\u7269\u5316\u89C6\u56FE\u67E5\u770B SyncWithBaseTables \u72B6\u6001\u65B9\u6CD5\u3002"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u5BF9\u4E8E\u900F\u660E\u6539\u5199\uFF0C\u901A\u5E38\u7269\u5316\u89C6\u56FE\u4F1A\u51FA\u73B0\u4E24\u79CD\u72B6\u6001\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u72B6\u6001\u6B63\u5E38\uFF1A"})," \u6307\u7684\u662F\u5F53\u524D\u7269\u5316\u89C6\u56FE\u662F\u5426\u53EF\u7528\u4E8E\u900F\u660E\u6539\u5199\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u4E0D\u53EF\u7528\u3001\u72B6\u6001\u4E0D\u6B63\u5E38\uFF1A"})," \u6307\u7684\u662F\u7269\u5316\u89C6\u56FE\u4E0D\u80FD\u7528\u4E8E\u900F\u660E\u6539\u5199\u7684\u7B80\u79F0\u3002\u5C3D\u7BA1\u5982\u6B64\uFF0C\u8BE5\u7269\u5316\u89C6\u56FE\u8FD8\u662F\u53EF\u4EE5\u76F4\u67E5\u7684\u3002"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u8BE6\u60C5\u53C2\u8003 ",(0,i.jsx)(e.a,{href:"../../../sql-manual/sql-functions/table-valued-functions/mv_infos",children:"MV_INFOS"})]}),"\n",(0,i.jsx)(e.h3,{id:"\u67E5\u8BE2\u5237\u65B0\u4EFB\u52A1-task-\u4FE1\u606F",children:"\u67E5\u8BE2\u5237\u65B0\u4EFB\u52A1 TASK \u4FE1\u606F"}),"\n",(0,i.jsx)(e.p,{children:"\u6BCF\u4E2A\u7269\u5316\u89C6\u56FE\u6709\u4E00\u4E2A Job\uFF0C\u6BCF\u6B21\u5237\u65B0\u4F1A\u6709\u4E00\u4E2A\u65B0\u7684 Task\uFF0CJob \u548C Task \u662F 1:n \u7684\u5173\u7CFB\u3002\n\u6839\u636E\u7269\u5316\u89C6\u56FE\u540D\u79F0\u67E5\u770B\u7269\u5316\u89C6\u56FE\u7684 Task \u72B6\u6001\uFF0C\u8FD0\u884C\u5982\u4E0B\u8BED\u53E5\uFF0C\u53EF\u4EE5\u67E5\u770B\u5237\u65B0\u4EFB\u52A1\u7684\u72B6\u6001\u548C\u8FDB\u5EA6\uFF1A"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"SELECT * \nFROM tasks(\"type\"=\"mv\")\nWHERE\nMvDatabaseName = 'mv_db_name' and    \nmvName = 'mv_name'\nORDER BY  CreateTime DESC \\G\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:'*************************** 1. row ***************************\n               TaskId: 167019363907545\n                JobId: 139872\n              JobName: inner_mtmv_139570\n                 MvId: 139570\n               MvName: mv11\n         MvDatabaseId: 16813\n       MvDatabaseName: regression_test_nereids_rules_p0_mv\n               Status: SUCCESS\n             ErrorMsg: \n           CreateTime: 2024-06-21 10:31:43\n            StartTime: 2024-06-21 10:31:43\n           FinishTime: 2024-06-21 10:31:45\n           DurationMs: 2466\n          TaskContext: {"triggerMode":"SYSTEM","isComplete":false}\n          RefreshMode: COMPLETE\nNeedRefreshPartitions: ["p_20231023_20231024","p_20231019_20231020","p_20231020_20231021","p_20231027_20231028","p_20231030_20231031","p_20231018_20231019","p_20231024_20231025","p_20231021_20231022","p_20231029_20231030","p_20231028_20231029","p_20231025_20231026","p_20231022_20231023","p_20231031_20231101","p_20231016_20231017","p_20231026_20231027"]\n  CompletedPartitions: ["p_20231023_20231024","p_20231019_20231020","p_20231020_20231021","p_20231027_20231028","p_20231030_20231031","p_20231018_20231019","p_20231024_20231025","p_20231021_20231022","p_20231029_20231030","p_20231028_20231029","p_20231025_20231026","p_20231022_20231023","p_20231031_20231101","p_20231016_20231017","p_20231026_20231027"]\n             Progress: 100.00% (15/15)\n          LastQueryId: fe700ca3d6504521-bb522fc9ccf615e3\n'})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"NeedRefreshPartitions\uFF0CCompletedPartitions \u8BB0\u5F55\u7684\u662F\u6B64\u6B21 Task \u5237\u65B0\u7684\u5206\u533A\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Status\uFF1A\u5982\u679C\u4E3A FAILED\uFF0C\u4EE3\u8868\u8FD0\u884C\u5931\u8D25\uFF0C\u53EF\u901A\u8FC7 ErrorMsg \u67E5\u770B\u5931\u8D25\u539F\u56E0\uFF0C\u4E5F\u53EF\u901A\u8FC7 LastQueryId \u6765\u641C\u7D22 Doris \u7684\u65E5\u5FD7\uFF0C\u83B7\u53D6\u66F4\u8BE6\u7EC6\u7684\u9519\u8BEF\u4FE1\u606F\u3002\u76EE\u524D\u4EFB\u52A1\u5931\u8D25\u4F1A\u5BFC\u81F4\u5DF2\u6709\u7269\u5316\u89C6\u56FE\u4E0D\u53EF\u7528\uFF0C\u540E\u9762\u4F1A\u6539\u6210\u5C3D\u7BA1\u4EFB\u52A1\u5931\u8D25\uFF0C\u4F46\u662F\u5DF2\u5B58\u5728\u7684\u7269\u5316\u89C6\u56FE\u53EF\u7528\u4E8E\u900F\u660E\u6539\u5199\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"ErrorMsg\uFF1A\u5931\u8D25\u539F\u56E0\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"RefreshMode\uFF1ACOMPLETE \u4EE3\u8868\u5237\u65B0\u4E86\u5168\u90E8\u5206\u533A\uFF0CPARTIAL \u4EE3\u8868\u5237\u65B0\u4E86\u90E8\u5206\u5206\u533A\uFF0CNOT_REFRESH \u4EE3\u8868\u4E0D\u9700\u8981\u5237\u65B0\u4EFB\u4F55\u5206\u533A\u3002"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.admonition,{title:"\u5907\u6CE8",type:"info",children:(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u76EE\u524D task \u5B58\u50A8\u548C\u5C55\u793A\u7684\u6570\u91CF\u9ED8\u8BA4\u662F 100\u4E2A\uFF0C\u53EF\u4EE5\u901A\u8FC7\u5728 fe.conf \u6587\u4EF6\u4E2D\u914D\u7F6E max_persistence_task_count \u4FEE\u6539\u6570\u91CF\uFF0C\u8D85\u8FC7\u8FD9\u4E2A\n\u6570\u91CF\u5C06\u4F1A\u4E22\u5F03\u65E7\u7684 task \u8BB0\u5F55, \u5982\u679C\u503C < 1, \u5C06\u4E0D\u4F1A\u6301\u4E45\u5316\u3002\u4FEE\u6539\u5B8C\u914D\u7F6E\u540E\u9700\u8981\u91CD\u542F FE \u624D\u80FD\u751F\u6548\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u5982\u679C\u7269\u5316\u89C6\u56FE\u521B\u5EFA\u7684\u65F6\u5019\u8BBE\u7F6E\u4E86 ",(0,i.jsx)(e.code,{children:"grace_period"})," \u5C5E\u6027\uFF0C\u90A3\u4E48\u5373\u4F7F ",(0,i.jsx)(e.code,{children:"SyncWithBaseTables"})," \u662F false \u6216\u8005 0\uFF0C\u6709\u4E9B\u60C5\u51B5\u4E0B\u5B83\u4F9D\u7136\u53EF\u7528\u4E8E\u900F\u660E\u6539\u5199\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"grace_period"})," \u7684\u5355\u4F4D\u662F\u79D2\uFF0C\u6307\u7684\u662F\u5BB9\u8BB8\u7269\u5316\u89C6\u56FE\u548C\u6240\u7528\u57FA\u8868\u6570\u636E\u4E0D\u4E00\u81F4\u7684\u65F6\u95F4\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5982\u679C\u8BBE\u7F6E\u6210 0\uFF0C\u610F\u5473\u7740\u8981\u6C42\u7269\u5316\u89C6\u56FE\u548C\u57FA\u8868\u6570\u636E\u4FDD\u6301\u4E00\u81F4\uFF0C\u6B64\u7269\u5316\u89C6\u56FE\u624D\u53EF\u7528\u4E8E\u900F\u660E\u6539\u5199\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5982\u679C\u8BBE\u7F6E\u6210 10\uFF0C\u610F\u5473\u7740\u7269\u5316\u89C6\u56FE\u548C\u57FA\u8868\u6570\u636E\u5141\u8BB8 10 \u79D2\u7684\u5EF6\u8FDF\uFF0C\u5982\u679C\u7269\u5316\u89C6\u56FE\u7684\u6570\u636E\u548C\u57FA\u8868\u7684\u6570\u636E\u6709\u5EF6\u8FDF\uFF0C\u5728 10 \u79D2\u5185\uFF0C\u6B64\u7269\u5316\u89C6\u56FE\u90FD\u53EF\u4EE5\u7528\u4E8E\u900F\u660E\u6539\u5199\u3002"}),"\n"]}),"\n"]})}),"\n",(0,i.jsxs)(e.p,{children:["\u8BE6\u60C5\u53C2\u8003 ",(0,i.jsx)(e.a,{href:"../../../sql-manual/sql-functions/table-valued-functions/tasks",children:"TASKS"})]}),"\n",(0,i.jsx)(e.h3,{id:"\u67E5\u8BE2\u7269\u5316\u89C6\u56FE\u5BF9\u5E94\u7684-job",children:"\u67E5\u8BE2\u7269\u5316\u89C6\u56FE\u5BF9\u5E94\u7684 JOB"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:'SELECT * \nFROM jobs("type"="mv") \nWHERE Name="inner_mtmv_75043";\n'})}),"\n",(0,i.jsxs)(e.p,{children:["\u8BE6\u60C5\u53C2\u8003 ",(0,i.jsx)(e.a,{href:"../../../sql-manual/sql-functions/table-valued-functions/jobs",children:"JOBS"})]}),"\n",(0,i.jsx)(e.h3,{id:"\u67E5\u8BE2\u7269\u5316\u89C6\u56FE\u7684\u5206\u533A\u4FE1\u606F",children:"\u67E5\u8BE2\u7269\u5316\u89C6\u56FE\u7684\u5206\u533A\u4FE1\u606F\uFF1A"}),"\n",(0,i.jsx)(e.p,{children:"\u5206\u533A\u7269\u5316\u89C6\u56FE\u67E5\u770B SyncWithBaseTables \u72B6\u6001\u65B9\u6CD5"}),"\n",(0,i.jsxs)(e.p,{children:["\u8FD0\u884C ",(0,i.jsx)(e.code,{children:"show partitions from mv_name"}),"\u67E5\u770B\u67E5\u8BE2\u4F7F\u7528\u7684\u5206\u533A\u662F\u5426\u6709\u6548\uFF0C\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-Plain",children:"show partitions from mv11;\n+-------------+---------------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+-----------+------------+-------------------------+-----------+--------------------+--------------+\n| PartitionId | PartitionName       | VisibleVersion | VisibleVersionTime  | State  | PartitionKey | Range                                                                          | DistributionKey | Buckets | ReplicationNum | StorageMedium | CooldownTime        | RemoteStoragePolicy | LastConsistencyCheckTime | DataSize  | IsInMemory | ReplicaAllocation       | IsMutable | SyncWithBaseTables | UnsyncTables |\n+-------------+---------------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+-----------+------------+-------------------------+-----------+--------------------+--------------+\n| 140189      | p_20231016_20231017 | 1              | 2024-06-21 10:31:45 | NORMAL | l_shipdate   | [types: [DATEV2]; keys: [2023-10-16]; ..types: [DATEV2]; keys: [2023-10-17]; ) | l_orderkey      | 10      | 1              | HDD           | 9999-12-31 23:59:59 |                     | NULL                     | 0.000     | false      | tag.location.default: 1 | true      | true               | []           |\n| 139995      | p_20231018_20231019 | 2              | 2024-06-21 10:31:44 | NORMAL | l_shipdate   | [types: [DATEV2]; keys: [2023-10-18]; ..types: [DATEV2]; keys: [2023-10-19]; ) | l_orderkey      | 10      | 1              | HDD           | 9999-12-31 23:59:59 |                     | NULL                     | 880.000 B | false      | tag.location.default: 1 | true      | true               | []           |\n| 139898      | p_20231019_20231020 | 2              | 2024-06-21 10:31:43 | NORMAL | l_shipdate   | [types: [DATEV2]; keys: [2023-10-19]; ..types: [DATEV2]; keys: [2023-10-20]; ) | l_orderkey      | 10      | 1              | HDD           | 9999-12-31 23:59:59 |                     | NULL                     | 878.000 B | false      | tag.location.default: 1 | true      | true               | []           |\n+-------------+---------------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+-----------+------------+-------------------------+-----------+--------------------+--------------+\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u4E3B\u8981\u67E5\u770B ",(0,i.jsx)(e.code,{children:"SyncWithBaseTables"})," \u5B57\u6BB5\u662F\u5426\u4E3A true\u3002false \u8868\u793A\u6B64\u5206\u533A\u4E0D\u53EF\u7528\u4E8E\u900F\u660E\u6539\u5199\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u8BE6\u60C5\u53C2\u8003 ",(0,i.jsx)(e.a,{href:"../../../sql-manual/sql-statements/table-and-view/table/SHOW-PARTITIONS",children:"SHOW PARTITIONS"})]}),"\n",(0,i.jsx)(e.h3,{id:"\u67E5\u770B\u7269\u5316\u89C6\u56FE\u8868\u7ED3\u6784",children:"\u67E5\u770B\u7269\u5316\u89C6\u56FE\u8868\u7ED3\u6784"}),"\n",(0,i.jsxs)(e.p,{children:["\u8BE6\u60C5\u53C2\u8003 ",(0,i.jsx)(e.a,{href:"../../../sql-manual/sql-statements/table-and-view/table/DESC-TABLE",children:"DESCRIBE"})]}),"\n",(0,i.jsx)(e.h3,{id:"\u76F8\u5173\u914D\u7F6E",children:"\u76F8\u5173\u914D\u7F6E"}),"\n",(0,i.jsx)(e.h4,{id:"session-variables-\u5F00\u5173",children:"Session Variables \u5F00\u5173"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u5F00\u5173"}),(0,i.jsx)(e.th,{children:"\u8BF4\u660E"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"SET enable_nereids_planner = true;"}),(0,i.jsx)(e.td,{children:"\u5F02\u6B65\u7269\u5316\u89C6\u56FE\u53EA\u6709\u5728\u65B0\u4F18\u5316\u5668\u4E0B\u624D\u652F\u6301\uFF0C\u6240\u4EE5\u7269\u5316\u89C6\u56FE\u900F\u660E\u6539\u5199\u6CA1\u6709\u751F\u6548\u65F6\uFF0C\u9700\u8981\u5F00\u542F\u65B0\u4F18\u5316\u5668"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"SET enable_materialized_view_rewrite = true;"}),(0,i.jsx)(e.td,{children:"\u5F00\u542F\u6216\u8005\u5173\u95ED\u67E5\u8BE2\u900F\u660E\u6539\u5199\uFF0C\u4ECE 2.1.5 \u7248\u672C\u5F00\u59CB\u9ED8\u8BA4\u5F00\u542F"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"SET materialized_view_rewrite_enable_contain_external_table = true;"}),(0,i.jsx)(e.td,{children:"\u53C2\u4E0E\u900F\u660E\u6539\u5199\u7684\u7269\u5316\u89C6\u56FE\u662F\u5426\u5141\u8BB8\u5305\u542B\u5916\u8868\uFF0C\u9ED8\u8BA4\u4E0D\u5141\u8BB8\uFF0C\u5982\u679C\u7269\u5316\u89C6\u56FE\u7684\u5B9A\u4E49 SQL \u4E2D\u5305\u542B\u5916\u8868\uFF0C\u4E5F\u60F3\u53C2\u4E0E\u5230\u900F\u660E\u6539\u5199\uFF0C\u53EF\u4EE5\u6253\u5F00\u6B64\u5F00\u5173\u3002"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"SET materialized_view_rewrite_success_candidate_num = 3;"}),(0,i.jsx)(e.td,{children:"\u900F\u660E\u6539\u5199\u6210\u529F\u7684\u7ED3\u679C\u96C6\u5408\uFF0C\u5141\u8BB8\u53C2\u4E0E\u5230 CBO \u5019\u9009\u7684\u6700\u5927\u6570\u91CF\uFF0C\u9ED8\u8BA4\u662F 3\u3002\u5982\u679C\u53D1\u73B0\u900F\u660E\u6539\u5199\u7684\u6027\u80FD\u5F88\u6162\uFF0C\u53EF\u4EE5\u8003\u8651\u628A\u8FD9\u4E2A\u503C\u8C03\u5C0F\u3002"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"SET enable_materialized_view_union_rewrite = true;"}),(0,i.jsx)(e.td,{children:"\u5F53\u5206\u533A\u7269\u5316\u89C6\u56FE\u4E0D\u8DB3\u4EE5\u63D0\u4F9B\u67E5\u8BE2\u7684\u5168\u90E8\u6570\u636E\u65F6\uFF0C\u662F\u5426\u5141\u8BB8\u57FA\u8868\u548C\u7269\u5316\u89C6\u56FE union all \u6765\u54CD\u5E94\u67E5\u8BE2\uFF0C\u9ED8\u8BA4\u5141\u8BB8\u3002\u5982\u679C\u53D1\u73B0\u547D\u4E2D\u7269\u5316\u89C6\u56FE\u65F6\u6570\u636E\u9519\u8BEF\uFF0C\u53EF\u4EE5\u628A\u6B64\u5F00\u5173\u5173\u95ED\u3002"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"SET enable_materialized_view_nest_rewrite = true;"}),(0,i.jsx)(e.td,{children:"\u662F\u5426\u5141\u8BB8\u5D4C\u5957\u6539\u5199\uFF0C\u9ED8\u8BA4\u4E0D\u5141\u8BB8\u3002\u5982\u679C\u67E5\u8BE2 SQL \u5F88\u590D\u6742\uFF0C\u9700\u8981\u6784\u5EFA\u5D4C\u5957\u7269\u5316\u89C6\u56FE\u624D\u53EF\u4EE5\u547D\u4E2D\uFF0C\u90A3\u4E48\u9700\u8981\u6253\u5F00\u6B64\u5F00\u5173\u3002"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"SET materialized_view_relation_mapping_max_count = 8;"}),(0,i.jsx)(e.td,{children:"\u900F\u660E\u6539\u5199\u8FC7\u7A0B\u4E2D\uFF0Crelation mapping \u6700\u5927\u5141\u8BB8\u6570\u91CF\uFF0C\u5982\u679C\u8D85\u8FC7\uFF0C\u8FDB\u884C\u622A\u53D6\u3002relation mapping \u901A\u5E38\u7531\u8868\u81EA\u5173\u8054\u4EA7\u751F\uFF0C\u6570\u91CF\u4E00\u822C\u4F1A\u662F\u7B1B\u5361\u5C14\u79EF\uFF0C\u6BD4\u5982 3 \u5F20\u8868\uFF0C\u53EF\u80FD\u4F1A\u4EA7\u751F 8 \u79CD\u7EC4\u5408\u3002\u9ED8\u8BA4\u662F 8\u3002\u5982\u679C\u53D1\u73B0\u900F\u660E\u6539\u5199\u65F6\u95F4\u5F88\u957F\uFF0C\u53EF\u4EE5\u628A\u8FD9\u4E2A\u503C\u8C03\u4F4E"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"SET enable_dml_materialized_view_rewrite = true;"}),(0,i.jsx)(e.td,{children:"DML \u65F6\uFF0C\u662F\u5426\u5F00\u542F\u57FA\u4E8E\u7ED3\u6784\u4FE1\u606F\u7684\u7269\u5316\u89C6\u56FE\u900F\u660E\u6539\u5199\uFF0C\u9ED8\u8BA4\u5F00\u542F"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"SET enable_dml_materialized_view_rewrite_when_base_table_unawareness = true;"}),(0,i.jsx)(e.td,{children:"DML \u65F6\uFF0C\u5F53\u7269\u5316\u89C6\u56FE\u5B58\u5728\u65E0\u6CD5\u5B9E\u65F6\u611F\u77E5\u6570\u636E\u7684\u5916\u8868\u65F6\uFF0C\u662F\u5426\u5F00\u542F\u57FA\u4E8E\u7ED3\u6784\u4FE1\u606F\u7684\u7269\u5316\u89C6\u56FE\u900F\u660E\u6539\u5199\uFF0C\u9ED8\u8BA4\u5173\u95ED"})]})]})]}),"\n",(0,i.jsx)(e.h4,{id:"feconf-\u914D\u7F6E",children:"fe.conf \u914D\u7F6E"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"job_mtmv_task_consumer_thread_num\uFF1A"})," \u6B64\u53C2\u6570\u63A7\u5236\u540C\u65F6\u8FD0\u884C\u7684\u7269\u5316\u89C6\u56FE\u5237\u65B0\u4EFB\u52A1\u6570\u91CF\uFF0C\u9ED8\u8BA4\u662F 10\uFF0C\u8D85\u8FC7\u8FD9\u4E2A\u6570\u91CF\u7684\u4EFB\u52A1\u5C06\u5904\u4E8E pending \u72B6\u6001\n\u4FEE\u6539\u8FD9\u4E2A\u53C2\u6570\u9700\u8981\u91CD\u542F FE \u624D\u53EF\u4EE5\u751F\u6548\u3002"]}),"\n"]})]})}function h(n={}){let{wrapper:e}={...(0,s.a)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(a,{...n})}):a(n)}},250065:function(n,e,r){r.d(e,{Z:function(){return o},a:function(){return d}});var l=r(667294);let i={},s=l.createContext(i);function d(n){let e=l.useContext(s);return l.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:d(n.components),l.createElement(s.Provider,{value:e},n.children)}}}]);