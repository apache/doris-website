"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["276211"],{611920:function(n,e,r){r.r(e),r.d(e,{default:()=>j,frontMatter:()=>i,metadata:()=>d,assets:()=>t,toc:()=>h,contentTitle:()=>c});var d=JSON.parse('{"id":"admin-manual/workload-management/spill-disk","title":"\u843D\u76D8","description":"Doris \u7684\u8BA1\u7B97\u5C42\u662F\u4E00\u4E2AMPP\u7684\u67B6\u6784\uFF0C\u6240\u6709\u7684\u8BA1\u7B97\u4EFB\u52A1\u90FD\u662F\u5728BE\u7684\u5185\u5B58\u4E2D\u5B8C\u6210\u7684\uFF0C\u5404\u4E2ABE\u4E4B\u95F4\u4E5F\u662F\u901A\u8FC7\u5185\u5B58\u6765\u5B8C\u6210\u6570\u636E\u4EA4\u6362\uFF0C\u6240\u4EE5\u5185\u5B58\u7BA1\u7406\u5BF9\u67E5\u8BE2\u7684\u7A33\u5B9A\u6027\u6709\u81F3\u5173\u91CD\u8981\u7684\u5F71\u54CD\uFF0C\u4ECE\u7EBF\u4E0A\u67E5\u8BE2\u7EDF\u8BA1\u770B\uFF0C\u6709\u4E00\u5927\u90E8\u5206\u7684\u67E5\u8BE2\u62A5\u9519\u4E5F\u662F\u8DDF\u5185\u5B58\u76F8\u5173\u3002\u5F53\u524D\u8D8A\u6765\u8D8A\u591A\u7684\u7528\u6237\u5C06ETL \u6570\u636E\u52A0\u5DE5\uFF0C\u591A\u8868\u7269\u5316\u89C6\u56FE\u5904\u7406\uFF0C\u590D\u6742\u7684AdHoc\u67E5\u8BE2\u7B49\u4EFB\u52A1\u8FC1\u79FB\u5230Doris \u4E0A\u8FD0\u884C\uFF0C\u6240\u4EE5\uFF0C\u9700\u8981\u5C06\u4E2D\u95F4\u64CD\u4F5C\u7ED3\u679C\u5378\u8F7D\u5230\u78C1\u76D8\u4E0A\uFF0C\u4F7F\u90A3\u4E9B\u6240\u9700\u5185\u5B58\u91CF\u8D85\u51FA\u6BCF\u4E2A\u67E5\u8BE2\u6216\u6BCF\u4E2A\u8282\u70B9\u9650\u5236\u7684\u67E5\u8BE2\u80FD\u591F\u5F97\u4EE5\u6267\u884C\u3002\u5177\u4F53\u6765\u8BF4\uFF0C\u5F53\u5904\u7406\u5927\u578B\u6570\u636E\u96C6\u6216\u6267\u884C\u590D\u6742\u67E5\u8BE2\u65F6\uFF0C\u5185\u5B58\u6D88\u8017\u53EF\u80FD\u4F1A\u8FC5\u901F\u589E\u52A0\uFF0C\u8D85\u51FA\u5355\u4E2A\u8282\u70B9\u6216\u6574\u4E2A\u67E5\u8BE2\u5904\u7406\u8FC7\u7A0B\u4E2D\u53EF\u7528\u7684\u5185\u5B58\u9650\u5236\u3002Doris\u901A\u8FC7\u5C06\u5176\u4E2D\u7684\u4E2D\u95F4\u7ED3\u679C\uFF08\u5982\u805A\u5408\u7684\u4E2D\u95F4\u72B6\u6001\u3001\u6392\u5E8F\u7684\u4E34\u65F6\u6570\u636E\u7B49\uFF09\u5199\u5165\u78C1\u76D8\uFF0C\u800C\u4E0D\u662F\u5B8C\u5168\u4F9D\u8D56\u5185\u5B58\u6765\u5B58\u50A8\u8FD9\u4E9B\u6570\u636E\uFF0C\u4ECE\u800C\u7F13\u89E3\u4E86\u5185\u5B58\u538B\u529B\u3002\u8FD9\u6837\u505A\u6709\u51E0\u4E2A\u597D\u5904\uFF1A","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs/current/admin-manual/workload-management/spill-disk.md","sourceDirName":"admin-manual/workload-management","slug":"/admin-manual/workload-management/spill-disk","permalink":"/zh-CN/docs/dev/admin-manual/workload-management/spill-disk","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"\u843D\u76D8","language":"zh-CN"},"sidebar":"docs","previous":{"title":"\u5E76\u53D1\u63A7\u5236\u4E0E\u6392\u961F","permalink":"/zh-CN/docs/dev/admin-manual/workload-management/concurrency-control-and-queuing"},"next":{"title":"\u67E5\u8BE2\u7194\u65AD","permalink":"/zh-CN/docs/dev/admin-manual/workload-management/sql-blocking"}}'),l=r("785893"),s=r("250065");let i={title:"\u843D\u76D8",language:"zh-CN"},c="\u6982\u8FF0",t={},h=[{value:"BE \u8FDB\u7A0B\u5185\u5B58\u914D\u7F6E",id:"be-\u8FDB\u7A0B\u5185\u5B58\u914D\u7F6E",level:2},{value:"Workload group \u5185\u5B58\u914D\u7F6E",id:"workload-group-\u5185\u5B58\u914D\u7F6E",level:2},{value:"Query \u5185\u5B58\u7BA1\u7406",id:"query-\u5185\u5B58\u7BA1\u7406",level:2},{value:"\u9759\u6001\u5185\u5B58\u5206\u914D",id:"\u9759\u6001\u5185\u5B58\u5206\u914D",level:3},{value:"\u57FA\u4E8ESlot\u7684\u5185\u5B58\u5206\u914D",id:"\u57FA\u4E8Eslot\u7684\u5185\u5B58\u5206\u914D",level:3},{value:"\u5F00\u542F\u67E5\u8BE2\u4E2D\u95F4\u7ED3\u679C\u843D\u76D8",id:"\u5F00\u542F\u67E5\u8BE2\u4E2D\u95F4\u7ED3\u679C\u843D\u76D8",level:2},{value:"BE\u914D\u7F6E\u9879",id:"be\u914D\u7F6E\u9879",level:3},{value:"FE Session Variable",id:"fe-session-variable",level:3},{value:"Workload Group",id:"workload-group",level:3},{value:"\u76D1\u6D4B\u843D\u76D8",id:"\u76D1\u6D4B\u843D\u76D8",level:2},{value:"\u5BA1\u8BA1\u65E5\u5FD7",id:"\u5BA1\u8BA1\u65E5\u5FD7",level:3},{value:"Profile",id:"profile",level:3},{value:"\u7CFB\u7EDF\u8868",id:"\u7CFB\u7EDF\u8868",level:3},{value:"backend_active_tasks",id:"backend_active_tasks",level:4},{value:"\u6D4B\u8BD5\u73AF\u5883",id:"\u6D4B\u8BD5\u73AF\u5883",level:2},{value:"\u673A\u5668\u914D\u7F6E",id:"\u673A\u5668\u914D\u7F6E",level:3},{value:"\u6D4B\u8BD5\u6570\u636E",id:"\u6D4B\u8BD5\u6570\u636E",level:3},{value:"\u6D4B\u8BD5\u7ED3\u679C",id:"\u6D4B\u8BD5\u7ED3\u679C",level:2},{value:"\u5355\u5E76\u53D1",id:"\u5355\u5E76\u53D1",level:3}];function x(n){let e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.a)(),...n.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.header,{children:(0,l.jsx)(e.h1,{id:"\u6982\u8FF0",children:"\u6982\u8FF0"})}),"\n",(0,l.jsxs)(e.p,{children:["Doris \u7684\u8BA1\u7B97\u5C42\u662F\u4E00\u4E2AMPP\u7684\u67B6\u6784\uFF0C\u6240\u6709\u7684\u8BA1\u7B97\u4EFB\u52A1\u90FD\u662F\u5728BE\u7684\u5185\u5B58\u4E2D\u5B8C\u6210\u7684\uFF0C\u5404\u4E2ABE\u4E4B\u95F4\u4E5F\u662F\u901A\u8FC7\u5185\u5B58\u6765\u5B8C\u6210\u6570\u636E\u4EA4\u6362\uFF0C\u6240\u4EE5\u5185\u5B58\u7BA1\u7406\u5BF9\u67E5\u8BE2\u7684\u7A33\u5B9A\u6027\u6709\u81F3\u5173\u91CD\u8981\u7684\u5F71\u54CD\uFF0C\u4ECE\u7EBF\u4E0A\u67E5\u8BE2\u7EDF\u8BA1\u770B\uFF0C\u6709\u4E00\u5927\u90E8\u5206\u7684\u67E5\u8BE2\u62A5\u9519\u4E5F\u662F\u8DDF\u5185\u5B58\u76F8\u5173\u3002",(0,l.jsx)(e.strong,{children:"\u5F53\u524D\u8D8A\u6765\u8D8A\u591A\u7684\u7528\u6237\u5C06ETL \u6570\u636E\u52A0\u5DE5\uFF0C\u591A\u8868\u7269\u5316\u89C6\u56FE\u5904\u7406\uFF0C\u590D\u6742\u7684AdHoc\u67E5\u8BE2"}),"\u7B49\u4EFB\u52A1\u8FC1\u79FB\u5230Doris \u4E0A\u8FD0\u884C\uFF0C\u6240\u4EE5\uFF0C\u9700\u8981\u5C06\u4E2D\u95F4\u64CD\u4F5C\u7ED3\u679C\u5378\u8F7D\u5230\u78C1\u76D8\u4E0A\uFF0C\u4F7F\u90A3\u4E9B\u6240\u9700\u5185\u5B58\u91CF\u8D85\u51FA\u6BCF\u4E2A\u67E5\u8BE2\u6216\u6BCF\u4E2A\u8282\u70B9\u9650\u5236\u7684\u67E5\u8BE2\u80FD\u591F\u5F97\u4EE5\u6267\u884C\u3002\u5177\u4F53\u6765\u8BF4\uFF0C\u5F53\u5904\u7406\u5927\u578B\u6570\u636E\u96C6\u6216\u6267\u884C\u590D\u6742\u67E5\u8BE2\u65F6\uFF0C\u5185\u5B58\u6D88\u8017\u53EF\u80FD\u4F1A\u8FC5\u901F\u589E\u52A0\uFF0C\u8D85\u51FA\u5355\u4E2A\u8282\u70B9\u6216\u6574\u4E2A\u67E5\u8BE2\u5904\u7406\u8FC7\u7A0B\u4E2D\u53EF\u7528\u7684\u5185\u5B58\u9650\u5236\u3002Doris\u901A\u8FC7\u5C06\u5176\u4E2D\u7684\u4E2D\u95F4\u7ED3\u679C\uFF08\u5982\u805A\u5408\u7684\u4E2D\u95F4\u72B6\u6001\u3001\u6392\u5E8F\u7684\u4E34\u65F6\u6570\u636E\u7B49\uFF09\u5199\u5165\u78C1\u76D8\uFF0C\u800C\u4E0D\u662F\u5B8C\u5168\u4F9D\u8D56\u5185\u5B58\u6765\u5B58\u50A8\u8FD9\u4E9B\u6570\u636E\uFF0C\u4ECE\u800C\u7F13\u89E3\u4E86\u5185\u5B58\u538B\u529B\u3002\u8FD9\u6837\u505A\u6709\u51E0\u4E2A\u597D\u5904\uFF1A"]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u6269\u5C55\u6027\uFF1A\u5141\u8BB8Doris\u5904\u7406\u6BD4\u5355\u4E2A\u8282\u70B9\u5185\u5B58\u9650\u5236\u5927\u5F97\u591A\u7684\u6570\u636E\u96C6\u3002"}),"\n",(0,l.jsx)(e.li,{children:"\u7A33\u5B9A\u6027\uFF1A\u51CF\u5C11\u56E0\u5185\u5B58\u4E0D\u8DB3\u5BFC\u81F4\u7684\u67E5\u8BE2\u5931\u8D25\u6216\u7CFB\u7EDF\u5D29\u6E83\u7684\u98CE\u9669\u3002"}),"\n",(0,l.jsx)(e.li,{children:"\u7075\u6D3B\u6027\uFF1A\u4F7F\u5F97\u7528\u6237\u80FD\u591F\u5728\u4E0D\u589E\u52A0\u786C\u4EF6\u8D44\u6E90\u7684\u60C5\u51B5\u4E0B\uFF0C\u6267\u884C\u66F4\u590D\u6742\u7684\u67E5\u8BE2\u3002"}),"\n"]}),"\n",(0,l.jsx)(e.p,{children:"\u4E3A\u4E86\u907F\u514D\u7533\u8BF7\u5185\u5B58\u65F6\u89E6\u53D1OOM\uFF0CDoris \u5F15\u5165\u4E86reserve memory\u673A\u5236\uFF0C\u8FD9\u4E2A\u673A\u5236\u7684\u5DE5\u4F5C\u6D41\u7A0B\u5982\u4E0B\uFF1A"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"Doris\u5728\u6267\u884C\u8FC7\u7A0B\u4E2D\uFF0C\u4F1A\u9884\u4F30\u6BCF\u6B21\u5904\u7406\u4E00\u4E2ABlock \u9700\u8981\u7684\u5185\u5B58\u5927\u5C0F\uFF0C\u7136\u540E\u5230\u4E00\u4E2A\u7EDF\u4E00\u7684\u5185\u5B58\u7BA1\u7406\u5668\u4E2D\u53BB\u7533\u8BF7\uFF1B"}),"\n",(0,l.jsx)(e.li,{children:"\u5168\u5C40\u7684\u5185\u5B58\u5206\u914D\u5668\u4F1A\u5224\u65AD\u5F53\u524D\u5185\u5B58\u7533\u8BF7\uFF0C\u662F\u5426\u8D85\u8FC7\u4E86Query\u3001Workload Group\u6216\u8005\u6574\u4E2A\u8FDB\u7A0B\u7684\u5185\u5B58\u9650\u5236\uFF0C\u5982\u679C\u8D85\u8FC7\u4E86\uFF0C\u90A3\u4E48\u5C31\u8FD4\u56DE\u5931\u8D25\uFF1B"}),"\n",(0,l.jsx)(e.li,{children:"Doris \u5728\u6536\u5230\u5931\u8D25\u6D88\u606F\u65F6\uFF0C\u4F1A\u5C06\u5F53\u524DQuery \u6302\u8D77\uFF0C\u7136\u540E\u9009\u62E9\u6700\u5927\u7684\u7B97\u5B50\u8FDB\u884C\u843D\u76D8\uFF0C\u7B49\u5230\u843D\u76D8\u7ED3\u675F\u540E\uFF0CQuery\u518D\u7EE7\u7EED\u6267\u884C\u3002"}),"\n"]}),"\n",(0,l.jsx)(e.p,{children:"\u76EE\u524D\u652F\u6301\u843D\u76D8\u7684\u7B97\u5B50\u6709\uFF1A"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"Hash Join\u7B97\u5B50"}),"\n",(0,l.jsx)(e.li,{children:"\u805A\u5408\u7B97\u5B50"}),"\n",(0,l.jsx)(e.li,{children:"\u6392\u5E8F\u7B97\u5B50"}),"\n",(0,l.jsx)(e.li,{children:"CTE"}),"\n"]}),"\n",(0,l.jsxs)(e.p,{children:["\u5F53\u67E5\u8BE2\u89E6\u53D1\u843D\u76D8\u65F6\uFF0C\u7531\u4E8E\u4F1A\u6709\u989D\u5916\u7684\u786C\u76D8\u8BFB\u5199\u64CD\u4F5C\uFF0C\u67E5\u8BE2\u65F6\u95F4\u53EF\u80FD\u4F1A\u663E\u8457\u589E\u957F\uFF0C\u5EFA\u8BAE\u8C03\u5927FE Session\u53D8\u91CF",(0,l.jsx)(e.code,{children:"query_timeout"}),"\u3002\u540C\u65F6\u843D\u76D8\u4F1A\u6709\u6BD4\u8F83\u5927\u7684\u78C1\u76D8IO\uFF0C\u5EFA\u8BAE\u5355\u72EC\u914D\u7F6E\u4E00\u4E2A\u78C1\u76D8\u76EE\u5F55\u6216\u8005\u4F7F\u7528SSD\u78C1\u76D8\u964D\u4F4E\u67E5\u8BE2\u843D\u76D8\u5BF9\u6B63\u5E38\u7684\u5BFC\u5165\u6216\u8005\u67E5\u8BE2\u7684\u5F71\u54CD\u3002\u76EE\u524D\u67E5\u8BE2\u843D\u76D8\u529F\u80FD\u9ED8\u8BA4\u5173\u95ED\u3002"]}),"\n",(0,l.jsx)(e.h1,{id:"\u5185\u5B58\u7BA1\u7406\u673A\u5236",children:"\u5185\u5B58\u7BA1\u7406\u673A\u5236"}),"\n",(0,l.jsx)(e.p,{children:"Doris \u7684\u5185\u5B58\u7BA1\u7406\u5206\u4E3A\u4E09\u4E2A\u7EA7\u522B\uFF1A \u8FDB\u7A0B\u7EA7\u522B\u3001WorkloadGroup \u7EA7\u522B\u3001Query \u7EA7\u522B\u3002"}),"\n",(0,l.jsx)(e.h2,{id:"be-\u8FDB\u7A0B\u5185\u5B58\u914D\u7F6E",children:"BE \u8FDB\u7A0B\u5185\u5B58\u914D\u7F6E"}),"\n",(0,l.jsxs)(e.p,{children:["\u6574\u4E2ABE \u8FDB\u7A0B\u7684\u5185\u5B58\u7531be.conf\u4E2D\u7684\u53C2\u6570",(0,l.jsx)(e.code,{children:"mem_limit"})," \u63A7\u5236\uFF0C\u4E00\u65E6Doris \u4F7F\u7528\u7684\u5185\u5B58\u8D85\u8FC7\u8FD9\u4E2A\u9608\u503C\uFF0CDoris \u5C31\u4F1A\u628A\u5F53\u524D\u6B63\u5728\u7533\u8BF7\u5185\u5B58\u7684Query \u53D6\u6D88\uFF0C\u540C\u65F6\u540E\u53F0\u4E5F\u4F1A\u6709\u4E00\u4E2A\u5B9A\u65F6\u4EFB\u52A1\uFF0C\u5F02\u6B65\u7684Kill \u4E00\u90E8\u5206 Query\u6765\u91CA\u653E\u5185\u5B58 \u6216\u8005 \u91CA\u653E\u4E00\u4E9BCache\u3002\u6240\u4EE5Doris \u5185\u90E8\u7684\u5404\u79CD\u7BA1\u7406\u64CD\u4F5C\uFF08\u6BD4\u5982spill disk \uFF0C flush memtable\u7B49\uFF09\u9700\u8981\u5728\u5FEB\u63A5\u8FD1\u8FD9\u4E2A\u9608\u503C\u7684\u65F6\u5019\uFF0C\u5C31\u9700\u8981\u8FD0\u884C\uFF0C\u5C3D\u53EF\u80FD\u7684\u907F\u514D\u5185\u5B58\u8FBE\u5230\u8FD9\u4E2A\u9608\u503C\uFF0C\u4E00\u65E6\u5230\u8FBE\u8FD9\u4E2A\u9608\u503C\uFF0C\u4E3A\u4E86\u907F\u514D\u6574\u4E2A\u8FDB\u7A0BOOM\uFF0CDoris \u4F1A\u91C7\u53D6\u4E00\u4E9B\u975E\u5E38\u66B4\u529B\u7684\u81EA\u6211\u4FDD\u62A4\u63AA\u65BD\u3002"]}),"\n",(0,l.jsxs)(e.p,{children:["\u5F53Doris\u7684BE\u8DDF\u5176\u4ED6\u7684\u8FDB\u7A0B\u6DF7\u90E8\uFF08\u6BD4\u5982Doris FE \u3001Kafka\u3001HDFS\uFF09\u7684\u65F6\u5019\uFF0C\u4F1A\u5BFC\u81F4Doris BE \u5B9E\u9645\u53EF\u7528\u7684\u5185\u5B58\u8FDC\u5C0F\u4E8E\u7528\u6237\u8BBE\u7F6E\u7684",(0,l.jsx)(e.code,{children:"mem_limit"})," \u5BFC\u81F4\u5185\u90E8\u7684\u91CA\u653E\u5185\u5B58\u673A\u5236\u5931\u6548\uFF0C\u7136\u540E\u5BFC\u81F4Doris \u8FDB\u7A0B\u88AB\u64CD\u4F5C\u7CFB\u7EDF\u7684OOM Killer \u6740\u6B7B\u3002"]}),"\n",(0,l.jsx)(e.p,{children:"\u5F53Doris \u8FDB\u7A0B\u90E8\u7F72\u5728K8S\u91CC\u6216\u8005\u7528Cgroup \u7BA1\u7406\u7684\u65F6\u5019\uFF0CDoris \u4F1A\u81EA\u52A8\u611F\u77E5\u5BB9\u5668\u7684\u5185\u5B58\u914D\u7F6E\u3002"}),"\n",(0,l.jsx)(e.h2,{id:"workload-group-\u5185\u5B58\u914D\u7F6E",children:"Workload group \u5185\u5B58\u914D\u7F6E"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"max_memory_percent\uFF0C\u610F\u5473\u7740\u5F53\u8BF7\u6C42\u5728\u8BE5\u6C60\u4E2D\u8FD0\u884C\u65F6\uFF0C\u5B83\u4EEC\u5360\u7528\u7684\u5185\u5B58\u7EDD\u4E0D\u4F1A\u8D85\u8FC7\u603B\u5185\u5B58\u7684\u8FD9\u4E00\u767E\u5206\u6BD4\uFF0C\u4E00\u65E6\u8D85\u8FC7\u90A3\u4E48Query \u5C06\u4F1A\u89E6\u53D1\u843D\u76D8\u6216\u8005\u88ABKill\u3002"}),"\n",(0,l.jsx)(e.li,{children:"min_memory_percent\uFF0C\u4E3A\u67D0\u4E2A\u6C60\u8BBE\u7F6E\u6700\u5C0F\u5185\u5B58\u503C\uFF0C\u5F53\u8D44\u6E90\u7A7A\u95F2\u65F6\uFF0C\u53EF\u4EE5\u4F7F\u7528\u8D85\u8FC7MIN_MEMORY_PERCENT\u7684\u5185\u5B58\uFF0C\u4F46\u662F\u5F53\u5185\u5B58\u4E0D\u8DB3\u65F6\uFF0C\u7CFB\u7EDF\u5C06\u6309\u7167min_memory_percent\uFF08\u6700\u5C0F\u5185\u5B58\u767E\u5206\u6BD4\uFF09\u5206\u914D\u5185\u5B58\uFF0C\u53EF\u80FD\u4F1A\u9009\u53D6\u4E00\u4E9BQuery Kill\uFF0C\u5C06Workload Group \u7684\u5185\u5B58\u4F7F\u7528\u91CF\u964D\u4F4E\u5230min_memory_percent\uFF0C\u4EE5\u786E\u4FDD\u5176\u4ED6Workload Group\u6709\u8DB3\u591F\u7684\u5185\u5B58\u53EF\u7528\u3002"}),"\n",(0,l.jsx)(e.li,{children:"\u6240\u6709\u7684Workload Group\u7684 MIN_MEMORY_PERCENT \u4E4B\u548C\u4E0D\u80FD\u8D85\u8FC7 100%\uFF0C\u5E76\u4E14 MIN_MEMORY_PERCENT \u4E0D\u80FD\u5927\u4E8E MAX_MEMORY_PERCENT\u3002"}),"\n",(0,l.jsx)(e.li,{children:"memory_low_watermark: \u9ED8\u8BA4\u662F80%\u3002\u8868\u793A\u5F53\u524Dworkload group\u7684\u5185\u5B58\u4F7F\u7528\u7387\u4F4E\u6C34\u4F4D\u7EBF\u3002"}),"\n",(0,l.jsx)(e.li,{children:"memory_high_watermark\uFF1A\u9ED8\u8BA4\u662F95%\u3002\u8868\u793A\u5F53\u524Dworkload group\u7684\u5185\u5B58\u4F7F\u7528\u7387\u9AD8\u6C34\u4F4D\u7EBF\u3002workload group\u7684\u5185\u5B58\u4F7F\u7528\u7387\u5927\u4E8E\u6B64\u503C\u65F6\uFF0Creserve memory\u4F1A\u5931\u8D25\uFF0C\u89E6\u53D1\u67E5\u8BE2\u843D\u76D8\u3002"}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"query-\u5185\u5B58\u7BA1\u7406",children:"Query \u5185\u5B58\u7BA1\u7406"}),"\n",(0,l.jsx)(e.h3,{id:"\u9759\u6001\u5185\u5B58\u5206\u914D",children:"\u9759\u6001\u5185\u5B58\u5206\u914D"}),"\n",(0,l.jsx)(e.p,{children:"Query \u8FD0\u884C\u7684\u5185\u5B58\u53D7exec_mem_limit\u8FD9\u4E2A\u53C2\u6570\u63A7\u5236\uFF0C\u5728query \u8FD0\u884C\u4E4B\u524D\u7528\u6237\u5C31\u9700\u8981\u5728session variable \u91CC\u8BBE\u7F6E\u597D\uFF0C\u8FD0\u884C\u671F\u95F4\u4E0D\u80FD\u591F\u52A8\u6001\u4FEE\u6539\u3002"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"exec_mem_limit\uFF0C\u8868\u793A\u4E00\u4E2Aquery \u6700\u5927\u53EF\u4EE5\u4F7F\u7528\u7684\u5185\u5B58\uFF0C\u9ED8\u8BA4\u503C100G\uFF1B\u8FD9\u4E2A\u503C\u57283.1 \u7248\u672C\u4E4B\u524D\uFF0C\u9ED8\u8BA4\u503C\u662F2G\uFF0C\u5B9E\u9645\u504F\u5C0F\uFF0C\u5927\u90E8\u5206\u67E5\u8BE2\u90FD\u9700\u8981\u8D85\u8FC72G\u7684\u5185\u5B58\uFF0C\u7531\u4E8E\u8FD9\u4E2A\u53C2\u6570\u5E76\u6CA1\u6709\u771F\u6B63\u5728BE\u7AEF\u751F\u6548\uFF0C\u6240\u4EE5\u5BF9\u67E5\u8BE2\u5E76\u6CA1\u6709\u5F71\u54CD\uFF1B\u57283.1 \u7248\u672C\u4E4B\u540E\uFF0C\u5F53\u67E5\u8BE2\u4F7F\u7528\u7684\u5185\u5B58\u8FBE\u5230\u8FD9\u4E2A\u9650\u5236\u65F6\uFF0C\u67E5\u8BE2\u4F1A\u88ABCancel\u6216\u8005\u89E6\u53D1\u843D\u76D8\uFF0C\u6240\u4EE5\u5728\u5347\u7EA7\u4E4B\u524D\u7528\u6237\u9700\u8981\u628A\u8FD9\u4E2A\u9ED8\u8BA4\u503C\u6539\u4E3A100G\u3002"}),"\n"]}),"\n",(0,l.jsx)(e.h3,{id:"\u57FA\u4E8Eslot\u7684\u5185\u5B58\u5206\u914D",children:"\u57FA\u4E8ESlot\u7684\u5185\u5B58\u5206\u914D"}),"\n",(0,l.jsx)(e.p,{children:"\u9759\u6001\u5185\u5B58\u5206\u914D\u65B9\u5F0F\uFF0C\u5728\u4F7F\u7528\u8FC7\u7A0B\u4E2D\u6211\u4EEC\u53D1\u73B0\uFF0C\u5F88\u591A\u65F6\u5019\u7528\u6237\u4E0D\u77E5\u9053\u4E00\u4E2Aquery \u5E94\u8BE5\u5206\u914D\u591A\u5C11\u5185\u5B58\uFF0C\u6240\u4EE5\u7ECF\u5E38\u628Aexec_mem_limit \u8BBE\u7F6E\u4E3A\u6574\u4E2ABE \u8FDB\u7A0B\u5185\u5B58\u7684\u4E00\u534A\uFF0C\u4E5F\u5C31\u662F\u6574\u4E2ABE\u5185\u6240\u6709\u7684query \u4F7F\u7528\u7684\u5185\u5B58\u90FD\u4E0D\u5141\u8BB8\u8D85\u8FC7\u6574\u4E2A\u8FDB\u7A0B\u5185\u5B58\u7684\u4E00\u534A\uFF0C\u8FD9\u4E2A\u529F\u80FD\u5728\u8FD9\u79CD\u573A\u666F\u4E0B\u5B9E\u9645\u53D8\u6210\u4E86\u4E00\u4E2A\u7C7B\u4F3C\u7194\u65AD\u7684\u529F\u80FD\u3002\u5F53\u6211\u4EEC\u8981\u6839\u636E\u5185\u5B58\u7684\u5927\u5C0F\u505A\u4E00\u4E9B\u66F4\u7CBE\u7EC6\u7684\u7B56\u7565\u63A7\u5236\uFF0C\u6BD4\u5982spill disk\u65F6\uFF0C\u7531\u4E8E\u8FD9\u4E2A\u503C\u592A\u5927\u4E86\uFF0C\u6240\u4EE5\u4E0D\u80FD\u4F9D\u8D56\u5B83\u6765\u505A\u4E00\u4E9B\u63A7\u5236\u3002"}),"\n",(0,l.jsx)(e.p,{children:"\u6240\u4EE5\u6211\u4EEC\u57FA\u4E8Eworkload group \u5B9E\u73B0\u4E86\u4E00\u4E2A\u65B0\u7684\u57FA\u4E8Eslot\u7684\u5185\u5B58\u9650\u5236\u65B9\u5F0F\uFF0C\u8FD9\u4E2A\u7B56\u7565\u7684\u539F\u7406\u5982\u4E0B\uFF1A"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u6BCF\u4E2Aworkload group \u7528\u6237\u90FD\u914D\u7F6E\u4E862\u4E2A\u53C2\u6570\uFF0Cmax_memory_percent\u548Cmax_concurrency\uFF0C\u90A3\u4E48\u5C31\u8BA4\u4E3A\u6574\u4E2Abe \u7684\u5185\u5B58\u88AB\u5212\u5206\u4E3A max_concurrency \u4E2Aslot\uFF0C\u6BCF\u4E2Aslot \u5360\u7528\u7684\u5185\u5B58\u662Fmax_memory_percent * mem_limit / max_concurrency\u3002"}),"\n",(0,l.jsxs)(e.li,{children:["\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u6BCF\u4E2Aquery \u8FD0\u884C\u5360\u75281\u4E2Aslot\uFF0C\u5982\u679C\u7528\u6237\u60F3\u8BA9\u4E00\u4E2Aquery \u4F7F\u7528\u66F4\u591A\u7684\u5185\u5B58\uFF0C\u90A3\u4E48\u5C31\u9700\u8981\u4FEE\u6539",(0,l.jsx)(e.code,{children:"query_slot_count"})," \u7684\u503C\u3002"]}),"\n",(0,l.jsx)(e.li,{children:"\u7531\u4E8Eworkload group \u7684slot\u7684\u603B\u6570\u662F\u56FA\u5B9A\u7684\uFF0C\u5047\u5982\u7528\u6237\u8C03\u5927query_slot_count\uFF0C\u76F8\u5F53\u4E8E\u6BCF\u4E2Aquery \u5360\u7528\u4E86\u66F4\u591A\u7684slot\uFF0C\u90A3\u4E48\u6574\u4E2Aworkload group \u53EF\u540C\u65F6\u8FD0\u884C\u7684query\u7684\u6570\u91CF\u5C31\u52A8\u6001\u51CF\u5C11\u4E86\uFF0C\u65B0\u6765\u7684query \u5C31\u81EA\u52A8\u6392\u961F\u3002"}),"\n"]}),"\n",(0,l.jsx)(e.p,{children:"Workload group\u7684slot_memory_policy\uFF0C\u8FD9\u4E2A\u53C2\u6570\u53EF\u4EE5\u67093\u4E2A\u53EF\u9009\u7684\u503C\uFF1A"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"none\uFF0C\u9ED8\u8BA4\u503C\uFF0C\u8868\u793A\u4E0D\u542F\u7528\uFF1B\u5728\u8FD9\u79CD\u65B9\u5F0F\u4E0B\uFF0CQuery \u5C31\u5C3D\u91CF\u7684\u4F7F\u7528\u5185\u5B58\uFF0C\u4F46\u662F\u4E00\u65E6\u8FBE\u5230Workload Group\u7684\u4E0A\u9650\uFF0C\u5C31\u4F1A\u89E6\u53D1\u843D\u76D8\uFF1B\u6B64\u65F6\u4E0D\u4F1A\u6839\u636E\u67E5\u8BE2\u7684\u5927\u5C0F\u9009\u62E9\u3002"}),"\n",(0,l.jsxs)(e.li,{children:["fixed\uFF0C\u6BCF\u4E2Aquery \u53EF\u4EE5\u4F7F\u7528\u7684\u7684\u5185\u5B58 = ",(0,l.jsx)(e.code,{children:"workload group\u7684mem_limit * query_slot_count/ max_concurrency"}),"\uFF1B\u8FD9\u79CD\u5185\u5B58\u5206\u914D\u7B56\u7565\u5B9E\u9645\u662F\u6309\u7167\u5E76\u53D1\uFF0C\u7ED9\u6BCF\u4E2AQuery \u5206\u914D\u4E86\u56FA\u5B9A\u7684\u5185\u5B58\u3002"]}),"\n",(0,l.jsxs)(e.li,{children:["dynamic\uFF0C\u6BCF\u4E2Aquery \u53EF\u4EE5\u4F7F\u7528\u7684\u7684\u5185\u5B58 = ",(0,l.jsx)(e.code,{children:"workload group\u7684mem_limit * query_slot_count/ "}),"\u200B",(0,l.jsx)(e.code,{children:"sum(running query slots)"}),"\uFF0C\u5B83\u4E3B\u8981\u662F\u514B\u670D\u4E86fixed \u6A21\u5F0F\u4E0B\uFF0C\u4F1A\u5B58\u5728\u6709\u4E00\u4E9Bslot \u6CA1\u6709\u4F7F\u7528\u7684\u60C5\u51B5\uFF1B\u5B9E\u9645\u5C31\u662F\u628A\u5927\u7684\u67E5\u8BE2\u5148\u843D\u76D8\u3002"]}),"\n"]}),"\n",(0,l.jsx)(e.p,{children:"fixed\u6216\u8005dynamic \u90FD\u662F\u8BBE\u7F6E\u7684query\u7684\u786C\u9650\uFF0C\u4E00\u65E6\u8D85\u8FC7\uFF0C\u5C31\u4F1A\u843D\u76D8\u6216\u8005kill\uFF1B\u800C\u4E14\u4F1A\u8986\u76D6\u7528\u6237\u8BBE\u7F6E\u7684\u9759\u6001\u5185\u5B58\u5206\u914D\u7684\u53C2\u6570\u3002 \u6240\u4EE5\u5F53\u8981\u8BBE\u7F6Eslot_memory_policy\u65F6\uFF0C\u4E00\u5B9A\u8981\u8BBE\u7F6E\u597Dworkload group\u7684max_concurrency\uFF0C\u5426\u5219\u4F1A\u51FA\u73B0\u5185\u5B58\u4E0D\u8DB3\u7684\u95EE\u9898\u3002"}),"\n",(0,l.jsx)(e.h1,{id:"\u843D\u76D8",children:"\u843D\u76D8"}),"\n",(0,l.jsx)(e.h2,{id:"\u5F00\u542F\u67E5\u8BE2\u4E2D\u95F4\u7ED3\u679C\u843D\u76D8",children:"\u5F00\u542F\u67E5\u8BE2\u4E2D\u95F4\u7ED3\u679C\u843D\u76D8"}),"\n",(0,l.jsx)(e.h3,{id:"be\u914D\u7F6E\u9879",children:"BE\u914D\u7F6E\u9879"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-JavaScript",children:"spill_storage_root_path=/mnt/disk1/spilltest/doris/be/storage;/mnt/disk2/doris-spill;/mnt/disk3/doris-spill\nspill_storage_limit=100%\n"})}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"spill_storage_root_path\uFF1A\u67E5\u8BE2\u4E2D\u95F4\u7ED3\u679C\u843D\u76D8\u6587\u4EF6\u5B58\u50A8\u8DEF\u5F84\uFF0C\u9ED8\u8BA4\u548Cstorage_root_path\u4E00\u6837\u3002"}),"\n",(0,l.jsx)(e.li,{children:"spill_storage_limit: \u843D\u76D8\u6587\u4EF6\u5360\u7528\u78C1\u76D8\u7A7A\u95F4\u9650\u5236\u3002\u53EF\u4EE5\u914D\u7F6E\u5177\u4F53\u7684\u7A7A\u95F4\u5927\u5C0F\uFF08\u6BD4\u5982100G, 1T\uFF09\u6216\u8005\u767E\u5206\u6BD4\uFF0C\u9ED8\u8BA4\u662F20%\u3002\u5982\u679Cspill_storage_root_path\u914D\u7F6E\u5355\u72EC\u7684\u78C1\u76D8\uFF0C\u53EF\u4EE5\u8BBE\u7F6E\u4E3A100%\u3002\u8FD9\u4E2A\u53C2\u6570\u4E3B\u8981\u662F\u9632\u6B62\u843D\u76D8\u5360\u7528\u592A\u591A\u7684\u78C1\u76D8\u7A7A\u95F4\uFF0C\u5BFC\u81F4\u65E0\u6CD5\u8FDB\u884C\u6B63\u5E38\u7684\u6570\u636E\u5B58\u50A8\u3002"}),"\n"]}),"\n",(0,l.jsx)(e.p,{children:"\u4FEE\u6539\u914D\u7F6E\u9879\u4E4B\u540E\uFF0C\u9700\u8981\u91CD\u542FBE\u624D\u80FD\u751F\u6548\u3002"}),"\n",(0,l.jsx)(e.h3,{id:"fe-session-variable",children:"FE Session Variable"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-JavaScript",children:"set enable_spill=true;\nset exec_mem_limit = 10g;\nset query_timeout = 3600;\n"})}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"enable_spill \u8868\u793A\u4E00\u4E2Aquery \u662F\u5426\u5F00\u542F\u843D\u76D8\uFF0C\u9ED8\u8BA4\u5173\u95ED\uFF1B\u5982\u679C\u5F00\u542F\uFF0C\u5728\u5185\u5B58\u7D27\u5F20\u7684\u60C5\u51B5\u4E0B\uFF0C\u4F1A\u89E6\u53D1\u67E5\u8BE2\u843D\u76D8\uFF1B"}),"\n",(0,l.jsx)(e.li,{children:"exec_mem_limit \u8868\u793A\u4E00\u4E2Aquery \u4F7F\u7528\u7684\u6700\u5927\u7684\u5185\u5B58\u5927\u5C0F\uFF1B"}),"\n",(0,l.jsx)(e.li,{children:"query_timeout \u5F00\u542F\u843D\u76D8\uFF0C\u67E5\u8BE2\u65F6\u95F4\u53EF\u80FD\u4F1A\u663E\u8457\u589E\u52A0\uFF0Cquery_timeout\u9700\u8981\u8FDB\u884C\u8C03\u6574\u3002"}),"\n"]}),"\n",(0,l.jsx)(e.h3,{id:"workload-group",children:"Workload Group"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"max_"}),"\u200B",(0,l.jsx)(e.code,{children:"memory_"}),"percent \u9ED8\u8BA4workload group \u7684",(0,l.jsx)(e.code,{children:"max_memory_"}),"percent\u9ED8\u8BA4\u503C\u662F100%\uFF0C\u53EF\u6309\u5B9E\u9645\u7684workload group\u7684\u6570\u91CF\u5408\u7406\u4FEE\u6539\u3002\u5982\u679C\u53EA\u6709\u4E00\u4E2Aworkload group\uFF0C\u53EF\u4EE5\u8C03\u6574\u4E3A90%\u3002"]}),"\n"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-Bash",children:"alter workload group normal properties ( 'max_memory_percent'='90%' );\n"})}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"slot_memory_policy"})," \u8BBE\u7F6E\u4E3A",(0,l.jsx)(e.code,{children:"fixed"}),"\u6216\u8005",(0,l.jsx)(e.code,{children:"dynamic"}),"\u3002\u5177\u4F53\u542B\u4E49\u53C2\u89C1",(0,l.jsx)(e.code,{children:"\u57FA\u4E8ESlot\u7684\u5185\u5B58\u5206\u914D"}),"\u7AE0\u8282\u3002"]}),"\n"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-C++",children:"alter workload group normal properties ('slot_memory_policy'='dynamic');\n"})}),"\n",(0,l.jsx)(e.h2,{id:"\u76D1\u6D4B\u843D\u76D8",children:"\u76D1\u6D4B\u843D\u76D8"}),"\n",(0,l.jsx)(e.h3,{id:"\u5BA1\u8BA1\u65E5\u5FD7",children:"\u5BA1\u8BA1\u65E5\u5FD7"}),"\n",(0,l.jsxs)(e.p,{children:["FE audit log\u4E2D\u589E\u52A0\u4E86",(0,l.jsx)(e.code,{children:"SpillWriteBytesToLocalStorage"}),"\u548C",(0,l.jsx)(e.code,{children:"SpillReadBytesFromLocalStorage"}),"\u5B57\u6BB5\uFF0C\u5206\u522B\u8868\u793A\u843D\u76D8\u65F6\u5199\u76D8\u548C\u8BFB\u76D8\u6570\u636E\u603B\u91CF\u3002"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-Plain",children:"SpillWriteBytesToLocalStorage=503412182|SpillReadBytesFromLocalStorage=503412182\n"})}),"\n",(0,l.jsx)(e.h3,{id:"profile",children:"Profile"}),"\n",(0,l.jsxs)(e.p,{children:["\u5982\u679C\u67E5\u8BE2\u8FC7\u7A0B\u4E2D\u89E6\u53D1\u4E86\u843D\u76D8\uFF0C\u5728Query Profile\u4E2D\u589E\u52A0\u4E86",(0,l.jsx)(e.code,{children:"Spill"})," \u524D\u7F00\u7684\u4E00\u4E9BCounter\u8FDB\u884C\u6807\u8BB0\u548C\u843D\u76D8\u76F8\u5173counter\u3002\u4EE5HashJoin\u65F6Build HashTable\u4E3A\u4F8B\uFF0C\u53EF\u4EE5\u770B\u5230\u4E0B\u9762\u7684Counter\uFF1A"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-Bash",children:"PARTITIONED_HASH_JOIN_SINK_OPERATOR  (id=4  ,  nereids_id=179):(ExecTime:  6sec351ms)\n      -  Spilled:  true\n      -  CloseTime:  528ns\n      -  ExecTime:  6sec351ms\n      -  InitTime:  5.751us\n      -  InputRows:  6.001215M  (6001215)\n      -  MemoryUsage:  0.00  \n      -  MemoryUsagePeak:  554.42  MB\n      -  MemoryUsageReserved:  1024.00  KB\n      -  OpenTime:  2.267ms\n      -  PendingFinishDependency:  0ns\n      -  SpillBuildTime:  2sec437ms\n      -  SpillInMemRow:  0\n      -  SpillMaxRowsOfPartition:  68.569K  (68569)\n      -  SpillMinRowsOfPartition:  67.455K  (67455)\n      -  SpillPartitionShuffleTime:  836.302ms\n      -  SpillPartitionTime:  131.839ms\n      -  SpillTotalTime:  5sec563ms\n      -  SpillWriteBlockBytes:  714.13  MB\n      -  SpillWriteBlockCount:  1.344K  (1344)\n      -  SpillWriteFileBytes:  244.40  MB\n      -  SpillWriteFileTime:  350.754ms\n      -  SpillWriteFileTotalCount:  32\n      -  SpillWriteRows:  6.001215M  (6001215)\n      -  SpillWriteSerializeBlockTime:  4sec378ms\n      -  SpillWriteTaskCount:  417\n      -  SpillWriteTaskWaitInQueueCount:  0\n      -  SpillWriteTaskWaitInQueueTime:  8.731ms\n      -  SpillWriteTime:  5sec549ms\n"})}),"\n",(0,l.jsx)(e.h3,{id:"\u7CFB\u7EDF\u8868",children:"\u7CFB\u7EDF\u8868"}),"\n",(0,l.jsx)(e.h4,{id:"backend_active_tasks",children:"backend_active_tasks"}),"\n",(0,l.jsxs)(e.p,{children:["\u589E\u52A0\u4E86",(0,l.jsx)(e.code,{children:"SPILL_WRITE_BYTES_TO_LOCAL_STORAGE"}),"\u548C",(0,l.jsx)(e.code,{children:"SPILL_READ_BYTES_FROM_LOCAL_STORAGE"}),"\u5B57\u6BB5\uFF0C\u5206\u522B\u8868\u793A\u4E00\u4E2A\u67E5\u8BE2\u76EE\u524D\u843D\u76D8\u4E2D\u95F4\u7ED3\u679C\u5199\u76D8\u6570\u636E\u548C\u8BFB\u76D8\u6570\u636E\u603B\u91CF\u3002"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-Bash",children:"mysql [information_schema]>select * from backend_active_tasks;\n+-------+------------+-------------------+-----------------------------------+--------------+------------------+-----------+------------+----------------------+---------------------------+--------------------+-------------------+------------+------------------------------------+-------------------------------------+\n| BE_ID | FE_HOST    | WORKLOAD_GROUP_ID | QUERY_ID                          | TASK_TIME_MS | TASK_CPU_TIME_MS | SCAN_ROWS | SCAN_BYTES | BE_PEAK_MEMORY_BYTES | CURRENT_USED_MEMORY_BYTES | SHUFFLE_SEND_BYTES | SHUFFLE_SEND_ROWS | QUERY_TYPE | SPILL_WRITE_BYTES_TO_LOCAL_STORAGE | SPILL_READ_BYTES_FROM_LOCAL_STORAGE |\n+-------+------------+-------------------+-----------------------------------+--------------+------------------+-----------+------------+----------------------+---------------------------+--------------------+-------------------+------------+------------------------------------+-------------------------------------+\n| 10009 | 10.16.10.8 |                 1 | 6f08c74afbd44fff-9af951270933842d |        13612 |            11025 |  12002430 | 1960955904 |            733243057 |                  70113260 |                  0 |                 0 | SELECT     |                          508110119 |                            26383070 |\n| 10009 | 10.16.10.8 |                 1 | 871d643b87bf447b-865eb799403bec96 |            0 |                0 |         0 |          0 |                    0 |                         0 |                  0 |                 0 | SELECT     |                                  0 |                                   0 |\n+-------+------------+-------------------+-----------------------------------+--------------+------------------+-----------+------------+----------------------+---------------------------+--------------------+-------------------+------------+------------------------------------+-------------------------------------+\n2 rows in set (0.00 sec)\n"})}),"\n",(0,l.jsx)(e.h1,{id:"\u6D4B\u8BD5",children:"\u6D4B\u8BD5"}),"\n",(0,l.jsx)(e.h2,{id:"\u6D4B\u8BD5\u73AF\u5883",children:"\u6D4B\u8BD5\u73AF\u5883"}),"\n",(0,l.jsx)(e.h3,{id:"\u673A\u5668\u914D\u7F6E",children:"\u673A\u5668\u914D\u7F6E"}),"\n",(0,l.jsx)(e.p,{children:"\u6D4B\u8BD5\u4F7F\u7528\u963F\u91CC\u4E91\u670D\u52A1\u5668\uFF0C\u5177\u4F53\u914D\u7F6E\u5982\u4E0B\u3002"}),"\n",(0,l.jsx)(e.p,{children:"1FE:"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-Bash",children:"16\u6838(vCPU) 32 GiB 200 Mbps ecs.c6.4xlarge\n"})}),"\n",(0,l.jsx)(e.p,{children:"3BE:"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-Bash",children:"16\u6838(vCPU) 64 GiB 0 Mbps ecs.g6.4xlarge\n"})}),"\n",(0,l.jsx)(e.h3,{id:"\u6D4B\u8BD5\u6570\u636E",children:"\u6D4B\u8BD5\u6570\u636E"}),"\n",(0,l.jsx)(e.p,{children:"\u6D4B\u8BD5\u6570\u636E\u4F7F\u7528TPC-DS 10TB\u4F5C\u4E3A\u6570\u636E\u8F93\u5165\uFF0C\u4F7F\u7528\u963F\u91CC\u4E91DLF\u6570\u636E\u6E90\uFF0C\u4F7F\u7528Catalog\u7684\u65B9\u5F0F\u6302\u8F7D\u5230Doris \u5185\uFF0CSQL \u8BED\u53E5\u5982\u4E0B\uFF1A"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-Bash",children:'CREATE CATALOG dlf PROPERTIES (\n"type"="hms",\n"hive.metastore.type" = "dlf",\n"dlf.proxy.mode" = "DLF_ONLY",\n"dlf.endpoint" = "dlf-vpc.cn-beijing.aliyuncs.com",\n"dlf.region" = "cn-beijing",\n"dlf.uid" = "217316283625971977",\n"dlf.catalog.id" = "emr_dev"\n);\n'})}),"\n",(0,l.jsxs)(e.p,{children:["\u53C2\u8003\u5B98\u7F51\u94FE\u63A5: ",(0,l.jsx)(e.a,{href:"https://doris.apache.org/zh-CN/docs/dev/benchmark/tpcds",children:"https://doris.apache.org/zh-CN/docs/dev/benchmark/tpcds"})]}),"\n",(0,l.jsx)(e.h2,{id:"\u6D4B\u8BD5\u7ED3\u679C",children:"\u6D4B\u8BD5\u7ED3\u679C"}),"\n",(0,l.jsx)(e.h3,{id:"\u5355\u5E76\u53D1",children:"\u5355\u5E76\u53D1"}),"\n",(0,l.jsx)(e.p,{children:"\u6570\u636E\u7684\u89C4\u6A21\u662F10TB\u3002\u5185\u5B58\u548C\u6570\u636E\u89C4\u6A21\u7684\u6BD4\u4F8B\u662F1:52\uFF0C\u6574\u4F53\u8FD0\u884C\u65F6\u95F428102.386s\uFF0C\u80FD\u591F\u8DD1\u51FA\u6240\u6709\u768499\u6761query\u3002\u672A\u6765\u6211\u4EEC\u5C06\u5BF9\u66F4\u591A\u7684\u7B97\u5B50\u63D0\u4F9B\u843D\u76D8\u80FD\u529B\uFF08\u5982window function\uFF0C Intersect\u7B49\uFF09\uFF0C\u540C\u65F6\u7EE7\u7EED\u4F18\u5316\u843D\u76D8\u60C5\u51B5\u4E0B\u7684\u6027\u80FD\uFF0C\u964D\u4F4E\u5BF9\u78C1\u76D8\u7684\u6D88\u8017\uFF0C\u63D0\u5347\u67E5\u8BE2\u7684\u7A33\u5B9A\u6027\u3002"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{children:"Query"}),(0,l.jsx)(e.th,{children:"Doris"})]})}),(0,l.jsxs)(e.tbody,{children:[(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query1"}),(0,l.jsx)(e.td,{children:"29092"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query2"}),(0,l.jsx)(e.td,{children:"130003"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query3"}),(0,l.jsx)(e.td,{children:"96119"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query4"}),(0,l.jsx)(e.td,{children:"1199097"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query5"}),(0,l.jsx)(e.td,{children:"212719"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query6"}),(0,l.jsx)(e.td,{children:"62259"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query7"}),(0,l.jsx)(e.td,{children:"209154"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query8"}),(0,l.jsx)(e.td,{children:"62433"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query9"}),(0,l.jsx)(e.td,{children:"579371"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query10"}),(0,l.jsx)(e.td,{children:"54260"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query11"}),(0,l.jsx)(e.td,{children:"560169"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query12"}),(0,l.jsx)(e.td,{children:"26084"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query13"}),(0,l.jsx)(e.td,{children:"228756"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query14"}),(0,l.jsx)(e.td,{children:"1137097"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query15"}),(0,l.jsx)(e.td,{children:"27509"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query16"}),(0,l.jsx)(e.td,{children:"84806"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query17"}),(0,l.jsx)(e.td,{children:"288164"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query18"}),(0,l.jsx)(e.td,{children:"94770"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query19"}),(0,l.jsx)(e.td,{children:"124955"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query20"}),(0,l.jsx)(e.td,{children:"30970"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query21"}),(0,l.jsx)(e.td,{children:"4333"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query22"}),(0,l.jsx)(e.td,{children:"9890"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query23"}),(0,l.jsx)(e.td,{children:"1757755"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query24"}),(0,l.jsx)(e.td,{children:"399553"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query25"}),(0,l.jsx)(e.td,{children:"291474"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query26"}),(0,l.jsx)(e.td,{children:"79832"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query27"}),(0,l.jsx)(e.td,{children:"175894"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query28"}),(0,l.jsx)(e.td,{children:"647497"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query29"}),(0,l.jsx)(e.td,{children:"1299597"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query30"}),(0,l.jsx)(e.td,{children:"11434"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query31"}),(0,l.jsx)(e.td,{children:"106665"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query32"}),(0,l.jsx)(e.td,{children:"33481"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query33"}),(0,l.jsx)(e.td,{children:"146101"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query34"}),(0,l.jsx)(e.td,{children:"84055"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query35"}),(0,l.jsx)(e.td,{children:"69885"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query36"}),(0,l.jsx)(e.td,{children:"148662"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query37"}),(0,l.jsx)(e.td,{children:"21598"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query38"}),(0,l.jsx)(e.td,{children:"164746"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query39"}),(0,l.jsx)(e.td,{children:"5874"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query40"}),(0,l.jsx)(e.td,{children:"51602"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query41"}),(0,l.jsx)(e.td,{children:"563"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query42"}),(0,l.jsx)(e.td,{children:"93005"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query43"}),(0,l.jsx)(e.td,{children:"67769"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query44"}),(0,l.jsx)(e.td,{children:"79527"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query45"}),(0,l.jsx)(e.td,{children:"26575"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query46"}),(0,l.jsx)(e.td,{children:"134991"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query47"}),(0,l.jsx)(e.td,{children:"161873"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query48"}),(0,l.jsx)(e.td,{children:"153657"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query49"}),(0,l.jsx)(e.td,{children:"259387"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query50"}),(0,l.jsx)(e.td,{children:"141421"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query51"}),(0,l.jsx)(e.td,{children:"158056"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query52"}),(0,l.jsx)(e.td,{children:"91392"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query53"}),(0,l.jsx)(e.td,{children:"89497"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query54"}),(0,l.jsx)(e.td,{children:"124118"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query55"}),(0,l.jsx)(e.td,{children:"82584"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query56"}),(0,l.jsx)(e.td,{children:"152110"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query57"}),(0,l.jsx)(e.td,{children:"83417"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query58"}),(0,l.jsx)(e.td,{children:"259580"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query59"}),(0,l.jsx)(e.td,{children:"177125"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query60"}),(0,l.jsx)(e.td,{children:"161729"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query61"}),(0,l.jsx)(e.td,{children:"258058"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query62"}),(0,l.jsx)(e.td,{children:"39619"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query63"}),(0,l.jsx)(e.td,{children:"91258"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query64"}),(0,l.jsx)(e.td,{children:"234882"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query65"}),(0,l.jsx)(e.td,{children:"278610"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query66"}),(0,l.jsx)(e.td,{children:"90246"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query67"}),(0,l.jsx)(e.td,{children:"3939554"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query68"}),(0,l.jsx)(e.td,{children:"183648"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query69"}),(0,l.jsx)(e.td,{children:"11031"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query70"}),(0,l.jsx)(e.td,{children:"137901"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query71"}),(0,l.jsx)(e.td,{children:"166454"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query72"}),(0,l.jsx)(e.td,{children:"2859001"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query73"}),(0,l.jsx)(e.td,{children:"92015"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query74"}),(0,l.jsx)(e.td,{children:"336694"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query75"}),(0,l.jsx)(e.td,{children:"838989"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query76"}),(0,l.jsx)(e.td,{children:"174235"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query77"}),(0,l.jsx)(e.td,{children:"174525"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query78"}),(0,l.jsx)(e.td,{children:"1956786"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query79"}),(0,l.jsx)(e.td,{children:"162259"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query80"}),(0,l.jsx)(e.td,{children:"602088"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query81"}),(0,l.jsx)(e.td,{children:"16184"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query82"}),(0,l.jsx)(e.td,{children:"56292"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query83"}),(0,l.jsx)(e.td,{children:"26211"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query84"}),(0,l.jsx)(e.td,{children:"11906"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query85"}),(0,l.jsx)(e.td,{children:"57739"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query86"}),(0,l.jsx)(e.td,{children:"34350"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query87"}),(0,l.jsx)(e.td,{children:"173631"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query88"}),(0,l.jsx)(e.td,{children:"449003"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query89"}),(0,l.jsx)(e.td,{children:"113799"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query90"}),(0,l.jsx)(e.td,{children:"30825"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query91"}),(0,l.jsx)(e.td,{children:"12239"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query92"}),(0,l.jsx)(e.td,{children:"26695"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query93"}),(0,l.jsx)(e.td,{children:"275828"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query94"}),(0,l.jsx)(e.td,{children:"56464"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query95"}),(0,l.jsx)(e.td,{children:"64932"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query96"}),(0,l.jsx)(e.td,{children:"48102"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query97"}),(0,l.jsx)(e.td,{children:"597371"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query98"}),(0,l.jsx)(e.td,{children:"112399"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"query99"}),(0,l.jsx)(e.td,{children:"64472"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"Sum"}),(0,l.jsx)(e.td,{children:"28102386"})]})]})]})]})}function j(n={}){let{wrapper:e}={...(0,s.a)(),...n.components};return e?(0,l.jsx)(e,{...n,children:(0,l.jsx)(x,{...n})}):x(n)}},250065:function(n,e,r){r.d(e,{Z:function(){return c},a:function(){return i}});var d=r(667294);let l={},s=d.createContext(l);function i(n){let e=d.useContext(s);return d.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(l):n.components||l:i(n.components),d.createElement(s.Provider,{value:e},n.children)}}}]);