"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["401456"],{857136:function(e,s,n){n.r(s),n.d(s,{default:()=>h,frontMatter:()=>a,metadata:()=>i,assets:()=>o,toc:()=>c,contentTitle:()=>t});var i=JSON.parse('{"id":"admin-manual/auth/integrations/aws-iam-role","title":"Apache Doris IAM Assume Role\u5DE5\u4F5C\u539F\u7406","description":"\u4E00\u3001\u4F20\u7EDFAK/SK\u65B9\u5F0F\u8BBF\u95EEAWS\u8D44\u6E90\u5B58\u5728\u7684\u95EE\u9898","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs/current/admin-manual/auth/integrations/aws-iam-role.md","sourceDirName":"admin-manual/auth/integrations","slug":"/admin-manual/auth/integrations/aws-iam-role","permalink":"/zh-CN/docs/dev/admin-manual/auth/integrations/aws-iam-role","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Apache Doris IAM Assume Role\u5DE5\u4F5C\u539F\u7406","language":"zh-CN"},"sidebar":"docs","previous":{"title":"AWS \u8BA4\u8BC1\u548C\u9274\u6743","permalink":"/zh-CN/docs/dev/admin-manual/auth/integrations/aws-authentication-and-authorization"},"next":{"title":"Star Schema Benchmark","permalink":"/zh-CN/docs/dev/benchmark/ssb"}}'),l=n("785893"),r=n("250065");let a={title:"Apache Doris IAM Assume Role\u5DE5\u4F5C\u539F\u7406",language:"zh-CN"},t="Apache Doris IAM Assume Role\u5DE5\u4F5C\u539F\u7406",o={},c=[{value:"\u4E00\u3001\u4F20\u7EDFAK/SK\u65B9\u5F0F\u8BBF\u95EEAWS\u8D44\u6E90\u5B58\u5728\u7684\u95EE\u9898",id:"\u4E00\u4F20\u7EDFaksk\u65B9\u5F0F\u8BBF\u95EEaws\u8D44\u6E90\u5B58\u5728\u7684\u95EE\u9898",level:2},{value:"\u5BC6\u94A5\u7BA1\u7406\u56F0\u5883\uFF1A",id:"\u5BC6\u94A5\u7BA1\u7406\u56F0\u5883",level:3},{value:"\u4E8C\u3001AWS IAM ASSUME ROLE\u673A\u5236\u4ECB\u7ECD",id:"\u4E8Caws-iam-assume-role\u673A\u5236\u4ECB\u7ECD",level:2},{value:"AWS IAM Assume Role \u662F\u4EC0\u4E48\uFF1F",id:"aws-iam-assume-role-\u662F\u4EC0\u4E48",level:3},{value:"\u4F7F\u7528AWS IAM Assume Role\u65B9\u5F0F\u8BBF\u95EE\u7684\u4F18\u70B9:",id:"\u4F7F\u7528aws-iam-assume-role\u65B9\u5F0F\u8BBF\u95EE\u7684\u4F18\u70B9",level:3},{value:"AWS IAM Assume Role\u8BBF\u95EES3 Bucket\u7684\u9274\u6743\u8FC7\u7A0B\uFF1A",id:"aws-iam-assume-role\u8BBF\u95EEs3-bucket\u7684\u9274\u6743\u8FC7\u7A0B",level:3},{value:"\u9636\u6BB51: \u6E90\u7528\u6237\u8EAB\u4EFD\u9A8C\u8BC1",id:"\u9636\u6BB51-\u6E90\u7528\u6237\u8EAB\u4EFD\u9A8C\u8BC1",level:4},{value:"\u9636\u6BB52: \u76EE\u6807\u89D2\u8272\u6743\u9650\u6FC0\u6D3B",id:"\u9636\u6BB52-\u76EE\u6807\u89D2\u8272\u6743\u9650\u6FC0\u6D3B",level:4},{value:"\u9636\u6BB53: \u8D44\u6E90\u64CD\u4F5C\u6267\u884C",id:"\u9636\u6BB53-\u8D44\u6E90\u64CD\u4F5C\u6267\u884C",level:4},{value:"\u4E09\u3001Doris\u5982\u4F55\u5E94\u7528AWS IAM Assume Role\u9274\u6743\u673A\u5236",id:"\u4E09doris\u5982\u4F55\u5E94\u7528aws-iam-assume-role\u9274\u6743\u673A\u5236",level:2}];function d(e){let s={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.header,{children:(0,l.jsx)(s.h1,{id:"apache-doris-iam-assume-role\u5DE5\u4F5C\u539F\u7406",children:"Apache Doris IAM Assume Role\u5DE5\u4F5C\u539F\u7406"})}),"\n",(0,l.jsx)(s.h2,{id:"\u4E00\u4F20\u7EDFaksk\u65B9\u5F0F\u8BBF\u95EEaws\u8D44\u6E90\u5B58\u5728\u7684\u95EE\u9898",children:"\u4E00\u3001\u4F20\u7EDFAK/SK\u65B9\u5F0F\u8BBF\u95EEAWS\u8D44\u6E90\u5B58\u5728\u7684\u95EE\u9898"}),"\n",(0,l.jsx)(s.h3,{id:"\u5BC6\u94A5\u7BA1\u7406\u56F0\u5883",children:"\u5BC6\u94A5\u7BA1\u7406\u56F0\u5883\uFF1A"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"\u957F\u671F\u66B4\u9732\u98CE\u9669"}),"\uFF1A\u9759\u6001AK/SK\u9700\u786C\u7F16\u7801\u4E8E\u914D\u7F6E\u6587\u4EF6\u4E2D\uFF0C\u4E00\u65E6\u56E0\u4EE3\u7801\u6CC4\u9732\u3001\u8BEF\u63D0\u4EA4\u6216\u6076\u610F\u7A83\u53D6\u5BFC\u81F4\u5BC6\u94A5\u6269\u6563\uFF0C\u653B\u51FB\u8005\u53EF\u6C38\u4E45\u83B7\u5F97\u7B49\u540C\u4E8E\u5BC6\u94A5\u6240\u6709\u8005\u7684\u5B8C\u6574\u6743\u9650\uFF0C\u5F15\u53D1\u6301\u7EED\u6027\u7684\u6570\u636E\u6CC4\u9732\u3001\u8D44\u6E90\u7BE1\u6539\u53CA\u8D44\u91D1\u635F\u5931\u98CE\u9669\uFF1B"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"\u5BA1\u8BA1\u76F2\u533A"}),"\uFF1A\u591A\u7528\u6237/\u591A\u670D\u52A1\u5171\u4EAB\u540C\u4E00\u7EC4\u5BC6\u94A5\u65F6\uFF0C\u4E91\u64CD\u4F5C\u65E5\u5FD7\u4EC5\u8BB0\u5F55\u5BC6\u94A5\u8EAB\u4EFD\u800C\u65E0\u6CD5\u5173\u8054\u5177\u4F53\u4F7F\u7528\u8005\uFF0C\u65E0\u6CD5\u8FFD\u6EAF\u771F\u5B9E\u8D23\u4EFB\u4EBA\u6216\u4E1A\u52A1\u6A21\u5757\uFF1B"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"\u8FD0\u7EF4\u6210\u672C\u9AD8"}),"\uFF1A\u5BC6\u94A5\u8F6E\u6362\u707E\u96BE\uFF0C\u9700\u624B\u52A8\u8F6E\u6362\u4E1A\u52A1\u6A21\u5757\u5BC6\u94A5\uFF0C\u5BB9\u6613\u51FA\u9519\u89E6\u53D1\u670D\u52A1\u4E2D\u65AD\uFF1B"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"\u6743\u9650\u7BA1\u7406\u5931\u63A7"}),"\uFF1A\u8D26\u6237\u7EA7\u7C97\u653E\u6388\u6743\u65E0\u6CD5\u6EE1\u8DB3\u670D\u52A1/\u5B9E\u4F8B\u7EA7\u7684\u6700\u5C0F\u6743\u9650\u7BA1\u63A7\u9700\u6C42\u3002"]}),"\n"]}),"\n",(0,l.jsx)(s.h2,{id:"\u4E8Caws-iam-assume-role\u673A\u5236\u4ECB\u7ECD",children:"\u4E8C\u3001AWS IAM ASSUME ROLE\u673A\u5236\u4ECB\u7ECD"}),"\n",(0,l.jsx)(s.h3,{id:"aws-iam-assume-role-\u662F\u4EC0\u4E48",children:"AWS IAM Assume Role \u662F\u4EC0\u4E48\uFF1F"}),"\n",(0,l.jsx)(s.p,{children:"AWS Assume Role \u662F\u4E00\u79CD\u5B89\u5168\u8EAB\u4EFD\u5207\u6362\u673A\u5236\uFF0C\u5141\u8BB8\u4E00\u4E2A\u53EF\u4FE1\u5B9E\u4F53\uFF08\u5982IAM\u7528\u6237\u3001EC2\u5B9E\u4F8B\u6216\u5916\u90E8\u8D26\u53F7\uFF09\u901A\u8FC7STS\uFF08\u5B89\u5168\u4EE4\u724C\u670D\u52A1\uFF09\u4E34\u65F6\u83B7\u53D6\u76EE\u6807\u89D2\u8272\u7684\u6743\u9650\uFF0C\u5176\u8FD0\u4F5C\u6D41\u7A0B\u5982\u4E0B:"}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.img,{src:n(30070).Z+"",width:"2396",height:"1206"})}),"\n",(0,l.jsx)(s.h3,{id:"\u4F7F\u7528aws-iam-assume-role\u65B9\u5F0F\u8BBF\u95EE\u7684\u4F18\u70B9",children:"\u4F7F\u7528AWS IAM Assume Role\u65B9\u5F0F\u8BBF\u95EE\u7684\u4F18\u70B9:"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"\u52A8\u6001\u4EE4\u724C\u673A\u5236(15\u5206\u949F~12\u5C0F\u65F6\u6709\u6548\u671F)\u66FF\u4EE3\u6C38\u4E45\u5BC6\u94A5"}),"\n",(0,l.jsx)(s.li,{children:"\u901A\u8FC7 External ID \u5B9E\u73B0\u8DE8\u8D26\u53F7\u5B89\u5168\u9694\u79BB\uFF0C\u5E76\u4E14\u53EF\u901A\u8FC7AWS\u540E\u53F0\u670D\u52A1\u8FDB\u884C\u5BA1\u8BA1"}),"\n",(0,l.jsx)(s.li,{children:"\u57FA\u4E8E\u89D2\u8272\u7684\u6700\u5C0F\u6743\u9650\u539F\u5219(Principle of Least Privilege)"}),"\n"]}),"\n",(0,l.jsx)(s.h3,{id:"aws-iam-assume-role\u8BBF\u95EEs3-bucket\u7684\u9274\u6743\u8FC7\u7A0B",children:"AWS IAM Assume Role\u8BBF\u95EES3 Bucket\u7684\u9274\u6743\u8FC7\u7A0B\uFF1A"}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.img,{src:n(377544).Z+"",width:"1301",height:"137"})}),"\n",(0,l.jsx)(s.h4,{id:"\u9636\u6BB51-\u6E90\u7528\u6237\u8EAB\u4EFD\u9A8C\u8BC1",children:"\u9636\u6BB51: \u6E90\u7528\u6237\u8EAB\u4EFD\u9A8C\u8BC1"}),"\n",(0,l.jsxs)(s.ol,{children:["\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"\u6743\u9650\u7B56\u7565\u68C0\u67E5"})}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"\u6E90\u7528\u6237\u53D1\u8D77AssumeRole\u8BF7\u6C42\u65F6\uFF0C\u6E90\u8D26\u6237\u7684IAM\u7B56\u7565\u5F15\u64CE\u9996\u5148\u9A8C\u8BC1\uFF1A\u8BE5\u7528\u6237\u662F\u5426\u88AB\u6388\u6743\u8C03\u7528sts:AssumeRole\u64CD\u4F5C\uFF1F"}),"\n",(0,l.jsx)(s.li,{children:"\u68C0\u67E5\u4F9D\u636E\uFF1A\u9644\u7740\u5728\u6E90\u7528\u6237\u8EAB\u4EFD\u4E0A\u7684IAM Permissions Policies"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"\u4FE1\u4EFB\u5173\u7CFB\u6821\u9A8C"})}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:["\u901A\u8FC7STS\u670D\u52A1\u5411\u76EE\u6807\u8D26\u6237\u53D1\u8D77\u8BF7\u6C42\uFF1A\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"\u6E90\u7528\u6237\u662F\u5426\u5728\u76EE\u6807\u89D2\u8272\u7684\u4FE1\u4EFB\u7B56\u7565\u767D\u540D\u5355\u4E2D\uFF1F"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(s.li,{children:"\u68C0\u67E5\u4F9D\u636E\uFF1A\u76EE\u6807\u89D2\u8272\u7ED1\u5B9A\u7684IAM Trust Relationships Policies\uFF08\u660E\u786E\u5141\u8BB8\u54EA\u4E9B\u8D26\u53F7/\u7528\u6237\u62C5\u4EFB\u8BE5\u89D2\u8272\uFF09"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(s.h4,{id:"\u9636\u6BB52-\u76EE\u6807\u89D2\u8272\u6743\u9650\u6FC0\u6D3B",children:"\u9636\u6BB52: \u76EE\u6807\u89D2\u8272\u6743\u9650\u6FC0\u6D3B"}),"\n",(0,l.jsxs)(s.ol,{start:"3",children:["\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.strong,{children:"\u4E34\u65F6\u51ED\u8BC1\u751F\u6210"}),(0,l.jsx)(s.br,{}),"\n\u82E5\u4FE1\u4EFB\u5173\u7CFB\u9A8C\u8BC1\u901A\u8FC7\uFF0CSTS\u751F\u6210\u4E09\u8981\u7D20\u4E34\u65F6\u51ED\u8BC1"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-json",children:' {\n "AccessKeyId": "***",\n "SecretAccessKey": "***",\n "SessionToken": "***" // \u6709\u6548\u671F15min-12h\n }\n'})}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"\u76EE\u6807\u89D2\u8272\u6743\u9650\u9A8C\u8BC1"})}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"\u76EE\u6807\u89D2\u8272\u4F7F\u7528\u4E34\u65F6\u51ED\u8BC1\u8BBF\u95EES3\u524D\uFF0C\u76EE\u6807\u8D26\u6237\u7684IAM\u7B56\u7565\u5F15\u64CE\u6821\u9A8C\uFF1A\u8BE5\u89D2\u8272\u662F\u5426\u88AB\u6388\u6743\u6267\u884C\u8BF7\u6C42\u7684S3\u64CD\u4F5C\uFF1F\uFF08\u5982s3:GetObject\u3001s3:PutObject\u7B49\uFF09"}),"\n",(0,l.jsx)(s.li,{children:"\u68C0\u67E5\u4F9D\u636E\uFF1A\u9644\u7740\u5728\u76EE\u6807\u89D2\u8272\u4E0A\u7684IAM Permissions Policies\uFF08\u5B9A\u4E49\u89D2\u8272\u80FD\u505A\u4EC0\u4E48\uFF09"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(s.h4,{id:"\u9636\u6BB53-\u8D44\u6E90\u64CD\u4F5C\u6267\u884C",children:"\u9636\u6BB53: \u8D44\u6E90\u64CD\u4F5C\u6267\u884C"}),"\n",(0,l.jsxs)(s.ol,{start:"5",children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"\u8BBF\u95EE\u5B58\u50A8\u6876"}),(0,l.jsx)(s.br,{}),"\n\u5168\u90E8\u9A8C\u8BC1\u901A\u8FC7\u540E\uFF0C\u76EE\u6807\u89D2\u8272\u624D\u53EF\u6267\u884CS3 API\u64CD\u4F5C"]}),"\n"]}),"\n",(0,l.jsx)(s.h2,{id:"\u4E09doris\u5982\u4F55\u5E94\u7528aws-iam-assume-role\u9274\u6743\u673A\u5236",children:"\u4E09\u3001Doris\u5982\u4F55\u5E94\u7528AWS IAM Assume Role\u9274\u6743\u673A\u5236"}),"\n",(0,l.jsxs)(s.ol,{children:["\n",(0,l.jsx)(s.li,{children:"Doris\u901A\u8FC7\u5C06FE\u3001BE\u8FDB\u7A0B\u6240\u90E8\u7F72\u7684AWS EC2 Instances\u7ED1\u5B9A\u5230Source Account\u6765\u4F7F\u7528AWS IAM Assume Role\u529F\u80FD\uFF0C\u4E3B\u8981\u6D41\u7A0B\u5982\u4E0B\u56FE\u6240\u793A\uFF1A"}),"\n"]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.img,{src:n(411088).Z+"",width:"962",height:"522"})}),"\n",(0,l.jsxs)(s.ol,{start:"2",children:["\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsx)(s.p,{children:"\u5B8C\u6210\u914D\u7F6E\u540EDoris FE/BE\u8FDB\u7A0B\u4F1A\u81EA\u52A8\u83B7\u53D6EC2 Instance\u7684Profile\u6267\u884CAssume Role\u64CD\u4F5C\u8BBF\u95EEBucket\u3002\u6269\u5BB9\u65F6BE\u8282\u70B9\u4F1A\u81EA\u52A8\u68C0\u6D4B\u65B0EC2 Instance\u662F\u5426\u6210\u529F\u7ED1\u5B9AIAM Role\uFF0C\u9632\u6B62\u6F0F\u914D;"}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsx)(s.p,{children:"Doris\u7684S3 Load\u3001TVF\u3001Export\u3001Resource\u3001Repository\u3001Storage Vault\u7B49\u529F\u80FD\u57283.0.6+\u7248\u672C\u5747\u652F\u6301AWS Assume Role\u65B9\u5F0F\uFF0C\u6267\u884CSQL\u76F8\u5173\u529F\u80FD\u65F6\u4F1A\u8FDB\u884C\u8FDE\u901A\u6027\u68C0\u6D4B\uFF1A"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-sql",children:'CREATE REPOSITORY `s3_repo`\nWITH S3 ON LOCATION "s3://bucket/path/"\nPROPERTIES (\n  "s3.role_arn" = "arn:aws:iam::1234567890:role/doris-s3-role",\n  "s3.external_id" = "doris-external-id",\n  "timeout" = "3600"\n);\n'})}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(s.p,{children:['\u5176\u4E2D"s3.role_arn" \u5BF9\u5E94\u586B\u5165AWS IAM Account2\u4E0B\u7684Iam role2\u7684arn\u503C,"s3.external_id"\u5BF9\u5E94\u586B\u5165Trust Relationships Policies\u4E2D\u914D\u7F6E\u7684externalId\u7684\u503C(\u53EF\u9009\u914D\u7F6E), \u66F4\u591A\u529F\u80FDSQL\u8BED\u53E5\u529F\u80FD\u8BE6\u7EC6\u53C2\u8003\uFF1A\n',(0,l.jsx)(s.a,{href:"/zh-CN/docs/dev/admin-manual/auth/integrations/aws-authentication-and-authorization#assumed-role-authentication",children:"AWS \u8BA4\u8BC1\u548C\u9274\u6743"}),"."]})]})}function h(e={}){let{wrapper:s}={...(0,r.a)(),...e.components};return s?(0,l.jsx)(s,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},30070:function(e,s,n){n.d(s,{Z:function(){return i}});let i=n.p+"assets/images/aws_iam_role_flow-71a06757a7b7e4c23e1f37447f0b9d45.png"},411088:function(e,s,n){n.d(s,{Z:function(){return i}});let i=n.p+"assets/images/doris_iam_role-59da8a0ee04a67be5f467235c5149702.png"},377544:function(e,s,n){n.d(s,{Z:function(){return i}});let i=n.p+"assets/images/iam_role_access_bucket-25d693a178d882dccf329f9f8167da06.png"},250065:function(e,s,n){n.d(s,{Z:function(){return t},a:function(){return a}});var i=n(667294);let l={},r=i.createContext(l);function a(e){let s=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function t(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:a(e.components),i.createElement(r.Provider,{value:s},e.children)}}}]);