"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["492599"],{327059:function(e,n,t){t.r(n),t.d(n,{default:()=>c,frontMatter:()=>i,metadata:()=>a,assets:()=>l,toc:()=>p,contentTitle:()=>o});var a=JSON.parse('{"id":"data-operate/import/complex-types/bitmap","title":"Bitmap","description":"BITMAP \u7C7B\u578B\u53EF\u4EE5\u5728 Duplicate \u8868\u3001Unique \u8868\u3001Aggregate \u8868\u4E2D\u4F7F\u7528\uFF0C\u53EA\u80FD\u4F5C\u4E3A Key \u7C7B\uFF0C\u65E0\u6CD5\u4F5C\u4E3A Value \u5217\u4F7F\u7528\u3002\u5728 Aggregate \u8868\u4E2D\u4F7F\u7528 BITMAP \u7C7B\u578B\uFF0C\u5176\u5EFA\u8868\u65F6\u5FC5\u987B\u4F7F\u7528\u805A\u5408\u7C7B\u578B BITMAP_UNION\u3002\u7528\u6237\u4E0D\u9700\u8981\u6307\u5B9A\u957F\u5EA6\u548C\u9ED8\u8BA4\u503C\u3002\u957F\u5EA6\u6839\u636E\u6570\u636E\u7684\u805A\u5408\u7A0B\u5EA6\u7CFB\u7EDF\u5185\u63A7\u5236\u3002\u66F4\u591A\u6587\u6863\u53C2\u8003Bitmap\u3002","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs/current/data-operate/import/complex-types/bitmap.md","sourceDirName":"data-operate/import/complex-types","slug":"/data-operate/import/complex-types/bitmap","permalink":"/zh-CN/docs/dev/data-operate/import/complex-types/bitmap","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Bitmap","language":"zh-CN"},"sidebar":"docs","previous":{"title":"JSON","permalink":"/zh-CN/docs/dev/data-operate/import/complex-types/json"},"next":{"title":"HLL","permalink":"/zh-CN/docs/dev/data-operate/import/complex-types/hll"}}'),r=t("785893"),s=t("250065");let i={title:"Bitmap",language:"zh-CN"},o=void 0,l={},p=[{value:"\u4F7F\u7528\u793A\u4F8B",id:"\u4F7F\u7528\u793A\u4F8B",level:2},{value:"\u7B2C 1 \u6B65\uFF1A\u51C6\u5907\u6570\u636E",id:"\u7B2C-1-\u6B65\u51C6\u5907\u6570\u636E",level:3},{value:"\u7B2C 2 \u6B65\uFF1A\u5728\u5E93\u4E2D\u521B\u5EFA\u8868",id:"\u7B2C-2-\u6B65\u5728\u5E93\u4E2D\u521B\u5EFA\u8868",level:3},{value:"\u7B2C 3 \u6B65\uFF1A\u5BFC\u5165\u6570\u636E",id:"\u7B2C-3-\u6B65\u5BFC\u5165\u6570\u636E",level:3},{value:"\u7B2C 4 \u6B65\uFF1A\u68C0\u67E5\u5BFC\u5165\u6570\u636E",id:"\u7B2C-4-\u6B65\u68C0\u67E5\u5BFC\u5165\u6570\u636E",level:3},{value:"\u5BFC\u5165\u542B\u6709\u591A\u4E2A\u5143\u7D20\u7684 bitmap",id:"\u5BFC\u5165\u542B\u6709\u591A\u4E2A\u5143\u7D20\u7684-bitmap",level:2},{value:"bitmap_from_string",id:"bitmap_from_string",level:3},{value:"bitmap_from_array",id:"bitmap_from_array",level:3}];function d(e){let n={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,s.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["BITMAP \u7C7B\u578B\u53EF\u4EE5\u5728 Duplicate \u8868\u3001Unique \u8868\u3001Aggregate \u8868\u4E2D\u4F7F\u7528\uFF0C\u53EA\u80FD\u4F5C\u4E3A Key \u7C7B\uFF0C\u65E0\u6CD5\u4F5C\u4E3A Value \u5217\u4F7F\u7528\u3002\u5728 Aggregate \u8868\u4E2D\u4F7F\u7528 BITMAP \u7C7B\u578B\uFF0C\u5176\u5EFA\u8868\u65F6\u5FC5\u987B\u4F7F\u7528\u805A\u5408\u7C7B\u578B BITMAP_UNION\u3002\u7528\u6237\u4E0D\u9700\u8981\u6307\u5B9A\u957F\u5EA6\u548C\u9ED8\u8BA4\u503C\u3002\u957F\u5EA6\u6839\u636E\u6570\u636E\u7684\u805A\u5408\u7A0B\u5EA6\u7CFB\u7EDF\u5185\u63A7\u5236\u3002\u66F4\u591A\u6587\u6863\u53C2\u8003",(0,r.jsx)(n.a,{href:"../../../sql-manual/basic-element/sql-data-types/aggregate/BITMAP",children:"Bitmap"}),"\u3002"]}),"\n",(0,r.jsx)(n.h2,{id:"\u4F7F\u7528\u793A\u4F8B",children:"\u4F7F\u7528\u793A\u4F8B"}),"\n",(0,r.jsx)(n.h3,{id:"\u7B2C-1-\u6B65\u51C6\u5907\u6570\u636E",children:"\u7B2C 1 \u6B65\uFF1A\u51C6\u5907\u6570\u636E"}),"\n",(0,r.jsx)(n.p,{children:"\u521B\u5EFA\u5982\u4E0B\u7684 csv \u6587\u4EF6\uFF1Atest_bitmap.csv"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"1|koga|17723\n2|nijg|146285\n3|lojn|347890\n4|lofn|489871\n5|jfin|545679\n6|kon|676724\n7|nhga|767689\n8|nfubg|879878\n9|huang|969798\n10|buag|97997\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u7B2C-2-\u6B65\u5728\u5E93\u4E2D\u521B\u5EFA\u8868",children:"\u7B2C 2 \u6B65\uFF1A\u5728\u5E93\u4E2D\u521B\u5EFA\u8868"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:'CREATE TABLE testdb.test_bitmap(\n    typ_id     BIGINT                NULL   COMMENT "ID",\n    hou        VARCHAR(10)           NULL   COMMENT "one",\n    arr        BITMAP  BITMAP_UNION  NOT NULL   COMMENT "two"\n)\nAGGREGATE KEY(typ_id,hou)\nDISTRIBUTED BY HASH(typ_id,hou) BUCKETS 10;\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\u7B2C-3-\u6B65\u5BFC\u5165\u6570\u636E",children:"\u7B2C 3 \u6B65\uFF1A\u5BFC\u5165\u6570\u636E"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:'curl --location-trusted -u <doris_user>:<doris_password> \\\n    -H "column_separator:|" \\\n    -H "columns:typ_id,hou,arr,arr=to_bitmap(arr)" \\\n    -T test_bitmap.csv \\\n    -XPUT http://<fe_ip>:<fe_http_port>/api/testdb/test_bitmap/_stream_load\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\u7B2C-4-\u6B65\u68C0\u67E5\u5BFC\u5165\u6570\u636E",children:"\u7B2C 4 \u6B65\uFF1A\u68C0\u67E5\u5BFC\u5165\u6570\u636E"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"mysql> select typ_id,hou,bitmap_to_string(arr) from testdb.test_bitmap;\n+--------+-------+-----------------------+\n| typ_id | hou   | bitmap_to_string(arr) |\n+--------+-------+-----------------------+\n|      4 | lofn  | 489871                |\n|      6 | kon   | 676724                |\n|      9 | huang | 969798                |\n|      3 | lojn  | 347890                |\n|      8 | nfubg | 879878                |\n|      7 | nhga  | 767689                |\n|      1 | koga  | 17723                 |\n|      2 | nijg  | 146285                |\n|      5 | jfin  | 545679                |\n|     10 | buag  | 97997                 |\n+--------+-------+-----------------------+\n10 rows in set (0.07 sec)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u5BFC\u5165\u542B\u6709\u591A\u4E2A\u5143\u7D20\u7684-bitmap",children:"\u5BFC\u5165\u542B\u6709\u591A\u4E2A\u5143\u7D20\u7684 bitmap"}),"\n",(0,r.jsx)(n.p,{children:"\u4EE5\u4E0B\u5C55\u793A\u4E86 stream load \u5BFC\u5165\u542B\u6709\u591A\u4E2A\u5143\u7D20\u7684 bitmap \u5217\u7684\u4E24\u79CD\u65B9\u6CD5\uFF0C\u7528\u6237\u53EF\u4EE5\u6839\u636E\u81EA\u5DF1\u6E90\u6587\u4EF6\u683C\u5F0F\u9009\u62E9\u5408\u9002\u7684\u65B9\u6CD5\u3002"}),"\n",(0,r.jsx)(n.h3,{id:"bitmap_from_string",children:"bitmap_from_string"}),"\n",(0,r.jsxs)(n.p,{children:["\u4F7F\u7528 ",(0,r.jsx)(n.code,{children:"bitmap_from_string"})," \u5BFC\u5165\u4E0D\u5141\u8BB8\u6E90\u6587\u4EF6\u4E2D arr \u5217\u5B58\u5728\u65B9\u62EC\u53F7\uFF0C\u5426\u5219\u4F1A\u8BA4\u4E3A\u662F\u6570\u636E\u8D28\u91CF\u9519\u8BEF\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"1|koga|17,723\n2|nijg|146,285\n3|lojn|347,890\n4|lofn|489,871\n5|jfin|545,679\n6|kon|676,724\n7|nhga|767,689\n8|nfubg|879,878\n9|huang|969,798\n10|buag|97,997\n"})}),"\n",(0,r.jsx)(n.p,{children:"stream load \u547D\u4EE4"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:'curl --location-trusted -u <doris_user>:<doris_password> \\\n    -H "column_separator:|" \\\n    -H "columns:typ_id,hou,arr,arr=bitmap_from_string(arr)" \\\n    -T test_bitmap.csv \\\n    -XPUT http://<fe_ip>:<fe_http_port>/api/testdb/test_bitmap/_stream_load\n'})}),"\n",(0,r.jsx)(n.h3,{id:"bitmap_from_array",children:"bitmap_from_array"}),"\n",(0,r.jsxs)(n.p,{children:["\u4F7F\u7528 ",(0,r.jsx)(n.code,{children:"bitmap_from_array"})," \u5BFC\u5165\u5141\u8BB8\u6E90\u6587\u4EF6\u4E2D arr \u5217\u5B58\u5728\u65B9\u62EC\u53F7\uFF0C\u4F46\u662F\u5728 stream load \u4E2D\u5FC5\u987B\u5148\u5C06 string \u7C7B\u578B cast \u6210 array \u7C7B\u578B\u4F7F\u7528\u3002\n\u5982\u679C\u4E0D\u52A0 cast \u8F6C\u6362\u53C2\u6570\u7C7B\u578B\uFF0C\u4F1A\u56E0\u4E3A\u627E\u4E0D\u5230\u6B63\u786E\u7684\u51FD\u6570\u7B7E\u540D\u62A5\u9519 ",(0,r.jsx)(n.code,{children:"[ANALYSIS_ERROR]TStatus: errCode = 2, detailMessage = Does not support non-builtin functions, or function does not exist: bitmap_from_array(<slot 8>)"}),"\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"1|koga|[17,723]\n2|nijg|[146,285]\n3|lojn|[347,890]\n4|lofn|[489,871]\n5|jfin|[545,679]\n6|kon|[676,724]\n7|nhga|[767,689]\n8|nfubg|[879,878]\n9|huang|[969,798]\n10|buag|[97,997]\n"})}),"\n",(0,r.jsx)(n.p,{children:"stream load \u547D\u4EE4"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:'curl --location-trusted -u <doris_user>:<doris_password> \\\n    -H "column_separator:|" \\\n    -H "columns:typ_id,hou,arr_str,arr=bitmap_from_array(cast(arr_str as array<int>))" \\\n    -T test_bitmap.csv \\\n    -XPUT http://<fe_ip>:<fe_http_port>/api/testdb/test_bitmap/_stream_load\n'})})]})}function c(e={}){let{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},250065:function(e,n,t){t.d(n,{Z:function(){return o},a:function(){return i}});var a=t(667294);let r={},s=a.createContext(r);function i(e){let n=a.useContext(s);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);