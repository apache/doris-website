"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["534917"],{661723:function(e,n,i){i.r(n),i.d(n,{default:()=>m,frontMatter:()=>r,metadata:()=>t,assets:()=>c,toc:()=>a,contentTitle:()=>o});var t=JSON.parse('{"id":"how-to-contribute/commit-format-specification","title":"Commit \u683C\u5F0F\u89C4\u8303","description":"\x3c!--","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs-community/current/how-to-contribute/commit-format-specification.md","sourceDirName":"how-to-contribute","slug":"/how-to-contribute/commit-format-specification","permalink":"/zh-CN/community/how-to-contribute/commit-format-specification","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Commit \u683C\u5F0F\u89C4\u8303","language":"zh-CN"},"sidebar":"community","previous":{"title":"\u5982\u4F55\u6210\u4E3A Committer","permalink":"/zh-CN/community/how-to-contribute/how-to-be-a-committer"},"next":{"title":"\u6587\u6863\u683C\u5F0F\u89C4\u8303","permalink":"/zh-CN/community/how-to-contribute/docs-format-specification"}}'),l=i("785893"),s=i("250065");let r={title:"Commit \u683C\u5F0F\u89C4\u8303",language:"zh-CN"},o=void 0,c={},a=[{value:"Commit \u683C\u5F0F\u89C4\u8303",id:"commit-\u683C\u5F0F\u89C4\u8303",level:2}];function h(e){let n={code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,s.a)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.h2,{id:"commit-\u683C\u5F0F\u89C4\u8303",children:"Commit \u683C\u5F0F\u89C4\u8303"}),"\n",(0,l.jsx)(n.p,{children:"Commit \u5206\u4E3A\u201C\u6807\u9898\u201D\u548C\u201C\u5185\u5BB9\u201D\u3002\u539F\u5219\u4E0A\u6807\u9898\u5168\u90E8\u5C0F\u5199\u3002\u5185\u5BB9\u9996\u5B57\u6BCD\u5927\u5199\u3002"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"\u6807\u9898"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:"[<type>](<scope>) <subject> (#pr)"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:"<type>"})}),"\n",(0,l.jsx)(n.p,{children:"\u672C\u6B21\u63D0\u4EA4\u7684\u7C7B\u578B\uFF0C\u9650\u5B9A\u5728\u4EE5\u4E0B\u7C7B\u578B\uFF08\u5168\u5C0F\u5199\uFF09"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"fix\uFF1Abug \u4FEE\u590D"}),"\n",(0,l.jsx)(n.li,{children:"feature\uFF1A\u65B0\u589E\u529F\u80FD"}),"\n",(0,l.jsx)(n.li,{children:"feature-wip\uFF1A\u5F00\u53D1\u4E2D\u7684\u529F\u80FD\uFF0C\u6BD4\u5982\u67D0\u529F\u80FD\u7684\u90E8\u5206\u4EE3\u7801\u3002"}),"\n",(0,l.jsx)(n.li,{children:"improvement\uFF1A\u539F\u6709\u529F\u80FD\u7684\u4F18\u5316\u548C\u6539\u8FDB"}),"\n",(0,l.jsx)(n.li,{children:"style\uFF1A\u4EE3\u7801\u98CE\u683C\u8C03\u6574"}),"\n",(0,l.jsx)(n.li,{children:"typo\uFF1A\u4EE3\u7801\u6216\u6587\u6863\u52D8\u8BEF"}),"\n",(0,l.jsx)(n.li,{children:"refactor\uFF1A\u4EE3\u7801\u91CD\u6784\uFF08\u4E0D\u6D89\u53CA\u529F\u80FD\u53D8\u52A8\uFF09"}),"\n",(0,l.jsx)(n.li,{children:"performance/optimize\uFF1A\u6027\u80FD\u4F18\u5316"}),"\n",(0,l.jsx)(n.li,{children:"test\uFF1A\u5355\u5143\u6D4B\u8BD5\u7684\u6DFB\u52A0\u6216\u4FEE\u590D"}),"\n",(0,l.jsx)(n.li,{children:"chore\uFF1A\u6784\u5EFA\u5DE5\u5177\u7684\u4FEE\u6539"}),"\n",(0,l.jsx)(n.li,{children:"revert\uFF1A\u56DE\u6EDA"}),"\n",(0,l.jsx)(n.li,{children:"deps\uFF1A\u7B2C\u4E09\u65B9\u4F9D\u8D56\u5E93\u7684\u4FEE\u6539"}),"\n",(0,l.jsx)(n.li,{children:"community\uFF1A\u793E\u533A\u76F8\u5173\u7684\u4FEE\u6539\uFF0C\u5982\u4FEE\u6539 Github Issue \u6A21\u677F\u7B49\u3002"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"\u51E0\u70B9\u8BF4\u660E\uFF1A"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"\u5982\u5728\u4E00\u6B21\u63D0\u4EA4\u4E2D\u51FA\u73B0\u591A\u79CD\u7C7B\u578B\uFF0C\u9700\u589E\u52A0\u591A\u4E2A\u7C7B\u578B\u3002"}),"\n",(0,l.jsx)(n.li,{children:"\u5982\u4EE3\u7801\u91CD\u6784\u5E26\u6765\u4E86\u6027\u80FD\u63D0\u5347\uFF0C\u53EF\u4EE5\u540C\u65F6\u6DFB\u52A0 [refactor][optimize]"}),"\n",(0,l.jsx)(n.li,{children:"\u4E0D\u5F97\u51FA\u73B0\u5982\u4E0A\u6240\u5217\u7C7B\u578B\u4E4B\u5916\u7684\u5176\u4ED6\u7C7B\u578B\u3002\u5982\u6709\u5FC5\u8981\uFF0C\u9700\u8981\u5C06\u65B0\u589E\u7C7B\u578B\u6DFB\u52A0\u5230\u8FD9\u4E2A\u6587\u6863\u4E2D\u3002"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:"<scope>"})}),"\n",(0,l.jsx)(n.p,{children:"\u672C\u6B21\u63D0\u4EA4\u6D89\u53CA\u7684\u6A21\u5757\u8303\u56F4\u3002\u56E0\u4E3A\u529F\u80FD\u6A21\u5757\u7E41\u591A\uFF0C\u5728\u6B64\u4EC5\u7F57\u5217\u90E8\u5206\uFF0C\u540E\u7EED\u6839\u636E\u9700\u6C42\u4E0D\u65AD\u5B8C\u5584\u3002"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"planner"}),"\n",(0,l.jsx)(n.li,{children:"meta"}),"\n",(0,l.jsx)(n.li,{children:"storage"}),"\n",(0,l.jsx)(n.li,{children:"stream-load"}),"\n",(0,l.jsx)(n.li,{children:"broker-load"}),"\n",(0,l.jsx)(n.li,{children:"routine-load"}),"\n",(0,l.jsx)(n.li,{children:"sync-job"}),"\n",(0,l.jsx)(n.li,{children:"export"}),"\n",(0,l.jsx)(n.li,{children:"executor"}),"\n",(0,l.jsx)(n.li,{children:"spark-connector"}),"\n",(0,l.jsx)(n.li,{children:"flink-connector"}),"\n",(0,l.jsx)(n.li,{children:"datax"}),"\n",(0,l.jsx)(n.li,{children:"log"}),"\n",(0,l.jsx)(n.li,{children:"cache"}),"\n",(0,l.jsx)(n.li,{children:"config"}),"\n",(0,l.jsx)(n.li,{children:"vectorization"}),"\n",(0,l.jsx)(n.li,{children:"docs"}),"\n",(0,l.jsx)(n.li,{children:"profile"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"\u51E0\u70B9\u8BF4\u660E\uFF1A"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"\u5C3D\u91CF\u4F7F\u7528\u5217\u8868\u4E2D\u5DF2\u5B58\u5728\u7684\u9009\u9879\u3002\u5982\u9700\u6DFB\u52A0\uFF0C\u8BF7\u53CA\u65F6\u66F4\u65B0\u672C\u6587\u6863\u3002"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:"<subject>"})}),"\n",(0,l.jsx)(n.p,{children:"\u6807\u9898\u9700\u5C3D\u91CF\u6E05\u6670\u8868\u660E\u672C\u6B21\u63D0\u4EA4\u7684\u4E3B\u8981\u5185\u5BB9\u3002"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"\u5185\u5BB9"}),"\n",(0,l.jsx)(n.p,{children:"commit message \u9700\u9075\u5FAA\u4EE5\u4E0B\u683C\u5F0F\uFF1A"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"issue\uFF1A#7777\n\nyour message\n"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"\u5982\u65E0 issue\uFF0C\u53EF\u4E0D\u586B\u3002issue \u4E5F\u53EF\u4EE5\u51FA\u73B0\u5728 message \u91CC\u3002"}),"\n",(0,l.jsx)(n.li,{children:"\u4E00\u884C\u539F\u5219\u4E0D\u8D85\u8FC7 100 \u4E2A\u5B57\u7B26\u3002"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"\u793A\u4F8B"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"[fix](executor) change DateTimeValue's memory layout to load (#7022)\n\nChange DateTimeValue memory's layout to old to fix compatibility problems.\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"[feat](log) extend logger interface, support structured log output(#6600)    \n\nSupport structured logging.\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"[fix][feat-opt](executor)(load)(config) fix some memory bugs (#6699)\n\n1. Fix a memory leak in `collect_iterator.cpp` (Fix #6700)\n2. Add a new BE config `max_segment_num_per_rowset` to limit the num of segment in new rowset.(Fix #6701)\n3. Make the error msg of stream load more friendly.\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"[feat-opt](load) Reduce the number of segments when loading a large volume data in one batch (#6947)\n\n## Case\n\nIn the load process, each tablet will have a memtable to save the incoming data,\nand if the data in a memtable is larger than 100MB, it will be flushed to disk\nas a `segment` file. And then a new memtable will be created to save the following data.\n\nAssume that this is a table with N buckets(tablets). So the max size of all memtables\nwill be `N * 100MB`. If N is large, it will cost too much memory.\n\nSo for memory limit purpose, when the size of all memtables reach a threshold(2GB as default),\nDoris will try to flush all current memtables to disk(even if their size are not reach 100MB).\n\nSo you will see that the memtable will be flushed when it's size reach `2GB/N`, which maybe much\nsmaller than 100MB, resulting in too many small segment files.\n\n## Solution\n\nWhen decide to flush memtable to reduce memory consumption, NOT to flush all memtable,\nbut to flush part of them.\n\nFor example, there are 50 tablets(with 50 memtables). The memory limit is 1GB,\nso when each memtable reach 20MB, the total size reach 1GB, and flush will occur.\n\nIf I only flush 25 of 50 memtables, then next time when the total size reach 1GB,\nthere will be 25 memtables with size 10MB, and other 25 memtables with size 30MB.\nSo I can flush those memtables with size 30MB, which is larger than 20MB.\n\nThe main idea is to introduce some jitter during flush to ensure the small unevenness\nof each memtable, so as to ensure that flush will only be triggered when the memtable\nis large enough.\n\nIn my test, loading a table with 48 buckets, mem limit 2G, in previous version,\nthe average memtable size is 44MB, after modification, the average size is 82MB\n"})}),"\n"]}),"\n"]})]})}function m(e={}){let{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(h,{...e})}):h(e)}},250065:function(e,n,i){i.d(n,{Z:function(){return o},a:function(){return r}});var t=i(667294);let l={},s=t.createContext(l);function r(e){let n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:r(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);