"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["559426"],{310591:function(n,e,s){s.r(e),s.d(e,{default:()=>E,frontMatter:()=>t,metadata:()=>c,assets:()=>i,toc:()=>a,contentTitle:()=>r});var c=JSON.parse('{"id":"sql-manual/basic-element/sql-data-types/semi-structured/STRUCT","title":"STRUCT | Semi Structured","description":"STRUCT \u7C7B\u578B\u7528\u4E8E\u5C06\u591A\u4E2A\u5B57\u6BB5\u7EC4\u5408\u6210\u4E00\u4E2A\u7ED3\u6784\u4F53\uFF0C\u6BCF\u4E2A\u5B57\u6BB5\u53EF\u4EE5\u6709\u81EA\u5DF1\u7684\u540D\u5B57\u548C\u7C7B\u578B\uFF0C\u9002\u5408\u8868\u793A\u5D4C\u5957\u6216\u590D\u6742\u7684\u4E1A\u52A1\u6570\u636E\u7ED3\u6784\u3002","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs/version-4.x/sql-manual/basic-element/sql-data-types/semi-structured/STRUCT.md","sourceDirName":"sql-manual/basic-element/sql-data-types/semi-structured","slug":"/sql-manual/basic-element/sql-data-types/semi-structured/STRUCT","permalink":"/zh-CN/docs/4.x/sql-manual/basic-element/sql-data-types/semi-structured/STRUCT","draft":false,"unlisted":false,"tags":[],"version":"4.x","lastUpdatedAt":1770477659000,"frontMatter":{"title":"STRUCT | Semi Structured","language":"zh-CN","description":"STRUCT \u7C7B\u578B\u7528\u4E8E\u5C06\u591A\u4E2A\u5B57\u6BB5\u7EC4\u5408\u6210\u4E00\u4E2A\u7ED3\u6784\u4F53\uFF0C\u6BCF\u4E2A\u5B57\u6BB5\u53EF\u4EE5\u6709\u81EA\u5DF1\u7684\u540D\u5B57\u548C\u7C7B\u578B\uFF0C\u9002\u5408\u8868\u793A\u5D4C\u5957\u6216\u590D\u6742\u7684\u4E1A\u52A1\u6570\u636E\u7ED3\u6784\u3002","sidebar_label":"STRUCT"},"sidebar":"docs","previous":{"title":"MAP","permalink":"/zh-CN/docs/4.x/sql-manual/basic-element/sql-data-types/semi-structured/MAP"},"next":{"title":"JSON","permalink":"/zh-CN/docs/4.x/sql-manual/basic-element/sql-data-types/semi-structured/JSON"}}'),l=s("785893"),T=s("250065");let t={title:"STRUCT | Semi Structured",language:"zh-CN",description:"STRUCT \u7C7B\u578B\u7528\u4E8E\u5C06\u591A\u4E2A\u5B57\u6BB5\u7EC4\u5408\u6210\u4E00\u4E2A\u7ED3\u6784\u4F53\uFF0C\u6BCF\u4E2A\u5B57\u6BB5\u53EF\u4EE5\u6709\u81EA\u5DF1\u7684\u540D\u5B57\u548C\u7C7B\u578B\uFF0C\u9002\u5408\u8868\u793A\u5D4C\u5957\u6216\u590D\u6742\u7684\u4E1A\u52A1\u6570\u636E\u7ED3\u6784\u3002",sidebar_label:"STRUCT"},r="STRUCT",i={},a=[{value:"\u7C7B\u578B\u63CF\u8FF0",id:"\u7C7B\u578B\u63CF\u8FF0",level:2},{value:"\u7C7B\u578B\u7EA6\u675F",id:"\u7C7B\u578B\u7EA6\u675F",level:2},{value:"\u7C7B\u578B\u6784\u9020",id:"\u7C7B\u578B\u6784\u9020",level:2},{value:"\u4FEE\u6539\u7C7B\u578B",id:"\u4FEE\u6539\u7C7B\u578B",level:2},{value:"\u5143\u7D20\u8BBF\u95EE",id:"\u5143\u7D20\u8BBF\u95EE",level:2},{value:"\u793A\u4F8B",id:"\u793A\u4F8B",level:2}];function d(n){let e={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,T.a)(),...n.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.header,{children:(0,l.jsx)(e.h1,{id:"struct",children:"STRUCT"})}),"\n",(0,l.jsx)(e.h2,{id:"\u7C7B\u578B\u63CF\u8FF0",children:"\u7C7B\u578B\u63CF\u8FF0"}),"\n",(0,l.jsx)(e.p,{children:"STRUCT \u7C7B\u578B\u7528\u4E8E\u5C06\u591A\u4E2A\u5B57\u6BB5\u7EC4\u5408\u6210\u4E00\u4E2A\u7ED3\u6784\u4F53\uFF0C\u6BCF\u4E2A\u5B57\u6BB5\u53EF\u4EE5\u6709\u81EA\u5DF1\u7684\u540D\u5B57\u548C\u7C7B\u578B\uFF0C\u9002\u5408\u8868\u793A\u5D4C\u5957\u6216\u590D\u6742\u7684\u4E1A\u52A1\u6570\u636E\u7ED3\u6784\u3002"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"STRUCT<field_name:field_type [COMMENT 'comment_string'], ... >"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"field_name"})," \u8868\u5F81\u540D\u5B57\uFF0C",(0,l.jsx)(e.strong,{children:"\u4E0D\u53EF\u4E3A\u7A7A\uFF0C\u4E0D\u53EF\u91CD\u590D\uFF0C\u540D\u5B57\u4E0D\u533A\u5206\u5927\u5C0F\u5199"}),"\u3002"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"field_type"})," \u8868\u5F81\u7C7B\u578B\uFF0C\u7C7B\u578B\u662FNullable\u7684\uFF0C\u4E0D\u53EF\u6307\u5B9ANOT NULL\uFF0C\u652F\u6301\u7684\u7C7B\u578B\u6709\uFF1A",(0,l.jsx)(e.code,{children:"BOOLEAN, TINYINT, SMALLINT, INT, BIGINT, LARGEINT, FLOAT, DOUBLE, DECIMAL, DATE, DATETIME, CHAR, VARCHAR, STRING, IPTV4, IPV6, ARRAY, MAP, STRUCT"}),"\u3002"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"[COMMENT 'comment-string']"})," \u8868\u5F81\u6CE8\u91CA\uFF0C\u53EF\u9009\u7684\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"\u7C7B\u578B\u7EA6\u675F",children:"\u7C7B\u578B\u7EA6\u675F"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"STRUCT"}),"\u7C7B\u578B\u652F\u6301\u7684\u6700\u5927\u5D4C\u5957\u6DF1\u5EA6\u4E3A 9\u3002"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"STRUCT"})," \u7C7B\u578B\u4E4B\u95F4\u7684\u8F6C\u6362\u53D6\u51B3\u4E8E\u5185\u90E8\u7684\u7C7B\u578B\u4E4B\u95F4\u662F\u5426\u80FD\u8F6C\u6362(\u540D\u5B57\u4E0D\u5F71\u54CD\u8F6C\u6362)\uFF0C",(0,l.jsx)(e.code,{children:"STRUCT"}),"\u7C7B\u578B\u4E0D\u80FD\u8F6C\u6210\u5176\u4ED6\u7C7B\u578B\u3002\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["\u5B57\u7B26\u4E32\u7C7B\u578B\u53EF\u4EE5\u8F6C\u6362\u6210",(0,l.jsx)(e.code,{children:"STRUCT"}),"\u7C7B\u578B\uFF08\u901A\u8FC7\u89E3\u6790\u7684\u5F62\u5F0F\uFF0C\u89E3\u6790\u5931\u8D25\u8FD4\u56DE NULL\uFF09\u3002"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"STRUCT"})," \u7C7B\u578B\u5728",(0,l.jsx)(e.code,{children:"AGGREGATE"}),"\u8868\u6A21\u578B\u4E2D\u53EA\u652F\u6301",(0,l.jsx)(e.code,{children:"REPLACE"}),"\u548C",(0,l.jsx)(e.code,{children:"REPLACE_IF_NOT_NULL"}),"\uFF0C",(0,l.jsx)(e.strong,{children:"\u5728\u4EFB\u4F55\u8868\u6A21\u578B\u4E2D\u90FD\u65E0\u6CD5\u4F5C\u4E3AKEY\u5217\uFF0C\u65E0\u6CD5\u4F5C\u4E3A\u5206\u533A\u5206\u6876\u5217\u3002"})]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"STRUCT"}),"\u7C7B\u578B\u7684\u5217\u4E0D\u652F\u6301\u6BD4\u8F83\u6216\u8005\u7B97\u6570\u8FD0\u7B97\uFF0C",(0,l.jsxs)(e.strong,{children:["\u4E0D\u652F\u6301",(0,l.jsx)(e.code,{children:"ORDER BY"}),"\u548C",(0,l.jsx)(e.code,{children:"GROUP BY"}),"\u64CD\u4F5C\uFF0C\u4E0D\u652F\u6301\u4F5C\u4E3A",(0,l.jsx)(e.code,{children:"JOIN KEY"}),"\uFF0C\u4E0D\u652F\u6301\u5728",(0,l.jsx)(e.code,{children:"DELETE"}),"\u8BED\u53E5\u4E2D\u4F7F\u7528"]}),"\u3002"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"STRUCT"}),"\u7C7B\u578B\u7684\u5217\u4E0D\u652F\u6301\u5EFA\u7ACB\u4EFB\u4F55\u7D22\u5F15\u3002"]}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"\u7C7B\u578B\u6784\u9020",children:"\u7C7B\u578B\u6784\u9020"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["\u4F7F\u7528",(0,l.jsx)(e.code,{children:"STRUCT()"}),"\u53EF\u4EE5\u6784\u9020\u4E00\u4E2A\u7684",(0,l.jsx)(e.code,{children:"STRUCT"}),"\u7C7B\u578B\u7684\u503C,",(0,l.jsx)(e.code,{children:"STRUCT"}),"\u5185\u90E8\u7684\u540D\u5B57\u4ECEcol1\u5F00\u59CB\u3002\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-SQL",children:'SELECT STRUCT(1, \'a\', "abc");\n\n+--------------------------------------+\n| STRUCT(1, \'a\', "abc")                |\n+--------------------------------------+\n| {"col1":1, "col2":"a", "col3":"abc"} |\n+--------------------------------------+\n'})}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\u4F7F\u7528",(0,l.jsx)(e.code,{children:"NAMED_STRUCT()"})," \u6784\u9020\u4E00\u4E2A\u65E2\u5B9A\u7684",(0,l.jsx)(e.code,{children:"STRUCT"}),"\u7C7B\u578B\u7684\u503C\u3002\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-SQL",children:'SELECT NAMED_STRUCT("name", "Jack", "id", 1728923);\n\n+---------------------------------------------+\n| NAMED_STRUCT("name", "Jack", "id", 1728923) |\n+---------------------------------------------+\n| {"name":"Jack", "id":1728923}               |\n+---------------------------------------------+\n'})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"\u4FEE\u6539\u7C7B\u578B",children:"\u4FEE\u6539\u7C7B\u578B"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:"STRUCT"}),"\u7684\u5B50\u5217\u7C7B\u578B\u4E3A",(0,l.jsx)(e.code,{children:"VARCHAR"}),"\u65F6\uFF0C\u624D\u5141\u8BB8\u8FDB\u884C\u4FEE\u6539\u3002"]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["\u53EA\u5141\u8BB8\u5C06",(0,l.jsx)(e.code,{children:"VARCHAR"}),"\u7684\u53C2\u6570\u4ECE\u5C0F\u6539\u5230\u5927\u3002\u53CD\u4E4B\u4E0D\u884C\u3002"]}),"\n"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-SQL",children:'CREATE TABLE struct_table (\n    `k` INT NOT NULL,\n    `struct_varchar` STRUCT<name: VARCHAR(10), age: INT>\n) ENGINE=OLAP\nDUPLICATE KEY(`k`)\nDISTRIBUTED BY HASH(`k`) BUCKETS 1\nPROPERTIES (\n    "replication_num" = "1"\n);\n\nALTER TABLE struct_table MODIFY COLUMN struct_varchar STRUCT<name: VARCHAR(20), age: INT>;\n'})}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:"STRUCT"}),"\u7C7B\u578B\u5185\u90E8\u7684\u5B50\u5217\u4E0D\u652F\u6301\u5220\u9664\uFF0C\u53EF\u4EE5\u5728\u672B\u5C3E\u589E\u52A0\u5B50\u5217\u3002"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-SQL",children:'  CREATE TABLE struct_table (\n      `k` INT NOT NULL,\n      `struct_varchar` STRUCT<name: VARCHAR(10), age: INT>\n  ) ENGINE=OLAP\n  DUPLICATE KEY(`k`)\n  DISTRIBUTED BY HASH(`k`) BUCKETS 1\n  PROPERTIES (\n      "replication_num" = "1"\n  );\n\n  -- \u5728\u672B\u5C3E\u589E\u52A0\u4E00\u4E2A\u5B50\u5217\n  ALTER TABLE struct_table MODIFY COLUMN struct_varchar STRUCT<name: VARCHAR(10), age: INT, id: INT>;\n'})}),"\n",(0,l.jsx)(e.h2,{id:"\u5143\u7D20\u8BBF\u95EE",children:"\u5143\u7D20\u8BBF\u95EE"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["\u4F7F\u7528",(0,l.jsx)(e.code,{children:"STRUCT_ELEMENT(struct, k/field_name)"}),"\u8BBF\u95EE",(0,l.jsx)(e.code,{children:"STRUCT"}),"\u5185\u90E8\u7684\u67D0\u4E00\u4E2A\u5B50\u5217\u3002\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"k\u8868\u5F81\u4F4D\u7F6E\uFF0C\u4ECE1\u5F00\u59CB\u3002"}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"filed_name"})," \u662F",(0,l.jsx)(e.code,{children:"STRUCT"}),"\u7684\u5B50\u5217\u7684\u540D\u5B57\u3002"]}),"\n"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-SQL",children:'SELECT STRUCT_ELEMENT(NAMED_STRUCT("name", "Jack", "id", 1728923), 1);\n\n+----------------------------------------------------------------+\n| STRUCT_ELEMENT(NAMED_STRUCT("name", "Jack", "id", 1728923), 1) |\n+----------------------------------------------------------------+\n| Jack                                                           |\n+----------------------------------------------------------------+\n\n\nSELECT STRUCT_ELEMENT(NAMED_STRUCT("name", "Jack", "id", 1728923), "id");\n\n+-------------------------------------------------------------------+\n| STRUCT_ELEMENT(NAMED_STRUCT("name", "Jack", "id", 1728923), "id") |\n+-------------------------------------------------------------------+\n|                                                           1728923 |\n+-------------------------------------------------------------------+\n'})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"\u793A\u4F8B",children:"\u793A\u4F8B"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:"\u5D4C\u5957\u590D\u6742\u7C7B\u578B"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-SQL",children:"-- \u5EFA\u8868\nCREATE TABLE IF NOT EXISTS struct_table (\n    id INT,\n    struct_complex STRUCT<\n        basic_info: STRUCT<name: STRING, age: INT>,\n        contact: STRUCT<email: STRING, phone: STRING>,\n        preferences: STRUCT<tags: ARRAY<STRING>, settings: MAP<STRING, INT>>,\n        metadata: STRUCT<\n            created_at: DATETIME,\n            updated_at: DATETIME,\n            stats: STRUCT<views: INT, clicks: INT>\n        >\n    >\n) ENGINE=OLAP\nDUPLICATE KEY(id)\nDISTRIBUTED BY HASH(id) BUCKETS 1\nPROPERTIES (\n    \"replication_allocation\" = \"tag.location.default: 1\"\n);\n\n-- \u63D2\u5165\nINSERT INTO struct_table VALUES (1, STRUCT(\n  STRUCT('John', 25),\n  STRUCT('john@example.com', '1234567890'),\n  STRUCT(['tag1', 'tag2'], MAP('setting1', 1, 'setting2', 2)),\n  STRUCT('2021-01-01 00:00:00', '2021-01-02 00:00:00', STRUCT(100, 50))\n));\n\n-- \u67E5\u8BE2\nSELECT STRUCT_ELEMENT(STRUCT_ELEMENT(struct_complex, 'basic_info'), 'name')  FROM struct_table order by id;\n+----------------------------------------------------------------------+\n| STRUCT_ELEMENT(STRUCT_ELEMENT(struct_complex, 'basic_info'), 'name') |\n+----------------------------------------------------------------------+\n| John                                                                 |\n+----------------------------------------------------------------------+\n\nSELECT STRUCT_ELEMENT(STRUCT_ELEMENT(STRUCT_ELEMENT(struct_complex, 'metadata'), 'stats'), 'views') FROM struct_table order by id;\n+----------------------------------------------------------------------------------------------+\n| STRUCT_ELEMENT(STRUCT_ELEMENT(STRUCT_ELEMENT(struct_complex, 'metadata'), 'stats'), 'views') |\n+----------------------------------------------------------------------------------------------+\n|                                                                                          100 |\n+----------------------------------------------------------------------------------------------+\n"})}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:"\u4FEE\u6539\u7C7B\u578B"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-SQL",children:'-- \u5EFA\u8868\nCREATE TABLE struct_table (\n      `k` INT NOT NULL,\n      `struct_varchar` STRUCT<name: VARCHAR(10), age: INT>\n  ) ENGINE=OLAP\n  DUPLICATE KEY(`k`)\n  DISTRIBUTED BY HASH(`k`) BUCKETS 1\n  PROPERTIES (\n      "replication_num" = "1"\n  );\n\n  -- \u4FEE\u6539 name \u8FD9\u4E00\u5217\u7684\u7C7B\u578B\n  ALTER TABLE struct_table MODIFY COLUMN struct_varchar STRUCT<name: VARCHAR(20), age: INT>;\n\n  -- \u67E5\u770B\u5217\u7C7B\u578B\n  DESC struct_table;\n  +----------------+----------------------------------+------+-------+---------+-------+\n  | Field          | Type                             | Null | Key   | Default | Extra |\n  +----------------+----------------------------------+------+-------+---------+-------+\n  | k              | int                              | No   | true  | NULL    |       |\n  | struct_varchar | struct<name:varchar(20),age:int> | Yes  | false | NULL    | NONE  |\n  +----------------+----------------------------------+------+-------+---------+-------+\n  \n  -- \u5EFA\u8868\n  CREATE TABLE struct_table (\n      `k` INT NOT NULL,\n      `struct_varchar` STRUCT<name: VARCHAR(10), age: INT>\n  ) ENGINE=OLAP\n  DUPLICATE KEY(`k`)\n  DISTRIBUTED BY HASH(`k`) BUCKETS 1\n  PROPERTIES (\n      "replication_num" = "1"\n  );\n\n  -- \u5728\u672B\u5C3E\u589E\u52A0\u4E00\u4E2A\u5B50\u5217\n  ALTER TABLE struct_table MODIFY COLUMN struct_varchar STRUCT<name: VARCHAR(10), age: INT, id: INT>;\n\n  -- \u67E5\u770B\u5217\u7C7B\u578B\n  DESC struct_table;\n  +----------------+-----------------------------------------+------+-------+---------+-------+\n  | Field          | Type                                    | Null | Key   | Default | Extra |\n  +----------------+-----------------------------------------+------+-------+---------+-------+\n  | k              | int                                     | No   | true  | NULL    |       |\n  | struct_varchar | struct<name:varchar(10),age:int,id:int> | Yes  | false | NULL    | NONE  |\n  +----------------+-----------------------------------------+------+-------+---------+-------+\n'})})]})}function E(n={}){let{wrapper:e}={...(0,T.a)(),...n.components};return e?(0,l.jsx)(e,{...n,children:(0,l.jsx)(d,{...n})}):d(n)}},250065:function(n,e,s){s.d(e,{Z:function(){return r},a:function(){return t}});var c=s(667294);let l={},T=c.createContext(l);function t(n){let e=c.useContext(T);return c.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(l):n.components||l:t(n.components),c.createElement(T.Provider,{value:e},n.children)}}}]);