"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["191108"],{522011:function(e,n,t){t.r(n),t.d(n,{default:()=>c,frontMatter:()=>a,metadata:()=>i,assets:()=>u,toc:()=>o,contentTitle:()=>l});var i=JSON.parse('{"id":"query-acceleration/tuning/tuning-execution/adjustment-of-runtimefilter-wait-time","title":"RuntimeFilter \u7684\u7B49\u5F85\u65F6\u95F4\u8C03\u6574","description":"\u5B9E\u9645\u751F\u4EA7\u573A\u666F\u4F1A\u9047\u5230\u56E0\u4E3A RuntimeFilter \u7B49\u5F85\u65F6\u95F4\u4E0D\u5408\u7406\uFF0C\u5F15\u8D77\u7684\u6027\u80FD\u95EE\u9898\u7684\u60C5\u51B5\u3002RuntimeFilter \u662F\u4E00\u79CD\u67E5\u8BE2\u4F18\u5316\u6280\u672F\uFF0C\u5B83\u901A\u8FC7\u8FD0\u884C\u65F6\u751F\u6210\u8FC7\u6EE4\u6761\u4EF6\uFF0C\u4ECE\u800C\u907F\u514D\u4E86\u5BF9\u65E0\u5173\u6570\u636E\u7684\u626B\u63CF\u3002\u8FD9\u79CD\u4F18\u5316\u65B9\u5F0F\u80FD\u591F\u5927\u5E45\u51CF\u5C11 I/O \u64CD\u4F5C\u548C\u8BA1\u7B97\u91CF\uFF0C\u8FDB\u800C\u52A0\u901F\u67E5\u8BE2\u6267\u884C\u3002\u4E0B\u9762\u4ECB\u7ECD\u51E0\u79CD\u5E38\u89C1\u7684\u6848\u4F8B\uFF0C","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs/version-3.x/query-acceleration/tuning/tuning-execution/adjustment-of-runtimefilter-wait-time.md","sourceDirName":"query-acceleration/tuning/tuning-execution","slug":"/query-acceleration/tuning/tuning-execution/adjustment-of-runtimefilter-wait-time","permalink":"/zh-CN/docs/3.x/query-acceleration/tuning/tuning-execution/adjustment-of-runtimefilter-wait-time","draft":false,"unlisted":false,"tags":[],"version":"3.x","lastUpdatedAt":1770477659000,"frontMatter":{"title":"RuntimeFilter \u7684\u7B49\u5F85\u65F6\u95F4\u8C03\u6574","language":"zh-CN","description":"\u5B9E\u9645\u751F\u4EA7\u573A\u666F\u4F1A\u9047\u5230\u56E0\u4E3A RuntimeFilter \u7B49\u5F85\u65F6\u95F4\u4E0D\u5408\u7406\uFF0C\u5F15\u8D77\u7684\u6027\u80FD\u95EE\u9898\u7684\u60C5\u51B5\u3002RuntimeFilter \u662F\u4E00\u79CD\u67E5\u8BE2\u4F18\u5316\u6280\u672F\uFF0C\u5B83\u901A\u8FC7\u8FD0\u884C\u65F6\u751F\u6210\u8FC7\u6EE4\u6761\u4EF6\uFF0C\u4ECE\u800C\u907F\u514D\u4E86\u5BF9\u65E0\u5173\u6570\u636E\u7684\u626B\u63CF\u3002\u8FD9\u79CD\u4F18\u5316\u65B9\u5F0F\u80FD\u591F\u5927\u5E45\u51CF\u5C11 I/O \u64CD\u4F5C\u548C\u8BA1\u7B97\u91CF\uFF0C\u8FDB\u800C\u52A0\u901F\u67E5\u8BE2\u6267\u884C\u3002\u4E0B\u9762\u4ECB\u7ECD\u51E0\u79CD\u5E38\u89C1\u7684\u6848\u4F8B\uFF0C"},"sidebar":"docs","previous":{"title":"DML \u8BA1\u5212\u8C03\u4F18","permalink":"/zh-CN/docs/3.x/query-acceleration/tuning/tuning-plan/dml-tuning-plan"},"next":{"title":"\u6570\u636E\u503E\u659C\u5904\u7406","permalink":"/zh-CN/docs/3.x/query-acceleration/tuning/tuning-execution/data-skew-handling"}}'),r=t("785893"),s=t("250065");let a={title:"RuntimeFilter \u7684\u7B49\u5F85\u65F6\u95F4\u8C03\u6574",language:"zh-CN",description:"\u5B9E\u9645\u751F\u4EA7\u573A\u666F\u4F1A\u9047\u5230\u56E0\u4E3A RuntimeFilter \u7B49\u5F85\u65F6\u95F4\u4E0D\u5408\u7406\uFF0C\u5F15\u8D77\u7684\u6027\u80FD\u95EE\u9898\u7684\u60C5\u51B5\u3002RuntimeFilter \u662F\u4E00\u79CD\u67E5\u8BE2\u4F18\u5316\u6280\u672F\uFF0C\u5B83\u901A\u8FC7\u8FD0\u884C\u65F6\u751F\u6210\u8FC7\u6EE4\u6761\u4EF6\uFF0C\u4ECE\u800C\u907F\u514D\u4E86\u5BF9\u65E0\u5173\u6570\u636E\u7684\u626B\u63CF\u3002\u8FD9\u79CD\u4F18\u5316\u65B9\u5F0F\u80FD\u591F\u5927\u5E45\u51CF\u5C11 I/O \u64CD\u4F5C\u548C\u8BA1\u7B97\u91CF\uFF0C\u8FDB\u800C\u52A0\u901F\u67E5\u8BE2\u6267\u884C\u3002\u4E0B\u9762\u4ECB\u7ECD\u51E0\u79CD\u5E38\u89C1\u7684\u6848\u4F8B\uFF0C"},l="RuntimeFilter \u7684\u7B49\u5F85\u65F6\u95F4\u8C03\u6574",u={},o=[{value:"\u6982\u8FF0",id:"\u6982\u8FF0",level:2},{value:"\u6848\u4F8B\uFF1ARuntimeFilter \u7B49\u5F85\u65F6\u95F4\u8FC7\u77ED",id:"\u6848\u4F8Bruntimefilter-\u7B49\u5F85\u65F6\u95F4\u8FC7\u77ED",level:2},{value:"\u603B\u7ED3",id:"\u603B\u7ED3",level:2}];function m(e){let n={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,s.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"runtimefilter-\u7684\u7B49\u5F85\u65F6\u95F4\u8C03\u6574",children:"RuntimeFilter \u7684\u7B49\u5F85\u65F6\u95F4\u8C03\u6574"})}),"\n",(0,r.jsx)(n.h2,{id:"\u6982\u8FF0",children:"\u6982\u8FF0"}),"\n",(0,r.jsx)(n.p,{children:"\u5B9E\u9645\u751F\u4EA7\u573A\u666F\u4F1A\u9047\u5230\u56E0\u4E3A RuntimeFilter \u7B49\u5F85\u65F6\u95F4\u4E0D\u5408\u7406\uFF0C\u5F15\u8D77\u7684\u6027\u80FD\u95EE\u9898\u7684\u60C5\u51B5\u3002RuntimeFilter \u662F\u4E00\u79CD\u67E5\u8BE2\u4F18\u5316\u6280\u672F\uFF0C\u5B83\u901A\u8FC7\u8FD0\u884C\u65F6\u751F\u6210\u8FC7\u6EE4\u6761\u4EF6\uFF0C\u4ECE\u800C\u907F\u514D\u4E86\u5BF9\u65E0\u5173\u6570\u636E\u7684\u626B\u63CF\u3002\u8FD9\u79CD\u4F18\u5316\u65B9\u5F0F\u80FD\u591F\u5927\u5E45\u51CF\u5C11 I/O \u64CD\u4F5C\u548C\u8BA1\u7B97\u91CF\uFF0C\u8FDB\u800C\u52A0\u901F\u67E5\u8BE2\u6267\u884C\u3002\u4E0B\u9762\u4ECB\u7ECD\u51E0\u79CD\u5E38\u89C1\u7684\u6848\u4F8B\uFF0C\u5E2E\u52A9\u5728\u6570\u636E\u503E\u659C\u573A\u666F\u4E0B\u8FDB\u884C\u8C03\u4F18\u3002\u3002"}),"\n",(0,r.jsx)(n.h2,{id:"\u6848\u4F8Bruntimefilter-\u7B49\u5F85\u65F6\u95F4\u8FC7\u77ED",children:"\u6848\u4F8B\uFF1ARuntimeFilter \u7B49\u5F85\u65F6\u95F4\u8FC7\u77ED"}),"\n",(0,r.jsx)(n.p,{children:"\u53C2\u8003\u4E0B\u9762 Profile \u7684\u4FE1\u606F\uFF1A"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-SQL",children:"OLAP_SCAN_OPERATOR (id=22. nereids_id=1764. table name = test_doris(test_doris)):(ExecTime: 62.870ms)\n               - RuntimeFilters: : RuntimeFilter: (id = 6, type = minmax, need_local_merge: true, is_broadcast: false, build_bf_cardinality: false, RuntimeFilter: (id = 7, type = in_or_bloomfilter, need_local_merge: true, is_broadcast: false, build_bf_cardinality: false, \n               - PushDownPredicates: []\n               - KeyRanges: ScanKeys:ScanKey=[null(-9223372036854775808) : 9223372036854775807]\n               - TabletIds: [1732763414173, 1732763414187, 1732763414201, 1732763414215]\n               - UseSpecificThreadToken: False\n               - AcquireRuntimeFilterTime: 969ns\n               - BlocksProduced: 1.829K (1829)\n               - CloseTime: 0ns\n               - ExecTime: 62.870ms\n               - InitTime: 75.703us\n               - KeyRangesNum: 0\n               - MaxScannerThreadNum: 32\n               - MemoryUsage: \n                 - PeakMemoryUsage: 0.00 \n               - NumScanners: 32\n               - OpenTime: 19.276ms\n               - ProcessConjunctTime: 30.360us\n               - ProjectionTime: 0ns\n               - RowsProduced: 7.433056M (7433056)\n               - RowsRead: 0\n               - RuntimeFilterInfo: \n               - ScannerWorkerWaitTime: 0ns\n               - TabletNum: 4\n               - TotalReadThroughput: 0\n               - WaitForDependency[OLAP_SCAN_OPERATOR_DEPENDENCY]Time: 0ns\n               - WaitForRuntimeFilter: 1000ms\n              RuntimeFilter: (id = 6, type = minmax):\n                 - Info: [IsPushDown = false, RuntimeFilterState = NOT_READY, HasRemoteTarget = true, HasLocalTarget = false, Ignored = false]\n              RuntimeFilter: (id = 7, type = in_or_bloomfilter):\n                 - Info: [IsPushDown = false, RuntimeFilterState = NOT_READY, HasRemoteTarget = true, HasLocalTarget = false, Ignored = false]\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u4ECE Profile \u4E2D\u53EF\u4EE5\u770B\u5230\uFF1A",(0,r.jsx)(n.code,{children:"WaitForRuntimeFilter: 1000ms"}),"\u3002\u8FD9\u91CC RuntimeFilter \u7B49\u5F85\u4E86 1000ms\uFF0C\u4F46\u662F\u8FD9\u4E2A ScanOperator \u5E76\u6CA1\u6709\u7B49\u5230\u5BF9\u5E94\u7684 RuntimeFilter\uFF0C",(0,r.jsx)(n.code,{children:"RuntimeFilterState = NOT_READY"}),"\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-SQL",children:" RuntimeFilter: (id = 6, type = minmax):\n                 - Info: [IsPushDown = false, RuntimeFilterState = NOT_READY, HasRemoteTarget = true, HasLocalTarget = false, Ignored = false]\n RuntimeFilter: (id = 7, type = in_or_bloomfilter):\n                 - Info: [IsPushDown = false, RuntimeFilterState = NOT_READY, HasRemoteTarget = true, HasLocalTarget = false, Ignored = false]\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u6240\u4EE5\u8FD9\u91CC\u5BF9\u5E94\u7684 RuntimeFilter \u7684 id 6 \u548C 7 \u90FD\u6CA1\u6709\u7B49\u5230\u3002\u901A\u8FC7 Profile \u5B9A\u4F4D\u5230\u751F\u6210 RuntimeFilter \u7684 Join\uFF0C\u53D1\u73B0 Join \u8017\u65F6"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-SQL",children:"  HASH_JOIN_OPERATOR (id=26 , nereids_id=37948):\n                - PlanInfo\n                   - join op: RIGHT OUTER JOIN(PARTITIONED)[]\n                   - equal join conjunct: (id = ID)\n                   - runtime filters: RF006[min_max] <- ID(6418/8192/1048576), RF007[in_or_bloom] <- ID(6418/8192/1048576)\n                   - cardinality=6,418\n                   - vec output tuple id: 27\n                   - output tuple id: 27\n                   - vIntermediate tuple ids: 25 \n                   - hash output slot ids: 396 398 399 400 401 402 403 404 405 406 407 408 409 410 411 412 413 447 \n                   - projections: USER_ID\n                   - project output tuple id: 27\n                - BlocksProduced: sum 1, avg 1, max 1, min 1\n                - CloseTime: avg 10.111us, max 10.111us, min 10.111us\n                - ExecTime: avg 364.497us, max 364.497us, min 364.497us\n                - InitTime: avg 26.653us, max 26.653us, min 26.653us\n                - MemoryUsage: sum , avg , max , min \n                  - PeakMemoryUsage: sum 0.00 , avg 0.00 , max 0.00 , min 0.00 \n                  - ProbeKeyArena: sum 0.00 , avg 0.00 , max 0.00 , min 0.00 \n                - OpenTime: avg 45.985us, max 45.985us, min 45.985us\n                - ProbeRows: sum 0, avg 0, max 0, min 0\n                - ProjectionTime: avg 211.930us, max 211.930us, min 211.930us\n                - RowsProduced: sum 1, avg 1, max 1, min 1\n                - WaitForDependency[HASH_JOIN_OPERATOR_DEPENDENCY]Time: avg 1sec780ms, max 1sec780ms, min 1sec780ms\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u53EF\u4EE5\u770B\u5230\u8FD9\u4E2A Join \u8017\u65F6\u5927\u6982\u662F",(0,r.jsx)(n.code,{children:"1sec780ms"}),"\uFF0C\u6240\u4EE5 RuntimeFilter \u5728 1s \u5185\u5E76\u6CA1\u6709\u7B49\u5230\u3002\u4E8E\u662F\u8C03\u6574 RuntimeFilter \u7684\u7B49\u5F85\u65F6\u95F4\uFF1A"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-SQL",children:"set runtime_filter_wait_time_ms = 3000;\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u8C03\u6574\u4E4B\u540E\uFF0C\u67E5\u8BE2\u8017\u65F6\u4ECE 5s \u964D\u4F4E\u5230 2s\u3002"}),"\n",(0,r.jsx)(n.h2,{id:"\u603B\u7ED3",children:"\u603B\u7ED3"}),"\n",(0,r.jsx)(n.p,{children:"RuntimeFilter \u7684\u7B49\u5F85\u65F6\u95F4\u9700\u8981\u6839\u636E\u573A\u666F\u5B9A\u4E49\uFF0CDoris \u6B63\u5728\u8FDB\u884C\u4E00\u4E9B\u81EA\u9002\u5E94\u7684\u4F18\u5316\u6539\u9020\u3002\u901A\u8FC7 EXPLAIN \u548C PROFILE \u5DE5\u5177\u89C2\u5BDF\u67E5\u8BE2\u6267\u884C\u74F6\u9888\uFF0C\u5B9A\u4F4D\u5BF9\u5E94\u95EE\u9898\uFF0C\u901A\u8FC7 SQL HINT \u4FEE\u6539 RuntimeFilter \u7B49\u5F85\u65F6\u95F4\uFF0C\u89C4\u907F\u5BF9\u5E94\u95EE\u9898\u5BF9\u6027\u80FD\u7684\u5F71\u54CD\u3002"})]})}function c(e={}){let{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(m,{...e})}):m(e)}},250065:function(e,n,t){t.d(n,{Z:function(){return l},a:function(){return a}});var i=t(667294);let r={},s=i.createContext(r);function a(e){let n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);