"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["649351"],{122067:function(e,n,i){i.r(n),i.d(n,{default:()=>N,frontMatter:()=>c,metadata:()=>l,assets:()=>a,toc:()=>t,contentTitle:()=>r});var l=JSON.parse('{"id":"ai/vector-search/index-management","title":"ANN \u7D22\u5F15\u7BA1\u7406","description":"Apache Doris \u4E2D\u7684\u8FD1\u4F3C\u6700\u8FD1\u90BB (ANN) \u7D22\u5F15\u652F\u6301\u5BF9\u9AD8\u7EF4\u6570\u636E\u8FDB\u884C\u9AD8\u6548\u7684\u5411\u91CF\u76F8\u4F3C\u6027\u641C\u7D22\u3002\u4ECE Doris 4.x \u5F00\u59CB\uFF0C\u901A\u7528\u7D22\u5F15\u64CD\u4F5C\u8BED\u6CD5\u4E5F\u652F\u6301\u4E86 ANN \u7D22\u5F15\u3002\u672C\u6587\u5C06\u4ECB\u7ECD ANN \u7D22\u5F15\u76F8\u5173\u64CD\u4F5C\u7684\u5177\u4F53 SQL \u8BED\u6CD5\uFF0C\u5E76\u63D0\u4F9B\u8BE6\u7EC6\u7684\u53C2\u6570\u8BF4\u660E\u3002","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs/current/ai/vector-search/index-management.md","sourceDirName":"ai/vector-search","slug":"/ai/vector-search/index-management","permalink":"/zh-CN/docs/dev/ai/vector-search/index-management","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1770477659000,"frontMatter":{"title":"ANN \u7D22\u5F15\u7BA1\u7406","language":"zh-CN","description":"Apache Doris \u4E2D\u7684\u8FD1\u4F3C\u6700\u8FD1\u90BB (ANN) \u7D22\u5F15\u652F\u6301\u5BF9\u9AD8\u7EF4\u6570\u636E\u8FDB\u884C\u9AD8\u6548\u7684\u5411\u91CF\u76F8\u4F3C\u6027\u641C\u7D22\u3002\u4ECE Doris 4.x \u5F00\u59CB\uFF0C\u901A\u7528\u7D22\u5F15\u64CD\u4F5C\u8BED\u6CD5\u4E5F\u652F\u6301\u4E86 ANN \u7D22\u5F15\u3002\u672C\u6587\u5C06\u4ECB\u7ECD ANN \u7D22\u5F15\u76F8\u5173\u64CD\u4F5C\u7684\u5177\u4F53 SQL \u8BED\u6CD5\uFF0C\u5E76\u63D0\u4F9B\u8BE6\u7EC6\u7684\u53C2\u6570\u8BF4\u660E\u3002"},"sidebar":"docs","previous":{"title":"IVF","permalink":"/zh-CN/docs/dev/ai/vector-search/ivf"},"next":{"title":"\u6027\u80FD\u6D4B\u8BD5\u4E0E\u5206\u6790","permalink":"/zh-CN/docs/dev/ai/vector-search/performance"}}'),d=i("785893"),s=i("250065");let c={title:"ANN \u7D22\u5F15\u7BA1\u7406",language:"zh-CN",description:"Apache Doris \u4E2D\u7684\u8FD1\u4F3C\u6700\u8FD1\u90BB (ANN) \u7D22\u5F15\u652F\u6301\u5BF9\u9AD8\u7EF4\u6570\u636E\u8FDB\u884C\u9AD8\u6548\u7684\u5411\u91CF\u76F8\u4F3C\u6027\u641C\u7D22\u3002\u4ECE Doris 4.x \u5F00\u59CB\uFF0C\u901A\u7528\u7D22\u5F15\u64CD\u4F5C\u8BED\u6CD5\u4E5F\u652F\u6301\u4E86 ANN \u7D22\u5F15\u3002\u672C\u6587\u5C06\u4ECB\u7ECD ANN \u7D22\u5F15\u76F8\u5173\u64CD\u4F5C\u7684\u5177\u4F53 SQL \u8BED\u6CD5\uFF0C\u5E76\u63D0\u4F9B\u8BE6\u7EC6\u7684\u53C2\u6570\u8BF4\u660E\u3002"},r="ANN \u7D22\u5F15\u7BA1\u7406",a={},t=[{value:"\u6982\u8FF0",id:"\u6982\u8FF0",level:2},{value:"\u521B\u5EFA ANN \u7D22\u5F15",id:"\u521B\u5EFA-ann-\u7D22\u5F15",level:2},{value:"\u8BED\u6CD5",id:"\u8BED\u6CD5",level:3},{value:"\u8BED\u6CD5",id:"\u8BED\u6CD5-1",level:3},{value:"\u901A\u7528\u5C5E\u6027",id:"\u901A\u7528\u5C5E\u6027",level:3},{value:"\u7D22\u5F15\u7279\u5B9A\u5C5E\u6027",id:"\u7D22\u5F15\u7279\u5B9A\u5C5E\u6027",level:3},{value:"IVF \u7D22\u5F15\u5C5E\u6027",id:"ivf-\u7D22\u5F15\u5C5E\u6027",level:4},{value:"HNSW \u7D22\u5F15\u5C5E\u6027",id:"hnsw-\u7D22\u5F15\u5C5E\u6027",level:4},{value:"\u91CF\u5316\u7279\u5B9A\u5C5E\u6027",id:"\u91CF\u5316\u7279\u5B9A\u5C5E\u6027",level:3},{value:"\u4E58\u79EF\u91CF\u5316\u5C5E\u6027",id:"\u4E58\u79EF\u91CF\u5316\u5C5E\u6027",level:4},{value:"\u793A\u4F8B",id:"\u793A\u4F8B",level:3},{value:"\u521B\u5EFA\u5E26\u6709 ANN \u7D22\u5F15\u7684\u8868",id:"\u521B\u5EFA\u5E26\u6709-ann-\u7D22\u5F15\u7684\u8868",level:4},{value:"IVF \u7D22\u5F15",id:"ivf-\u7D22\u5F15",level:4},{value:"HNSW \u7D22\u5F15",id:"hnsw-\u7D22\u5F15",level:4},{value:"HNSW + SQ",id:"hnsw--sq",level:4},{value:"HNSW + PQ",id:"hnsw--pq",level:4},{value:"IVF + SQ",id:"ivf--sq",level:4},{value:"IVF + PQ",id:"ivf--pq",level:4},{value:"\u6784\u5EFA ANN \u7D22\u5F15",id:"\u6784\u5EFA-ann-\u7D22\u5F15",level:2},{value:"\u8BED\u6CD5",id:"\u8BED\u6CD5-2",level:3},{value:"\u76D1\u63A7\u6784\u5EFA\u8FDB\u5EA6",id:"\u76D1\u63A7\u6784\u5EFA\u8FDB\u5EA6",level:3},{value:"\u53D6\u6D88\u7D22\u5F15\u6784\u5EFA",id:"\u53D6\u6D88\u7D22\u5F15\u6784\u5EFA",level:3},{value:"\u5220\u9664 ANN \u7D22\u5F15",id:"\u5220\u9664-ann-\u7D22\u5F15",level:2},{value:"\u8BED\u6CD5",id:"\u8BED\u6CD5-3",level:3},{value:"\u67E5\u770B ANN \u7D22\u5F15",id:"\u67E5\u770B-ann-\u7D22\u5F15",level:2},{value:"\u8BED\u6CD5",id:"\u8BED\u6CD5-4",level:3},{value:"\u793A\u4F8B\u8F93\u51FA",id:"\u793A\u4F8B\u8F93\u51FA",level:3}];function h(e){let n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.header,{children:(0,d.jsx)(n.h1,{id:"ann-\u7D22\u5F15\u7BA1\u7406",children:"ANN \u7D22\u5F15\u7BA1\u7406"})}),"\n",(0,d.jsx)(n.h2,{id:"\u6982\u8FF0",children:"\u6982\u8FF0"}),"\n",(0,d.jsx)(n.p,{children:"Apache Doris \u4E2D\u7684\u8FD1\u4F3C\u6700\u8FD1\u90BB (ANN) \u7D22\u5F15\u652F\u6301\u5BF9\u9AD8\u7EF4\u6570\u636E\u8FDB\u884C\u9AD8\u6548\u7684\u5411\u91CF\u76F8\u4F3C\u6027\u641C\u7D22\u3002\u4ECE Doris 4.x \u5F00\u59CB\uFF0C\u901A\u7528\u7D22\u5F15\u64CD\u4F5C\u8BED\u6CD5\u4E5F\u652F\u6301\u4E86 ANN \u7D22\u5F15\u3002\u672C\u6587\u5C06\u4ECB\u7ECD ANN \u7D22\u5F15\u76F8\u5173\u64CD\u4F5C\u7684\u5177\u4F53 SQL \u8BED\u6CD5\uFF0C\u5E76\u63D0\u4F9B\u8BE6\u7EC6\u7684\u53C2\u6570\u8BF4\u660E\u3002"}),"\n",(0,d.jsxs)(n.p,{children:["ANN \u7D22\u5F15\u5EFA\u7ACB\u5728\u5411\u91CF\u5217\u4E0A\uFF08",(0,d.jsx)(n.code,{children:"ARRAY<FLOAT> NOT NULL"})," \u7C7B\u578B\uFF09\uFF0C\u652F\u6301\u4E24\u79CD\u5EA6\u91CF\u7C7B\u578B\u5305\u62EC l2 distance(\u4E5F\u53EB\u6B27\u5F0F\u8DDD\u79BB)\u548Cinner product(\u5185\u79EF)\u3002"]}),"\n",(0,d.jsx)(n.h2,{id:"\u521B\u5EFA-ann-\u7D22\u5F15",children:"\u521B\u5EFA ANN \u7D22\u5F15"}),"\n",(0,d.jsxs)(n.p,{children:["\u53EF\u4EE5\u4F7F\u7528\u5E26\u6709 ",(0,d.jsx)(n.code,{children:"USING ANN"})," \u7684 ",(0,d.jsx)(n.code,{children:"CREATE INDEX"})," \u8BED\u53E5\u521B\u5EFA ANN \u7D22\u5F15\u3002\u6709\u4E24\u79CD\u4E3B\u8981\u65B9\u6CD5\uFF1A"]}),"\n",(0,d.jsxs)(n.ol,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"\u5728\u8868\u521B\u5EFA\u671F\u95F4\u5B9A\u4E49\u7D22\u5F15"}),"\uFF1A\u7D22\u5F15\u5728\u6570\u636E\u52A0\u8F7D\u65F6\u540C\u6B65\u6784\u5EFA\u3002"]}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"\u8BED\u6CD5",children:"\u8BED\u6CD5"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:'CREATE TABLE [IF NOT EXISTS] <table_name> (\n  <columns_definition>\n  INDEX <index_name> (<vector_column) USING ANN PROPERTIES (\n    "<key>" = "<value>" [, ...]\n  )\n)\n[ <key_type> KEY (<key_cols>)\n    [ CLUSTER BY (<cluster_cols>) ]\n]\n[ COMMENT \'<table_comment>\' ]\n[ <partitions_definition> ]\n[ DISTRIBUTED BY { HASH (<distribute_cols>) | RANDOM }\n    [ BUCKETS { <bucket_count> | AUTO } ]\n]\n[ <roll_up_definition> ]\n[ PROPERTIES (\n    -- Table property\n    <table_property>\n    -- Additional table properties\n    [ , ... ])\n]\n'})}),"\n",(0,d.jsxs)(n.ol,{start:"2",children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"\u5355\u72EC\u521B\u5EFA\u7D22\u5F15"}),"\uFF1A\u5148\u5B9A\u4E49\u7D22\u5F15\uFF0C\u7136\u540E\u4F7F\u7528 ",(0,d.jsx)(n.code,{children:"BUILD INDEX"})," \u5728\u73B0\u6709\u6570\u636E\u4E0A\u6784\u5EFA\u3002"]}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"\u8BED\u6CD5-1",children:"\u8BED\u6CD5"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:'CREATE INDEX [IF NOT EXISTS] <index_name>\n             ON <table_name> (<column_name>)\n             USING ANN\n             PROPERTIES ("<key>" = "<value>" [, ...])\n             [COMMENT \'<index_comment>\']\n\n-- or\nALTER TABLE <table_name> ADD INDEX <index_name>(<column_name>)\n             USING ANN\n             [PROPERTIES("<key>" = "<value>" [, ...])]\n             [COMMENT \'<index_comment>\']\n'})}),"\n",(0,d.jsx)(n.h3,{id:"\u901A\u7528\u5C5E\u6027",children:"\u901A\u7528\u5C5E\u6027"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"index_type"}),': ANN \u7D22\u5F15\u7684\u7C7B\u578B\u3002\u652F\u6301\u7684\u503C\uFF1A"ivf" \u6216 "hnsw"\u3002']}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"metric_type"}),': \u5EA6\u91CF\u7C7B\u578B\u3002\u652F\u6301\u7684\u503C\uFF1A"l2_distance"\u3001"inner_product"\u3002']}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"dim"}),": \u5411\u91CF\u5217\u7684\u7EF4\u5EA6\u3002"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"quantizer"}),": \u91CF\u5316\u5668\u7C7B\u578B\u3002\u652F\u6301\u7684\u503C\uFF1Aflat\u3001sq4\u3001sq8\u3001pq\u3002\u4E0D\u6307\u5B9A\u65F6\u9ED8\u8BA4\u4E3A flat\u3002"]}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"\u7D22\u5F15\u7279\u5B9A\u5C5E\u6027",children:"\u7D22\u5F15\u7279\u5B9A\u5C5E\u6027"}),"\n",(0,d.jsx)(n.h4,{id:"ivf-\u7D22\u5F15\u5C5E\u6027",children:"IVF \u7D22\u5F15\u5C5E\u6027"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"nlist"}),": \u805A\u7C7B\u6570\u91CF\uFF08\u5012\u6392\u5217\u8868\uFF09\u3002\u9ED8\u8BA4\uFF1A1024\u3002\u66F4\u9AD8\u7684\u503C\u6539\u5584\u53EC\u56DE\u7387\u4F46\u589E\u52A0\u6784\u5EFA\u65F6\u95F4\u548C\u5185\u5B58\u4F7F\u7528\u3002"]}),"\n"]}),"\n",(0,d.jsx)(n.h4,{id:"hnsw-\u7D22\u5F15\u5C5E\u6027",children:"HNSW \u7D22\u5F15\u5C5E\u6027"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"max_degree"}),": \u6BCF\u4E2A\u8282\u70B9\u7684\u8FDE\u63A5\u6700\u5927\u6570\u91CF\u3002\u9ED8\u8BA4\uFF1A32\u3002\u5F71\u54CD\u53EC\u56DE\u7387\u548C\u67E5\u8BE2\u6027\u80FD\u3002"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"ef_construction"}),": \u7D22\u5F15\u6784\u5EFA\u671F\u95F4\u5019\u9009\u961F\u5217\u7684\u5927\u5C0F\u3002\u9ED8\u8BA4\uFF1A40\u3002\u66F4\u9AD8\u7684\u503C\u6539\u5584\u56FE\u8D28\u91CF\u4F46\u589E\u52A0\u6784\u5EFA\u65F6\u95F4\u3002"]}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"\u91CF\u5316\u7279\u5B9A\u5C5E\u6027",children:"\u91CF\u5316\u7279\u5B9A\u5C5E\u6027"}),"\n",(0,d.jsx)(n.p,{children:"\u5BF9\u4E8E\u91CF\u5316\u5668\u5C5E\u6027\uFF1A"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"sq4"}),": \u6807\u91CF\u91CF\u5316 (SQ)\uFF0C\u4F7F\u7528 4 \u4F4D\u6574\u6570\u66FF\u4EE3 32 \u4F4D\u6D6E\u70B9\u6570\u6765\u5B58\u50A8\u5411\u91CF\u7684\u6BCF\u4E2A\u7EF4\u5EA6\u503C\u3002"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"sq8"}),": \u6807\u91CF\u91CF\u5316 (SQ)\uFF0C\u4F7F\u7528 8 \u4F4D\u6574\u6570\u66FF\u4EE3 32 \u4F4D\u6D6E\u70B9\u6570\u6765\u5B58\u50A8\u5411\u91CF\u7684\u6BCF\u4E2A\u7EF4\u5EA6\u503C\u3002"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"pq"}),": \u4E58\u79EF\u91CF\u5316 (PQ)\uFF0Cproperties\u4E2D\u9700\u8981\u989D\u5916\u6307\u5B9A\u4E24\u4E2A\u53C2\u6570\uFF0C",(0,d.jsx)(n.code,{children:"pq_m"})," \u548C ",(0,d.jsx)(n.code,{children:"pq_nbits"})]}),"\n"]}),"\n",(0,d.jsx)(n.h4,{id:"\u4E58\u79EF\u91CF\u5316\u5C5E\u6027",children:"\u4E58\u79EF\u91CF\u5316\u5C5E\u6027"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"pq_m"}),": \u6307\u5B9A\u4F7F\u7528\u7684\u5B50\u5411\u91CF\u6570\u91CF\uFF08\u5411\u91CF\u7EF4\u5EA6 dim \u5FC5\u987B\u80FD\u88AB pq_m \u6574\u9664\uFF09\u3002"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"pq_nbits"}),": \u7528\u4E8E\u8868\u793A\u6BCF\u4E2A\u5B50\u5411\u91CF\u7684\u6BD4\u7279\u6570\uFF0C\u5728 faiss \u4E2D pq_nbits \u901A\u5E38\u8981\u6C42\u4E0D\u8D85\u8FC7 24\u3002"]}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"\u793A\u4F8B",children:"\u793A\u4F8B"}),"\n",(0,d.jsx)(n.h4,{id:"\u521B\u5EFA\u5E26\u6709-ann-\u7D22\u5F15\u7684\u8868",children:"\u521B\u5EFA\u5E26\u6709 ANN \u7D22\u5F15\u7684\u8868"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:'CREATE TABLE tbl_ann (\n    id int NOT NULL,\n    embedding array<float> NOT NULL,\n    INDEX ann_index (embedding) USING ANN PROPERTIES(\n        "index_type"="hnsw",\n        "metric_type"="l2_distance",\n        "dim"="128"\n    )\n) ENGINE=OLAP\nDUPLICATE KEY(id)\nDISTRIBUTED BY HASH(id) BUCKETS 1\nPROPERTIES ("replication_num" = "1");\n'})}),"\n",(0,d.jsx)(n.h4,{id:"ivf-\u7D22\u5F15",children:"IVF \u7D22\u5F15"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:'CREATE INDEX ann_ivf_index ON tbl_ivf (`embedding`) USING ANN PROPERTIES(\n    "index_type"="ivf",\n    "metric_type"="l2_distance",\n    "dim"="128",\n    "nlist"="1024"\n);\n'})}),"\n",(0,d.jsx)(n.h4,{id:"hnsw-\u7D22\u5F15",children:"HNSW \u7D22\u5F15"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:'CREATE INDEX ann_hnsw_index ON tbl_hnsw (`embedding`) USING ANN PROPERTIES(\n    "index_type"="hnsw",\n    "metric_type"="l2_distance",\n    "dim"="128",\n    "max_degree"="32",\n    "ef_construction"="40"\n);\n'})}),"\n",(0,d.jsx)(n.h4,{id:"hnsw--sq",children:"HNSW + SQ"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:'CREATE INDEX ann_hnsw_sq ON tbl_hnsw (`embedding`) USING ANN PROPERTIES(\n    "index_type"="hnsw",\n    "metric_type"="l2_distance",\n    "dim"="128",\n    "max_degree"="32",\n    "ef_construction"="40",\n    "quantizer"="sq8"\n);\n'})}),"\n",(0,d.jsx)(n.h4,{id:"hnsw--pq",children:"HNSW + PQ"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:'CREATE INDEX ann_hnsw_pq ON tbl_hnsw (`embedding`) USING ANN PROPERTIES(\n    "index_type"="hnsw",\n    "metric_type"="l2_distance",\n    "dim"="128",\n    "max_degree"="32",\n    "ef_construction"="40",\n    "quantizer"="pq",\n    "pq_m"="8",\n    "pq_nbits"="8"\n);\n'})}),"\n",(0,d.jsx)(n.h4,{id:"ivf--sq",children:"IVF + SQ"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:'CREATE INDEX ann_ivf_sq ON tbl_ivf (`embedding`) USING ANN PROPERTIES(\n    "index_type"="ivf",\n    "metric_type"="l2_distance",\n    "dim"="128",\n    "nlist"="1024",\n    "quantizer"="sq8"\n);\n'})}),"\n",(0,d.jsx)(n.h4,{id:"ivf--pq",children:"IVF + PQ"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:'CREATE INDEX ann_ivf_pq ON tbl_ivf (`embedding`) USING ANN PROPERTIES(\n    "index_type"="ivf",\n    "metric_type"="l2_distance",\n    "dim"="128",\n    "nlist"="1024",\n    "quantizer"="pq",\n    "pq_m"="8",\n    "pq_nbits"="8"\n);\n'})}),"\n",(0,d.jsx)(n.h2,{id:"\u6784\u5EFA-ann-\u7D22\u5F15",children:"\u6784\u5EFA ANN \u7D22\u5F15"}),"\n",(0,d.jsxs)(n.p,{children:["\u5BF9\u4E8E\u5355\u72EC\u521B\u5EFA\u7684\u7D22\u5F15\uFF0C\u4F7F\u7528 ",(0,d.jsx)(n.code,{children:"BUILD INDEX"})," \u5728\u73B0\u6709\u6570\u636E\u4E0A\u6784\u5EFA\u7D22\u5F15\u3002\u8FD9\u4E2A\u64CD\u4F5C\u662F\u5F02\u6B65\u7684\u3002"]}),"\n",(0,d.jsx)(n.h3,{id:"\u8BED\u6CD5-2",children:"\u8BED\u6CD5"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:"BUILD INDEX <index_name> ON <table_name> [PARTITION (<partition_name> [, ...])]\n"})}),"\n",(0,d.jsx)(n.h3,{id:"\u76D1\u63A7\u6784\u5EFA\u8FDB\u5EA6",children:"\u76D1\u63A7\u6784\u5EFA\u8FDB\u5EA6"}),"\n",(0,d.jsxs)(n.p,{children:["\u4F7F\u7528 ",(0,d.jsx)(n.code,{children:"SHOW BUILD INDEX"})," \u68C0\u67E5\u7D22\u5F15\u6784\u5EFA\u7684\u8FDB\u5EA6\u548C\u72B6\u6001\u3002"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:'-- \u67E5\u770B\u6240\u6709 BUILD INDEX \u4EFB\u52A1\u7684\u8FDB\u5EA6 [\u5BF9\u4E8E\u7279\u5B9A\u6570\u636E\u5E93]\nSHOW BUILD INDEX [FROM db_name];\n\n-- \u67E5\u770B\u7279\u5B9A\u8868\u7684 BUILD INDEX \u4EFB\u52A1\u8FDB\u5EA6\nSHOW BUILD INDEX WHERE TableName = "<table_name>";\n'})}),"\n",(0,d.jsxs)(n.p,{children:["\u8F93\u51FA\u5305\u62EC ",(0,d.jsx)(n.code,{children:"JobId"}),"\u3001",(0,d.jsx)(n.code,{children:"TableName"}),"\u3001",(0,d.jsx)(n.code,{children:"State"}),"\uFF08\u4F8B\u5982 ",(0,d.jsx)(n.code,{children:"FINISHED"}),"\u3001",(0,d.jsx)(n.code,{children:"RUNNING"}),"\uFF09\u548C ",(0,d.jsx)(n.code,{children:"Progress"})," \u7B49\u5217\uFF0C\u4F8B\u5982\uFF1A"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:'mysql> show build index where TableName = "sift_1M";\n+---------------+-----------+---------------+-----------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------+-------------------------+---------------+----------+------+----------+\n| JobId         | TableName | PartitionName | AlterInvertedIndexes                                                                                                                                | CreateTime              | FinishTime              | TransactionId | State    | Msg  | Progress |\n+---------------+-----------+---------------+-----------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------+-------------------------+---------------+----------+------+----------+\n| 1764579876673 | sift_1M   | sift_1M       | [ADD INDEX idx_test_ann (`embedding`) USING ANN PROPERTIES("dim" = "128", "index_type" = "ivf", "metric_type" = "l2_distance", "nlist" = "1024")],  | 2025-12-01 17:59:54.277 | 2025-12-01 17:59:56.987 | 82            | FINISHED |      | NULL     |\n+---------------+-----------+---------------+-----------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------+-------------------------+---------------+----------+------+----------+\n1 row in set (0.00 sec)\n'})}),"\n",(0,d.jsx)(n.h3,{id:"\u53D6\u6D88\u7D22\u5F15\u6784\u5EFA",children:"\u53D6\u6D88\u7D22\u5F15\u6784\u5EFA"}),"\n",(0,d.jsx)(n.p,{children:"\u8981\u53D6\u6D88\u6B63\u5728\u8FDB\u884C\u7684\u7D22\u5F15\u6784\u5EFA\uFF1A"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:"CANCEL BUILD INDEX ON <table_name> [(<job_id> [, ...])]\n"})}),"\n",(0,d.jsx)(n.h2,{id:"\u5220\u9664-ann-\u7D22\u5F15",children:"\u5220\u9664 ANN \u7D22\u5F15"}),"\n",(0,d.jsxs)(n.p,{children:["\u4F7F\u7528 ",(0,d.jsx)(n.code,{children:"DROP INDEX"})," \u5220\u9664 ANN \u7D22\u5F15\u3002"]}),"\n",(0,d.jsx)(n.h3,{id:"\u8BED\u6CD5-3",children:"\u8BED\u6CD5"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:"DROP INDEX [IF EXISTS] <index_name> ON [<db_name>.]<table_name>\n\n-- or\nALTER TABLE [<db_name>.]<table_name> DROP INDEX <index_name>\n"})}),"\n",(0,d.jsx)(n.h2,{id:"\u67E5\u770B-ann-\u7D22\u5F15",children:"\u67E5\u770B ANN \u7D22\u5F15"}),"\n",(0,d.jsxs)(n.p,{children:["\u4F7F\u7528 ",(0,d.jsx)(n.code,{children:"SHOW INDEX"})," \u6216 ",(0,d.jsx)(n.code,{children:"SHOW CREATE TABLE"})," \u67E5\u770B\u7D22\u5F15\u4FE1\u606F\u3002"]}),"\n",(0,d.jsx)(n.h3,{id:"\u8BED\u6CD5-4",children:"\u8BED\u6CD5"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:"SHOW INDEX[ES] FROM [<db_name>.]<table_name> [FROM <db_name>]\n\n-- or\nSHOW CREATE TABLE [<db_name>.]<table_name>\n"})}),"\n",(0,d.jsx)(n.h3,{id:"\u793A\u4F8B\u8F93\u51FA",children:"\u793A\u4F8B\u8F93\u51FA"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:'mysql> SHOW INDEX FROM sift_1M;\n+---------+------------+--------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+----------------------------------------------------------------------------------------+\n| Table   | Non_unique | Key_name     | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Properties                                                                             |\n+---------+------------+--------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+----------------------------------------------------------------------------------------+\n| sift_1M |            | idx_test_ann |              | embedding   |           |             |          |        |      | ANN        |         | ("dim" = "128", "index_type" = "ivf", "metric_type" = "l2_distance", "nlist" = "1024") |\n+---------+------------+--------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+----------------------------------------------------------------------------------------+\n1 row in set (0.01 sec)\n'})}),"\n",(0,d.jsxs)(n.p,{children:["\u8F93\u51FA\u5305\u62EC ",(0,d.jsx)(n.code,{children:"Table"}),"\u3001",(0,d.jsx)(n.code,{children:"Key_name"}),"\u3001",(0,d.jsx)(n.code,{children:"Index_type"}),"\uFF08ANN \u7D22\u5F15\u663E\u793A ",(0,d.jsx)(n.code,{children:"ANN"}),"\uFF09\u548C ",(0,d.jsx)(n.code,{children:"Properties"}),"\uFF08\u5305\u542B\u7D22\u5F15\u914D\u7F6E\uFF09\u7B49\u5217\u3002"]})]})}function N(e={}){let{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(h,{...e})}):h(e)}},250065:function(e,n,i){i.d(n,{Z:function(){return r},a:function(){return c}});var l=i(667294);let d={},s=l.createContext(d);function c(e){let n=l.useContext(s);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:c(e.components),l.createElement(s.Provider,{value:n},e.children)}}}]);