<!doctype html><html lang=en-US dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-admin-manual/maint-monitor/tablet-repair-and-balance" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.6.3"><title data-rh=true>Data Replica Management - Apache Doris</title><meta data-rh=true name=viewport content="width=device-width,initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:url content=https://doris.apache.org/docs/dev/admin-manual/maint-monitor/tablet-repair-and-balance/><meta data-rh=true property=og:locale content=en_US><meta data-rh=true property=og:locale:alternate content=zh_Hans-CN><meta data-rh=true name=docusaurus_locale content=en><meta data-rh=true name=docsearch:language content=en><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-default-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current><meta data-rh=true property=og:title content="Data Replica Management - Apache Doris"><meta data-rh=true name=description content="Beginning with version 0.9.0, Doris introduced an optimized replica management strategy and supported a richer replica status viewing tool. This document focuses on Doris data replica balancing, repair scheduling strategies, and replica management operations and maintenance methods. Help users to more easily master and manage the replica status in the cluster."><meta data-rh=true property=og:description content="Beginning with version 0.9.0, Doris introduced an optimized replica management strategy and supported a richer replica status viewing tool. This document focuses on Doris data replica balancing, repair scheduling strategies, and replica management operations and maintenance methods. Help users to more easily master and manage the replica status in the cluster."><link data-rh=true rel=icon href=/images/favicon.ico><link data-rh=true rel=canonical href=https://doris.apache.org/docs/dev/admin-manual/maint-monitor/tablet-repair-and-balance/><link data-rh=true rel=alternate href=https://doris.apache.org/docs/dev/admin-manual/maint-monitor/tablet-repair-and-balance/ hreflang=en-US><link data-rh=true rel=alternate href=https://doris.apache.org/zh-CN/docs/dev/admin-manual/maint-monitor/tablet-repair-and-balance/ hreflang=zh-Hans-CN><link data-rh=true rel=alternate href=https://doris.apache.org/docs/dev/admin-manual/maint-monitor/tablet-repair-and-balance/ hreflang=x-default><link rel=alternate type=application/rss+xml href=/blog/rss.xml title="Apache Doris RSS Feed"><link rel=alternate type=application/atom+xml href=/blog/atom.xml title="Apache Doris Atom Feed"><link rel=preconnect href=https://analytics.apache.org/><script>var _paq=window._paq=window._paq||[];_paq.push(["setRequestMethod","POST"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),_paq.push(["enableHeartBeatTimer"]),function(){var e="https://analytics.apache.org/";_paq.push(["setRequestMethod","POST"]),_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","43"]);var a=document,t=a.createElement("script"),p=a.getElementsByTagName("script")[0];t.type="text/javascript",t.async=!0,t.src=e+"matomo.js",p.parentNode.insertBefore(t,p)}()</script><link rel=stylesheet href=/css/katex.min.css><script src=/js/custom-script.js></script><link rel=stylesheet href=/assets/css/styles.defc27e2.css><script src=/assets/js/runtime~main.49ae4c11.js defer></script><script src=/assets/js/main.67040986.js defer></script><body class=navigation-with-keyboard><script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:"light",document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id=__docusaurus><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><div class=announcementBar_s0pr style=color:#FFF role=banner><div class="content_zf74 announcementBarContent_dpRF"><a href="https://www.airmeet.com/e/10fb98e0-9921-11f0-89cc-795d82447e40?utm_source=Apache_Doris_Banner" target=_blank style="display:flex; width: 100%; align-items: center; justify-content: center; margin-left: 4px; text-decoration: none;">
                    <img style="width: 60px; height: 24px; margin-right: 34px;" src=/images/doris-summit.svg>
                   <span style="font-weight:700; font-size:0.875rem; line-height: 120%;">Apache Doris Summit 2025 Â· Virtual</span> 
                   <p style=margin-left:2.5rem;color:#FFF;font-size:0.875rem;line-height:120%;font-weight:600;>See Full Agenda and Register Now -></p> 
                       </a></div></div><nav aria-label=Main class="navbar navbar--fixed-top"><div class=navbar__inner><div class=navbar__items><div class=navbar-left><div class="navbar-logo-wrapper flex items-center"><div class="cursor-pointer docs"><svg width=236 height=30 fill=none viewBox="0 0 236 30"><g clip-path=url(#a)><path fill=#15A9CA d="m13.606 4.594-3.274-3.273A4.5 4.5 0 0 0 7.153 0a4.18 4.18 0 0 0-2.92 1.176 4.285 4.285 0 0 0-.06 6.107l5.94 5.94a.68.68 0 0 0 .933 0l2.556-2.557c.16-.192 2.834-3.245.003-6.072"/><path fill=#52CAA3 d="M18.97 9.823c-.624-.604-1.27-1.227-1.855-1.901v-.024q-.031.093-.047.189a6.73 6.73 0 0 1-2.003 3.747c-3.446 3.422-6.93 6.919-10.302 10.302l-.455.45a4.37 4.37 0 0 0-1.336 2.416 4.67 4.67 0 0 0 1.2 3.669 3.92 3.92 0 0 0 3.084 1.325c1.345.02 2-.157 2.98-1.11 3.92-3.837 7.84-7.706 10.807-10.646 1.4-1.392 1.72-3.697.729-5.25a18 18 0 0 0-2.803-3.167"/><path fill=#5268AD d="M-.004 7.774v14.457a.803.803 0 0 0 1.372.569l7.276-7.276a.74.74 0 0 0 0-1.042L1.368 7.206a.78.78 0 0 0-.56-.235.81.81 0 0 0-.812.803"/><path fill=#1D2434 d="M31.748 21.14V8.876h3.638c3.986 0 6.468 2.352 6.468 6.127s-2.481 6.139-6.468 6.139zm1.96-1.755h1.76c2.693 0 4.43-1.717 4.43-4.371s-1.737-4.371-4.43-4.371h-1.76zM50.612 21.33a6.326 6.326 0 1 1 0-12.652 6.326 6.326 0 0 1 0 12.652m0-10.835a4.512 4.512 0 0 0 0 9.016 4.555 4.555 0 0 0 4.45-4.532 4.473 4.473 0 0 0-4.45-4.484M75.056 8.875H73.04v12.254h2.015zM82.474 21.33a9.55 9.55 0 0 1-3.76-.804v-1.803a9.2 9.2 0 0 0 3.76.87c1.568 0 2.615-.717 2.615-1.78 0-1.195-1.278-1.67-2.63-2.171-2.121-.784-3.744-1.54-3.744-3.548 0-2.52 2.281-3.418 4.237-3.418 1.1 0 2.19.205 3.215.603v1.765a9.2 9.2 0 0 0-3.266-.651c-1.505 0-2.18.784-2.18 1.568 0 1.039 1.13 1.454 2.455 1.932 2.313.835 4.077 1.65 4.077 3.842-.008 2.125-1.968 3.595-4.779 3.595M66.026 16.174l.764-.33a3.63 3.63 0 0 0 2.2-3.327c0-2.211-1.592-3.638-4.054-3.638h-4.645V21.14h1.96V10.61h2.477a2.147 2.147 0 0 1 2.278 2.16 2.17 2.17 0 0 1-2.278 2.16h-1.042c-.459.067-.22.46-.22.46l3.956 5.75h2.214z"/></g><path fill=#484E5B d="M228.138 20.965h-1.821V8.935h1.756l5.934 8.665h.098V8.934h1.82v12.031h-1.707l-5.983-8.665h-.097zM219.104 21.193q-1.692 0-2.943-.748t-1.935-2.146q-.666-1.415-.666-3.35 0-1.934.666-3.332.683-1.415 1.935-2.146 1.251-.749 2.943-.748 1.69 0 2.926.748 1.252.731 1.919 2.146.682 1.398.682 3.332 0 1.935-.682 3.35-.667 1.398-1.919 2.146-1.236.747-2.926.748m0-1.756q1.658 0 2.633-1.187.992-1.186.992-3.3 0-1.4-.455-2.407-.439-1.008-1.268-1.528-.813-.537-1.902-.537-1.675 0-2.65 1.187-.976 1.187-.976 3.285 0 2.114.976 3.3.975 1.187 2.65 1.187M211.897 8.934v12.031h-1.853V8.935zM204.154 20.965h-1.87V10.706h-3.658V8.934h9.186v1.772h-3.658zM199.83 20.965h-1.984l-1.317-3.625h-4.308l-1.317 3.625h-1.984l4.488-12.03h1.934zm-5.496-9.446-1.479 4.065h3.04l-1.463-4.065zM186.483 20.965h-1.869V10.706h-3.658V8.934h9.185v1.772h-3.658zM170.935 20.965h-1.821V8.935h1.756l5.934 8.665h.098V8.934h1.821v12.031h-1.707l-5.983-8.665h-.098zM160.569 15.616v3.626h6.032v1.723h-7.885V8.935h7.674v1.739h-5.821v3.219h5.496v1.723zM146.454 20.965h-1.821V8.935h1.772l4.211 6.779h.097l4.211-6.78h1.789v12.031h-1.838V12.43h-.097l-3.496 5.609h-1.235l-3.496-5.593h-.097zM137.64 19.502q1.264 0 2-.816t.736-2.272V8.958h1.904v7.568q0 1.472-.576 2.544a3.9 3.9 0 0 1-1.6 1.648q-1.04.56-2.464.56t-2.464-.56a4 4 0 0 1-1.616-1.648q-.56-1.072-.56-2.544V8.958h1.904v7.392q0 1.472.736 2.32.736.832 2 .832M131.113 18.852a4.8 4.8 0 0 1-1.772 1.707q-1.122.634-2.553.634-1.69 0-2.975-.78-1.284-.782-2-2.196-.699-1.43-.699-3.332 0-1.854.699-3.252.716-1.398 2-2.146 1.284-.764 2.975-.764 1.414 0 2.553.634a4.63 4.63 0 0 1 1.772 1.707l-1.479 1.024a3.4 3.4 0 0 0-1.269-1.187 3.25 3.25 0 0 0-1.593-.422q-1.138 0-1.983.536-.83.537-1.285 1.528-.455.992-.455 2.342 0 1.38.455 2.406.456 1.024 1.301 1.593.845.553 1.967.553.83 0 1.577-.423.765-.439 1.285-1.22zM114.258 21.193q-1.69 0-2.942-.748t-1.935-2.146q-.667-1.415-.667-3.35 0-1.934.667-3.332.682-1.415 1.935-2.146 1.251-.749 2.942-.748 1.692 0 2.927.748 1.252.731 1.918 2.146.684 1.398.683 3.332 0 1.935-.683 3.35-.667 1.398-1.918 2.146-1.235.747-2.927.748m0-1.756q1.659 0 2.634-1.187.992-1.186.992-3.3 0-1.4-.455-2.407-.44-1.008-1.268-1.528-.813-.537-1.903-.537-1.674 0-2.65 1.187-.975 1.187-.975 3.285 0 2.114.975 3.3.976 1.187 2.65 1.187M97.244 20.965V8.935h4.487q1.805 0 3.073.747a4.77 4.77 0 0 1 1.935 2.097q.666 1.35.666 3.17 0 1.821-.699 3.187a4.86 4.86 0 0 1-2.032 2.098q-1.334.73-3.219.731zm4.227-1.756q1.952 0 2.976-1.105 1.023-1.123 1.024-3.154 0-2.032-.992-3.138-.991-1.106-2.878-1.106h-2.503v8.503z"/><defs><clipPath id=a><path fill=#fff d="M0 0h87.244v30H0z"/></clipPath></defs></svg></div></div><div class=undefined><div class="docs-search navbarSearchContainer_dCNk"><div class="navbar__search searchBarContainer_PzyC" dir=ltr><input placeholder=Search aria-label=Search class=navbar__search-input value=""><div class="loadingRing__K5d searchBarLoadingRing_e2f0"><div></div><div></div><div></div><div></div></div></div></div></div></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link><svg class=icon-language width=16 height=16 viewBox="0 0 16 16" fill=none><path d="M7.75756 14.3L10.5816 6.91667H11.8759L14.7 14.3H13.4057L12.7501 12.4167H9.74113L9.06873 14.3H7.75756ZM10.1109 11.35H12.3467L11.254 8.3H11.2036L10.1109 11.35ZM2.84908 12.45L1.97498 11.5833L5.11841 8.48333C4.72618 8.05 4.38439 7.60267 4.09302 7.14133C3.80165 6.68044 3.54389 6.19444 3.31976 5.68333H4.61412C4.80463 6.06111 5.00635 6.39711 5.21927 6.69133C5.43219 6.986 5.68434 7.29444 5.97571 7.61667C6.43519 7.12778 6.81621 6.62511 7.11879 6.10867C7.42137 5.59178 7.67352 5.03889 7.87523 4.45H1V3.23333H5.33694V2H6.58087V3.23333H10.9178V4.45H9.11916C8.89503 5.18333 8.59805 5.89155 8.22824 6.57467C7.85842 7.25822 7.39895 7.90555 6.84983 8.51667L8.3459 10.0167L7.87523 11.2833L5.95891 9.38333L2.84908 12.45Z" fill=#4C576C /></svg></a><ul class=dropdown__menu><li><a href=/docs/dev/admin-manual/maint-monitor/tablet-repair-and-balance/ rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang=en-US>English</a><li><a href=/zh-CN/docs/dev/admin-manual/maint-monitor/tablet-repair-and-balance/ rel="noopener noreferrer" class=dropdown__link lang=zh-Hans-CN>ä¸­æ</a></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current=page class="navbar__link active" aria-haspopup=true aria-expanded=false role=button href=/docs/dev/admin-manual/maint-monitor/tablet-repair-and-balance/><span class=text-sm>Versions: <!-- -->Dev</span></a><ul class=dropdown__menu><li><a class=dropdown__link href=/docs/3.x/admin-manual/maint-monitor/tablet-repair-and-balance/>3.x</a><li><a class=dropdown__link href=/docs/2.1/admin-manual/maint-monitor/tablet-repair-and-balance/>2.1</a><li><a class=dropdown__link href=/docs/2.0/admin-manual/maint-monitor/tablet-repair-and-balance/>2.0</a><li><a aria-current=page class="dropdown__link dropdown__link--active" href=/docs/dev/admin-manual/maint-monitor/tablet-repair-and-balance/>Dev</a><li><a class=dropdown__link href=/archive-docs/>Archived</a></ul></div><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class="header-right-button-primary navbar-download-desktop" href=/download/>Download</a></div></div><div class=navbar__bottom><div class=docs-nav-version-locale><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link type=localeDropdown><svg class=icon-language width=16 height=16 viewBox="0 0 16 16" fill=none><path d="M7.75756 14.3L10.5816 6.91667H11.8759L14.7 14.3H13.4057L12.7501 12.4167H9.74113L9.06873 14.3H7.75756ZM10.1109 11.35H12.3467L11.254 8.3H11.2036L10.1109 11.35ZM2.84908 12.45L1.97498 11.5833L5.11841 8.48333C4.72618 8.05 4.38439 7.60267 4.09302 7.14133C3.80165 6.68044 3.54389 6.19444 3.31976 5.68333H4.61412C4.80463 6.06111 5.00635 6.39711 5.21927 6.69133C5.43219 6.986 5.68434 7.29444 5.97571 7.61667C6.43519 7.12778 6.81621 6.62511 7.11879 6.10867C7.42137 5.59178 7.67352 5.03889 7.87523 4.45H1V3.23333H5.33694V2H6.58087V3.23333H10.9178V4.45H9.11916C8.89503 5.18333 8.59805 5.89155 8.22824 6.57467C7.85842 7.25822 7.39895 7.90555 6.84983 8.51667L8.3459 10.0167L7.87523 11.2833L5.95891 9.38333L2.84908 12.45Z" fill=#4C576C /></svg></a><ul class=dropdown__menu><li><a href=/docs/dev/admin-manual/maint-monitor/tablet-repair-and-balance/ rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang=en-US>English</a><li><a href=/zh-CN/docs/dev/admin-manual/maint-monitor/tablet-repair-and-balance/ rel="noopener noreferrer" class=dropdown__link lang=zh-Hans-CN>ä¸­æ</a></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current=page class="navbar__link active" aria-haspopup=true aria-expanded=false role=button type=docsVersionDropdown href=/docs/dev/admin-manual/maint-monitor/tablet-repair-and-balance/><span class=text-sm>Versions: <!-- -->Dev</span></a><ul class=dropdown__menu><li><a class=dropdown__link href=/docs/3.x/admin-manual/maint-monitor/tablet-repair-and-balance/>3.x</a><li><a class=dropdown__link href=/docs/2.1/admin-manual/maint-monitor/tablet-repair-and-balance/>2.1</a><li><a class=dropdown__link href=/docs/2.0/admin-manual/maint-monitor/tablet-repair-and-balance/>2.0</a><li><a aria-current=page class="dropdown__link dropdown__link--active" href=/docs/dev/admin-manual/maint-monitor/tablet-repair-and-balance/>Dev</a><li><a class=dropdown__link href=/archive-docs/>Archived</a></ul></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_eExm"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_mhZE><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_Y1UP menuWithAnnouncementBar_fPny"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=true href=/docs/dev/gettingStarted/what-is-apache-doris/>Getting Started</a></div><ul style=display:block;overflow:visible;height:auto class="menu__list menu__list_level_2 community_level_2"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link length=3 tabindex=0 href=/docs/dev/gettingStarted/what-is-apache-doris/>Introduction to Apache Doris</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link length=3 tabindex=0 href=/docs/dev/gettingStarted/quick-start/>Quick Start</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/gettingStarted/alternatives/alternative-to-clickhouse/>Tech Alternatives</a></div></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=true href=/docs/dev/install/preparation/env-checking/>Guides</a></div><ul style=display:block;overflow:visible;height:auto class="menu__list menu__list_level_2 community_level_2"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/install/preparation/env-checking/>Installation and Deployment</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/db-connect/database-connect/>Database Connection</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/table-design/overview/>Data Table Design</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/data-operate/import/load-manual/>Loading Data</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/data-operate/update/update-overview/>Data Update and Delete</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/data-operate/export/export-overview/>Exporting Data</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/query-data/mysql-compatibility/>Data Queries</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/query-acceleration/performance-tuning-overview/tuning-overview/>Queries Acceleration</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/ai/ai-function-overview/>AI</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/lakehouse/lakehouse-overview/>Data Lakehouse</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/observability/overview/>Observability</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/compute-storage-decoupled/overview/>Compute-Storage Decoupled</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/admin-manual/auth/security-overview/>Security</a></div></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=true href=/docs/dev/benchmark/ssb/>Benchmark</a></div><ul style=display:block;overflow:visible;height:auto class="menu__list menu__list_level_2 community_level_2"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link length=3 tabindex=0 href=/docs/dev/benchmark/ssb/>Star Schema Benchmark</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link length=3 tabindex=0 href=/docs/dev/benchmark/tpch/>TPC-H Benchmark</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link length=3 tabindex=0 href=/docs/dev/benchmark/tpcds/>TPC-DS Benchmark</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true href=/docs/dev/admin-manual/cluster-management/upgrade/>Management</a></div><ul style=display:block;overflow:visible;height:auto class="menu__list menu__list_level_2 community_level_2"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/admin-manual/cluster-management/upgrade/>Managing Cluster</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/admin-manual/workload-management/workload-management-summary/>Managing Workload</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/admin-manual/data-admin/overview/>Managing Disaster Recovery</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/admin-manual/log-management/fe-log/>Log Management</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true tabindex=0 href=/docs/dev/admin-manual/maint-monitor/metrics/>Maintenance</a></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link length=5 tabindex=0 href=/docs/dev/admin-manual/maint-monitor/metrics/>Monitor Metrics</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link length=5 tabindex=0 href=/docs/dev/admin-manual/maint-monitor/monitor-alert/>Monitoring and alarming</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link length=5 tabindex=0 href=/docs/dev/admin-manual/maint-monitor/disk-capacity/>Disk Capacity Management</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current=page length=5 tabindex=0 href=/docs/dev/admin-manual/maint-monitor/tablet-repair-and-balance/>Data Replica Management</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link length=5 tabindex=0 href=/docs/dev/admin-manual/maint-monitor/automatic-service-start/>Automated Service Startup</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/admin-manual/config/config-dir/>Managing Configuration</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/admin-manual/system-tables/overview/>System Tables</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/admin-manual/trouble-shooting/memory-management/overview/>Trouble Shooting</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/admin-manual/open-api/overview/>OPEN API</a></div></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=true href=/docs/dev/ecosystem/spark-doris-connector/>Ecosystem</a></div><ul style=display:block;overflow:visible;height:auto class="menu__list menu__list_level_2 community_level_2"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link length=9 tabindex=0 href=/docs/dev/ecosystem/spark-doris-connector/>Spark Doris Connector</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link length=9 tabindex=0 href=/docs/dev/ecosystem/flink-doris-connector/>Flink Doris Connector</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link length=9 tabindex=0 href=/docs/dev/ecosystem/doris-kafka-connector/>Doris Kafka Connector</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/ecosystem/doris-operator/doris-operator-overview/>Doris Operator</a></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link length=9 tabindex=0 href=/docs/dev/ecosystem/doris-streamloader/>Doris Streamloader</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/ecosystem/bi/apache-superset/>BI</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/ecosystem/bi/clouddm/>SQL Clients</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/ecosystem/observability/logstash/>Observability</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/ecosystem/cloudcanal/>More</a></div></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=true href=/docs/dev/faq/install-faq/>FAQ</a></div><ul style=display:block;overflow:visible;height:auto class="menu__list menu__list_level_2 community_level_2"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link length=7 tabindex=0 href=/docs/dev/faq/install-faq/>Install Error</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link length=7 tabindex=0 href=/docs/dev/faq/data-faq/>Data Operation Error</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link length=7 tabindex=0 href=/docs/dev/faq/sql-faq/>SQL Error</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link length=7 tabindex=0 href=/docs/dev/faq/lakehouse-faq/>Data Lakehouse FAQ</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link length=7 tabindex=0 href=/docs/dev/faq/bi-faq/>BI FAQ</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link length=7 tabindex=0 href=/docs/dev/faq/correctness-faq/>Data Integrity FAQ</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link length=7 tabindex=0 href=/docs/dev/faq/load-faq/>Load FAQ</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=true href=/docs/dev/sql-manual/basic-element/sql-data-types/data-type-overview/>Reference</a></div><ul style=display:block;overflow:visible;height:auto class="menu__list menu__list_level_2 community_level_2"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/sql-manual/basic-element/sql-data-types/data-type-overview/>Basic Elements</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/sql-manual/sql-functions/ai-functions/distance-functions/cosine-distance/>SQL Functions</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/sql-manual/sql-statements/data-query/SELECT/>SQL Statements</a></div></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=true href=/docs/dev/releasenotes/all-release/>Releases</a></div><ul style=display:block;overflow:visible;height:auto class="menu__list menu__list_level_2 community_level_2"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link length=7 tabindex=0 href=/docs/dev/releasenotes/all-release/>All Releases</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/releasenotes/v3.1/release-3.1.1/>v3.1</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/releasenotes/v3.0/release-3.0.8/>v3.0</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/releasenotes/v2.1/release-2.1.11/>v2.1</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/releasenotes/v2.0/release-2.0.15/>v2.0</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/releasenotes/v1.2/release-1.2.8/>v1.2</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/dev/releasenotes/v1.1/release-1.1.5/>v1.1</a></div></ul></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_z5aJ"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role=alert><div>This documentation is for an <b>unreleased</b> version of Apache Doris.</div><div class=margin-top--md>For usage, please refer to the official documentation of  <b><a href=/docs/3.x/admin-manual/maint-monitor/tablet-repair-and-balance/>Version 2.1</a></b> or <b><a href=/docs/3.x/gettingStarted/what-is-apache-doris/>Version 3.x</a></b>.</div></div><div class=docItemContainer_c0TR><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><span class=breadcrumbs__link>Management</span><meta itemprop=position content=1><li class=breadcrumbs__item><span class=breadcrumbs__link>Maintenance</span><meta itemprop=position content=2><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link itemprop=name>Data Replica Management</span><meta itemprop=position content=3></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_bxCs"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Data Replica Management</h1></header><p>Beginning with version 0.9.0, Doris introduced an optimized replica management strategy and supported a richer replica status viewing tool. This document focuses on Doris data replica balancing, repair scheduling strategies, and replica management operations and maintenance methods. Help users to more easily master and manage the replica status in the cluster.</p>
<blockquote>
<p>Repairing and balancing copies of tables with Colocation attributes can be referred to <a href=/docs/dev/admin-manual/query-data/join/#colocate-join>HERE</a></p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=noun-interpretation>Noun Interpretation<a href=#noun-interpretation class=hash-link aria-label="Direct link to Noun Interpretation" title="Direct link to Noun Interpretation">â</a></h2>
<ol>
<li>Tablet: The logical fragmentation of a Doris table, where a table has multiple fragments.</li>
<li>Replica: A sliced copy, defaulting to three copies of a slice.</li>
<li>Healthy Replica: A healthy copy that survives at Backend and has a complete version.</li>
<li>Tablet Checker (TC): A resident background thread that scans all Tablets regularly, checks the status of these Tablets, and decides whether to send them to Tablet Scheduler based on the results.</li>
<li>Tablet Scheduler (TS): A resident background thread that handles Tablets sent by Tablet Checker that need to be repaired. At the same time, cluster replica balancing will be carried out.</li>
<li>Tablet SchedCtx (TSC): is a tablet encapsulation. When TC chooses a tablet, it encapsulates it as a TSC and sends it to TS.</li>
<li>Storage Medium: Storage medium. Doris supports specifying different storage media for partition granularity, including SSD and HDD. The replica scheduling strategy is also scheduled for different storage media.</li>
</ol>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">              +--------+              +-----------+</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">              |  Meta  |              |  Backends |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">              +---^----+              +------^----+</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">                  | |                        | 3. Send clone tasks</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain"> 1. Check tablets | |                        |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">           +--------v------+        +-----------------+</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">           | TabletChecker +--------> TabletScheduler |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">           +---------------+        +-----------------+</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">                   2. Waiting to be scheduled</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>The figure above is a simplified workflow.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=duplicate-status>Duplicate status<a href=#duplicate-status class=hash-link aria-label="Direct link to Duplicate status" title="Direct link to Duplicate status">â</a></h2>
<p>Multiple copies of a Tablet may cause state inconsistencies due to certain circumstances. Doris will attempt to automatically fix the inconsistent copies of these states so that the cluster can recover from the wrong state as soon as possible.</p>
<p><strong>The health status of a Replica is as follows:</strong></p>
<ol>
<li>
<p>BAD</p>
<p>That is, the copy is damaged. Includes, but is not limited to, the irrecoverable damaged status of copies caused by disk failures, BUGs, etc.</p>
</li>
<li>
<p>VERSION_MISSING</p>
<p>Version missing. Each batch of imports in Doris corresponds to a data version. A copy of the data consists of several consecutive versions. However, due to import errors, delays and other reasons, the data version of some copies may be incomplete.</p>
</li>
<li>
<p>HEALTHY</p>
<p>Health copy. That is, a copy of the normal data, and the BE node where the copy is located is in a normal state (heartbeat is normal and not in the offline process).</p>
</li>
</ol>
<p><strong>The health status of a Tablet is determined by the status of all its copies. There are the following categories:</strong></p>
<ol>
<li>
<p>REPLICA_MISSING</p>
<p>The copy is missing. That is, the number of surviving copies is less than the expected number of copies.</p>
</li>
<li>
<p>VERSION_INCOMPLETE</p>
<p>The number of surviving copies is greater than or equal to the number of expected copies, but the number of healthy copies is less than the number of expected copies.</p>
</li>
<li>
<p>REPLICA_RELOCATING</p>
<p>Have a full number of live copies of the replication num version, but the BE nodes where some copies are located are in unavailable state (such as decommission)</p>
</li>
<li>
<p>REPLICA_MISSING_IN_CLUSTER</p>
<p>When using multi-cluster, the number of healthy replicas is greater than or equal to the expected number of replicas, but the number of replicas in the corresponding cluster is less than the expected number of replicas.</p>
</li>
<li>
<p>REDUNDANT</p>
<p>Duplicate redundancy. Healthy replicas are in the corresponding cluster, but the number of replicas is larger than the expected number. Or there's a spare copy of unavailable.</p>
</li>
<li>
<p>FORCE_REDUNDANT</p>
<p>This is a special state. It only occurs when the number of existed replicas is greater than or equal to the number of available nodes, and the number of available nodes is greater than or equal to the number of expected replicas, and when the number of alive replicas is less than the number of expected replicas. In this case, you need to delete a copy first to ensure that there are available nodes for creating a new copy.</p>
</li>
<li>
<p>COLOCATE_MISMATCH</p>
<p>Fragmentation status of tables for Collocation attributes. Represents that the distribution of fragmented copies is inconsistent with the specified distribution of Colocation Group.</p>
</li>
<li>
<p>COLOCATE_REDUNDANT</p>
<p>Fragmentation status of tables for Collocation attributes. Represents the fragmented copy redundancy of the Colocation table.</p>
</li>
<li>
<p>HEALTHY</p>
<p>Healthy fragmentation, that is, conditions [1-5] are not satisfied.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=replica-repair>Replica Repair<a href=#replica-repair class=hash-link aria-label="Direct link to Replica Repair" title="Direct link to Replica Repair">â</a></h2>
<p>As a resident background process, Tablet Checker regularly checks the status of all fragments. For unhealthy fragmentation, it will be sent to Tablet Scheduler for scheduling and repair. The actual operation of repair is accomplished by clone task on BE. FE is only responsible for generating these clone tasks.</p>
<blockquote>
<p>Note 1: The main idea of replica repair is to make the number of fragmented replicas reach the desired value by creating or completing them first. Then delete the redundant copy.</p>
<p>Note 2: A clone task is to complete the process of copying specified data from a specified remote end to a specified destination.</p>
</blockquote>
<p>For different states, we adopt different repair methods:</p>
<ol>
<li>
<p>REPLICA_MISSING/REPLICA_RELOCATING</p>
<p>Select a low-load, available BE node as the destination. Choose a healthy copy as the source. Clone tasks copy a complete copy from the source to the destination. For replica completion, we will directly select an available BE node, regardless of the storage medium.</p>
</li>
<li>
<p>VERSION_INCOMPLETE</p>
<p>Select a relatively complete copy as the destination. Choose a healthy copy as the source. The clone task attempts to copy the missing version from the source to the destination.</p>
</li>
<li>
<p>REPLICA_MISSING_IN_CLUSTER</p>
<p>This state processing method is the same as REPLICA_MISSING.</p>
</li>
<li>
<p>REDUNDANT</p>
<p>Usually, after repair, there will be redundant copies in fragmentation. We select a redundant copy to delete it. The selection of redundant copies follows the following priorities:</p>
<ol>
<li>The BE where the copy is located has been offline.</li>
<li>The copy is damaged</li>
<li>The copy is lost in BE or offline</li>
<li>The replica is in the CLONE state (which is an intermediate state during clone task execution)</li>
<li>The copy has version missing</li>
<li>The cluster where the copy is located is incorrect</li>
<li>The BE node where the replica is located has a high load</li>
</ol>
</li>
<li>
<p>FORCE_REDUNDANT</p>
<p>Unlike REDUNDANT, because at this point Tablet has a copy missing, because there are no additional available nodes for creating new copies. So at this point, a copy must be deleted to free up a available node for creating a new copy.
The order of deleting copies is the same as REDUNDANT.</p>
</li>
<li>
<p>COLOCATE_MISMATCH</p>
<p>Select one of the replica distribution BE nodes specified in Colocation Group as the destination node for replica completion.</p>
</li>
<li>
<p>COLOCATE_REDUNDANT</p>
<p>Delete a copy on a BE node that is distributed by a copy specified in a non-Colocation Group.</p>
<p>Doris does not deploy a copy of the same Tablet on a different BE of the same host when selecting a replica node. It ensures that even if all BEs on the same host are deactivated, all copies will not be lost.</p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=scheduling-priority>Scheduling priority<a href=#scheduling-priority class=hash-link aria-label="Direct link to Scheduling priority" title="Direct link to Scheduling priority">â</a></h3>
<p>Waiting for the scheduled fragments in Tablet Scheduler gives different priorities depending on the status. High priority fragments will be scheduled first. There are currently several priorities.</p>
<ol>
<li>
<p>VERY_HIGH</p>
<ul>
<li>REDUNDANT. For slices with duplicate redundancy, we give priority to them. Logically, duplicate redundancy is the least urgent, but because it is the fastest to handle and can quickly release resources (such as disk space, etc.), we give priority to it.</li>
<li>FORCE_REDUNDANT. Ditto.</li>
</ul>
</li>
<li>
<p>HIGH</p>
<ul>
<li>REPLICA_MISSING and most copies are missing (for example, 2 copies are missing in 3 copies)</li>
<li>VERSION_INCOMPLETE and most copies are missing</li>
<li>COLOCATE_MISMATCH We hope that the fragmentation related to the Collocation table can be repaired as soon as possible.</li>
<li>COLOCATE_REDUNDANT</li>
</ul>
</li>
<li>
<p>NORMAL</p>
<ul>
<li>REPLICA_MISSING, but most survive (for example, three copies lost one)</li>
<li>VERSION_INCOMPLETE, but most copies are complete</li>
<li>REPLICA_RELOCATING and relocate is required for most replicas (e.g. 3 replicas with 2 replicas)</li>
</ul>
</li>
<li>
<p>LOW</p>
<ul>
<li>REPLICA_MISSING_IN_CLUSTER</li>
<li>REPLICA_RELOCATING most copies stable</li>
</ul>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=manual-priority>Manual priority<a href=#manual-priority class=hash-link aria-label="Direct link to Manual priority" title="Direct link to Manual priority">â</a></h3>
<p>The system will automatically determine the scheduling priority. Sometimes, however, users want the fragmentation of some tables or partitions to be repaired faster. So we provide a command that the user can specify that a slice of a table or partition is repaired first:</p>
<p><code>ADMIN REPAIR TABLE tbl [PARTITION (p1, p2, ...)];</code></p>
<p>This command tells TC to give VERY HIGH priority to the problematic tables or partitions that need to be repaired first when scanning Tablets.</p>
<blockquote>
<p>Note: This command is only a hint, which does not guarantee that the repair will be successful, and the priority will change with the scheduling of TS. And when Master FE switches or restarts, this information will be lost.</p>
</blockquote>
<p>Priority can be cancelled by the following commands:</p>
<p><code>ADMIN CANCEL REPAIR TABLE tbl [PARTITION (p1, p2, ...)];</code></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=priority-scheduling>Priority scheduling<a href=#priority-scheduling class=hash-link aria-label="Direct link to Priority scheduling" title="Direct link to Priority scheduling">â</a></h3>
<p>Priority ensures that severely damaged fragments can be repaired first, and improves system availability. But if the high priority repair task fails all the time, the low priority task will never be scheduled. Therefore, we will dynamically adjust the priority of tasks according to the running status of tasks, so as to ensure that all tasks have the opportunity to be scheduled.</p>
<ul>
<li>If the scheduling fails for five consecutive times (e.g., no resources can be obtained, no suitable source or destination can be found, etc.), the priority will be lowered.</li>
<li>If not scheduled for 30 minutes, priority will be raised.</li>
<li>The priority of the same tablet task is adjusted at least five minutes apart.</li>
</ul>
<p>At the same time, in order to ensure the weight of the initial priority, we stipulate that the initial priority is VERY HIGH, and the lowest is lowered to NORMAL. When the initial priority is LOW, it is raised to HIGH at most. The priority adjustment here also adjusts the priority set manually by the user.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=replicas-balance>Replicas Balance<a href=#replicas-balance class=hash-link aria-label="Direct link to Replicas Balance" title="Direct link to Replicas Balance">â</a></h2>
<p>Doris automatically balances replicas within the cluster. Currently supports two rebalance strategies, BeLoad and Partition. BeLoad rebalance will consider about the disk usage and replica count for each BE. Partition rebalance just aim at replica count for each partition, this helps to avoid hot spots. If you want high read/write performance, you may need this. Note that Partition rebalance do not consider about the disk usage, pay more attention to it when you are using Partition rebalance. The strategy selection config is not mutable at runtime.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=beload>BeLoad<a href=#beload class=hash-link aria-label="Direct link to BeLoad" title="Direct link to BeLoad">â</a></h3>
<p>The main idea of balancing is to create a replica of some fragments on low-load nodes, and then delete the replicas of these fragments on high-load nodes. At the same time, because of the existence of different storage media, there may or may not exist one or two storage media on different BE nodes in the same cluster. We require that fragments of storage medium A be stored in storage medium A as far as possible after equalization. So we divide the BE nodes of the cluster according to the storage medium. Then load balancing scheduling is carried out for different BE node sets of storage media.</p>
<p>Similarly, replica balancing ensures that a copy of the same table will not be deployed on the BE of the same host.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=be-node-load>BE Node Load<a href=#be-node-load class=hash-link aria-label="Direct link to BE Node Load" title="Direct link to BE Node Load">â</a></h3>
<p>We use Cluster LoadStatistics (CLS) to represent the load balancing of each backend in a cluster. Tablet Scheduler triggers cluster equilibrium based on this statistic. We currently calculate a load Score for each BE as the BE load score by using <strong>disk usage</strong> and <strong>number of copies</strong>. The higher the score, the heavier the load on the BE.</p>
<p>Disk usage and number of copies have a weight factor, which is <strong>capacityCoefficient</strong> and <strong>replicaNumCoefficient</strong>, respectively. The sum of them is <strong>constant to 1</strong>. Among them, capacityCoefficient will dynamically adjust according to actual disk utilization. When the overall disk utilization of a BE is below 50%, the capacityCoefficient value is 0.5, and if the disk utilization is above 75% (configurable through the FE configuration item <code>capacity_used_percent_high_water</code>), the value is 1. If the utilization rate is between 50% and 75%, the weight coefficient increases smoothly. The formula is as follows:</p>
<p><code>capacityCoefficient = 2 * Disk Utilization - 0.5</code></p>
<p>The weight coefficient ensures that when disk utilization is too high, the backend load score will be higher to ensure that the BE load is reduced as soon as possible.</p>
<p>Tablet Scheduler updates CLS every 20 seconds.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=partition>Partition<a href=#partition class=hash-link aria-label="Direct link to Partition" title="Direct link to Partition">â</a></h3>
<p>The main idea of <code>partition rebalancing</code> is to decrease the skew of partitions. The skew of the partition is defined as the difference between the maximum replica count of the partition over all bes and the minimum replica count over all bes.</p>
<p>So we only consider about the replica count, do not consider replica size(disk usage).
To fewer moves, we use TwoDimensionalGreedyAlgo which two dims are cluster & partition. It prefers a move that reduce the skew of the cluster when we want to rebalance a max skew partition.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=skew-info>Skew Info<a href=#skew-info class=hash-link aria-label="Direct link to Skew Info" title="Direct link to Skew Info">â</a></h4>
<p>The skew info is represented by <code>ClusterBalanceInfo</code>. <code>partitionInfoBySkew</code> is a multimap which key is the partition's skew, so we can get max skew partitions simply. <code>beByTotalReplicaCount</code> is a multimap which key is the total replica count of the backend.</p>
<p><code>ClusterBalanceInfo</code> is in CLS, updated every 20 seconds.</p>
<p>When get more than one max skew partitions, we random select one partition to calculate the move.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=equilibrium-strategy>Equilibrium strategy<a href=#equilibrium-strategy class=hash-link aria-label="Direct link to Equilibrium strategy" title="Direct link to Equilibrium strategy">â</a></h3>
<p>Tablet Scheduler uses Load Balancer to select a certain number of healthy fragments as candidate fragments for balance in each round of scheduling. In the next scheduling, balanced scheduling will be attempted based on these candidate fragments.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=resource-control>Resource control<a href=#resource-control class=hash-link aria-label="Direct link to Resource control" title="Direct link to Resource control">â</a></h2>
<p>Both replica repair and balancing are accomplished by replica copies between BEs. If the same BE performs too many tasks at the same time, it will bring a lot of IO pressure. Therefore, Doris controls the number of tasks that can be performed on each node during scheduling. The smallest resource control unit is the disk (that is, a data path specified in be.conf). By default, we configure two slots per disk for replica repair. A clone task occupies one slot at the source and one slot at the destination. If the number of slots is zero, no more tasks will be assigned to this disk. The number of slots can be configured by FE's <code>schedule_slot_num_per_hdd_path</code> or <code>schedule_slot_num_per_ssd_path</code> parameter.</p>
<p>In addition, by default, we provide two separate slots per disk for balancing tasks. The purpose is to prevent high-load nodes from losing space by balancing because slots are occupied by repair tasks.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=tablet-state-view>Tablet State View<a href=#tablet-state-view class=hash-link aria-label="Direct link to Tablet State View" title="Direct link to Tablet State View">â</a></h2>
<p>Tablet state view mainly looks at the state of the tablet, as well as the state of the tablet repair and balancing tasks. Most of these states <strong>exist only in</strong> Master FE nodes. Therefore, the following commands need to be executed directly to Master FE.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=tablet-state>Tablet state<a href=#tablet-state class=hash-link aria-label="Direct link to Tablet state" title="Direct link to Tablet state">â</a></h3>
<ol>
<li>
<p>Global state checking</p>
<p>Through <code>SHOW PROC'/cluster_health/tablet_health'; </code>commands can view the replica status of the entire cluster.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">+-------+--------------------------------+-----------+------------+-------------------+----------------------+----------------------+--------------+----------------------------+-------------------------+-------------------+---------------------+----------------------+----------------------+------------------+-----------------------------+-----------------+-------------+------------+</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| DbId  | DbName                         | TabletNum | HealthyNum | ReplicaMissingNum | VersionIncompleteNum | ReplicaRelocatingNum | RedundantNum | ReplicaMissingInClusterNum | ReplicaMissingForTagNum | ForceRedundantNum | ColocateMismatchNum | ColocateRedundantNum | NeedFurtherRepairNum | UnrecoverableNum | ReplicaCompactionTooSlowNum | InconsistentNum | OversizeNum | CloningNum |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">+-------+--------------------------------+-----------+------------+-------------------+----------------------+----------------------+--------------+----------------------------+-------------------------+-------------------+---------------------+----------------------+----------------------+------------------+-----------------------------+-----------------+-------------+------------+</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 10005 | default_cluster:doris_audit_db | 84        | 84         | 0                 | 0                    | 0                    | 0            | 0                          | 0                       | 0                 | 0                   | 0                    | 0                    | 0                | 0                           | 0               | 0           | 0          |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 13402 | default_cluster:ssb1           | 709       | 708        | 1                 | 0                    | 0                    | 0            | 0                          | 0                       | 0                 | 0                   | 0                    | 0                    | 0                | 0                           | 0               | 0           | 0          |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 10108 | default_cluster:tpch1          | 278       | 278        | 0                 | 0                    | 0                    | 0            | 0                          | 0                       | 0                 | 0                   | 0                    | 0                    | 0                | 0                           | 0               | 0           | 0          |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| Total | 3                              | 1071      | 1070       | 1                 | 0                    | 0                    | 0            | 0                          | 0                       | 0                 | 0                   | 0                    | 0                    | 0                | 0                           | 0               | 0           | 0          |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">+-------+--------------------------------+-----------+------------+-------------------+----------------------+----------------------+--------------+----------------------------+-------------------------+-------------------+---------------------+----------------------+----------------------+------------------+-----------------------------+-----------------+-------------+------------+</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>The <code>HealthyNum</code> column shows how many Tablets are in a healthy state in the corresponding database. <code>ReplicaCompactionTooSlowNum</code> column shows how many Tablets are in a too many versions state in the corresponding database, <code>InconsistentNum</code> column shows how many Tablets are in an inconsistent replica state in the corresponding database. The last <code>Total</code> line counts the entire cluster. Normally <code>TabletNum</code> and <code>HealthyNum</code> should be equal. If it's not equal, you can further see which Tablets are there. As shown in the figure above, one table in the ssb1 database is not healthy, you can use the following command to see which one is.</p>
<p><code>SHOW PROC '/cluster_health/tablet_health/13402';</code></p>
<p>Among them <code>13402</code> is the corresponding DbId.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">+-----------------------+--------------------------+--------------------------+------------------+--------------------------------+-----------------------------+-----------------------+-------------------------+--------------------------+--------------------------+----------------------+---------------------------------+---------------------+-----------------+</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| ReplicaMissingTablets | VersionIncompleteTablets | ReplicaRelocatingTablets | RedundantTablets | ReplicaMissingInClusterTablets | ReplicaMissingForTagTablets | ForceRedundantTablets | ColocateMismatchTablets | ColocateRedundantTablets | NeedFurtherRepairTablets | UnrecoverableTablets | ReplicaCompactionTooSlowTablets | InconsistentTablets | OversizeTablets |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">+-----------------------+--------------------------+--------------------------+------------------+--------------------------------+-----------------------------+-----------------------+-------------------------+--------------------------+--------------------------+----------------------+---------------------------------+---------------------+-----------------+</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 14679                 |                          |                          |                  |                                |                             |                       |                         |                          |                          |                      |                                 |                     |                 |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">+-----------------------+--------------------------+--------------------------+------------------+--------------------------------+-----------------------------+-----------------------+-------------------------+--------------------------+--------------------------+----------------------+---------------------------------+---------------------+-----------------+</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>The figure above shows the specific unhealthy Tablet ID (14679). Later we'll show you how to view the status of each copy of a specific Tablet.</p>
</li>
<li>
<p>Table (partition) level status checking</p>
<p>Users can view the status of a copy of a specified table or partition through the following commands and filter the status through a WHERE statement. If you look at table tbl1, the state on partitions P1 and P2 is a copy of OK:</p>
<p><code>SHOW REPLICA STATUS FROM tbl1 PARTITION (p1, p2) WHERE STATUS = "OK";</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">+----------+-----------+-----------+---------+-------------------+--------------------+------------------+------------+------------+-------+--------+--------+</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| TabletId | ReplicaId | BackendId | Version | LastFailedVersion | LastSuccessVersion | CommittedVersion | SchemaHash | VersionNum | IsBad | State  | Status |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">+----------+-----------+-----------+---------+-------------------+--------------------+------------------+------------+------------+-------+--------+--------+</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 29502429 | 29502432  | 10006     | 2       | -1                | 2                  | 1                | -1         | 2          | false | NORMAL | OK     |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 29502429 | 36885996  | 10002     | 2       | -1                | -1                 | 1                | -1         | 2          | false | NORMAL | OK     |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 29502429 | 48100551  | 10007     | 2       | -1                | -1                 | 1                | -1         | 2          | false | NORMAL | OK     |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 29502433 | 29502434  | 10001     | 2       | -1                | 2                  | 1                | -1         | 2          | false | NORMAL | OK     |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 29502433 | 44900737  | 10004     | 2       | -1                | -1                 | 1                | -1         | 2          | false | NORMAL | OK     |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 29502433 | 48369135  | 10006     | 2       | -1                | -1                 | 1                | -1         | 2          | false | NORMAL | OK     |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">+----------+-----------+-----------+---------+-------------------+--------------------+------------------+------------+------------+-------+--------+--------+</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>The status of all copies is shown here. Where <code>IsBad</code> is listed as <code>true</code>, the copy is damaged. The <code>Status</code> column displays other states. Specific status description, you can see help through <code>HELP SHOW REPLICA STATUS</code>.</p>
<p><code>The SHOW REPLICA STATUS</code>command is mainly used to view the health status of copies. Users can also view additional information about copies of a specified table by using the following commands:</p>
<p><code>SHOW TABLETS FROM tbl1;</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">+----------+-----------+-----------+------------+---------+-------------+-------------------+-----------------------+------------------+----------------------+---------------+----------+----------+--------+-------------------------+--------------+----------------------+--------------+----------------------+----------------------+----------------------+</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| TabletId | ReplicaId | BackendId | SchemaHash | Version | VersionHash | LstSuccessVersion | LstSuccessVersionHash | LstFailedVersion | LstFailedVersionHash | LstFailedTime | DataSize | RowCount | State  | LstConsistencyCheckTime | CheckVersion | 	CheckVersionHash | VersionCount | PathHash             | MetaUrl              | CompactionStatus     |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">+----------+-----------+-----------+------------+---------+-------------+-------------------+-----------------------+------------------+----------------------+---------------+----------+----------+--------+-------------------------+--------------+----------------------+--------------+----------------------+----------------------+----------------------+</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 29502429 | 29502432  | 10006     | 1421156361 | 2       | 0           | 2                 | 0                     | -1               | 0                    | N/A           | 784      | 0        | NORMAL | N/A                     | -1           | 	-1               | 2            | -5822326203532286804 | url                  | url                  |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 29502429 | 36885996  | 10002     | 1421156361 | 2       | 0           | -1                | 0                     | -1               | 0                    | N/A           | 784      | 0        | NORMAL | N/A                     | -1           | 	-1               | 2            | -1441285706148429853 | url                  | url                  |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 29502429 | 48100551  | 10007     | 1421156361 | 2       | 0           | -1                | 0                     | -1               | 0                    | N/A           | 784      | 0        | NORMAL | N/A                     | -1           | 	-1               | 2            | -4784691547051455525 | url                  | url                  |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">+----------+-----------+-----------+------------+---------+-------------+-------------------+-----------------------+------------------+----------------------+---------------+----------+----------+--------+-------------------------+--------------+----------------------+--------------+----------------------+----------------------+----------------------+  </span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>The figure above shows some additional information, including copy size, number of rows, number of versions, where the data path is located.</p>
<blockquote>
<p>Note: The contents of the <code>State</code> column shown here do not represent the health status of the replica, but the status of the replica under certain tasks, such as CLONE, SCHEMA CHANGE, ROLLUP, etc.</p>
</blockquote>
<p>In addition, users can check the distribution of replicas in a specified table or partition by following commands.</p>
<p><code>SHOW REPLICA DISTRIBUTION FROM tbl1;</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">+-----------+------------+-------+---------+</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| BackendId | ReplicaNum | Graph | Percent |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">+-----------+------------+-------+---------+</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 10000     | 7          |       | 7.29 %  |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 10001     | 9          |       | 9.38 %  |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 10002     | 7          |       | 7.29 %  |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 10003     | 7          |       | 7.29 %  |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 10004     | 9          |       | 9.38 %  |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 10005     | 11         | >     | 11.46 % |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 10006     | 18         | >     | 18.75 % |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 10007     | 15         | >     | 15.62 % |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 10008     | 13         | >     | 13.54 % |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">+-----------+------------+-------+---------+</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>Here we show the number and percentage of replicas of table tbl1 on each BE node, as well as a simple graphical display.</p>
</li>
<li>
<p>Tablet level status checking</p>
<p>When we want to locate a specific Tablet, we can use the following command to view the status of a specific Tablet. For example, check the tablet with ID 2950253:</p>
<p><code>SHOW TABLET 29502553;</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">+------------------------+-----------+---------------+-----------+----------+----------+-------------+----------+--------+---------------------------------------------------------------------------+</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| DbName                 | TableName | PartitionName | IndexName | DbId     | TableId  | PartitionId | IndexId  | IsSync | DetailCmd                                                                 |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">+------------------------+-----------+---------------+-----------+----------+----------+-------------+----------+--------+---------------------------------------------------------------------------+</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| default_cluster:test   | test      | test          | test      | 29502391 | 29502428 | 29502427    | 29502428 | true   | SHOW PROC '/dbs/29502391/29502428/partitions/29502427/29502428/29502553'; |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">+------------------------+-----------+---------------+-----------+----------+----------+-------------+----------+--------+---------------------------------------------------------------------------+</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>The figure above shows the database, tables, partitions, roll-up tables and other information corresponding to this tablet. The user can copy the command in the <code>DetailCmd</code> command to continue executing:</p>
<p><code>Show Proc'/DBS/29502391/29502428/Partitions/29502427/29502428/29502553;</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">+-----------+-----------+---------+-------------+-------------------+-----------------------+------------------+----------------------+---------------+------------+----------+----------+--------+-------+--------------+----------------------+</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| ReplicaId | BackendId | Version | VersionHash | LstSuccessVersion | LstSuccessVersionHash | LstFailedVersion | LstFailedVersionHash | LstFailedTime | SchemaHash | DataSize | RowCount | State  | IsBad | VersionCount | PathHash             |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">+-----------+-----------+---------+-------------+-------------------+-----------------------+------------------+----------------------+---------------+------------+----------+----------+--------+-------+--------------+----------------------+</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 43734060  | 10004     | 2       | 0           | -1                | 0                     | -1               | 0                    | N/A           | -1         | 784      | 0        | NORMAL | false | 2            | -8566523878520798656 |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 29502555  | 10002     | 2       | 0           | 2                 | 0                     | -1               | 0                    | N/A           | -1         | 784      | 0        | NORMAL | false | 2            | 1885826196444191611  |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 39279319  | 10007     | 2       | 0           | -1                | 0                     | -1               | 0                    | N/A           | -1         | 784      | 0        | NORMAL | false | 2            | 1656508631294397870  |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">+-----------+-----------+---------+-------------+-------------------+-----------------------+------------------+----------------------+---------------+------------+----------+----------+--------+-------+--------------+----------------------+</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>The figure above shows all replicas of the corresponding Tablet. The content shown here is the same as <code>SHOW TABLETS FROM tbl1;</code>. But here you can clearly see the status of all copies of a specific Tablet.</p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=duplicate-scheduling-task>Duplicate Scheduling Task<a href=#duplicate-scheduling-task class=hash-link aria-label="Direct link to Duplicate Scheduling Task" title="Direct link to Duplicate Scheduling Task">â</a></h3>
<ol>
<li>
<p>View tasks waiting to be scheduled</p>
<p><code>SHOW PROC '/cluster_balance/pending_tablets';</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">+----------+--------+-----------------+---------+----------+----------+-------+---------+--------+----------+---------+---------------------+---------------------+---------------------+----------+------+-------------+---------------+---------------------+------------+---------------------+--------+---------------------+-------------------------------+</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| TabletId | Type   | Status          | State   | OrigPrio | DynmPrio | SrcBe | SrcPath | DestBe | DestPath | Timeout | Create              | LstSched            | LstVisit            | Finished | Rate | FailedSched | FailedRunning | LstAdjPrio          | VisibleVer | VisibleVerHash      | CmtVer | CmtVerHash          | ErrMsg                        |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">+----------+--------+-----------------+---------+----------+----------+-------+---------+--------+----------+---------+---------------------+---------------------+---------------------+----------+------+-------------+---------------+---------------------+------------+---------------------+--------+---------------------+-------------------------------+</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 4203036  | REPAIR | REPLICA_MISSING | PENDING | HIGH     | LOW      | -1    | -1      | -1     | -1       | 0       | 2019-02-21 15:00:20 | 2019-02-24 11:18:41 | 2019-02-24 11:18:41 | N/A      | N/A  | 2           | 0             | 2019-02-21 15:00:43 | 1          | 0                   | 2      | 0                   | unable to find source replica |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">+----------+--------+-----------------+---------+----------+----------+-------+---------+--------+----------+---------+---------------------+---------------------+---------------------+----------+------+-------------+---------------+---------------------+------------+---------------------+--------+---------------------+-------------------------------+</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>The specific meanings of each column are as follows:</p>
<ul>
<li>TabletId: The ID of the Tablet waiting to be scheduled. A scheduling task is for only one Tablet</li>
<li>Type: Task type, which can be REPAIR (repair) or BALANCE (balance)</li>
<li>Status: The current status of the Tablet, such as REPLICA_MISSING (copy missing)</li>
<li>State: The status of the scheduling task may be PENDING/RUNNING/FINISHED/CANCELLED/TIMEOUT/UNEXPECTED</li>
<li>OrigPrio: Initial Priority</li>
<li>DynmPrio: Current dynamically adjusted priority</li>
<li>SrcBe: ID of the BE node at the source end</li>
<li>SrcPath: hash value of the path of the BE node at the source end</li>
<li>DestBe: ID of destination BE node</li>
<li>DestPath: hash value of the path of the destination BE node</li>
<li>Timeout: When the task is scheduled successfully, the timeout time of the task is displayed here in units of seconds.</li>
<li>Create: The time when the task was created</li>
<li>LstSched: The last time a task was scheduled</li>
<li>LstVisit: The last time a task was accessed. Here "accessed" refers to the processing time points associated with the task, including scheduling, task execution reporting, and so on.</li>
<li>Finished: Task End Time</li>
<li>Rate: Clone Task Data Copy Rate</li>
<li>Failed Sched: Number of Task Scheduling Failures</li>
<li>Failed Running: Number of task execution failures</li>
<li>LstAdjPrio: Time of last priority adjustment</li>
<li>CmtVer/CmtVerHash/VisibleVer/VisibleVerHash: version information for clone tasks</li>
<li>ErrMsg: Error messages that occur when tasks are scheduled and run</li>
</ul>
</li>
<li>
<p>View running tasks</p>
<p><code>SHOW PROC '/cluster_balance/running_tablets';</code></p>
<p>The columns in the result have the same meaning as <code>pending_tablets</code>.</p>
</li>
<li>
<p>View completed tasks</p>
<p><code>SHOW PROC '/cluster_balance/history_tablets';</code></p>
<p>By default, we reserve only the last 1,000 completed tasks. The columns in the result have the same meaning as <code>pending_tablets</code>. If <code>State</code> is listed as <code>FINISHED</code>, the task is normally completed. For others, you can see the specific reason based on the error information in the <code>ErrMsg</code> column.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=viewing-cluster-load-and-scheduling-resources>Viewing Cluster Load and Scheduling Resources<a href=#viewing-cluster-load-and-scheduling-resources class=hash-link aria-label="Direct link to Viewing Cluster Load and Scheduling Resources" title="Direct link to Viewing Cluster Load and Scheduling Resources">â</a></h2>
<ol>
<li>
<p>Cluster load</p>
<p>You can view the current load of the cluster by following commands:</p>
<p><code>SHOW PROC '/cluster_balance/cluster_load_stat/location_default';</code></p>
<p>First of all, we can see the division of different storage media:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">+---------------+</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| StorageMedium |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">+---------------+</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| HDD           |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| SSD           |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">+---------------+</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>Click on a storage medium to see the equilibrium state of the BE node that contains the storage medium:</p>
<p><code>SHOW PROC '/cluster_balance/cluster_load_stat/location_default/HDD';</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">+----------+-----------------+-----------+---------------+----------------+-------------+------------+----------+-----------+--------------------+-------+</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| BeId     | Cluster         | Available | UsedCapacity  | Capacity       | UsedPercent | ReplicaNum | CapCoeff | ReplCoeff | Score              | Class |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">+----------+-----------------+-----------+---------------+----------------+-------------+------------+----------+-----------+--------------------+-------+</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 10003    | default_cluster | true      | 3477875259079 | 19377459077121 | 17.948      | 493477     | 0.5      | 0.5       | 0.9284678149967587 | MID   |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 10002    | default_cluster | true      | 3607326225443 | 19377459077121 | 18.616      | 496928     | 0.5      | 0.5       | 0.948660871419998  | MID   |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 10005    | default_cluster | true      | 3523518578241 | 19377459077121 | 18.184      | 545331     | 0.5      | 0.5       | 0.9843539990641831 | MID   |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 10001    | default_cluster | true      | 3535547090016 | 19377459077121 | 18.246      | 558067     | 0.5      | 0.5       | 0.9981869446537612 | MID   |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 10006    | default_cluster | true      | 3636050364835 | 19377459077121 | 18.764      | 547543     | 0.5      | 0.5       | 1.0011489897614072 | MID   |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 10004    | default_cluster | true      | 3506558163744 | 15501967261697 | 22.620      | 468957     | 0.5      | 0.5       | 1.0228319835582569 | MID   |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 10007    | default_cluster | true      | 4036460478905 | 19377459077121 | 20.831      | 551645     | 0.5      | 0.5       | 1.057279369420761  | MID   |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 10000    | default_cluster | true      | 4369719923760 | 19377459077121 | 22.551      | 547175     | 0.5      | 0.5       | 1.0964036415787461 | MID   |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">+----------+-----------------+-----------+---------------+----------------+-------------+------------+----------+-----------+--------------------+-------+</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>Some of these columns have the following meanings:</p>
<ul>
<li>Available: True means that BE heartbeat is normal and not offline.</li>
<li>UsedCapacity: Bytes, the size of disk space used on BE</li>
<li>Capacity: Bytes, the total disk space size on BE</li>
<li>UsedPercent: Percentage, disk space utilization on BE</li>
<li>ReplicaNum: Number of copies on BE</li>
<li>CapCoeff/ReplCoeff: Weight Coefficient of Disk Space and Copy Number</li>
<li>Score: Load score. The higher the score, the heavier the load.</li>
<li>Class: Classified by load, LOW/MID/HIGH. Balanced scheduling moves copies from high-load nodes to low-load nodes</li>
</ul>
<p>Users can further view the utilization of each path on a BE, such as the BE with ID 10001:</p>
<p><code>SHOW PROC '/cluster_balance/cluster_load_stat/location_default/HDD/10001';</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">+------------------+------------------+---------------+---------------+---------+--------+----------------------+</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| RootPath         | DataUsedCapacity | AvailCapacity | TotalCapacity | UsedPct | State  | PathHash             |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">+------------------+------------------+---------------+---------------+---------+--------+----------------------+</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| /home/disk4/palo | 498.757 GB       | 3.033 TB      | 3.525 TB      | 13.94 % | ONLINE | 4883406271918338267  |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| /home/disk3/palo | 704.200 GB       | 2.832 TB      | 3.525 TB      | 19.65 % | ONLINE | -5467083960906519443 |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| /home/disk1/palo | 512.833 GB       | 3.007 TB      | 3.525 TB      | 14.69 % | ONLINE | -7733211489989964053 |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| /home/disk2/palo | 881.955 GB       | 2.656 TB      | 3.525 TB      | 24.65 % | ONLINE | 4870995507205544622  |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| /home/disk5/palo | 694.992 GB       | 2.842 TB      | 3.525 TB      | 19.36 % | ONLINE | 1916696897889786739  |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">+------------------+------------------+---------------+---------------+---------+--------+----------------------+</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>The disk usage of each data path on the specified BE is shown here.</p>
</li>
<li>
<p>Scheduling resources</p>
<p>Users can view the current slot usage of each node through the following commands:</p>
<p><code>SHOW PROC '/cluster_balance/working_slots';</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">+----------+----------------------+------------+------------+-------------+----------------------+</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| BeId     | PathHash             | AvailSlots | TotalSlots | BalanceSlot | AvgRate              |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">+----------+----------------------+------------+------------+-------------+----------------------+</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 10000    | 8110346074333016794  | 2          | 2          | 2           | 2.459007474009069E7  |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 10000    | -5617618290584731137 | 2          | 2          | 2           | 2.4730105014001578E7 |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 10001    | 4883406271918338267  | 2          | 2          | 2           | 1.6711402709780257E7 |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 10001    | -5467083960906519443 | 2          | 2          | 2           | 2.7540126380326536E7 |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 10002    | 9137404661108133814  | 2          | 2          | 2           | 2.417217089806745E7  |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| 10002    | 1885826196444191611  | 2          | 2          | 2           | 1.6327378456676323E7 |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">+----------+----------------------+------------+------------+-------------+----------------------+</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>In this paper, data path is used as granularity to show the current use of slot. Among them, `AvgRate'is the copy rate of clone task in bytes/seconds on the path of historical statistics.</p>
</li>
<li>
<p>Priority repair view</p>
<p>The following command allows you to view the priority repaired tables or partitions set by the `ADMIN REPAIR TABLE'command.</p>
<p><code>SHOW PROC '/cluster_balance/priority_repair';</code></p>
<p>Among them, `Remaining TimeMs'indicates that these priority fixes will be automatically removed from the priority fix queue after this time. In order to prevent resources from being occupied due to the failure of priority repair.</p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=scheduler-statistical-status-view>Scheduler Statistical Status View<a href=#scheduler-statistical-status-view class=hash-link aria-label="Direct link to Scheduler Statistical Status View" title="Direct link to Scheduler Statistical Status View">â</a></h3>
<p>We have collected some statistics of Tablet Checker and Tablet Scheduler during their operation, which can be viewed through the following commands:</p>
<p><code>SHOW PROC '/cluster_balance/sched_stat';</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">+---------------------------------------------------+-------------+</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| Item                                              | Value       |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">+---------------------------------------------------+-------------+</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| num of tablet check round                         | 12041       |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| cost of tablet check(ms)                          | 7162342     |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| num of tablet checked in tablet checker           | 18793506362 |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| num of unhealthy tablet checked in tablet checker | 7043900     |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| num of tablet being added to tablet scheduler     | 1153        |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| num of tablet schedule round                      | 49538       |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| cost of tablet schedule(ms)                       | 49822       |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| num of tablet being scheduled                     | 4356200     |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| num of tablet being scheduled succeeded           | 320         |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| num of tablet being scheduled failed              | 4355594     |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| num of tablet being scheduled discard             | 286         |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| num of tablet priority upgraded                   | 0           |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| num of tablet priority downgraded                 | 1096        |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| num of clone task                                 | 230         |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| num of clone task succeeded                       | 228         |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| num of clone task failed                          | 2           |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| num of clone task timeout                         | 2           |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| num of replica missing error                      | 4354857     |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| num of replica version missing error              | 967         |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| num of replica relocating                         | 0           |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| num of replica redundant error                    | 90          |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| num of replica missing in cluster error           | 0           |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">| num of balance scheduled                          | 0           |</span><br></span><span class=token-line style=color:#F8F8F2><span class="token plain">+---------------------------------------------------+-------------+</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>The meanings of each line are as follows:</p>
<ul>
<li>
<p>num of tablet check round: Number of Tablet Checker inspections</p>
</li>
<li>
<p>cost of tablet check(ms): Total time consumed by Tablet Checker inspections (milliseconds)</p>
</li>
<li>
<p>num of tablet checked in tablet checker: Number of tablets checked by the Tablet Checker</p>
</li>
<li>
<p>num of unhealthy tablet checked in tablet checker: Number of unhealthy tablets checked by the Tablet Checker</p>
</li>
<li>
<p>num of tablet being added to tablet scheduler: Number of tablets submitted to the Tablet Scheduler</p>
</li>
<li>
<p>num of tablet schedule round: Number of Tablet Scheduler runs</p>
</li>
<li>
<p>cost of tablet schedule(ms): Total time consumed by Tablet Scheduler runs (milliseconds)</p>
</li>
<li>
<p>num of tablet being scheduled: Total number of tablets scheduled</p>
</li>
<li>
<p>num of tablet being scheduled succeeded: Total number of tablets successfully scheduled</p>
</li>
<li>
<p>num of tablet being scheduled failed: Total number of tablets that failed scheduling</p>
</li>
<li>
<p>num of tablet being scheduled discard: Total number of tablets discarded due to scheduling failures</p>
</li>
<li>
<p>num of tablet priority upgraded: Number of tablet priority upgrades</p>
</li>
<li>
<p>num of tablet priority downgraded: Number of tablet priority downgrades</p>
</li>
<li>
<p>num of clone task: Number of clone tasks generated</p>
</li>
<li>
<p>num of clone task succeeded: Number of successful clone tasks</p>
</li>
<li>
<p>num of clone task failed: Number of failed clone tasks</p>
</li>
<li>
<p>num of clone task timeout: Number of clone tasks that timed out</p>
</li>
<li>
<p>num of replica missing error: Number of tablets whose status is checked as missing replicas</p>
</li>
<li>
<p>num of replica version missing error: Number of tablets checked with missing version status (this statistic includes num of replica relocating and num of replica missing in cluster error)</p>
</li>
<li>
<p>num of replica relocation: Number of replica relocations</p>
</li>
<li>
<p>num of replica redundant error: Number of tablets whose checked status is replica redundant</p>
</li>
<li>
<p>num of replica missing in cluster error: Number of tablets checked with a status indicating they are missing from the corresponding cluster</p>
</li>
<li>
<p>num of balance scheduled: Number of balanced scheduling attempts</p>
</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_Gfwi alert alert--info"><div class=admonitionHeading_f1Ed>Note</div><div class=admonitionContent_UjKb><p>The above states are only historical accumulative values. We also print these statistics regularly in the FE logs, where the values in parentheses represent the number of changes in each statistical value since the last printing dependence of the statistical information.</div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=relevant-configuration-instructions>Relevant configuration instructions<a href=#relevant-configuration-instructions class=hash-link aria-label="Direct link to Relevant configuration instructions" title="Direct link to Relevant configuration instructions">â</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=adjustable-parameters>Adjustable parameters<a href=#adjustable-parameters class=hash-link aria-label="Direct link to Adjustable parameters" title="Direct link to Adjustable parameters">â</a></h3>
<p>The following adjustable parameters are all configurable parameters in fe.conf.</p>
<ul>
<li>
<p>use_new_tablet_scheduler</p>
<ul>
<li>Description: Whether to enable the new replica scheduling mode. The new replica scheduling method is the replica scheduling method introduced in this document. If turned on, <code>disable_colocate_join</code> must be <code>true</code>. Because the new scheduling strategy does not support data fragmentation scheduling of co-location tables for the time being.</li>
<li>Default value:true</li>
<li>Importance: High</li>
</ul>
</li>
<li>
<p>tablet_repair_delay_factor_second</p>
<ul>
<li>Note: For different scheduling priorities, we will delay different time to start repairing. In order to prevent a large number of unnecessary replica repair tasks from occurring in the process of routine restart and upgrade. This parameter is a reference coefficient. For HIGH priority, the delay is the reference coefficient * 1; for NORMAL priority, the delay is the reference coefficient * 2; for LOW priority, the delay is the reference coefficient * 3. That is, the lower the priority, the longer the delay waiting time. If the user wants to repair the copy as soon as possible, this parameter can be reduced appropriately.</li>
<li>Default value: 60 seconds</li>
<li>Importance: High</li>
</ul>
</li>
<li>
<p>schedule_slot_num_per_path</p>
<ul>
<li>Note: The default number of slots allocated to each disk for replica repair. This number represents the number of replica repair tasks that a disk can run simultaneously. If you want to repair the copy faster, you can adjust this parameter appropriately. The higher the single value, the greater the impact on IO.</li>
<li>Default value: 2</li>
<li>Importance: High</li>
</ul>
</li>
<li>
<p>balance_load_score_threshold</p>
<ul>
<li>Description: Threshold of Cluster Equilibrium. The default is 0.1, or 10%. When the load core of a BE node is not higher than or less than 10% of the average load core, we think that the node is balanced. If you want to make the cluster load more even, you can adjust this parameter appropriately.</li>
<li>Default value: 0.1</li>
<li>Importance:</li>
</ul>
</li>
<li>
<p>storage_high_watermark_usage_percent å storage_min_left_capacity_bytes</p>
<ul>
<li>Description: These two parameters represent the upper limit of the maximum space utilization of a disk and the lower limit of the minimum space remaining, respectively. When the space utilization of a disk is greater than the upper limit or the remaining space is less than the lower limit, the disk will no longer be used as the destination address for balanced scheduling.</li>
<li>Default values: 0.85 and 2097152000 (2GB)</li>
<li>Importance:</li>
</ul>
</li>
<li>
<p>disable_balance</p>
<ul>
<li>Description: Control whether to turn off the balancing function. When replicas are in equilibrium, some functions, such as ALTER TABLE, will be banned. Equilibrium can last for a long time. Therefore, if the user wants to do the prohibited operation as soon as possible. This parameter can be set to true to turn off balanced scheduling.</li>
<li>Default value: false</li>
<li>Importance:</li>
</ul>
</li>
</ul>
<p>The following adjustable parameters are all configurable parameters in be.conf.</p>
<ul>
<li>
<p>clone_worker_count</p>
<ul>
<li>Description: Affects the speed of copy equalization. In the case of low disk pressure, you can speed up replica balancing by adjusting this parameter.</li>
<li>Default: 3</li>
<li>Importance: Medium</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=unadjustable-parameters>Unadjustable parameters<a href=#unadjustable-parameters class=hash-link aria-label="Direct link to Unadjustable parameters" title="Direct link to Unadjustable parameters">â</a></h3>
<p>The following parameters do not support modification for the time being, just for illustration.</p>
<ul>
<li>
<p>Tablet Checker scheduling interval</p>
<p>Tablet Checker schedules checks every 20 seconds.</p>
</li>
<li>
<p>Tablet Scheduler scheduling interval</p>
<p>Tablet Scheduler schedules every five seconds</p>
</li>
<li>
<p>Number of Tablet Scheduler Schedules per Batch</p>
<p>Tablet Scheduler schedules up to 50 tablets at a time.</p>
</li>
<li>
<p>Tablet Scheduler Maximum Waiting Schedule and Number of Tasks in Operation</p>
<p>The maximum number of waiting tasks and running tasks is 2000. When over 2000, Tablet Checker will no longer generate new scheduling tasks to Tablet Scheduler.</p>
</li>
<li>
<p>Tablet Scheduler Maximum Balanced Task Number</p>
<p>The maximum number of balanced tasks is 500. When more than 500, there will be no new balancing tasks.</p>
</li>
<li>
<p>Number of slots per disk for balancing tasks</p>
<p>The number of slots per disk for balancing tasks is 2. This slot is independent of the slot used for replica repair.</p>
</li>
<li>
<p>Update interval of cluster equilibrium</p>
<p>Tablet Scheduler recalculates the load score of the cluster every 20 seconds.</p>
</li>
<li>
<p>Minimum and Maximum Timeout for Clone Tasks</p>
<p>A clone task timeout time range is 3 minutes to 2 hours. The specific timeout is calculated by the size of the tablet. The formula is (tablet size)/ (5MB/s). When a clone task fails three times, the task terminates.</p>
</li>
<li>
<p>Dynamic Priority Adjustment Strategy</p>
<p>The minimum priority adjustment interval is 5 minutes. When a tablet schedule fails five times, priority is lowered. When a tablet is not scheduled for 30 minutes, priority is raised.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=relevant-issues>Relevant issues<a href=#relevant-issues class=hash-link aria-label="Direct link to Relevant issues" title="Direct link to Relevant issues">â</a></h2>
<ul>
<li>
<p>In some cases, the default replica repair and balancing strategy may cause the network to be full (mostly in the case of gigabit network cards and a large number of disks per BE). At this point, some parameters need to be adjusted to reduce the number of simultaneous balancing and repair tasks.</p>
</li>
<li>
<p>Current balancing strategies for copies of Colocate Table do not guarantee that copies of the same Tablet will not be distributed on the BE of the same host. However, the repair strategy of the copy of Colocate Table detects this distribution error and corrects it. However, it may occur that after correction, the balancing strategy regards the replicas as unbalanced and rebalances them. As a result, the Colocate Group cannot achieve stability because of the continuous alternation between the two states. In view of this situation, we suggest that when using Colocate attribute, we try to ensure that the cluster is isomorphic, so as to reduce the probability that replicas are distributed on the same host.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=best-practices>Best Practices<a href=#best-practices class=hash-link aria-label="Direct link to Best Practices" title="Direct link to Best Practices">â</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=control-and-manage-the-progress-of-replica-repair-and-balancing-of-clusters>Control and manage the progress of replica repair and balancing of clusters<a href=#control-and-manage-the-progress-of-replica-repair-and-balancing-of-clusters class=hash-link aria-label="Direct link to Control and manage the progress of replica repair and balancing of clusters" title="Direct link to Control and manage the progress of replica repair and balancing of clusters">â</a></h3>
<p>In most cases, Doris can automatically perform replica repair and cluster balancing by default parameter configuration. However, in some cases, we need to manually intervene to adjust the parameters to achieve some special purposes. Such as prioritizing the repair of a table or partition, disabling cluster balancing to reduce cluster load, prioritizing the repair of non-colocation table data, and so on.</p>
<p>This section describes how to control and manage the progress of replica repair and balancing of the cluster by modifying the parameters.</p>
<ol>
<li>
<p>Deleting Corrupt Replicas</p>
<p>In some cases, Doris may not be able to automatically detect some corrupt replicas, resulting in frequent query or import errors on the corrupt replicas. In this case, we need to delete the corrupted copies manually. This method can be used to: delete a copy with a high version number resulting in a -235 error, delete a corrupted copy of a file, etc.</p>
<p>First, find the tablet id of the corresponding copy, let's say 10001, and use <code>show tablet 10001;</code> and execute the <code>show proc</code> statement to see the details of each copy of the corresponding tablet.</p>
<p>Assuming that the backend id of the copy to be deleted is 20001, the following statement is executed to mark the copy as <code>bad</code>.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">ADMIN SET REPLICA STATUS PROPERTIES("tablet_id" = "10001", "backend_id" = "20001", "status" = "bad");</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>At this point, the <code>show proc</code> statement again shows that the <code>IsBad</code> column of the corresponding copy has a value of <code>true</code>.</p>
<p>The replica marked as <code>bad</code> will no longer participate in imports and queries. The replica repair logic will automatically replenish a new replica at the same time. 2.</p>
</li>
<li>
<p>prioritize repairing a table or partition</p>
<p><code>help admin repair table;</code> View help. This command attempts to repair the tablet of the specified table or partition as a priority.</p>
</li>
<li>
<p>Stop the balancing task</p>
<p>The balancing task will take up some network bandwidth and IO resources. If you wish to stop the generation of new balancing tasks, you can do so with the following command.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">ADMIN SET FRONTEND CONFIG ("disable_balance" = "true");</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
</li>
<li>
<p>Stop all replica scheduling tasks</p>
<p>Copy scheduling tasks include balancing and repair tasks. These tasks take up some network bandwidth and IO resources. All replica scheduling tasks (excluding those already running, including colocation tables and common tables) can be stopped with the following command.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">ADMIN SET FRONTEND CONFIG ("disable_tablet_scheduler" = "true");</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
</li>
<li>
<p>Stop the copy scheduling task for all colocation tables.</p>
<p>The colocation table copy scheduling is run separately and independently from the regular table. In some cases, users may wish to stop the balancing and repair of colocation tables first and use the cluster resources for normal table repair with the following command.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">ADMIN SET FRONTEND CONFIG ("disable_colocate_balance" = "true");</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
</li>
<li>
<p>Repair replicas using a more conservative strategy</p>
<p>Doris automatically repairs replicas when it detects missing replicas, BE downtime, etc. However, in order to reduce some errors caused by jitter (e.g., BE being down briefly), Doris delays triggering these tasks.</p>
<ul>
<li>The <code>tablet_repair_delay_factor_second</code> parameter. Default 60 seconds. Depending on the priority of the repair task, it will delay triggering the repair task for 60 seconds, 120 seconds, or 180 seconds. This time can be extended so that longer exceptions can be tolerated to avoid triggering unnecessary repair tasks by using the following command.</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">ADMIN SET FRONTEND CONFIG ("tablet_repair_delay_factor_second" = "120");</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
</li>
<li>
<p>use a more conservative strategy to trigger redistribution of colocation groups</p>
<p>Redistribution of colocation groups may be accompanied by a large number of tablet migrations. <code>colocate_group_relocate_delay_second</code> is used to control the redistribution trigger delay. The default is 1800 seconds. If a BE node is likely to be offline for a long time, you can try to increase this parameter to avoid unnecessary redistribution by.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">ADMIN SET FRONTEND CONFIG ("colocate_group_relocate_delay_second" = "3600");</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
</li>
<li>
<p>Faster Replica Balancing</p>
<p>Doris' replica balancing logic adds a normal replica first and then deletes the old one for the purpose of replica migration. When deleting the old replica, Doris waits for the completion of the import task that has already started on this replica to avoid the balancing task from affecting the import task. However, this will slow down the execution speed of the balancing logic. In this case, you can make Doris ignore this wait and delete the old replica directly by modifying the following parameters.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">ADMIN SET FRONTEND CONFIG ("enable_force_drop_redundant_replica" = "true");</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>This operation may cause some import tasks to fail during balancing (requiring a retry), but it will speed up balancing significantly.</p>
</li>
</ol>
<p>Overall, when we need to bring the cluster back to a normal state quickly, consider handling it along the following lines.</p>
<ol>
<li>find the tablet that is causing the highly optimal task to report an error and set the problematic copy to bad.</li>
<li>repair some tables with the <code>admin repair</code> statement.</li>
<li>Stop the replica balancing logic to avoid taking up cluster resources, and then turn it on again after the cluster is restored.</li>
<li>Use a more conservative strategy to trigger repair tasks to deal with the avalanche effect caused by frequent BE downtime.</li>
<li>Turn off scheduling tasks for colocation tables on-demand and focus cluster resources on repairing other high-optimality data.</li>
</ol></div></article><div class="flex items-center text-sm lg:text-base justify-end lg:col mt-10"><a href="https://github.com/apache/doris-website/issues/new?title=Issue on docs&body=Path:false" target=_blank rel="noopener noreferrer" class="lg:mr-6 footerBtn_e3I8"><svg width=20 height=20 viewBox="0 0 20 20" fill=none><path d="M9.48038 2.9C9.71132 2.5 10.2887 2.5 10.5196 2.9L18.1406 16.1C18.3716 16.5 18.0829 17 17.621 17H2.37898C1.9171 17 1.62842 16.5 1.85936 16.1L9.48038 2.9Z" stroke=currentColor stroke-width=1.2 stroke-linecap=round /><path d="M10.5699 7.9516C10.5874 7.5628 10.2769 7.23804 9.88766 7.23804C9.49847 7.23804 9.18796 7.5628 9.20543 7.9516L9.41597 12.6385C9.42731 12.8908 9.63513 13.0895 9.88766 13.0895C10.1402 13.0895 10.348 12.8908 10.3593 12.6385L10.5699 7.9516ZM9.89338 13.7638C9.65338 13.7638 9.44766 13.8323 9.28766 13.9923C9.12766 14.1409 9.04766 14.3352 9.04766 14.5752C9.04766 14.8152 9.12766 15.0095 9.28766 15.1695C9.45909 15.318 9.6648 15.398 9.89338 15.398C10.1219 15.398 10.3162 15.318 10.4762 15.158C10.6477 14.998 10.7277 14.8038 10.7277 14.5752C10.7277 14.3352 10.6477 14.1409 10.4762 13.9923C10.3162 13.8323 10.1219 13.7638 9.89338 13.7638Z" fill=currentColor /></svg> <span class=ml-2>Report issue</span></a></div><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/docs/dev/admin-manual/maint-monitor/disk-capacity/><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>Disk Capacity Management</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/docs/dev/admin-manual/maint-monitor/automatic-service-start/><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>Automated Service Startup</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_jeP5 thin-scrollbar toc-container theme-doc-toc-desktop"><div><a href=/><div class="toc-icon-content group"><svg width=21 height=20 fill=currentColor viewBox="0 0 21 20" class=group-hover:text-[#444FD9]><path fill-rule=evenodd d="M3.835 6.44a1 1 0 0 0-.445.832v8.939c0 .436.354.79.79.79H16.81a.79.79 0 0 0 .79-.79V7.272a1 1 0 0 0-.446-.832L11.05 2.37a1 1 0 0 0-1.11 0zm7.26 4.16a.6.6 0 1 0-1.2 0v3.3a.6.6 0 0 0 1.2 0z" clip-rule=evenodd /></svg><span class=group-hover:text-[#444FD9]>Doris Homepage</span></div></a><a href=https://github.com/apache/doris/discussions target=_blank rel="noopener noreferrer" class="toc-icon-content group"><svg class=group-hover:text-[#444FD9] width=21 height=20 fill=currentColor viewBox="0 0 21 20"><g clip-path=url(#a)><g clip-path=url(#b)><path d="M10.506 2.698a7.494 7.494 0 0 1 7.5 7.495c0 3.274-2.099 6.058-5.023 7.08-.394.099-.334-.181-.334-.372v-1.299c2.274.266 2.367-1.238 2.519-1.49.308-.526 1.037-.66.82-.911-.518-.267-1.046.067-1.658.97-.442.655-1.305.545-1.743.436a2.1 2.1 0 0 0-.581-1.02c2.356-.421 3.338-1.86 3.338-3.569 0-.83-.273-1.592-.81-2.207.342-1.014-.031-1.882-.082-2.01-.973-.088-1.985.696-2.064.759a7.3 7.3 0 0 0-1.892-.228c-.71 0-1.344.082-1.902.233-.19-.145-1.128-.818-2.033-.736-.048.129-.414.977-.092 1.977a3.3 3.3 0 0 0-.82 2.217c0 1.713.99 3.153 3.352 3.568a2.14 2.14 0 0 0-.638 1.525v1.885c-.014.151 0 .3-.252.3a7.496 7.496 0 0 1 2.395-14.603"/></g></g><defs><clipPath id=a><path fill=#fff d="M0 0h21v20H0z"/></clipPath><clipPath id=b><path fill=#fff d="M18.5 2h-16v16h16z"/></clipPath></defs></svg><span class=group-hover:text-[#444FD9]>Ask Questions on Discussion</span></a><a href=https://join.slack.com/t/apachedoriscommunity/shared_invite/zt-35mzao67o-BrpU70FNKPyB6UlgpXf8_w target=_blank rel="noopener noreferrer" class="toc-icon-content group"><div style=padding:2px><svg class=group-hover:text-[#444FD9] fill=currentColor viewBox="0 0 1024 1024" version=1.1 p-id=4316 width=16 height=16><path d="M85.333333 625.92a85.333333 85.333333 0 1 0 170.666667 0v-85.333333H170.666667a85.333333 85.333333 0 0 0-85.333334 85.333333z m539.306667-142.506667a85.333333 85.333333 0 0 0 85.333333-85.333333V170.666667a85.333333 85.333333 0 1 0-170.666666 0v227.413333a85.333333 85.333333 0 0 0 86.186666 85.333333z m312.32-85.333333a85.333333 85.333333 0 1 0-170.666667 0v85.333333h85.333334a85.333333 85.333333 0 0 0 87.04-85.333333zM398.506667 540.586667a85.333333 85.333333 0 0 0-85.333334 85.333333V853.333333a85.333333 85.333333 0 1 0 170.666667 0v-227.413333a85.333333 85.333333 0 0 0-85.333333-85.333333zM625.493333 768h-85.333333v85.333333a85.333333 85.333333 0 1 0 85.333333-85.333333zM853.333333 540.586667h-227.84a85.333333 85.333333 0 0 0 0 170.666666H853.333333a85.333333 85.333333 0 0 0 0-170.666666zM398.506667 312.746667H170.666667a85.333333 85.333333 0 1 0 0 170.666666h227.84a85.333333 85.333333 0 0 0 0-170.666666z m0-227.413334a85.333333 85.333333 0 0 0 0 170.666667h85.333333V170.666667a85.333333 85.333333 0 0 0-85.333333-85.333334z" p-id=4317 /></svg></div><span class=group-hover:text-[#444FD9]>Chat on Slack</span></a></div><div><span class="ml-4 title-text">On This Page</span><ul class="table-of-contents table-of-contents__left-border"><li><a href=#noun-interpretation class="table-of-contents__link toc-highlight">Noun Interpretation</a><li><a href=#duplicate-status class="table-of-contents__link toc-highlight">Duplicate status</a><li><a href=#replica-repair class="table-of-contents__link toc-highlight">Replica Repair</a><ul><li><a href=#scheduling-priority class="table-of-contents__link toc-highlight">Scheduling priority</a><li><a href=#manual-priority class="table-of-contents__link toc-highlight">Manual priority</a><li><a href=#priority-scheduling class="table-of-contents__link toc-highlight">Priority scheduling</a></ul><li><a href=#replicas-balance class="table-of-contents__link toc-highlight">Replicas Balance</a><ul><li><a href=#beload class="table-of-contents__link toc-highlight">BeLoad</a><li><a href=#be-node-load class="table-of-contents__link toc-highlight">BE Node Load</a><li><a href=#partition class="table-of-contents__link toc-highlight">Partition</a><li><a href=#equilibrium-strategy class="table-of-contents__link toc-highlight">Equilibrium strategy</a></ul><li><a href=#resource-control class="table-of-contents__link toc-highlight">Resource control</a><li><a href=#tablet-state-view class="table-of-contents__link toc-highlight">Tablet State View</a><ul><li><a href=#tablet-state class="table-of-contents__link toc-highlight">Tablet state</a><li><a href=#duplicate-scheduling-task class="table-of-contents__link toc-highlight">Duplicate Scheduling Task</a></ul><li><a href=#viewing-cluster-load-and-scheduling-resources class="table-of-contents__link toc-highlight">Viewing Cluster Load and Scheduling Resources</a><ul><li><a href=#scheduler-statistical-status-view class="table-of-contents__link toc-highlight">Scheduler Statistical Status View</a></ul><li><a href=#relevant-configuration-instructions class="table-of-contents__link toc-highlight">Relevant configuration instructions</a><ul><li><a href=#adjustable-parameters class="table-of-contents__link toc-highlight">Adjustable parameters</a><li><a href=#unadjustable-parameters class="table-of-contents__link toc-highlight">Unadjustable parameters</a></ul><li><a href=#relevant-issues class="table-of-contents__link toc-highlight">Relevant issues</a><li><a href=#best-practices class="table-of-contents__link toc-highlight">Best Practices</a><ul><li><a href=#control-and-manage-the-progress-of-replica-repair-and-balancing-of-clusters class="table-of-contents__link toc-highlight">Control and manage the progress of replica repair and balancing of clusters</a></ul></ul></div></div></div></div></div></main></div></div></div><div class="footer pt-16 pb-10"><div class=container><div class=footer-box><div class=left><img src=/images/asf_logo_apache.svg alt="" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src=/images/asf_logo_apache.svg alt="" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"><div class="row footer__links"><div class="col footer__col"><div class=footer__title>ASF</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://www.apache.org/ target=_blank rel="noopener noreferrer" class=footer__link-item>Foundation<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://www.apache.org/licenses/ target=_blank rel="noopener noreferrer" class=footer__link-item>License<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://www.apache.org/events/current-event target=_blank rel="noopener noreferrer" class=footer__link-item>Events<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://www.apache.org/foundation/sponsorship.html target=_blank rel="noopener noreferrer" class=footer__link-item>Sponsorship<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://privacy.apache.org/policies/privacy-policy-public.html target=_blank rel="noopener noreferrer" class=footer__link-item>Privacy<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://www.apache.org/security/ target=_blank rel="noopener noreferrer" class=footer__link-item>Security<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://www.apache.org/foundation/thanks.html target=_blank rel="noopener noreferrer" class=footer__link-item>Thanks<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a></ul></div><div class="col footer__col"><div class=footer__title>Resources</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/download/>Download</a><li class=footer__item><a class=footer__link-item href=/blog/>Blog</a><li class=footer__item><a class=footer__link-item href=/ecosystem/cluster-management/>Ecosystem</a><li class=footer__item><a class=footer__link-item href=/users/>Users</a><li class=footer__item><a href=https://github.com/apache/doris/discussions target=_blank rel="noopener noreferrer" class=footer__link-item>Discussions<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a></ul></div><div class="col footer__col"><div class=footer__title>Community</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/community/how-to-contribute/contribute-to-doris/>How to contribute</a><li class=footer__item><a href=https://github.com/apache/doris/ target=_blank rel="noopener noreferrer" class=footer__link-item>Source code<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a class=footer__link-item href=/community/team/>Doris team</a><li class=footer__item><a href=https://github.com/apache/doris/issues/30669 target=_blank rel="noopener noreferrer" class=footer__link-item>Roadmap<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://cwiki.apache.org/confluence/display/DORIS/Doris+Improvement+Proposals target=_blank rel="noopener noreferrer" class=footer__link-item>Improvement proposal<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a></ul></div></div></div><div class=right><div class=footer__title>Join the community</div><div class=social-list><div class=social><a href=mailto:dev@doris.apache.org target=_blank title=mail class=item><svg width=2em height=2em viewBox="0 0 32 32" fill=none><path d="M5.6003 6H26.3997C27.8186 6 28.982 7.10964 29 8.46946L16.0045 15.454L3.01202 8.47829C3.02405 7.11258 4.1784 6 5.6003 6ZM3.01202 11.1508L3 23.5011C3 24.8756 4.16938 26 5.6003 26H26.3997C27.8306 26 29 24.8756 29 23.5011V11.145L16.3111 17.8028C16.1157 17.9058 15.8813 17.9058 15.6889 17.8028L3.01202 11.1508Z" fill=currentColor /></svg></a><a href=https://github.com/apache/doris target=_blank title=github class=item><svg width=2em height=2em viewBox="0 0 32 32" fill=none><path d="M16.0001 2.66675C8.63342 2.66675 2.66675 8.63341 2.66675 16.0001C2.66524 18.7991 3.54517 21.5276 5.1817 23.7983C6.81824 26.0691 9.12828 27.7668 11.7841 28.6508C12.4508 28.7668 12.7001 28.3668 12.7001 28.0161C12.7001 27.7001 12.6828 26.6508 12.6828 25.5334C9.33342 26.1508 8.46675 24.7174 8.20008 23.9668C8.04942 23.5828 7.40008 22.4001 6.83342 22.0828C6.36675 21.8334 5.70008 21.2161 6.81608 21.2001C7.86675 21.1828 8.61608 22.1668 8.86675 22.5668C10.0668 24.5828 11.9841 24.0161 12.7494 23.6668C12.8668 22.8001 13.2161 22.2174 13.6001 21.8841C10.6334 21.5508 7.53342 20.4001 7.53342 15.3001C7.53342 13.8494 8.04942 12.6507 8.90008 11.7161C8.76675 11.3827 8.30008 10.0161 9.03342 8.18275C9.03342 8.18275 10.1494 7.83342 12.7001 9.55075C13.7855 9.2495 14.907 9.09787 16.0334 9.10008C17.1668 9.10008 18.3001 9.24942 19.3668 9.54942C21.9161 7.81608 23.0334 8.18408 23.0334 8.18408C23.7668 10.0174 23.3001 11.3841 23.1668 11.7174C24.0161 12.6507 24.5334 13.8334 24.5334 15.3001C24.5334 20.4174 21.4174 21.5508 18.4508 21.8841C18.9334 22.3001 19.3508 23.1001 19.3508 24.3508C19.3508 26.1334 19.3334 27.5668 19.3334 28.0174C19.3334 28.3668 19.5841 28.7828 20.2508 28.6494C22.8975 27.7558 25.1973 26.0547 26.8266 23.7856C28.4559 21.5165 29.3327 18.7936 29.3334 16.0001C29.3334 8.63341 23.3668 2.66675 16.0001 2.66675V2.66675Z" fill=currentColor /></svg></a><a href=https://twitter.com/doris_apache target=_blank title=twitter class=item><svg width=2em height=2em viewBox="0 0 32 32" fill=none><path d="M4.625 4.625H11.2809L27.375 27.375H20.7191L4.625 4.625ZM7.52549 6.10639L21.5236 25.8936H24.4746L10.4764 6.10639H7.52549Z" fill=currentColor /><path d="M14.4268 18.4803L6.53447 27.375H4.625L13.5581 17.2525L14.4268 18.4803ZM18.1299 14.3066L26.7203 4.625H24.7017L17.2525 13.0662L18.1299 14.3066Z" fill=currentColor /></svg></a><a href=https://join.slack.com/t/apachedoriscommunity/shared_invite/zt-35mzao67o-BrpU70FNKPyB6UlgpXf8_w title=slack target=_blank class=item><svg width=2em height=2em viewBox="0 0 32 32" fill=none><g clip-path=url(#clip0_125_278)><path d="M12.5875 16.6906C11.0844 16.6906 9.86562 17.9094 9.86562 19.4125V26.2375C9.86562 26.9594 10.1524 27.6517 10.6628 28.1622C11.1733 28.6726 11.8656 28.9594 12.5875 28.9594C13.3094 28.9594 14.0017 28.6726 14.5122 28.1622C15.0226 27.6517 15.3094 26.9594 15.3094 26.2375V19.4531C15.3094 17.9094 14.0906 16.6906 12.5875 16.6906ZM3 19.4531C3 20.175 3.28677 20.8673 3.79722 21.3778C4.30767 21.8882 4.99999 22.175 5.72187 22.175C6.44376 22.175 7.13608 21.8882 7.64653 21.3778C8.15698 20.8673 8.44375 20.175 8.44375 19.4531V16.7312H5.7625C4.25938 16.6906 3 17.9094 3 19.4531ZM12.5875 3C11.8656 3 11.1733 3.28677 10.6628 3.79722C10.1524 4.30767 9.86562 4.99999 9.86562 5.72187C9.86562 6.44376 10.1524 7.13608 10.6628 7.64653C11.1733 8.15698 11.8656 8.44375 12.5875 8.44375H15.3094V5.72187C15.3094 4.21875 14.0906 3 12.5875 3ZM5.72187 15.3094H12.5469C13.2688 15.3094 13.9611 15.0226 14.4715 14.5122C14.982 14.0017 15.2688 13.3094 15.2688 12.5875C15.2688 11.8656 14.982 11.1733 14.4715 10.6628C13.9611 10.1524 13.2688 9.86562 12.5469 9.86562H5.72187C4.99999 9.86562 4.30767 10.1524 3.79722 10.6628C3.28677 11.1733 3 11.8656 3 12.5875C3 13.3094 3.28677 14.0017 3.79722 14.5122C4.30767 15.0226 4.99999 15.3094 5.72187 15.3094ZM26.2375 9.86562C24.7344 9.86562 23.5156 11.0844 23.5156 12.5875V15.3094H26.2375C26.9594 15.3094 27.6517 15.0226 28.1622 14.5122C28.6726 14.0017 28.9594 13.3094 28.9594 12.5875C28.9594 11.8656 28.6726 11.1733 28.1622 10.6628C27.6517 10.1524 26.9594 9.86562 26.2375 9.86562ZM16.6906 5.72187V12.5875C16.6906 13.3094 16.9774 14.0017 17.4878 14.5122C17.9983 15.0226 18.6906 15.3094 19.4125 15.3094C20.1344 15.3094 20.8267 15.0226 21.3372 14.5122C21.8476 14.0017 22.1344 13.3094 22.1344 12.5875V5.72187C22.1344 4.99999 21.8476 4.30767 21.3372 3.79722C20.8267 3.28677 20.1344 3 19.4125 3C18.6906 3 17.9983 3.28677 17.4878 3.79722C16.9774 4.30767 16.6906 4.99999 16.6906 5.72187ZM22.1344 26.2781C22.1344 24.775 20.9156 23.5562 19.4125 23.5562H16.6906V26.2781C16.6906 27 16.9774 27.6923 17.4878 28.2028C17.9983 28.7132 18.6906 29 19.4125 29C20.1344 29 20.8267 28.7132 21.3372 28.2028C21.8476 27.6923 22.1344 27 22.1344 26.2781ZM26.2781 16.6906H19.4125C18.6906 16.6906 17.9983 16.9774 17.4878 17.4878C16.9774 17.9983 16.6906 18.6906 16.6906 19.4125C16.6906 20.1344 16.9774 20.8267 17.4878 21.3372C17.9983 21.8476 18.6906 22.1344 19.4125 22.1344H26.2375C27.7406 22.1344 28.9594 20.9156 28.9594 19.4125C29 17.9094 27.7812 16.6906 26.2781 16.6906Z" fill=currentColor /></g><defs><clipPath id=clip0_125_278><rect width=26 height=26 fill=currentColor transform="translate(3 3)"/></clipPath></defs></svg></a></div><div class=social><a href=https://www.youtube.com/hashtag/apachedoris title=youtube target=_blank class=item><svg width=2em height=2em viewBox="0 0 32 32" fill=none><path d="M28.5167 7.83429C28.9436 8.25423 29.2532 8.77539 29.4154 9.34742C29.8205 11.5462 30.0159 13.7775 29.999 16.0121C30.0144 18.2382 29.819 20.4609 29.4154 22.6515C29.2532 23.2235 28.9436 23.7446 28.5167 24.1645C28.0898 24.5845 27.5601 24.889 26.9785 25.0486C24.7728 25.625 16.0124 25.625 16.0124 25.625C16.0124 25.625 7.22652 25.625 5.04638 25.0486C4.46489 24.889 3.9351 24.5845 3.5082 24.1645C3.08132 23.7446 2.77176 23.2235 2.60948 22.6515C2.19736 20.4617 1.9934 18.239 2.00025 16.0121C1.9918 13.7767 2.19577 11.5455 2.60948 9.34742C2.77176 8.77539 3.08132 8.25423 3.5082 7.83429C3.9351 7.41436 4.46489 7.10985 5.04638 6.95021C7.25103 6.36354 16.0124 6.37502 16.0124 6.37502C16.0124 6.37502 24.796 6.37502 26.9785 6.95021C27.5601 7.10985 28.0898 7.41436 28.5167 7.83429ZM12.5 21.25L21.25 16.008L12.5 10.75V21.25Z" fill=currentColor /></svg></a><a href=https://www.linkedin.com/company/doris-apache/ title=linkedin target=_blank class=item><svg width=2rem height=2rem viewBox="0 0 32 32" fill=none><path d="M4.29925 26.9996H9.66738V11.6781H4.29925V26.9996ZM22.1628 11.1949C19.9409 11.1949 18.7157 11.9388 17.3054 13.7407V11.6777H11.9459V26.9996H17.305V18.6738C17.305 16.9168 18.145 15.1982 20.1535 15.1982C22.162 15.1982 22.6559 16.9164 22.6559 18.632V27H28V18.2902C28 12.2386 24.3854 11.1949 22.1628 11.1949ZM6.99325 4C5.3395 4 4 5.21047 4 6.7046C4 8.19759 5.3395 9.40617 6.99325 9.40617C8.6455 9.40617 9.985 8.19722 9.985 6.7046C9.985 5.21047 8.6455 4 6.99325 4Z" fill=white /></svg></a><a href=https://medium.com/@ApacheDoris title=medium target=_blank class=item><svg width=2em height=2em viewBox="0 0 32 32" fill=none><g id=Frame><path id=Vector d="M17.7967 16.5385C17.8029 18.53 16.9746 20.4425 15.4937 21.8559C14.0128 23.2693 12.0004 24.0681 9.89836 24.0769C7.79633 24.0681 5.78391 23.2693 4.30302 21.8559C2.82212 20.4425 1.99383 18.53 2.00003 16.5385C1.99383 14.5469 2.82212 12.6344 4.30302 11.221C5.78391 9.80759 7.79633 9.00878 9.89836 9C12.0004 9.00878 14.0128 9.80759 15.4937 11.221C16.9746 12.6344 17.8029 14.5469 17.7967 16.5385ZM26.4533 16.5385C26.4533 20.4514 24.6917 23.6348 22.51 23.6348C20.3283 23.6348 18.555 20.4514 18.555 16.5385C18.555 12.6255 20.3283 9.44214 22.51 9.44214C24.6917 9.44214 26.4533 12.6255 26.4533 16.5385ZM30 16.5385C30 20.0424 29.3817 22.8942 28.6117 22.8942C27.8417 22.8942 27.2233 20.0424 27.2233 16.5385C27.2233 13.0345 27.8417 10.1827 28.6117 10.1827C29.3817 10.1827 30 13.0345 30 16.5385Z" fill=currentColor /></g></svg></a></div></div></div></div><div class=footer__copyright>Copyright Â© 2025 The Apache Software Foundation,Licensed under the <a href=https://www.apache.org/licenses/LICENSE-2.0 target=_blank>Apache License, Version 2.0</a>. Apache, Doris, Apache Doris, the Apache feather logo and the Apache Doris logo are trademarks of The Apache Software Foundation.</div></div></div></div>