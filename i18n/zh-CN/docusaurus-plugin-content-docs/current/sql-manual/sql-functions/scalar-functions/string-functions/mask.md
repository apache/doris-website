---
{
    "title": "MASK",
    "language": "zh-CN",
    "description": "MASK 函数用于对数据进行屏蔽以保护敏感信息。默认行为是将大写字母转换为 X，小写字母转换为 x，数字转换为 n。"
}
---

## 描述

MASK 函数用于对数据进行屏蔽以保护敏感信息。默认行为是将大写字母转换为 `X`，小写字母转换为 `x`，数字转换为 `n`。

## 语法

```sql
MASK(<str>[, <upper>[, <lower>[, <number>]]])
```

## 参数

| 参数 | 说明 |
| ---------- | ----------------------------------------- |
| `<str>` | 需要被脱敏的字符串。类型：VARCHAR |
| `<upper>` | 替换大写字母的字符，默认为 `X`（可选）。类型：VARCHAR |
| `<lower>` | 替换小写字母的字符，默认为 `x`（可选）。类型：VARCHAR |
| `<number>` | 替换数字的字符，默认为 `n`（可选）。类型：VARCHAR |

## 返回值

返回 VARCHAR 类型，为字母和数字被替换后的字符串。

特殊情况：

- 任意参数中有一个为 NULL，则返回 NULL
- 非字母和数字会原样返回
- 替换字符参数如果包含多个字符，只取第一个字符
- 仅支持ASCII字母的替换，非ASCII字母（如带重音的拉丁字母）会原样保留

## 示例

1. 基本用法：默认替换规则
```sql
SELECT mask('abc123XYZ');
```
```text
+-------------------+
| mask('abc123XYZ') |
+-------------------+
| xxxnnnXXX         |
+-------------------+
```

2. 自定义替换字符
```sql
SELECT mask('abc123XYZ', '*', '#', '$');
```
```text
+----------------------------------+
| mask('abc123XYZ', '*', '#', '$') |
+----------------------------------+
| ###$$$***                        |
+----------------------------------+
```

3. 特殊字符保持不变
```sql
SELECT mask('Hello-123!');
```
```text
+--------------------+
| mask('Hello-123!') |
+--------------------+
| Xxxxx-nnn!         |
+--------------------+
```

4. NULL 值处理
```sql
SELECT mask(NULL);
```
```text
+------------+
| mask(NULL) |
+------------+
| NULL       |
+------------+
```

5. 仅包含数字的字符串

```sql
SELECT mask('1234567890');
```

```text
+--------------------+
| mask('1234567890') |
+--------------------+
| nnnnnnnnnn         |
+--------------------+
```

6. 仅包含字母的字符串

```sql
SELECT mask('AbCdEfGh');
```

```text
+------------------+
| mask('AbCdEfGh') |
+------------------+
| XxXxXxXx         |
+------------------+
```

7. 空字符串处理

```sql
SELECT mask('');
```

```text
+----------+
| mask('') |
+----------+
|          |
+----------+
```

8. 使用单字符替换符（多字符时取第一个）

```sql
SELECT mask('Test123', 'ABC', 'xyz', '999');
```

```text
+--------------------------------------+
| mask('Test123', 'ABC', 'xyz', '999') |
+--------------------------------------+
| Xxxx999                              |
+--------------------------------------+
```

9. 脱敏信用卡号

```sql
SELECT mask('1234-5678-9012-3456');
```

```text
+-----------------------------+
| mask('1234-5678-9012-3456') |
+-----------------------------+
| nnnn-nnnn-nnnn-nnnn         |
+-----------------------------+
```

10. 脱敏邮箱地址

```sql
SELECT mask('user@example.com');
```

```text
+--------------------------+
| mask('user@example.com') |
+--------------------------+
| xxxx@xxxxxxx.xxx         |
+--------------------------+
```

```sql
select mask('eeeéèêëìí1234');
```

```text
+-----------------------------+
| mask('eeeéèêëìí1234')       |
+-----------------------------+
| xxxéèêëìínnnn               |
+-----------------------------+
```
