---
{
    "title": "REGEXP_POSITION",
    "language": "zh-CN"
}
---

## æè¿°

REGEXP_POSITIONå‡½æ•°å¯ä»¥è¿”å›å­—ç¬¦ä¸²ä¸­æ¨¡å¼ï¼ˆpatternï¼‰é¦–æ¬¡å‡ºç°çš„ç´¢å¼•ï¼Œä»èµ·å§‹ä½ç½®ï¼ˆstartï¼‰å¼€å§‹æœç´¢ï¼ˆåŒ…å«èµ·å§‹ä½ç½®ï¼‰ã€‚è‹¥æœªæ‰¾åˆ°ï¼Œåˆ™è¿”å› -1ã€‚

## è¯­æ³•

```sql
REGEXP_POSITION ( <str>, <pattern> [, <position>] )
```

## å‚æ•°

| å‚æ•°      | æè¿°                           |
|---------|------------------------------|
| `<str>` | è¯¥å‚æ•°ä¸º Varchar ç±»å‹ã€‚å®ƒè¡¨ç¤ºå°†æ‰§è¡Œæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„å­—ç¬¦ä¸²ï¼Œæ—¢å¯ä»¥æ˜¯å­—é¢é‡å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥æ˜¯è¡¨ä¸­åŒ…å«å­—ç¬¦ä¸²å€¼çš„åˆ—                     |
| `<pattern>` | è¯¥å‚æ•°ä¸º Varchar ç±»å‹ã€‚å®ƒæ˜¯ç”¨äºåŒ¹é…å­—ç¬¦ä¸²çš„æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ï¼Œè¯¥æ¨¡å¼å¯åŒ…å«å„ç§æ­£åˆ™è¡¨è¾¾å¼å…ƒå­—ç¬¦å’Œæ„é€ ï¼Œç”¨äºå®šä¹‰å¤æ‚çš„åŒ¹é…è§„åˆ™   |
| `<position>` | å¯é€‰å‚æ•°ã€‚æ­¤å‚æ•°ç”¨äºæŒ‡å®šåœ¨å­—ç¬¦ä¸²ä¸­å¼€å§‹æœç´¢æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„ä½ç½®ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œä»£è¡¨å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦ä½ç½®ï¼ˆä» 1 å¼€å§‹è®¡æ•°ï¼‰ï¼Œé»˜è®¤å€¼ä¸º 1 |

## è¿”å›å€¼

è¿”å›å­—ç¬¦ä¸²ä¸­æ¨¡å¼ï¼ˆpatternï¼‰é¦–æ¬¡å‡ºç°çš„ç´¢å¼•ï¼Œä»èµ·å§‹ä½ç½®ï¼ˆstartï¼‰å¼€å§‹æœç´¢ï¼ˆåŒ…å«èµ·å§‹ä½ç½®ï¼‰ã€‚ç‰¹æ®Šæƒ…å†µå¦‚ä¸‹ï¼š

- è‹¥ä»»ä¸€å‚æ•°ä¸º NULLï¼Œåˆ™è¿”å› NULL
- è‹¥èµ·å§‹ä½ç½®ï¼ˆpositionï¼‰å°äº 1ï¼Œåˆ™è¿”å› -1

## ç¤ºä¾‹

æ™®é€šä¾‹å­
```sql
SELECT regexp_position('I have 23 apples, 5 pears and 13 oranges', ' ', 0);
```
```text
+---------------------------------------------------------------------+
| regexp_position('I have 23 apples, 5 pears and 13 oranges', ' ', 0) |
+---------------------------------------------------------------------+
|                                                                  -1 |
+---------------------------------------------------------------------+
```

```sql
SELECT regexp_position('I have 23 apples, 5 pears and 13 oranges', ' ', 1);
```
```text
+---------------------------------------------------------------------+
| regexp_position('I have 23 apples, 5 pears and 13 oranges', ' ', 1) |
+---------------------------------------------------------------------+
|                                                                  2 |
+---------------------------------------------------------------------+
```

```sql
SELECT regexp_position('I have 23 apples, 5 pears and 13 oranges', ' ', 4);
```
```text
+---------------------------------------------------------------------+
| regexp_position('I have 23 apples, 5 pears and 13 oranges', ' ', 4) |
+---------------------------------------------------------------------+
|                                                                  7 |
+---------------------------------------------------------------------+
```

æ­£åˆ™è¡¨è¾¾å¼ä¾‹å­
```sql
SELECT regexp_position('I have 23 apples, 5 pears and 13 oranges', '\\d', 0);
```
```text
+-----------------------------------------------------------------------+
| regexp_position('I have 23 apples, 5 pears and 13 oranges', '\\d', 0) |
+-----------------------------------------------------------------------+
|                                                                    -1 |
+-----------------------------------------------------------------------+
```

```sql
SELECT regexp_position('I have 23 apples, 5 pears and 13 oranges', '\\d', 9);
```
```text
+-----------------------------------------------------------------------+
| regexp_position('I have 23 apples, 5 pears and 13 oranges', '\\d', 9) |
+-----------------------------------------------------------------------+
|                                                                     9 |
+-----------------------------------------------------------------------+
```

ä¸­æ–‡ä¾‹å­
```sql
SELECT regexp_position('æˆ‘çˆ±åŒ—äº¬å¤©å®‰é—¨', 'çˆ±', 1);
```
```text
+----------------------------------------------------+
| regexp_position('æˆ‘çˆ±åŒ—äº¬å¤©å®‰é—¨', 'çˆ±', 1)         |
+----------------------------------------------------+
|                                                 4 |
+----------------------------------------------------+
```

æ¶‰åŠåˆ°Nullçš„ä¾‹å­
```sql
SELECT regexp_position(null, ' ', 0);
```
```text
+-------------------------------+
| regexp_position(null, ' ', 0) |
+-------------------------------+
|                          NULL |
+-------------------------------+
```

```sql
SELECT regexp_position('abc', null, 0);
```
```text
+---------------------------------+
| regexp_position('abc', null, 0) |
+---------------------------------+
|                            NULL |
+---------------------------------+
```

```sql
SELECT regexp_position(null, null, 0);
```
```text
+--------------------------------+
| regexp_position(null, null, 0) |
+--------------------------------+
|                           NULL |
+--------------------------------+
```

```sql
SELECT regexp_position('abc', 'b', null);
```
```text
+-----------------------------------+
| regexp_position('abc', 'b', null) |
+-----------------------------------+
|                              NULL |
+-----------------------------------+
```

emojiè¡¨æƒ…åŒ…ä¾‹å­
```sql
SELECT regexp_position('ğŸ˜€ğŸ˜ŠğŸ˜', 'ğŸ˜€|ğŸ˜Š|ğŸ˜', 0);
```
```text
+------------------------------------------------------+
| regexp_position('ğŸ˜€ğŸ˜ŠğŸ˜', 'ğŸ˜€|ğŸ˜Š|ğŸ˜', 0)                         |
+------------------------------------------------------+
|                                                   -1 |
+------------------------------------------------------+
```
```sql
SELECT regexp_position('ğŸ˜€ğŸ˜ŠğŸ˜', 'ğŸ˜€|ğŸ˜Š|ğŸ˜', 1);
```
```text
+------------------------------------------------------+
| regexp_position('ğŸ˜€ğŸ˜ŠğŸ˜', 'ğŸ˜€|ğŸ˜Š|ğŸ˜', 1)                         |
+------------------------------------------------------+
|                                                   1 |
+------------------------------------------------------+
```
```sql
SELECT regexp_position('ğŸ˜€ğŸ˜ŠğŸ˜', 'ğŸ˜€|ğŸ˜Š|ğŸ˜', 2);
```
```text
+------------------------------------------------------+
| regexp_position('ğŸ˜€ğŸ˜ŠğŸ˜', 'ğŸ˜€|ğŸ˜Š|ğŸ˜', 2)                         |
+------------------------------------------------------+
|                                                   5 |
+------------------------------------------------------+
```

è¡¨ä¸­æ•°æ®çš„ä¾‹å­
```sql
CREATE TABLE test_regexp_position (
            str varchar(100),                      
            pattern varchar(100),             
            position int,
            num int  -- this colum used to order
        )
        DISTRIBUTED BY HASH(str)
        PROPERTIES (
            "replication_num" = "1"
        );
        
 INSERT INTO test_regexp_position VALUES 
 ('I have 23 apples, 5 pears and 13 oranges', '\\d', 15, 1),
 ('I have 23 apples, 5 pears and 13 oranges', ' ', 3, 2),
 ('I have 23 apples, 5 pears and 13 oranges', '\\b\\d+\\b', 10, 3),
 ('I have 23 apples, 5 pears and 13 oranges', '5', 0, 4),
 ('I have 23 apples, 5 pears and 13 oranges', '5', 25, 5),
 ('æˆ‘çˆ±åŒ—äº¬å¤©å®‰é—¨', 'çˆ±', 3, 6),
 ('123AbCdExCx', '([[:lower:]]+)C([[:lower:]]+)', 5, 7),
 (null, null, null, 8),
 ('ğŸ˜€ğŸ˜ŠğŸ˜', 'ğŸ˜€|ğŸ˜Š|ğŸ˜', 2, 9);
 
 select regexp_position(str, pattern, position) from test_regexp_position order by num;
```
```text
+------------------------------------------+-------------------------------+----------+-----------------------------------------+
| str                                      | pattern                       | position | regexp_position(str, pattern, position) |
+------------------------------------------+-------------------------------+----------+-----------------------------------------+
| I have 23 apples, 5 pears and 13 oranges | \d                            |       15 |                                      19 |
| I have 23 apples, 5 pears and 13 oranges |                               |        3 |                                       7 |
| I have 23 apples, 5 pears and 13 oranges | \b\d+\b                       |       10 |                                      19 |
| I have 23 apples, 5 pears and 13 oranges | 5                             |        0 |                                      -1 |
| I have 23 apples, 5 pears and 13 oranges | 5                             |       25 |                                      -1 |
| æˆ‘çˆ±åŒ—äº¬å¤©å®‰é—¨                           | çˆ±                            |        3 |                                       4 |
| 123AbCdExCx                              | ([[:lower:]]+)C([[:lower:]]+) |        5 |                                       5 |
| NULL                                     | NULL                          |     NULL |                                    NULL |
| ğŸ˜€ğŸ˜ŠğŸ˜                                         | ğŸ˜€|ğŸ˜Š|ğŸ˜                            |        2 |                                       5 |
+------------------------------------------+-------------------------------+----------+-----------------------------------------+
```

