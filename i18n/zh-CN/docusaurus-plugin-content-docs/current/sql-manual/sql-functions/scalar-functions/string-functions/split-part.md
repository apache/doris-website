---
{
    "title": "SPLIT_PART",
    "language": "zh-CN"
}
---

## 描述

SPLIT_PART 函数将字符串按照指定的分隔符拆分成多个部分，然后返回指定索引位置的部分。该函数常用于从分隔符分隔的数据中提取特定字段。

## 语法

```sql
SPLIT_PART(<str>, <separator>, <part_index>)
```

## 参数

| 参数             | 说明       |
|----------------|----------|
| `<str>`        | 需要分割的源字符串。类型：VARCHAR |
| `<separator>`  | 用于分割的分隔符字符串。类型：VARCHAR |
| `<part_index>` | 要返回的部分的索引位置（从 1 开始计数）。类型：INT |

## 返回值

返回 VARCHAR 类型，表示按分隔符拆分后指定位置的字符串部分。

索引规则：
- part_index 从 1 开始计数
- 如果 part_index 超出分割后数组的范围，返回空字符串
- 负数索引表示从末尾开始计数（-1 表示最后一个，-2 表示倒数第二个，依此类推）

特殊情况：
- 如果任意参数为 NULL，返回 NULL
- 如果 part_index 为 0，返回 NULL
- 如果 str 为空字符串，返回 NULL
- 如果 separator 为空字符串，返回空字符串
- 如果 separator 在 str 中不存在，返回 NULL

## 示例

1. 基本字符串分割
```sql
SELECT SPLIT_PART('hello world', ' ', 1);
```
```text
+----------------------------------+
| SPLIT_PART('hello world', ' ', 1) |
+----------------------------------+
| hello                            |
+----------------------------------+
```

2. 获取第二个部分
```sql
SELECT SPLIT_PART('apple,banana,cherry', ',', 2);
```
```text
+-------------------------------------------+
| SPLIT_PART('apple,banana,cherry', ',', 2) |
+-------------------------------------------+
| banana                                    |
+-------------------------------------------+
```

3. 索引为 0（返回 NULL）
```sql
SELECT SPLIT_PART('apple,banana,cherry', ',', 0);
```
```text
+-------------------------------------------+
| SPLIT_PART('apple,banana,cherry', ',', 0) |
+-------------------------------------------+
| NULL                                      |
+-------------------------------------------+
```

4. 负数索引（从末尾计数）
```sql
SELECT SPLIT_PART('apple,banana,cherry', ',', -1), SPLIT_PART('apple,banana,cherry', ',', -2);
```
```text
+--------------------------------------------+--------------------------------------------+
| SPLIT_PART('apple,banana,cherry', ',', -1) | SPLIT_PART('apple,banana,cherry', ',', -2) |
+--------------------------------------------+--------------------------------------------+
| cherry                                     | banana                                     |
+--------------------------------------------+--------------------------------------------+
```

5. 索引超出范围
```sql
SELECT SPLIT_PART('apple,banana', ',', 5), SPLIT_PART('apple,banana', ',', -5);
```
```text
+-----------------------------------+------------------------------------+
| SPLIT_PART('apple,banana', ',', 5) | SPLIT_PART('apple,banana', ',', -5) |
+-----------------------------------+------------------------------------+
|                                   |                                    |
+-----------------------------------+------------------------------------+
```

6. NULL 值处理
```sql
SELECT SPLIT_PART(NULL, ',', 1), SPLIT_PART('test', NULL, 1), SPLIT_PART('test', ',', NULL);
```
```text
+---------------------------+-----------------------------+-------------------------------+
| SPLIT_PART(NULL, ',', 1)  | SPLIT_PART('test', NULL, 1) | SPLIT_PART('test', ',', NULL) |
+---------------------------+-----------------------------+-------------------------------+
| NULL                      | NULL                        | NULL                          |
+---------------------------+-----------------------------+-------------------------------+
```

7. 空字符串处理
```sql
SELECT SPLIT_PART('', ',', 1), SPLIT_PART('test', '', 2);
```
```text
+------------------------+---------------------------+
| SPLIT_PART('', ',', 1) | SPLIT_PART('test', '', 2) |
+------------------------+---------------------------+
| NULL                   |                           |
+------------------------+---------------------------+
```

8. 分隔符不存在
```sql
SELECT SPLIT_PART('hello world', '|', 1), SPLIT_PART('hello world', '|', 2);
```
```text
+-----------------------------------+-----------------------------------+
| SPLIT_PART('hello world', '|', 1) | SPLIT_PART('hello world', '|', 2) |
+-----------------------------------+-----------------------------------+
| NULL                              | NULL                              |
+-----------------------------------+-----------------------------------+
```

9. 连续分隔符
```sql
SELECT SPLIT_PART('a,,c', ',', 1), SPLIT_PART('a,,c', ',', 2), SPLIT_PART('a,,c', ',', 3);
```
```text
+----------------------------+----------------------------+----------------------------+
| SPLIT_PART('a,,c', ',', 1) | SPLIT_PART('a,,c', ',', 2) | SPLIT_PART('a,,c', ',', 3) |
+----------------------------+----------------------------+----------------------------+
| a                          |                            | c                          |
+----------------------------+----------------------------+----------------------------+
```

10. UTF-8 字符处理
```sql
SELECT SPLIT_PART('ṭṛì ḍḍumai ṭṛì', ' ', 2);
```
```text
+--------------------------------------+
| SPLIT_PART('ṭṛì ḍḍumai ṭṛì', ' ', 2) |
+--------------------------------------+
| ḍḍumai                               |
+--------------------------------------+
```
