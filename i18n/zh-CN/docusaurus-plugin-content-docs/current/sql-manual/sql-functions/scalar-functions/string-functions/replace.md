---
{
    "title": "REPLACE",
    "language": "zh-CN"
}
---

## 描述

REPLACE 函数用于将字符串中所有出现的指定子字符串替换为新的子字符串。该函数会替换字符串中所有匹配的子字符串实例，执行全局替换操作。

**与 REPLACE_EMPTY 函数的区别：**
- `REPLACE()` 替换指定的子字符串，包括空字符串
- `REPLACE_EMPTY()` 专门用于将空值或空字符串替换为指定值

## 语法

```sql
REPLACE(<str>, <old>, <new>)
```

## 参数

| 参数      | 说明                                      |
|---------|-----------------------------------------|
| `<str>` | 需要进行替换操作的源字符串。类型：VARCHAR |
| `<old>` | 要被替换的目标子字符串。如果在 str 中不存在，则不进行替换。类型：VARCHAR |
| `<new>` | 用于替换 old 的新子字符串。类型：VARCHAR |

## 返回值

返回 VARCHAR 类型，表示替换操作后的新字符串。

替换规则：
- 替换字符串中所有匹配的 old 子字符串
- 替换是大小写敏感的
- 如果 old 为空字符串，返回原字符串（不进行任何操作）
- 如果 new 为空字符串，相当于删除所有匹配的 old 子字符串

特殊情况：
- 如果任意参数为 NULL，返回 NULL
- 如果 str 为空字符串，返回空字符串
- 如果 old 为空字符串，返回原 str（不进行替换）
- 如果 old 在 str 中不存在，返回原 str

## 示例

1. 基本替换操作
```sql
SELECT REPLACE('hello world', 'world', 'universe');
```
```text
+---------------------------------------------+
| REPLACE('hello world', 'world', 'universe') |
+---------------------------------------------+
| hello universe                              |
+---------------------------------------------+
```

2. 替换多个匹配项
```sql
SELECT REPLACE('apple apple apple', 'apple', 'orange');
```
```text
+------------------------------------------------+
| REPLACE('apple apple apple', 'apple', 'orange') |
+------------------------------------------------+
| orange orange orange                           |
+------------------------------------------------+
```

3. 删除子字符串（替换为空字符串）
```sql
SELECT REPLACE('banana', 'a', '');
```
```text
+---------------------------+
| REPLACE('banana', 'a', '') |
+---------------------------+
| bnn                       |
+---------------------------+
```

4. NULL 值处理
```sql
SELECT REPLACE(NULL, 'old', 'new'), REPLACE('test', NULL, 'new'), REPLACE('test', 'old', NULL);
```
```text
+------------------------------+------------------------------+------------------------------+
| REPLACE(NULL, 'old', 'new')  | REPLACE('test', NULL, 'new') | REPLACE('test', 'old', NULL) |
+------------------------------+------------------------------+------------------------------+
| NULL                         | NULL                         | NULL                         |
+------------------------------+------------------------------+------------------------------+
```

5. 空字符串处理
```sql
SELECT REPLACE('', 'old', 'new'), REPLACE('test', '', 'new'), REPLACE('test', 'old', '');
```
```text
+---------------------------+---------------------------+---------------------------+
| REPLACE('', 'old', 'new') | REPLACE('test', '', 'new') | REPLACE('test', 'old', '') |
+---------------------------+---------------------------+---------------------------+
|                           | test                      | test                      |
+---------------------------+---------------------------+---------------------------+
```

6. 大小写敏感性
```sql
SELECT REPLACE('Hello HELLO hello', 'hello', 'hi');
```
```text
+----------------------------------------------+
| REPLACE('Hello HELLO hello', 'hello', 'hi') |
+----------------------------------------------+
| Hello HELLO hi                               |
+----------------------------------------------+
```

7. 子字符串不存在
```sql
SELECT REPLACE('hello world', 'xyz', 'abc');
```
```text
+--------------------------------------+
| REPLACE('hello world', 'xyz', 'abc') |
+--------------------------------------+
| hello world                          |
+--------------------------------------+
```

8. UTF-8 字符替换
```sql
SELECT REPLACE('ṭṛì ḍḍumai test ṭṛì ḍḍumannàri', 'ṭṛì', 'replaced');
```
```text
+-----------------------------------------------------------+
| REPLACE('ṭṛì ḍḍumai test ṭṛì ḍḍumannàri', 'ṭṛì', 'replaced') |
+-----------------------------------------------------------+
| replaced ḍḍumai test replaced ḍḍumannàri                  |
+-----------------------------------------------------------+
```

9. 数字字符串替换
```sql
SELECT REPLACE('123123123', '123', 'ABC');
```
```text
+------------------------------------+
| REPLACE('123123123', '123', 'ABC') |
+------------------------------------+
| ABCABCABC                          |
+------------------------------------+
```