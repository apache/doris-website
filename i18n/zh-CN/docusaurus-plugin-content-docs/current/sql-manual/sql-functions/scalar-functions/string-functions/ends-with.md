---
{
    "title": "ENDS_WITH",
    "language": "zh-CN"
}
---

## 描述

ENDS_WITH 函数用于检查字符串是否以指定的后缀结尾。

## 语法

```sql
ENDS_WITH(<str>, <suffix>)
```

## 参数

| 参数       | 说明           |
|----------|--------------|
| `str`    | 要检查的主字符串。类型：VARCHAR |
| `suffix` | 要匹配的后缀字符串。类型：VARCHAR |

## 返回值

返回 BOOLEAN 类型（在 Doris 中以 TINYINT 形式显示，1 表示 true，0 表示 false）。

匹配规则：
- 精确后缀匹配，大小写敏感
- 空后缀与任何字符串都匹配（返回 true）
- 支持 UTF-8 多字节字符的正确匹配
- 后缀长度不能超过主字符串长度（除非后缀为空）

特殊情况：
- 如果任一参数为 NULL，返回 NULL
- 如果后缀为空字符串，返回 true（任何字符串都以空字符串结尾）
- 如果主字符串为空但后缀不为空，返回 false
- 如果两者都为空字符串，返回 true

## 示例

1. 基本后缀匹配
```sql
SELECT ENDS_WITH('Hello doris', 'doris'), ENDS_WITH('Hello doris', 'Hello');
```
```text
+-----------------------------------+-----------------------------------+
| ENDS_WITH('Hello doris', 'doris') | ENDS_WITH('Hello doris', 'Hello') |
+-----------------------------------+-----------------------------------+
|                                 1 |                                 0 |
+-----------------------------------+-----------------------------------+
```

2. 大小写敏感性
```sql
SELECT ENDS_WITH('Hello World', 'world'), ENDS_WITH('Hello World', 'World');
```
```text
+-----------------------------------+-----------------------------------+
| ENDS_WITH('Hello World', 'world') | ENDS_WITH('Hello World', 'World') |
+-----------------------------------+-----------------------------------+
|                                 0 |                                 1 |
+-----------------------------------+-----------------------------------+
```

3. NULL 值处理
```sql
SELECT ENDS_WITH(NULL, 'test'), ENDS_WITH('test', NULL);
```
```text
+--------------------------+--------------------------+
| ENDS_WITH(NULL, 'test')  | ENDS_WITH('test', NULL)  |
+--------------------------+--------------------------+
| NULL                     | NULL                     |
+--------------------------+--------------------------+
```

4. 空字符串处理
```sql
SELECT ENDS_WITH('hello', ''), ENDS_WITH('', 'world');
```
```text
+-------------------------+--------------------------+
| ENDS_WITH('hello', '')  | ENDS_WITH('', 'world')   |
+-------------------------+--------------------------+
|                       1 |                        0 |
+-------------------------+--------------------------+
```

5. 完整字符串匹配
```sql
SELECT ENDS_WITH('test', 'test'), ENDS_WITH('testing', 'test');
```
```text
+---------------------------+------------------------------+
| ENDS_WITH('test', 'test') | ENDS_WITH('testing', 'test') |
+---------------------------+------------------------------+
|                         1 |                            1 |
+---------------------------+------------------------------+
```

6. 文件扩展名检查
```sql
SELECT ENDS_WITH('document.pdf', '.pdf'), ENDS_WITH('image.jpg', '.png');
```
```text
+------------------------------------+----------------------------------+
| ENDS_WITH('document.pdf', '.pdf')  | ENDS_WITH('image.jpg', '.png')   |
+------------------------------------+----------------------------------+
|                                  1 |                                0 |
+------------------------------------+----------------------------------+
```

7. UTF-8 多字节字符
```sql
SELECT ENDS_WITH('hello ṭṛì ḍḍumai', 'ḍḍumai'), ENDS_WITH('hello ṭṛì ḍḍumai', 'ṭṛì');
```
```text
+------------------------------------------+---------------------------------------+
| ENDS_WITH('hello ṭṛì ḍḍumai', 'ḍḍumai') | ENDS_WITH('hello ṭṛì ḍḍumai', 'ṭṛì')  |
+------------------------------------------+---------------------------------------+
|                                        1 |                                     0 |
+------------------------------------------+---------------------------------------+
```

8. URL 路径检查
```sql
SELECT ENDS_WITH('https://example.com/api', '/api'), ENDS_WITH('https://example.com/', '.html');
```
```text
+--------------------------------------------+---------------------------------------------+
| ENDS_WITH('https://example.com/api', '/api') | ENDS_WITH('https://example.com/', '.html') |
+--------------------------------------------+---------------------------------------------+
|                                          1 |                                           0 |
+--------------------------------------------+---------------------------------------------+
```

9. 数字字符串后缀
```sql
SELECT ENDS_WITH('123456789', '789'), ENDS_WITH('123456789', '456');
```
```text
+--------------------------------+--------------------------------+
| ENDS_WITH('123456789', '789')  | ENDS_WITH('123456789', '456')  |
+--------------------------------+--------------------------------+
|                              1 |                              0 |
+--------------------------------+--------------------------------+
```

10. 电子邮件域名检查
```sql
SELECT ENDS_WITH('user@gmail.com', '.com'), ENDS_WITH('admin@company.org', '.com');
```
```text
+------------------------------------+--------------------------------------+
| ENDS_WITH('user@gmail.com', '.com') | ENDS_WITH('admin@company.org', '.com') |
+------------------------------------+--------------------------------------+
|                                  1 |                                    0 |
+------------------------------------+--------------------------------------+
```
