---
{
    "title": "ARRAY_POPBACK",
    "language": "zh-CN",
    "description": "移除数组的最后一个元素。函数会返回一个新数组，包含原数组中除最后一个元素外的所有元素。"
}
---

## array_popback

<version since="2.0.0">

</version>

## 描述

移除数组的最后一个元素。函数会返回一个新数组，包含原数组中除最后一个元素外的所有元素。

## 语法

```sql
array_popback(ARRAY<T> arr)
```

### 参数

- `arr`：ARRAY<T> 类型，要移除最后一个元素的数组

**T 支持的类型：**
- 数值类型：TINYINT、SMALLINT、INT、BIGINT、LARGEINT、FLOAT、DOUBLE、DECIMAL
- 字符串类型：CHAR、VARCHAR、STRING
- 日期时间类型：DATE、DATETIME、DATEV2、DATETIMEV2
- 布尔类型：BOOLEAN
- IP 类型：IPV4、IPV6
- 复杂类型：ARRAY、MAP、STRUCT

### 返回值

返回类型：ARRAY<T>

返回值含义：
- 返回一个新数组，包含原数组中除最后一个元素外的所有元素
- NULL：如果输入数组为 NULL

使用说明：
- 函数会移除数组的最后一个元素，返回剩余的元素
- 空数组返回空数组，只有一个元素的数组返回空数组
- 对数组元素中的 null 值：null 元素会被正常处理

**查询示例：**

移除字符串数组的最后一个元素：
```sql
SELECT array_popback(['apple', 'banana', 'cherry', 'date']);
+--------------------------------------------------+
| array_popback(['apple', 'banana', 'cherry', 'date']) |
+--------------------------------------------------+
| ["apple", "banana", "cherry"]                    |
+--------------------------------------------------+
```

移除包含 null 的数组的最后一个元素：
```sql
SELECT array_popback([1, null, 3, null, 5]);
+--------------------------------------------+
| array_popback([1, null, 3, null, 5])      |
+--------------------------------------------+
| [1, null, 3, null]                        |
+--------------------------------------------+
```

只有一个元素的数组返回空数组：
```sql
SELECT array_popback([42]);
+----------------------+
| array_popback([42])  |
+----------------------+
| []                   |
+----------------------+
```

空数组返回空数组：
```sql
SELECT array_popback([]);
+----------------------+
| array_popback([])    |
+----------------------+
| []                   |
+----------------------+
```

NULL 数组返回 NULL：
```sql
SELECT array_popback(NULL);
+----------------------+
| array_popback(NULL)  |
+----------------------+
| NULL                 |
+----------------------+
```

移除 IP 地址数组的最后一个元素：
```sql
SELECT array_popback(CAST(['192.168.1.1', '192.168.1.2', '192.168.1.3'] AS ARRAY<IPV4>));
+----------------------------------------------------------------------------------+
| array_popback(CAST(['192.168.1.1', '192.168.1.2', '192.168.1.3'] AS ARRAY<IPV4>)) |
+----------------------------------------------------------------------------------+
| ["192.168.1.1", "192.168.1.2"]                                                   |
+----------------------------------------------------------------------------------+
```

移除嵌套数组的最后一个元素：
```sql
SELECT array_popback([[1, 2], [3, 4], [5, 6]]);
+------------------------------------------+
| array_popback([[1, 2], [3, 4], [5, 6]]) |
+------------------------------------------+
| [[1, 2], [3, 4]]                         |
+------------------------------------------+
```

移除 MAP 数组的最后一个元素：
```sql
SELECT array_popback([{'name':'Alice','age':20}, {'name':'Bob','age':30}, {'name':'Charlie','age':40}]);
+------------------------------------------------------------------------------------------+
| array_popback([{'name':'Alice','age':20}, {'name':'Bob','age':30}, {'name':'Charlie','age':40}]) |
+------------------------------------------------------------------------------------------+
| [{"name":"Alice","age":20}, {"name":"Bob","age":30}]                                     |
+------------------------------------------------------------------------------------------+
```

移除 STRUCT 数组的最后一个元素：
```sql
SELECT array_popback(array(named_struct('name','Alice','age',20), named_struct('name','Bob','age',30), named_struct('name','Charlie','age',40)));
+-------------------------------------------------------------------------------------------------------------------------------------------+
| array_popback(array(named_struct('name','Alice','age',20), named_struct('name','Bob','age',30), named_struct('name','Charlie','age',40))) |
+-------------------------------------------------------------------------------------------------------------------------------------------+
| [{"name":"Alice", "age":20}, {"name":"Bob", "age":30}]                                                                                    |
+-------------------------------------------------------------------------------------------------------------------------------------------+
```

### Keywords

ARRAY, POPBACK, ARRAY_POPBACK
