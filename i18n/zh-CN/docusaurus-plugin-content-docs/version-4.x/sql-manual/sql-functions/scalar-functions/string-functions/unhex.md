---
{
    "title": "UNHEX",
    "language": "zh-CN",
    "description": "UNHEX 函数用于将十六进制字符串转换为原始字符串，是 HEX 函数的逆操作。该函数将每两个十六进制字符（0-9, A-F, a-f）转换为一个字节。UNHEXNULL 函数功能相同，但在遇到无效输入时返回 NULL 而不是空字符串。"
}
---

## 描述

UNHEX 函数用于将十六进制字符串转换为原始字符串，是 HEX 函数的逆操作。该函数将每两个十六进制字符（0-9, A-F, a-f）转换为一个字节。UNHEX_NULL 函数功能相同，但在遇到无效输入时返回 NULL 而不是空字符串。这两个函数在处理二进制数据、加密数据或需要十六进制表示的数据时非常有用。

:::tip
该函数自 3.0.6 版本开始支持
:::

## 语法

```sql
UNHEX(<str>)
UNHEX_NULL(<str>)
```

## 参数

| 参数 | 说明 |
| -- | -- |
| `<str>` | 需要解码的十六进制字符串。类型：VARCHAR |

## 返回值

返回 VARCHAR 类型，表示十六进制解码后的原始字符串。

解码规则：
- 接受字符范围：0-9, a-f, A-F
- 每两个十六进制字符转换为一个字节
- 结果可能包含不可打印字符

特殊情况（UNHEX）：
- 如果输入为 NULL，返回空字符串
- 如果字符串长度为 0 或奇数，返回空字符串
- 如果包含非十六进制字符，返回空字符串

特殊情况（UNHEX_NULL）：
- 如果输入为 NULL，返回 NULL
- 如果字符串长度为 0 或奇数，返回 NULL
- 如果包含非十六进制字符，返回 NULL

## 示例

1. 基本十六进制解码
```sql
SELECT UNHEX('41'), UNHEX('61');
```
```text
+-------------+-------------+
| UNHEX('41') | UNHEX('61') |
+-------------+-------------+
| A           | a           |
+-------------+-------------+
```

2. 多字符解码
```sql
SELECT UNHEX('4142'), UNHEX('48656C6C6F');
```
```text
+---------------+----------------------+
| UNHEX('4142') | UNHEX('48656C6C6F')  |
+---------------+----------------------+
| AB            | Hello                |
+---------------+----------------------+
```

3. NULL 值处理（两个函数对比）
```sql
SELECT UNHEX(NULL), UNHEX_NULL(NULL);
```
```text
+-------------+-----------------+
| UNHEX(NULL) | UNHEX_NULL(NULL) |
+-------------+-----------------+
|             | NULL            |
+-------------+-----------------+
```

4. 空字符串处理
```sql
SELECT UNHEX(''), UNHEX_NULL('');
```
```text
+-----------+-----------------+
| UNHEX('') | UNHEX_NULL('')  |
+-----------+-----------------+
|           | NULL            |
+-----------+-----------------+
```

5. 非法字符处理
```sql
SELECT UNHEX('@'), UNHEX_NULL('@');
```
```text
+------------+-----------------+
| UNHEX('@') | UNHEX_NULL('@') |
+------------+-----------------+
|            | NULL            |
+------------+-----------------+
```

6. 奇数长度字符串
```sql
SELECT UNHEX('123'), UNHEX_NULL('123');
```
```text
+--------------+-------------------+
| UNHEX('123') | UNHEX_NULL('123') |
+--------------+-------------------+
|              | NULL              |
+--------------+-------------------+
```

7. UTF-8 字符解码
```sql
SELECT UNHEX('E4B8AD'), UNHEX('E69687');
```
```text
+-----------------+-----------------+
| UNHEX('E4B8AD') | UNHEX('E69687') |
+-----------------+-----------------+
| 中              | 文              |
+-----------------+-----------------+
```

8. 数字编码解码
```sql
SELECT UNHEX('313233'), UNHEX('393837');
```
```text
+------------------+------------------+
| UNHEX('313233')  | UNHEX('393837')  |
+------------------+------------------+
| 123              | 987              |
+------------------+------------------+
```

10. 十六进制编码解码循环验证
```sql
SELECT UNHEX(HEX('Hello')), UNHEX(HEX('Test123'));
```
```text
+---------------------+------------------------+
| UNHEX(HEX('Hello')) | UNHEX(HEX('Test123'))  |
+---------------------+------------------------+
| Hello               | Test123                |
+---------------------+------------------------+
```
