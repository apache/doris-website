"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["812915"],{664458:function(e,n,r){r.r(n),r.d(n,{default:()=>d,frontMatter:()=>i,metadata:()=>t,assets:()=>u,toc:()=>l,contentTitle:()=>a});var t=JSON.parse('{"id":"admin-manual/workload-management/compute-group","title":"Compute Group","description":"Compute Group is a mechanism for physical isolation between different workloads in a storage-compute separation architecture. The basic principle of Compute Group is illustrated in the diagram below:","source":"@site/docs/admin-manual/workload-management/compute-group.md","sourceDirName":"admin-manual/workload-management","slug":"/admin-manual/workload-management/compute-group","permalink":"/docs/dev/admin-manual/workload-management/compute-group","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Compute Group","language":"en"},"sidebar":"docs","previous":{"title":"Resource Group","permalink":"/docs/dev/admin-manual/workload-management/resource-group"},"next":{"title":"Workload Group","permalink":"/docs/dev/admin-manual/workload-management/workload-group"}}'),s=r("785893"),o=r("250065");let i={title:"Compute Group",language:"en"},a=void 0,u={},l=[{value:"Viewing All Compute Groups",id:"viewing-all-compute-groups",level:2},{value:"Adding Compute Groups",id:"adding-compute-groups",level:2},{value:"Granting Compute Group Access",id:"granting-compute-group-access",level:2},{value:"Revoking Compute Group Access",id:"revoking-compute-group-access",level:2},{value:"Setting Default Compute Group",id:"setting-default-compute-group",level:2},{value:"Switching Compute Groups",id:"switching-compute-groups",level:2},{value:"Scaling Compute Groups",id:"scaling-compute-groups",level:2}];function c(e){let n={a:"a",admonition:"admonition",code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"Compute Group is a mechanism for physical isolation between different workloads in a storage-compute separation architecture. The basic principle of Compute Group is illustrated in the diagram below:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Compute Group workloads management in a storage-compute separation architecture",src:r(427199).Z+"",width:"1120",height:"552"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"One or more BE nodes can form a Compute Group."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"BE nodes are stateless locally, with data stored on shared storage."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Multiple Compute Groups access data through shared storage."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"While maintaining the strong isolation benefits like Resource Group, Compute Group offer the following advantages:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Lower costs: Due to the storage-compute separation architecture, data resides in shared storage, so the number of Compute Groups is no longer limited by the number of replicas. Users can create as many Compute Groups as needed without increasing storage costs."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"More flexibility: In a storage-compute separation architecture, data on BE nodes is cached, so adding a Compute Group does not require a cumbersome data migration process. The new Compute Group only needs to warm up its cache during queries."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Better isolation: Data availability is handled by the shared storage layer, so the failure of a BE node within any Compute Group will not cause data loading failures as it would in a Resource Group."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{title:"Caution",type:"caution",children:(0,s.jsx)(n.p,{children:"Before 3.0.2, it was called Compute Cluster."})}),"\n",(0,s.jsx)(n.h2,{id:"viewing-all-compute-groups",children:"Viewing All Compute Groups"}),"\n",(0,s.jsxs)(n.p,{children:["Use the ",(0,s.jsx)(n.code,{children:"SHOW COMPUTE GROUPS"})," command to view all compute groups in the current repository. The returned results will display different content based on the user's permission level:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Users with ",(0,s.jsx)(n.code,{children:"ADMIN"})," privileges can view all compute groups"]}),"\n",(0,s.jsx)(n.li,{children:"Regular users can only view compute groups for which they have usage permissions (USAGE_PRIV)"}),"\n",(0,s.jsx)(n.li,{children:"If a user doesn't have usage permissions for any compute groups, an empty result will be returned"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"SHOW COMPUTE GROUPS;\n"})}),"\n",(0,s.jsx)(n.h2,{id:"adding-compute-groups",children:"Adding Compute Groups"}),"\n",(0,s.jsxs)(n.p,{children:["Managing compute groups requires ",(0,s.jsx)(n.code,{children:"OPERATOR"})," privilege, which controls node management permissions. For more details, please refer to ",(0,s.jsx)(n.a,{href:"../../sql-manual/sql-statements/account-management/GRANT-TO",children:"Privilege Management"}),". By default, only the root account has the ",(0,s.jsx)(n.code,{children:"OPERATOR"})," privilege, but it can be granted to other accounts using the ",(0,s.jsx)(n.code,{children:"GRANT"})," command.\nTo add a BE and assign it to a compute group, use the ",(0,s.jsx)(n.a,{href:"../../sql-manual/sql-statements/cluster-management/instance-management/ADD-BACKEND",children:"Add BE"})," command. For example:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:'ALTER SYSTEM ADD BACKEND \'host:9050\' PROPERTIES ("tag.compute_group_name" = "new_group");\n'})}),"\n",(0,s.jsxs)(n.p,{children:["The above sql will add ",(0,s.jsx)(n.code,{children:"host:9050"})," to compute group ",(0,s.jsx)(n.code,{children:"new_group"}),". The BE will be added to compute group ",(0,s.jsx)(n.code,{children:"default_compute_group"})," if you omit PROPERTIES statement, for example:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"ALTER SYSTEM ADD BACKEND 'host:9050';\n"})}),"\n",(0,s.jsx)(n.h2,{id:"granting-compute-group-access",children:"Granting Compute Group Access"}),"\n",(0,s.jsx)(n.p,{children:"Prerequisite: The current operating user has' ADMIN 'permission, or the current user belongs to the admin role."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"GRANT USAGE_PRIV ON COMPUTE GROUP {compute_group_name} TO {user}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"revoking-compute-group-access",children:"Revoking Compute Group Access"}),"\n",(0,s.jsx)(n.p,{children:"Prerequisite: The current operating user has' ADMIN 'permission, or the current user belongs to the admin role."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"REVOKE USAGE_PRIV ON COMPUTE GROUP {compute_group_name} FROM {user}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"setting-default-compute-group",children:"Setting Default Compute Group"}),"\n",(0,s.jsx)(n.p,{children:"To set the default compute group for the current user(This operation requires the current user to already have permission to use the computing group):"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"SET PROPERTY 'default_compute_group' = '{clusterName}';\n"})}),"\n",(0,s.jsx)(n.p,{children:"To set the default compute group for other users (this operation requires Admin privileges):"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"SET PROPERTY FOR {user} 'default_compute_group' = '{clusterName}';\n"})}),"\n",(0,s.jsxs)(n.p,{children:["To view the current user's default compute group, the value of ",(0,s.jsx)(n.code,{children:"default_compute_group"})," in the returned result is the default compute group:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"SHOW PROPERTY;\n"})}),"\n",(0,s.jsxs)(n.p,{children:["To view the default compute group of other users, This operation requires the current user to have admin privileges, and the value of ",(0,s.jsx)(n.code,{children:"default_compute_group"})," in the returned result is the default compute group:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"SHOW PROPERTY FOR {user};\n"})}),"\n",(0,s.jsx)(n.p,{children:"To view all available compute groups in the current repository:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"SHOW COMPUTE GROUPS;\n"})}),"\n",(0,s.jsx)(n.admonition,{title:"Note",type:"info",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["If the current user has an Admin role, for example: ",(0,s.jsx)(n.code,{children:"CREATE USER jack IDENTIFIED BY '123456' DEFAULT ROLE \"admin\""}),", then:\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"They can set the default compute group for themselves and other users;"}),"\n",(0,s.jsxs)(n.li,{children:["They can view their own and other users' ",(0,s.jsx)(n.code,{children:"PROPERTY"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["If the current user does not have an Admin role, for example: ",(0,s.jsx)(n.code,{children:"CREATE USER jack1 IDENTIFIED BY '123456'"}),", then:\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"They can set the default compute group for themselves;"}),"\n",(0,s.jsxs)(n.li,{children:["They can view their own ",(0,s.jsx)(n.code,{children:"PROPERTY"}),";"]}),"\n",(0,s.jsxs)(n.li,{children:["They cannot view all compute groups, as this operation requires ",(0,s.jsx)(n.code,{children:"GRANT ADMIN"})," privileges."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["If the current user has not configured a default compute group, the existing system will trigger an error when performing data read/write operations. To resolve this issue, the user can execute the ",(0,s.jsx)(n.code,{children:"use @cluster"})," command to specify the compute group used by the current context, or use the ",(0,s.jsx)(n.code,{children:"SET PROPERTY"})," statement to set the default compute group."]}),"\n",(0,s.jsxs)(n.li,{children:["If the current user has configured a default compute group, but that cluster is subsequently deleted, an error will also be triggered during data read/write operations. The user can execute the ",(0,s.jsx)(n.code,{children:"use @cluster"})," command to re-specify the compute group used by the current context, or use the ",(0,s.jsx)(n.code,{children:"SET PROPERTY"})," statement to update the default cluster settings."]}),"\n"]})}),"\n",(0,s.jsx)(n.h2,{id:"switching-compute-groups",children:"Switching Compute Groups"}),"\n",(0,s.jsx)(n.p,{children:"Users can specify the database and compute group to use in a compute-storage decoupled architecture."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Syntax"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"USE { [catalog_name.]database_name[@compute_group_name] | @compute_group_name }\n"})}),"\n",(0,s.jsx)(n.p,{children:"If the database or compute group name contains reserved keywords, the corresponding name must be enclosed in backticks ```."}),"\n",(0,s.jsx)(n.h2,{id:"scaling-compute-groups",children:"Scaling Compute Groups"}),"\n",(0,s.jsxs)(n.p,{children:["You can scale compute groups by adding or removing BE using ",(0,s.jsx)(n.code,{children:"ALTER SYSTEM ADD BACKEND"})," and ",(0,s.jsx)(n.code,{children:"ALTER SYSTEM DECOMMISION BACKEND"}),"."]})]})}function d(e={}){let{wrapper:n}={...(0,o.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},427199:function(e,n,r){r.d(n,{Z:function(){return t}});let t=r.p+"assets/images/compute_group_workload_management-9bc39c8bd6de5908611e26f1e6a82054.png"},250065:function(e,n,r){r.d(n,{Z:function(){return a},a:function(){return i}});var t=r(667294);let s={},o=t.createContext(s);function i(e){let n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);