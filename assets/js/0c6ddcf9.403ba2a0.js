"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["985945"],{980581:function(e,r,n){n.r(r),n.d(r,{default:()=>o,frontMatter:()=>l,metadata:()=>a,assets:()=>c,toc:()=>d,contentTitle:()=>i});var a=JSON.parse('{"id":"sql-manual/sql-functions/scalar-functions/array-functions/array-except","title":"ARRAY_EXCEPT","description":"array_except","source":"@site/docs/sql-manual/sql-functions/scalar-functions/array-functions/array-except.md","sourceDirName":"sql-manual/sql-functions/scalar-functions/array-functions","slug":"/sql-manual/sql-functions/scalar-functions/array-functions/array-except","permalink":"/docs/dev/sql-manual/sql-functions/scalar-functions/array-functions/array-except","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"ARRAY_EXCEPT","language":"en"},"sidebar":"docs","previous":{"title":"ARRAY_ENUMERATE_UNIQ","permalink":"/docs/dev/sql-manual/sql-functions/scalar-functions/array-functions/array-enumerate-uniq"},"next":{"title":"ARRAY_EXISTS","permalink":"/docs/dev/sql-manual/sql-functions/scalar-functions/array-functions/array-exists"}}'),s=n("785893"),t=n("250065");let l={title:"ARRAY_EXCEPT",language:"en"},i=void 0,c={},d=[{value:"array_except",id:"array_except",level:2},{value:"Description",id:"description",level:2},{value:"Syntax",id:"syntax",level:2},{value:"Parameters",id:"parameters",level:3},{value:"Return Value",id:"return-value",level:3},{value:"Examples",id:"examples",level:3},{value:"Exception examples",id:"exception-examples",level:3},{value:"Keywords",id:"keywords",level:3}];function p(e){let r={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",t:"t",ul:"ul",version:"version",...(0,t.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.h2,{id:"array_except",children:"array_except"}),"\n",(0,s.jsx)(r.version,{since:"2.0.0",children:"\n"}),"\n",(0,s.jsx)(r.h2,{id:"description",children:"Description"}),"\n",(0,s.jsx)(r.p,{children:"Returns elements that exist in the first array but not in the second array, forming a new array after deduplication while maintaining the original order."}),"\n",(0,s.jsx)(r.h2,{id:"syntax",children:"Syntax"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sql",children:"array_except(ARRAY<T> arr1, ARRAY<T> arr2)\n"})}),"\n",(0,s.jsx)(r.h3,{id:"parameters",children:"Parameters"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"arr1"}),"\uFF1AARRAY",(0,s.jsx)(r.t,{children:" type, the first array."})]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"arr2"}),"\uFF1AARRAY",(0,s.jsx)(r.t,{children:" type, the second array."})]}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"T supported types:"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"Numeric types: TINYINT, SMALLINT, INT, BIGINT, LARGEINT, FLOAT, DOUBLE, DECIMAL"}),"\n",(0,s.jsx)(r.li,{children:"String types: CHAR, VARCHAR, STRING"}),"\n",(0,s.jsx)(r.li,{children:"Date and time types: DATE, DATETIME, DATEV2, DATETIMEV2"}),"\n",(0,s.jsx)(r.li,{children:"Boolean type: BOOLEAN"}),"\n",(0,s.jsx)(r.li,{children:"IP types: IPV4, IPV6"}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"return-value",children:"Return Value"}),"\n",(0,s.jsxs)(r.p,{children:["Return type: ARRAY",(0,s.jsx)(r.t,{})]}),"\n",(0,s.jsx)(r.p,{children:"Return value meaning:"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"Returns a new array containing all unique elements that exist in arr1 but not in arr2, maintaining the same order as arr1."}),"\n",(0,s.jsx)(r.li,{children:"NULL: if either input array is NULL."}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:"Usage notes:"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"Only supports basic type arrays, does not support complex types (ARRAY, MAP, STRUCT)."}),"\n",(0,s.jsx)(r.li,{children:"Empty array with any array results in an empty array."}),"\n",(0,s.jsx)(r.li,{children:"Element comparison follows type compatibility rules, attempts conversion when types are incompatible, fails to null."}),"\n",(0,s.jsx)(r.li,{children:"For null values in array elements: null elements are treated as regular elements in operations, null and null are considered the same"}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"examples",children:"Examples"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sql",children:'CREATE TABLE array_except_test (\n    id INT,\n    arr1 ARRAY<INT>,\n    arr2 ARRAY<INT>,\n    str_arr1 ARRAY<STRING>,\n    str_arr2 ARRAY<STRING>\n)\nDUPLICATE KEY(id)\nDISTRIBUTED BY HASH(id) BUCKETS 3\nPROPERTIES (\n    "replication_num" = "1"\n);\n\nINSERT INTO array_except_test VALUES\n(1, [1, 2, 3, 4, 5], [2, 4]),\n(2, [10, 20, 30], [30, 40]),\n(3, [], [1, 2]),\n(4, NULL, [1, 2]),\n(5, [1, null, 2, null, 3], [null, 2]),\n(6, [1, 2, 3], NULL),\n(7, [1, 2, 3], []),\n(8, [], []),\n(9, [1, 2, 2, 3, 3, 3, 4, 5, 5], [2, 3, 5]),\n(10, [1], [1]);\n'})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Query examples:"})}),"\n",(0,s.jsx)(r.p,{children:"Basic integer array except:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sql",children:"SELECT array_except(arr1, arr2) FROM array_except_test WHERE id = 1;\n+-----------------------------+\n| array_except(arr1, arr2)    |\n+-----------------------------+\n| [1, 3, 5]                   |\n+-----------------------------+\n"})}),"\n",(0,s.jsx)(r.p,{children:"Partial element overlap:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sql",children:"SELECT array_except(arr1, arr2) FROM array_except_test WHERE id = 2;\n+-----------------------------+\n| array_except(arr1, arr2)    |\n+-----------------------------+\n| [10, 20]                    |\n+-----------------------------+\n"})}),"\n",(0,s.jsx)(r.p,{children:"Empty array with any array:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sql",children:"SELECT array_except(arr1, arr2) FROM array_except_test WHERE id = 3;\n+-----------------------------+\n| array_except(arr1, arr2)    |\n+-----------------------------+\n| []                          |\n+-----------------------------+\n"})}),"\n",(0,s.jsx)(r.p,{children:"NULL array: returning NULL when either input array is NULL without throwing an error."}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sql",children:"SELECT array_except(arr1, arr2) FROM array_except_test WHERE id = 4;\n+-----------------------------+\n| array_except(arr1, arr2)    |\n+-----------------------------+\n| NULL                        |\n+-----------------------------+\n"})}),"\n",(0,s.jsx)(r.p,{children:"Array containing null values:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sql",children:"SELECT array_except(arr1, arr2) FROM array_except_test WHERE id = 5;\n+-----------------------------+\n| array_except(arr1, arr2)    |\n+-----------------------------+\n| [1, 3]                      |\n+-----------------------------+\n"})}),"\n",(0,s.jsx)(r.p,{children:"Second array is NULL: returning NULL when either input array is NULL without throwing an error."}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sql",children:"SELECT array_except(arr1, arr2) FROM array_except_test WHERE id = 6;\n+-----------------------------+\n| array_except(arr1, arr2)    |\n+-----------------------------+\n| NULL                        |\n+-----------------------------+\n"})}),"\n",(0,s.jsx)(r.p,{children:"Second array is empty:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sql",children:"SELECT array_except(arr1, arr2) FROM array_except_test WHERE id = 7;\n+-----------------------------+\n| array_except(arr1, arr2)    |\n+-----------------------------+\n| [1, 2, 3]                   |\n+-----------------------------+\n"})}),"\n",(0,s.jsx)(r.p,{children:"Both arrays are empty:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sql",children:"SELECT array_except(arr1, arr2) FROM array_except_test WHERE id = 8;\n+-----------------------------+\n| array_except(arr1, arr2)    |\n+-----------------------------+\n| []                          |\n+-----------------------------+\n"})}),"\n",(0,s.jsx)(r.p,{children:"Deduplication example:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sql",children:"SELECT array_except(arr1, arr2) FROM array_except_test WHERE id = 9;\n+-----------------------------+\n| array_except(arr1, arr2)    |\n+-----------------------------+\n| [1, 4]                      |\n+-----------------------------+\n"})}),"\n",(0,s.jsx)(r.p,{children:"All elements are excepted:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sql",children:"SELECT array_except(arr1, arr2) FROM array_except_test WHERE id = 10;\n+-----------------------------+\n| array_except(arr1, arr2)    |\n+-----------------------------+\n| []                          |\n+-----------------------------+\n"})}),"\n",(0,s.jsx)(r.p,{children:"String array except:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sql",children:"SELECT array_except(['a', 'b', 'c', 'd'], ['b', 'd']);\n+----------------------------------+\n| array_except(['a','b','c','d'],['b','d']) |\n+----------------------------------+\n| [\"a\", \"c\"]                      |\n+----------------------------------+\n"})}),"\n",(0,s.jsx)(r.h3,{id:"exception-examples",children:"Exception examples"}),"\n",(0,s.jsx)(r.p,{children:"Incorrect number of parameters:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sql",children:"SELECT array_except([1, 2, 3]);\nERROR 1105 (HY000): errCode = 2, detailMessage = Can not found function 'array_except' which has 1 arity. Candidate functions are: [array_except(Expression, Expression)]\n"})}),"\n",(0,s.jsx)(r.p,{children:"Incompatible types:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sql",children:"SELECT array_except([1, 2, 3], ['a', 'b']);\nERROR 1105 (HY000): errCode = 2, detailMessage = Can not find the compatibility function signature: array_except(ARRAY<INT>, ARRAY<VARCHAR(1)>)\n"})}),"\n",(0,s.jsx)(r.p,{children:"Passing non-array type:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sql",children:"SELECT array_except('not_an_array', [1, 2, 3]);\nERROR 1105 (HY000): errCode = 2, detailMessage = Can not find the compatibility function signature: array_except(VARCHAR(12), ARRAY<INT>)\n"})}),"\n",(0,s.jsx)(r.p,{children:"Complex types not supported:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sql",children:"SELECT array_except([[1,2],[3,4]], [[3,4]]);\nERROR 1105 (HY000): errCode = 2, detailMessage = Can not find the compatibility function signature: array_except(ARRAY<ARRAY<INT>>, ARRAY<ARRAY<INT>>)\n"})}),"\n",(0,s.jsx)(r.h3,{id:"keywords",children:"Keywords"}),"\n",(0,s.jsx)(r.p,{children:"ARRAY, EXCEPT, ARRAY_EXCEPT"})]})}function o(e={}){let{wrapper:r}={...(0,t.a)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}},250065:function(e,r,n){n.d(r,{Z:function(){return i},a:function(){return l}});var a=n(667294);let s={},t=a.createContext(s);function l(e){let r=a.useContext(t);return a.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function i(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),a.createElement(t.Provider,{value:r},e.children)}}}]);