"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["37430"],{669752:function(e,n,t){t.r(n),t.d(n,{default:()=>p,frontMatter:()=>s,metadata:()=>i,assets:()=>l,toc:()=>c,contentTitle:()=>a});var i=JSON.parse('{"id":"source-install/compilation-mac","title":"Compiling on MacOS","description":"\x3c!--","source":"@site/community/source-install/compilation-mac.md","sourceDirName":"source-install","slug":"/source-install/compilation-mac","permalink":"/community/source-install/compilation-mac","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Compiling on MacOS","language":"en"},"sidebar":"community","previous":{"title":"Compiling on Windows","permalink":"/community/source-install/compilation-win"},"next":{"title":"Security","permalink":"/community/security"}}'),o=t("785893"),r=t("250065");let s={title:"Compiling on MacOS",language:"en"},a="Compile on MacOS",l={},c=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Compile source code",id:"compile-source-code",level:2},{value:"Start",id:"start",level:2},{value:"Speed up by using pre-compiled third-party libraries",id:"speed-up-by-using-pre-compiled-third-party-libraries",level:2},{value:"Common Errors",id:"common-errors",level:2}];function d(e){let n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",mdxadmonitiontitle:"mdxadmonitiontitle",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"compile-on-macos",children:"Compile on MacOS"})}),"\n",(0,o.jsx)(n.p,{children:"This guide is about how to compile Doris on MacOS."}),"\n",(0,o.jsx)(n.admonition,{type:"tip",children:(0,o.jsx)(n.p,{children:"Currently, this is not supported in the compute-storage decoupled mode."})}),"\n",(0,o.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["MacOS 12 (Monterey) or later (Both ",(0,o.jsx)(n.strong,{children:"Intel"})," and ",(0,o.jsx)(n.strong,{children:"Apple Silicon"})," are supported.)"]}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://brew.sh/",children:"Homebrew"})}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"compile-source-code",children:"Compile source code"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Install dependencies using"})," ",(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.a,{href:"https://brew.sh/",children:"Homebrew"})})]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-Shell",children:"brew install automake autoconf libtool pkg-config texinfo coreutils gnu-getopt \\\npython@3 cmake ninja ccache bison byacc gettext wget pcre maven llvm@16 openjdk@11 npm\n"})}),"\n",(0,o.jsxs)(n.admonition,{type:"tip",children:[(0,o.jsx)(n.mdxadmonitiontitle,{}),(0,o.jsx)(n.p,{children:"On MacOS, since Homebrew does not provide an installation package for JDK8, JDK11 is used here instead. Alternatively, you can manually download and install JDK8."})]}),"\n",(0,o.jsxs)(n.ol,{start:"2",children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.strong,{children:"Compile source code"})}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-Shell",children:"bash build.sh\n"})}),"\n",(0,o.jsxs)(n.admonition,{type:"tip",children:[(0,o.jsx)(n.mdxadmonitiontitle,{}),(0,o.jsxs)(n.p,{children:["The first step of compiling Doris is to download and compile third-party libraries. You can download the pre-compiled versions of third-party libraries provided by the Doris community. Please refer to the instructions below for downloading ",(0,o.jsx)(n.strong,{children:"pre-compiled third-party libraries"})," to speed up the build process."]})]}),"\n",(0,o.jsx)(n.h2,{id:"start",children:"Start"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.strong,{children:"Increase file descriptors limit"})}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-Shell",children:"# Increase the file descriptor limit using the ulimit command.\nulimit -n 65536\n\n# Check if the change is effective.\n$ ulimit -n\n\n# Add the configuration to your startup script so that you do not have to set it again every time you open a new terminal session.\n# If you are using bash, execute the following statement:\necho 'ulimit -n 65536' >>~/.bashrc\n# If you are using zsh, execute the following statement:\necho 'ulimit -n 65536' >>~/.zshrc\n"})}),"\n",(0,o.jsxs)(n.ol,{start:"2",children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.strong,{children:"Start BE"})}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-Shell",children:"cd output/be/bin\n./start_be.sh --daemon\n"})}),"\n",(0,o.jsxs)(n.ol,{start:"3",children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Start"})," ",(0,o.jsx)(n.strong,{children:"FE"})]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-Shell",children:"cd output/fe/bin\n./start_fe.sh --daemon\n"})}),"\n",(0,o.jsx)(n.h2,{id:"speed-up-by-using-pre-compiled-third-party-libraries",children:"Speed up by using pre-compiled third-party libraries"}),"\n",(0,o.jsxs)(n.p,{children:["Download the pre-compiled third-party libraries from ",(0,o.jsx)(n.a,{href:"https://github.com/apache/doris-thirdparty/releases/tag/automation",children:"Apache Doris Third Party Prebuilt"}),". Refer to the command below:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"cd thirdparty\nrm -rf installed\n\n# Intel chip\ncurl -L https://github.com/apache/doris-thirdparty/releases/download/automation/doris-thirdparty-prebuilt-darwin-x86_64.tar.xz \\\n    -o - | tar -Jxf -\n\n# Apple Silicon chip\ncurl -L https://github.com/apache/doris-thirdparty/releases/download/automation/doris-thirdparty-prebuilt-darwin-arm64.tar.xz \\\n    -o - | tar -Jxf -\n\n# Check if protoc and thrift functions normally\ncd installed/bin\n\n./protoc --version\n./thrift --version\n"})}),"\n",(0,o.jsxs)(n.admonition,{type:"tip",children:[(0,o.jsx)(n.mdxadmonitiontitle,{}),(0,o.jsxs)(n.p,{children:['When running protoc and thrift, you may encounter an issue where the binary cannot be opened due to developer verification. To resolve this, you can go to "Security & Privacy" settings. In the "General" tab, click on the "Open Anyway" button to confirm your intent to open the binary. Refer to: ',(0,o.jsx)(n.a,{href:"https://support.apple.com/en-us/102445",children:"https://support.apple.com/en-us/102445"})]})]}),"\n",(0,o.jsx)(n.h2,{id:"common-errors",children:"Common Errors"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["When running ",(0,o.jsx)(n.code,{children:"protoc"})," and ",(0,o.jsx)(n.code,{children:"thrift"}),', you may encounter an issue where the binary cannot be opened due to developer verification. To resolve this, you can go to "Security & Privacy" settings. In the "General" tab, click on the "Open Anyway" button to confirm your intent to open the binary. Refer to: ',(0,o.jsx)(n.a,{href:"https://support.apple.com/en-us/102445",children:"https://support.apple.com/en-us/102445"}),"."]}),"\n",(0,o.jsx)(n.li,{children:"When compiling with a Mac with an M3 chip, the compilation of the proto file fails.\nThe failure log is as follows:"}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-Shell",children:"[ERROR] ... [0:0]: --grpc-java_out: protoc-gen-grpc-java: Plugin failed with status code 1.\n"})}),"\n",(0,o.jsxs)(n.p,{children:["The reason for this error may be that the Apple arm-based chip does not support software on the x86 platform.\nYou can download the protoc-gen-grpc-java software used from ",(0,o.jsx)(n.a,{href:"https://repo.maven.apache.org/maven2/io/grpc/protoc-gen-grpc-java/",children:"https://repo.maven.apache.org/maven2/io/grpc/protoc-gen-grpc-java/"}),", and the version information can be viewed from the grpc.java.artifact property under the protoc_rosetta profile in fe/fe-core/pom.xml. If the following error is reported after downloading and executing, it means that the current Mac cannot execute software based on x86 compiled software."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-Shell",children:"zsh: bad CPU type in executable:./protoc-gen-grpc-java-1.34.0-osx-x86_64.exe\n"})}),"\n",(0,o.jsxs)(n.p,{children:["You can refer to the official documentation ",(0,o.jsx)(n.a,{href:"https://support.apple.com/en-us/102527",children:"https://support.apple.com/en-us/102527"})," and install ",(0,o.jsx)(n.code,{children:"Rosetta"})," to solve this problem."]})]})}function p(e={}){let{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},250065:function(e,n,t){t.d(n,{Z:function(){return a},a:function(){return s}});var i=t(667294);let o={},r=i.createContext(o);function s(e){let n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);