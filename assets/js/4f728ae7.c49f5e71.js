"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["134015"],{650917:function(e,n,s){s.r(n),s.d(n,{default:()=>h,frontMatter:()=>o,metadata:()=>t,assets:()=>l,toc:()=>d,contentTitle:()=>a});var t=JSON.parse('{"id":"sql-manual/sql-statements/data-modification/backup-and-restore/CREATE-REPOSITORY","title":"CREATE REPOSITORY","description":"Description","source":"@site/docs/sql-manual/sql-statements/data-modification/backup-and-restore/CREATE-REPOSITORY.md","sourceDirName":"sql-manual/sql-statements/data-modification/backup-and-restore","slug":"/sql-manual/sql-statements/data-modification/backup-and-restore/CREATE-REPOSITORY","permalink":"/docs/dev/sql-manual/sql-statements/data-modification/backup-and-restore/CREATE-REPOSITORY","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"CREATE REPOSITORY","language":"en"},"sidebar":"docs","previous":{"title":"CLEAN LABEL","permalink":"/docs/dev/sql-manual/sql-statements/data-modification/load-and-export/CLEAN-LABEL"},"next":{"title":"DROP REPOSITORY","permalink":"/docs/dev/sql-manual/sql-statements/data-modification/backup-and-restore/DROP-REPOSITORY"}}'),r=s("785893"),i=s("250065");let o={title:"CREATE REPOSITORY",language:"en"},a=void 0,l={},d=[{value:"Description",id:"description",level:2},{value:"Syntax",id:"syntax",level:2},{value:"Required Parameters",id:"required-parameters",level:2},{value:"Access Control Requirements",id:"access-control-requirements",level:2},{value:"Usage notes",id:"usage-notes",level:2},{value:"Examples",id:"examples",level:2}];function c(e){let n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"description",children:"Description"}),"\n",(0,r.jsx)(n.p,{children:"This statement is used to create a repository. Repositories are used for backup or restore."}),"\n",(0,r.jsx)(n.h2,{id:"syntax",children:"Syntax"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"CREATE [READ ONLY] REPOSITORY <repo_name>\n    WITH [ S3 | HDFS ]\n    ON LOCATION <repo_location>\n    PROPERTIES (\n              -- S3 or HDFS storage property\n              <storage_property>\n              [ , ... ]\n    )\n"})}),"\n",(0,r.jsx)(n.h2,{id:"required-parameters",children:"Required Parameters"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"<repo_name>"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"The unique name of the repository."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"<repo_location>"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"The storage path of the repository."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"<storage_property>"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"The properties of the repository. The corresponding parameters should be selected based on whether S3 or HDFS is chosen as the storage medium."}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"<storage_property>"})," Optional parameters are as follows, and additional parameters can be added based on the actual environment."]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\u53C2\u6570"}),(0,r.jsx)(n.th,{children:"\u8BF4\u660E"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"s3.endpoint"})}),(0,r.jsx)(n.td,{children:"S3 service endpoint"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"s3.access_key"})}),(0,r.jsx)(n.td,{children:"S3 access key"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"s3.secret_key"})}),(0,r.jsx)(n.td,{children:"S3 secret key"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"s3.region"})}),(0,r.jsx)(n.td,{children:"S3 region"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"use_path_style"})}),(0,r.jsx)(n.td,{children:"Whether to use path-style access for S3 (applies to MinIO)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"fs.defaultFS"})}),(0,r.jsx)(n.td,{children:"Hadoop default file system URI"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"hadoop.username"})}),(0,r.jsx)(n.td,{children:"Hadoop username"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Note: "})}),"\n",(0,r.jsxs)(n.p,{children:["Doris also supported ",(0,r.jsx)(n.code,{children:"AWS Assume Role"})," for creating AWS S3 Repository, please refer to ",(0,r.jsx)(n.a,{href:"/docs/dev/admin-manual/auth/integrations/aws-authentication-and-authorization#assumed-role-authentication",children:"AWS intergration"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"access-control-requirements",children:"Access Control Requirements"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Privilege"}),(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Object"}),(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Notes"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"ADMIN_PRIV"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Entire cluster management permissions"}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Only the root or superuser can create repositories"})]})})]}),"\n",(0,r.jsx)(n.h2,{id:"usage-notes",children:"Usage notes"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"If it is a read-only repository, restoration can only be performed on the repository. If not, both backup and restoration operations can be performed."}),"\n",(0,r.jsx)(n.li,{children:"The properties (PROPERTIES) vary depending on whether it is S3 or HDFS, as shown in the example."}),"\n",(0,r.jsx)(n.li,{children:"For ON LOCATION, if it is S3, the following should be the S3 Bucket Name."}),"\n",(0,r.jsx)(n.li,{children:"When performing data migration, the same repository must be created in both the source and destination clusters so that the destination cluster can view the data snapshot from the source cluster's backup."}),"\n",(0,r.jsxs)(n.li,{children:["Any user can view the repositories that have been created by using the ",(0,r.jsx)(n.a,{href:"./SHOW-REPOSITORIES",children:"SHOW REPOSITORIES"})," command."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,r.jsx)(n.p,{children:"Create a repository named s3_repo."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:'CREATE REPOSITORY `s3_repo`\nWITH S3\nON LOCATION "s3://s3-repo"\nPROPERTIES\n(\n    "s3.endpoint" = "http://s3-REGION.amazonaws.com",\n    "s3.region" = "s3-REGION",\n    "s3.access_key" = "AWS_ACCESS_KEY",\n    "s3.secret_key"="AWS_SECRET_KEY",\n    "s3.region" = "REGION"\n);\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Note: "})}),"\n",(0,r.jsxs)(n.p,{children:["Doris also supported ",(0,r.jsx)(n.code,{children:"AWS Assume Role"})," for creating AWS S3 Repository, please refer to ",(0,r.jsx)(n.a,{href:"/docs/dev/admin-manual/auth/integrations/aws-authentication-and-authorization#assumed-role-authentication",children:"AWS intergration"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"Create a repository named hdfs_repo."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:'CREATE REPOSITORY `hdfs_repo`\nWITH hdfs\nON LOCATION "hdfs://hadoop-name-node:54310/path/to/repo/"\nPROPERTIES\n(\n    "fs.defaultFS"="hdfs://hadoop-name-node:54310",\n    "hadoop.username"="user"\n);\n'})}),"\n",(0,r.jsx)(n.p,{children:"Create a repository named minio_repo to link minio storage directly through the S3 protocol."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:'CREATE REPOSITORY `minio_repo`\nWITH S3\nON LOCATION "s3://minio_repo"\nPROPERTIES\n(\n    "s3.endpoint" = "http://minio.com",\n    "s3.access_key" = "MINIO_USER",\n    "s3.secret_key"="MINIO_PASSWORD",\n    "s3.region" = "REGION",\n    "use_path_style" = "true"\n);\n'})}),"\n",(0,r.jsx)(n.p,{children:"Create a repository named minio_repo via temporary security credentials."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:'CREATE REPOSITORY `minio_repo`\nWITH S3\nON LOCATION "s3://minio_repo"\nPROPERTIES\n( \n    "s3.endpoint" = "AWS_ENDPOINT",\n    "s3.access_key" = "AWS_TEMP_ACCESS_KEY",\n    "s3.secret_key" = "AWS_TEMP_SECRET_KEY",\n    "s3.session_token" = "AWS_TEMP_TOKEN",\n    "s3.region" = "AWS_REGION"\n)\n'})}),"\n",(0,r.jsx)(n.p,{children:"Create repository using Tencent COS"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:'CREATE REPOSITORY `cos_repo`\nWITH S3\nON LOCATION "s3://backet1/"\nPROPERTIES\n(\n    "s3.access_key" = "ak",\n    "s3.secret_key" = "sk",\n    "s3.endpoint" = "http://cos.ap-beijing.myqcloud.com",\n    "s3.region" = "ap-beijing"\n);\n'})})]})}function h(e={}){let{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},250065:function(e,n,s){s.d(n,{Z:function(){return a},a:function(){return o}});var t=s(667294);let r={},i=t.createContext(r);function o(e){let n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);