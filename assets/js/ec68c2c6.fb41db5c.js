"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["53460"],{887747:function(e,n,t){t.r(n),t.d(n,{default:()=>h,frontMatter:()=>s,metadata:()=>r,assets:()=>o,toc:()=>d,contentTitle:()=>l});var r=JSON.parse('{"id":"lakehouse/catalogs/delta-lake-catalog","title":"Delta Lake Catalog","description":"Apache Doris Delta Lake Catalog User Guide: Connect to Delta Lake data lake through Trino Connector framework to query and integrate Delta Lake table data. Supports Hive Metastore, multiple data type mappings, and quick integration between Delta Lake and Doris.","source":"@site/versioned_docs/version-4.x/lakehouse/catalogs/delta-lake-catalog.md","sourceDirName":"lakehouse/catalogs","slug":"/lakehouse/catalogs/delta-lake-catalog","permalink":"/docs/4.x/lakehouse/catalogs/delta-lake-catalog","draft":false,"unlisted":false,"tags":[],"version":"4.x","lastUpdatedAt":1770477659000,"frontMatter":{"title":"Delta Lake Catalog","language":"en","description":"Apache Doris Delta Lake Catalog User Guide: Connect to Delta Lake data lake through Trino Connector framework to query and integrate Delta Lake table data. Supports Hive Metastore, multiple data type mappings, and quick integration between Delta Lake and Doris."},"sidebar":"docs","previous":{"title":"MaxCompute Catalog","permalink":"/docs/4.x/lakehouse/catalogs/maxcompute-catalog"},"next":{"title":"BigQuery Catalog","permalink":"/docs/4.x/lakehouse/catalogs/bigquery-catalog"}}'),i=t("785893"),a=t("250065");let s={title:"Delta Lake Catalog",language:"en",description:"Apache Doris Delta Lake Catalog User Guide: Connect to Delta Lake data lake through Trino Connector framework to query and integrate Delta Lake table data. Supports Hive Metastore, multiple data type mappings, and quick integration between Delta Lake and Doris."},l=void 0,o={},d=[{value:"Overview",id:"overview",level:2},{value:"Use Cases",id:"use-cases",level:3},{value:"Version Compatibility",id:"version-compatibility",level:3},{value:"Quick Start",id:"quick-start",level:2},{value:"Step 1: Prepare Connector Plugin",id:"step-1-prepare-connector-plugin",level:3},{value:"Step 2: Deploy Plugin",id:"step-2-deploy-plugin",level:3},{value:"Step 3: Create Catalog",id:"step-3-create-catalog",level:3},{value:"Step 4: Query Data",id:"step-4-query-data",level:3},{value:"Configuration Description",id:"configuration-description",level:2},{value:"Catalog Configuration Parameters",id:"catalog-configuration-parameters",level:3},{value:"TrinoProperties Parameters",id:"trinoproperties-parameters",level:4},{value:"CommonProperties Parameters",id:"commonproperties-parameters",level:4},{value:"Data Type Mapping",id:"data-type-mapping",level:2}];function c(e){let n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsxs)(n.p,{children:["Delta Lake Catalog uses the ",(0,i.jsx)(n.a,{href:"https://doris.apache.org/community/how-to-contribute/trino-connector-developer-guide/",children:"Trino Connector"})," compatibility framework with Trino Delta Lake Connector to access Delta Lake tables."]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"This is an experimental feature, supported since version 3.0.1."}),"\n",(0,i.jsx)(n.li,{children:"This feature does not depend on a Trino cluster environment, it only uses the Trino compatibility plugin."}),"\n"]})}),"\n",(0,i.jsx)(n.h3,{id:"use-cases",children:"Use Cases"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Scenario"}),(0,i.jsx)(n.th,{children:"Support Status"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Data Integration"}),(0,i.jsx)(n.td,{children:"Read Delta Lake data and write to Doris internal tables"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Data Write-back"}),(0,i.jsx)(n.td,{children:"Not supported"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"version-compatibility",children:"Version Compatibility"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Doris Version"}),": 3.0.1 and above"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Trino Connector Version"}),": 435"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Delta Lake Version"}),": For supported versions, please refer to ",(0,i.jsx)(n.a,{href:"https://trino.io/docs/435/connector/delta-lake.html",children:"Trino Documentation"})]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,i.jsx)(n.h3,{id:"step-1-prepare-connector-plugin",children:"Step 1: Prepare Connector Plugin"}),"\n",(0,i.jsx)(n.p,{children:"You can obtain the Delta Lake Connector plugin using one of the following methods:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Method 1: Use Pre-compiled Package (Recommended)"})}),"\n",(0,i.jsxs)(n.p,{children:["Download the pre-compiled ",(0,i.jsx)(n.a,{href:"https://github.com/apache/Doris-thirdparty/releases/download/trino-435-20240724/trino-delta-lake-435-20240724.tar.gz",children:"trino-delta-lake-435-20240724.tar.gz"})," and ",(0,i.jsx)(n.a,{href:"https://github.com/apache/doris-thirdparty/releases/download/trino-435-20240724/trino-hdfs-435-20240724.tar.gz",children:"hdfs.tar.gz"})," and extract them."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Method 2: Manual Compilation"})}),"\n",(0,i.jsx)(n.p,{children:"If you need custom compilation, follow these steps (requires JDK 17):"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"git clone https://github.com/apache/doris-thirdparty.git\ncd doris-thirdparty\ngit checkout trino-435\ncd plugin/trino-delta-lake\nmvn clean install -DskipTests\ncd ../../lib/trino-hdfs\nmvn clean install -DskipTests\n"})}),"\n",(0,i.jsxs)(n.p,{children:["After compilation, you'll get the ",(0,i.jsx)(n.code,{children:"trino-delta-lake-435"})," directory under ",(0,i.jsx)(n.code,{children:"trino/plugin/trino-delta-lake/target/"}),", and the ",(0,i.jsx)(n.code,{children:"hdfs"})," directory under ",(0,i.jsx)(n.code,{children:"trino/lib/trino-hdfs/target/"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"step-2-deploy-plugin",children:"Step 2: Deploy Plugin"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Place the ",(0,i.jsx)(n.code,{children:"trino-delta-lake-435/"})," directory under the ",(0,i.jsx)(n.code,{children:"connectors/"})," directory of all FE and BE deployment paths (create the directory manually if it doesn't exist):"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"\u251C\u2500\u2500 bin\n\u251C\u2500\u2500 conf\n\u251C\u2500\u2500 plugins\n\u2502   \u251C\u2500\u2500 connectors\n\u2502       \u251C\u2500\u2500 trino-delta-lake-435\n\u2502           \u251C\u2500\u2500 hdfs\n...\n"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["You can also customize the plugin path by modifying the ",(0,i.jsx)(n.code,{children:"trino_connector_plugin_dir"})," configuration in ",(0,i.jsx)(n.code,{children:"fe.conf"}),". For example: ",(0,i.jsx)(n.code,{children:"trino_connector_plugin_dir=/path/to/connectors/"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Restart all FE and BE nodes to ensure the connector is loaded correctly."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"step-3-create-catalog",children:"Step 3: Create Catalog"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Basic Configuration"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"CREATE CATALOG delta_lake_catalog PROPERTIES (\n    'type' = 'trino-connector',\n    'trino.connector.name' = 'delta_lake',\n    'trino.hive.metastore' = 'thrift',\n    'trino.hive.metastore.uri' = 'thrift://ip:port',\n    'trino.hive.config.resources' = '/path/to/core-site.xml,/path/to/hdfs-site.xml'\n);\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Configuration Description"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"trino.hive.metastore"}),": Metadata service type, supports ",(0,i.jsx)(n.code,{children:"thrift"})," (Hive Metastore), etc."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"trino.hive.metastore.uri"}),": Hive Metastore service address"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"trino.hive.config.resources"}),": Hadoop configuration file path, multiple files separated by commas"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:['For more configuration options, please refer to the "Configuration Description" section below or ',(0,i.jsx)(n.a,{href:"https://trino.io/docs/435/connector/delta-lake.html",children:"Trino Official Documentation"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"step-4-query-data",children:"Step 4: Query Data"}),"\n",(0,i.jsx)(n.p,{children:"After creating the Catalog, you can query Delta Lake table data using one of the following three methods:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"-- Method 1: Switch to Catalog then query\nSWITCH delta_lake_catalog;\nUSE delta_lake_db;\nSELECT * FROM delta_lake_tbl LIMIT 10;\n\n-- Method 2: Use two-level path\nUSE delta_lake_catalog.delta_lake_db;\nSELECT * FROM delta_lake_tbl LIMIT 10;\n\n-- Method 3: Use fully qualified name\nSELECT * FROM delta_lake_catalog.delta_lake_db.delta_lake_tbl LIMIT 10;\n"})}),"\n",(0,i.jsx)(n.h2,{id:"configuration-description",children:"Configuration Description"}),"\n",(0,i.jsx)(n.h3,{id:"catalog-configuration-parameters",children:"Catalog Configuration Parameters"}),"\n",(0,i.jsx)(n.p,{children:"The basic syntax for creating a Delta Lake Catalog is as follows:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"CREATE CATALOG [IF NOT EXISTS] catalog_name PROPERTIES (\n    'type' = 'trino-connector',            -- Required, fixed value\n    'trino.connector.name' = 'delta_lake', -- Required, fixed value\n    {TrinoProperties},                     -- Trino Connector related properties\n    {CommonProperties}                     -- Common properties\n);\n"})}),"\n",(0,i.jsx)(n.h4,{id:"trinoproperties-parameters",children:"TrinoProperties Parameters"}),"\n",(0,i.jsxs)(n.p,{children:["TrinoProperties are used to configure Trino Delta Lake Connector specific properties, these properties are prefixed with ",(0,i.jsx)(n.code,{children:"trino."}),". Common parameters include:"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter Name"}),(0,i.jsx)(n.th,{children:"Required"}),(0,i.jsx)(n.th,{children:"Default Value"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"trino.hive.metastore"})}),(0,i.jsx)(n.td,{children:"Yes"}),(0,i.jsx)(n.td,{children:"-"}),(0,i.jsxs)(n.td,{children:["Metadata service type, such as ",(0,i.jsx)(n.code,{children:"thrift"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"trino.hive.metastore.uri"})}),(0,i.jsx)(n.td,{children:"Yes"}),(0,i.jsx)(n.td,{children:"-"}),(0,i.jsx)(n.td,{children:"Hive Metastore service address"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"trino.hive.config.resources"})}),(0,i.jsx)(n.td,{children:"No"}),(0,i.jsx)(n.td,{children:"-"}),(0,i.jsx)(n.td,{children:"Hadoop configuration file path, multiple files separated by commas"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"trino.delta.hide-non-delta-tables"})}),(0,i.jsx)(n.td,{children:"No"}),(0,i.jsx)(n.td,{children:"false"}),(0,i.jsx)(n.td,{children:"Whether to hide non-Delta Lake tables"})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["For more Delta Lake Connector configuration parameters, please refer to ",(0,i.jsx)(n.a,{href:"https://trino.io/docs/435/connector/delta-lake.html",children:"Trino Official Documentation"}),"."]}),"\n",(0,i.jsx)(n.h4,{id:"commonproperties-parameters",children:"CommonProperties Parameters"}),"\n",(0,i.jsxs)(n.p,{children:['CommonProperties are used to configure common Catalog properties, such as metadata refresh policies, permission control, etc. For detailed information, please refer to the "Common Properties" section in ',(0,i.jsx)(n.a,{href:"/docs/4.x/lakehouse/catalog-overview",children:"Catalog Overview"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"data-type-mapping",children:"Data Type Mapping"}),"\n",(0,i.jsx)(n.p,{children:"When using Delta Lake Catalog, data types are mapped according to the following rules:"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Delta Lake Type"}),(0,i.jsx)(n.th,{children:"Trino Type"}),(0,i.jsx)(n.th,{children:"Doris Type"}),(0,i.jsx)(n.th,{children:"Notes"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"boolean"}),(0,i.jsx)(n.td,{children:"boolean"}),(0,i.jsx)(n.td,{children:"boolean"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"int"}),(0,i.jsx)(n.td,{children:"int"}),(0,i.jsx)(n.td,{children:"int"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"byte"}),(0,i.jsx)(n.td,{children:"tinyint"}),(0,i.jsx)(n.td,{children:"tinyint"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"short"}),(0,i.jsx)(n.td,{children:"smallint"}),(0,i.jsx)(n.td,{children:"smallint"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"long"}),(0,i.jsx)(n.td,{children:"bigint"}),(0,i.jsx)(n.td,{children:"bigint"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"float"}),(0,i.jsx)(n.td,{children:"real"}),(0,i.jsx)(n.td,{children:"float"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"double"}),(0,i.jsx)(n.td,{children:"double"}),(0,i.jsx)(n.td,{children:"double"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"decimal(P, S)"}),(0,i.jsx)(n.td,{children:"decimal(P, S)"}),(0,i.jsx)(n.td,{children:"decimal(P, S)"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"varchar"}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"binary"}),(0,i.jsx)(n.td,{children:"varbinary"}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"date"}),(0,i.jsx)(n.td,{children:"date"}),(0,i.jsx)(n.td,{children:"date"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"timestamp_ntz"}),(0,i.jsx)(n.td,{children:"timestamp(N)"}),(0,i.jsx)(n.td,{children:"datetime(N)"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"timestamp"}),(0,i.jsx)(n.td,{children:"timestamp with time zone(N)"}),(0,i.jsx)(n.td,{children:"datetime(N)"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"array"}),(0,i.jsx)(n.td,{children:"array"}),(0,i.jsx)(n.td,{children:"array"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"map"}),(0,i.jsx)(n.td,{children:"map"}),(0,i.jsx)(n.td,{children:"map"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"struct"}),(0,i.jsx)(n.td,{children:"row"}),(0,i.jsx)(n.td,{children:"struct"}),(0,i.jsx)(n.td,{})]})]})]})]})}function h(e={}){let{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},250065:function(e,n,t){t.d(n,{Z:function(){return l},a:function(){return s}});var r=t(667294);let i={},a=r.createContext(i);function s(e){let n=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);