"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["61103"],{482799:function(e,n,i){i.r(n),i.d(n,{default:()=>u,frontMatter:()=>c,metadata:()=>s,assets:()=>o,toc:()=>a,contentTitle:()=>t});var s=JSON.parse('{"id":"sql-manual/sql-functions/ai-functions/ai-function","title":"AI_Function","description":"\x3c!--","source":"@site/docs/sql-manual/sql-functions/ai-functions/ai-function.md","sourceDirName":"sql-manual/sql-functions/ai-functions","slug":"/sql-manual/sql-functions/ai-functions/ai-function","permalink":"/docs/dev/sql-manual/sql-functions/ai-functions/ai-function","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"AI_Function","language":"en"},"sidebar":"docs","previous":{"title":"AI_FIXGRAMMAR","permalink":"/docs/dev/sql-manual/sql-functions/ai-functions/ai-fixgrammar"},"next":{"title":"AI_GENERATE","permalink":"/docs/dev/sql-manual/sql-functions/ai-functions/ai-generate"}}'),r=i("785893"),l=i("250065");let c={title:"AI_Function",language:"en"},t=void 0,o={},a=[{value:"Description",id:"description",level:2},{value:"Configure AI Resource",id:"configure-ai-resource",level:2},{value:"Example: Create AI Resource",id:"example-create-ai-resource",level:3},{value:"Parameter Description",id:"parameter-description",level:5},{value:"Resource Selection and Session Variables",id:"resource-selection-and-session-variables",level:2},{value:"Resource Selection Priority",id:"resource-selection-priority",level:3},{value:"AI Functions",id:"ai-functions",level:2},{value:"Examples",id:"examples",level:3}];function d(e){let n={a:"a",code:"code",h2:"h2",h3:"h3",h5:"h5",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"description",children:"Description"}),"\n",(0,r.jsx)(n.p,{children:"AI Function is a built-in function provided by Doris based on Artificial Intelligence (AI) capabilities. Users can directly call AI in SQL queries to perform various intelligent text tasks. AI Function connects to multiple mainstream AI providers (such as OpenAI, Anthropic, DeepSeek, Gemini, Ollama, MoonShot, etc.) through Doris's resource mechanism."}),"\n",(0,r.jsx)(n.p,{children:"The AI used must be provided externally by Doris and support text analysis."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"configure-ai-resource",children:"Configure AI Resource"}),"\n",(0,r.jsx)(n.p,{children:"Before using AI Function, you need to create a Resource of type AI to centrally manage access information for the AI API."}),"\n",(0,r.jsx)(n.h3,{id:"example-create-ai-resource",children:"Example: Create AI Resource"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"CREATE RESOURCE \"ai_resource_name\"\nPROPERTIES (\n    'type' = 'ai',\n    'ai.provider_type' = 'openai',\n    'ai.endpoint' = 'https://endpoint_example',\n    'ai.model_name' = 'model_example',\n    'ai.api_key' = 'sk-xxx',\n    'ai.temperature' = '0.7',\n    'ai.max_token' = '1024',\n    'ai.max_retries' = '3',\n    'ai.retry_delay_second' = '1',\n    'ai.dimensions' = '1024';\n);\n"})}),"\n",(0,r.jsx)(n.h5,{id:"parameter-description",children:"Parameter Description"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"type"}),": Required, must be ",(0,r.jsx)(n.code,{children:"ai"}),", used as the type identifier for ai."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"ai.provider_type"}),": Required, external AI provider type. Currently supported providers include: OpenAI, Anthropic, Gemini, DeepSeek, Local, MoonShot, MiniMax, Zhipu, QWen, Baichuan. If there are providers not listed above but their API format is the same as ",(0,r.jsx)(n.a,{href:"https://platform.openai.com/docs/overview",children:"OpenAI"}),"/",(0,r.jsx)(n.a,{href:"https://docs.anthropic.com/en/api/messages-examples",children:"Anthropic"}),"/",(0,r.jsx)(n.a,{href:"https://ai.google.dev/gemini-api/docs/quickstart#rest_1",children:"Gemini"}),", you can directly fill in the corresponding provider."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"ai.endpoint"}),": Required, AI API endpoint."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"ai.model_name"}),": Required, model name."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"ai_api_key"}),": Required except when ",(0,r.jsx)(n.code,{children:"ai.provider_type = local"}),", API key."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"ai.temperature"}),": Optional. Controls the randomness of generated content. Accepts a float value between 0 and 1.\nThe default value is -1, which means this parameter is not set."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"ai.max_tokens"}),": Optional. Limits the maximum number of tokens for generated content.\nThe default value is -1, which means this parameter is not set. The default value for Anthropic is 2048."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"ai.max_retries"}),": Optional. The maximum number of retries for a single request. The default value is 3."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"ai.retry_delay_second"}),": Optional. The delay time (in seconds) before retrying. The default value is 0."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"ai.dimensions"}),": Optional, control the vector dimension of ",(0,r.jsx)(n.a,{href:"https://doris.apache.org/docs/dev/sql-manual/sql-functions/ai-functions/distance-functions/embed",children:"EMBED"})," output.\n",(0,r.jsxs)(n.strong,{children:["Make sure to confirm that the model filled in ",(0,r.jsx)(n.code,{children:"ai.model_name"})," supports custom vector dimension before setting"]}),",\notherwise it may cause model call failure."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"resource-selection-and-session-variables",children:"Resource Selection and Session Variables"}),"\n",(0,r.jsx)(n.p,{children:"When users call AI-related functions, resources can be specified in the following two ways:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Explicitly specify the resource: directly pass the resource name when calling the function."}),"\n",(0,r.jsx)(n.li,{children:"Implicitly specify the resource: set the Session variable in advance, and the function will automatically use the corresponding resource."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Set Session variable format:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SET default_ai_resource='resource_name';\n"})}),"\n",(0,r.jsx)(n.p,{children:"Function call format:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT AI_FUNCTION([<resource_name>], <args...>);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"resource-selection-priority",children:"Resource Selection Priority"}),"\n",(0,r.jsx)(n.p,{children:"When calling an AI_Function, it determines which resource to use in the following order:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"The resource explicitly specified by the user in the call"}),"\n",(0,r.jsxs)(n.li,{children:["The global default resource (",(0,r.jsx)(n.code,{children:"default_ai_resource"}),")"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Example:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SET default_ai_resource='global_default_resource';\nSELECT AI_SENTIMENT('this is a test'); -- Uses resource named 'global_default_resource'\nSELECT AI_SENTIMENT('invoke_resource', 'this is a test') --Uses resource named 'invoke_resource'\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"ai-functions",children:"AI Functions"}),"\n",(0,r.jsx)(n.p,{children:"Currently supported AI Functions in Doris include:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"AI_CLASSIFY"}),": Information classification"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"AI_EXTRACT"}),": Information extraction"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"AI_FILTER"}),"\uFF1AFilter information"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"AI_FIXGRAMMAR"}),": Grammar correction"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"AI_GENERATE"}),": Text generation"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"AI_MASK"}),": Masking sensitive information"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"AI_SENTIMENT"}),": Sentiment analysis"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"AI_SIMILARITY"}),": Text semantic similarity comparison"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"AI_SUMMARIZE"}),": Text summarization"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"AI_TRANSLATE"}),": Translation"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"AI_AGG"}),": Perform cross-line aggregation analysis on multiple texts"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"examples",children:"Examples"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"AI_TRANSLATE"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT AI_TRANSLATE('resource_name', 'this is a test', 'Chinese');\n-- \u8FD9\u662F\u4E00\u4E2A\u6D4B\u8BD5\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"AI_SENTIMENT"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SET default_ai_resource = 'resource_name';\nSELECT AI_SENTIMENT('Apache Doris is a great DBMS.');\n"})}),"\n",(0,r.jsx)(n.p,{children:"For detailed function and usage, please refer to the documentation of each specific function."})]})}function u(e={}){let{wrapper:n}={...(0,l.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},250065:function(e,n,i){i.d(n,{Z:function(){return t},a:function(){return c}});var s=i(667294);let r={},l=s.createContext(r);function c(e){let n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);