"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["699846"],{882199:function(e,n,l){l.r(n),l.d(n,{default:()=>u,frontMatter:()=>o,metadata:()=>a,assets:()=>r,toc:()=>c,contentTitle:()=>i});var a=JSON.parse('{"id":"sql-manual/sql-functions/aggregate-functions/bool-and","title":"BOOL_AND","description":"Performs a logical AND aggregation over all non-NULL values of the expression.","source":"@site/versioned_docs/version-4.x/sql-manual/sql-functions/aggregate-functions/bool-and.md","sourceDirName":"sql-manual/sql-functions/aggregate-functions","slug":"/sql-manual/sql-functions/aggregate-functions/bool-and","permalink":"/docs/4.x/sql-manual/sql-functions/aggregate-functions/bool-and","draft":false,"unlisted":false,"tags":[],"version":"4.x","lastUpdatedAt":1770477659000,"frontMatter":{"title":"BOOL_AND","language":"en","description":"Performs a logical AND aggregation over all non-NULL values of the expression."},"sidebar":"docs","previous":{"title":"BITMAP-UNION-INT","permalink":"/docs/4.x/sql-manual/sql-functions/aggregate-functions/bitmap-union-int"},"next":{"title":"BOOL_OR","permalink":"/docs/4.x/sql-manual/sql-functions/aggregate-functions/bool-or"}}'),t=l("785893"),s=l("250065");let o={title:"BOOL_AND",language:"en",description:"Performs a logical AND aggregation over all non-NULL values of the expression."},i=void 0,r={},c=[{value:"Description",id:"description",level:2},{value:"Alias",id:"alias",level:2},{value:"Syntax",id:"syntax",level:2},{value:"Parameters",id:"parameters",level:2},{value:"Return Value",id:"return-value",level:2},{value:"Examples",id:"examples",level:2},{value:"Aggregate function:",id:"aggregate-function",level:3},{value:"Window function:",id:"window-function",level:3},{value:"Error example:",id:"error-example",level:3}];function d(e){let n={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"description",children:"Description"}),"\n",(0,t.jsx)(n.p,{children:"Performs a logical AND aggregation over all non-NULL values of the expression."}),"\n",(0,t.jsx)(n.h2,{id:"alias",children:"Alias"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"BOOLAND_AGG"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"syntax",children:"Syntax"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"BOOL_AND(<expr>)\n"})}),"\n",(0,t.jsx)(n.h2,{id:"parameters",children:"Parameters"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Parameter"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsx)(n.tbody,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"<expr>"})}),(0,t.jsx)(n.td,{children:"Expression to be aggregated with logical AND. Supports BOOLEAN type and numeric types that can be converted to boolean by the 0/non-0 rule (0 is FALSE, non-0 is TRUE)."})]})})]}),"\n",(0,t.jsx)(n.h2,{id:"return-value",children:"Return Value"}),"\n",(0,t.jsx)(n.p,{children:"The return value is BOOLEAN. It returns TRUE only when all non-NULL values are TRUE; otherwise, it returns FALSE."}),"\n",(0,t.jsx)(n.p,{children:"If all values of the expression are NULL or the expression is empty, the function returns NULL."}),"\n",(0,t.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,t.jsx)(n.p,{children:"setup :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:'CREATE TABLE IF NOT EXISTS test_boolean_agg (\n     id INT,\n     c1 BOOLEAN,\n     c2 BOOLEAN,\n     c3 BOOLEAN,\n     c4 BOOLEAN\n) DISTRIBUTED BY HASH(id) BUCKETS 1\nPROPERTIES ("replication_num" = "1"); \n\nINSERT INTO test_boolean_agg (id, c1, c2, c3, c4) values \n(1, true, true, true, false),\n(2, true, false, false, false),\n(3, true, true, false, false),\n(4, true, false, false, false);\n'})}),"\n",(0,t.jsx)(n.h3,{id:"aggregate-function",children:"Aggregate function:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"SELECT booland_agg(c1), booland_agg(c2), booland_agg(c3), booland_agg(c4)\nFROM test_boolean_agg;\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"+-----------------+-----------------+-----------------+-----------------+\n| booland_agg(c1) | booland_agg(c2) | booland_agg(c3) | booland_agg(c4) |\n+-----------------+-----------------+-----------------+-----------------+\n|               1 |               0 |               0 |               0 |\n+-----------------+-----------------+-----------------+-----------------+\n"})}),"\n",(0,t.jsxs)(n.p,{children:["bool_and can also accept numeric type parameters, if the number is not 0, it will be converted to ",(0,t.jsx)(n.code,{children:"TRUE"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:'CREATE TABLE test_numeric_and_null (\n    id INT,\n    c_int INT,\n    c_float FLOAT,\n    c_decimal DECIMAL(10,2),\n    c_bool BOOLEAN\n) DISTRIBUTED BY HASH(id) BUCKETS 1\nPROPERTIES ("replication_num" = "1");\n\nINSERT INTO test_numeric_and_null (id, c_int, c_float, c_decimal, c_bool) VALUES\n(1, 1, 1.0, NULL, NULL),\n(2, 0, NULL, 0.00, NULL),\n(3, 1, 3.14, 1.00, NULL),\n(4, 0, 1.0, 0.00, NULL),\n(5, NULL, NULL, NULL, NULL);\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"SELECT\n    BOOL_AND(c_int) AS bool_and_int,\n    BOOL_AND(c_float) AS bool_and_float,\n    BOOL_AND(c_decimal) AS bool_and_decimal,\n    BOOL_AND(c_bool) AS bool_and_bool\nFROM test_numeric_and_null;\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"+--------------+----------------+------------------+---------------+\n| bool_and_int | bool_and_float | bool_and_decimal | bool_and_bool |\n+--------------+----------------+------------------+---------------+\n|            0 |              1 |                0 |          NULL |\n+--------------+----------------+------------------+---------------+\n"})}),"\n",(0,t.jsx)(n.h3,{id:"window-function",children:"Window function:"}),"\n",(0,t.jsx)(n.p,{children:"The following example partitions the rows based on the condition (id > 2),\ndivides them into two groups, and displays the window aggregation results:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM test_boolean_agg;\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"+------+------+------+------+------+\n| id   | c1   | c2   | c3   | c4   |\n+------+------+------+------+------+\n|    1 |    1 |    1 |    1 |    0 |\n|    2 |    1 |    0 |    0 |    0 |\n|    3 |    1 |    1 |    0 |    0 |\n|    4 |    1 |    0 |    0 |    0 |\n+------+------+------+------+------+\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"SELECT\n    id,\n    BOOLAND_AGG(c1) OVER (PARTITION BY (id > 2)) AS a,\n    BOOLAND_AGG(c2) OVER (PARTITION BY (id > 2)) AS b,\n    BOOLAND_AGG(c3) OVER (PARTITION BY (id > 2)) AS c,\n    BOOLAND_AGG(c4) OVER (PARTITION BY (id > 2)) AS d\nFROM test_boolean_agg\nORDER BY id;\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"+------+------+------+------+------+\n| id   | a    | b    | c    | d    |\n+------+------+------+------+------+\n|    1 |    1 |    0 |    0 |    0 |\n|    2 |    1 |    0 |    0 |    0 |\n|    3 |    1 |    0 |    0 |    0 |\n|    4 |    1 |    0 |    0 |    0 |\n+------+------+------+------+------+\n"})}),"\n",(0,t.jsx)(n.h3,{id:"error-example",children:"Error example:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"SELECT BOOL_AND('invalid type');\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"ERROR 1105 (HY000): errCode = 2, detailMessage = bool_and requires a boolean or numeric argument\n"})})]})}function u(e={}){let{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},250065:function(e,n,l){l.d(n,{Z:function(){return i},a:function(){return o}});var a=l(667294);let t={},s=a.createContext(t);function o(e){let n=a.useContext(s);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);