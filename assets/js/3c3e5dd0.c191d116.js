"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["882436"],{977648:function(e,n,a){a.r(n),a.d(n,{default:()=>h,frontMatter:()=>i,metadata:()=>r,assets:()=>d,toc:()=>o,contentTitle:()=>l});var r=JSON.parse('{"id":"sql-manual/sql-functions/scalar-functions/array-functions/array-last-index","title":"ARRAY_LAST_INDEX","description":"Finds the position index (starting from 1) of the last element in the array that satisfies the lambda expression.","source":"@site/docs/sql-manual/sql-functions/scalar-functions/array-functions/array-last-index.md","sourceDirName":"sql-manual/sql-functions/scalar-functions/array-functions","slug":"/sql-manual/sql-functions/scalar-functions/array-functions/array-last-index","permalink":"/docs/dev/sql-manual/sql-functions/scalar-functions/array-functions/array-last-index","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1770477659000,"frontMatter":{"title":"ARRAY_LAST_INDEX","language":"en","description":"Finds the position index (starting from 1) of the last element in the array that satisfies the lambda expression."},"sidebar":"docs","previous":{"title":"ARRAY_LAST","permalink":"/docs/dev/sql-manual/sql-functions/scalar-functions/array-functions/array-last"},"next":{"title":"ARRAY_MAP","permalink":"/docs/dev/sql-manual/sql-functions/scalar-functions/array-functions/array-map"}}'),s=a("785893"),t=a("250065");let i={title:"ARRAY_LAST_INDEX",language:"en",description:"Finds the position index (starting from 1) of the last element in the array that satisfies the lambda expression."},l=void 0,d={},o=[{value:"array_last_index",id:"array_last_index",level:2},{value:"Description",id:"description",level:2},{value:"Syntax",id:"syntax",level:2},{value:"Parameters",id:"parameters",level:3},{value:"Return Value",id:"return-value",level:3},{value:"Keywords",id:"keywords",level:3}];function c(e){let n={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",t:"t",ul:"ul",version:"version",...(0,t.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"array_last_index",children:"array_last_index"}),"\n",(0,s.jsx)(n.version,{since:"2.0.0",children:"\n"}),"\n",(0,s.jsx)(n.h2,{id:"description",children:"Description"}),"\n",(0,s.jsx)(n.p,{children:"Finds the position index (starting from 1) of the last element in the array that satisfies the lambda expression. Finds the last element that satisfies the condition and returns its position index."}),"\n",(0,s.jsx)(n.h2,{id:"syntax",children:"Syntax"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"array_last_index(lambda, ARRAY<T> arr1, [ARRAY<T> arr2, ...])\n"})}),"\n",(0,s.jsx)(n.h3,{id:"parameters",children:"Parameters"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"lambda"}),"\uFF1Alambda expression used to define search conditions"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"arr1, arr2, ..."}),"\uFF1AARRAY",(0,s.jsx)(n.t,{children:" type, arrays to search. Supports one or more array parameters."})]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Supported types for T:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Numeric types: TINYINT, SMALLINT, INT, BIGINT, LARGEINT, FLOAT, DOUBLE, DECIMAL"}),"\n",(0,s.jsx)(n.li,{children:"String types: CHAR, VARCHAR, STRING"}),"\n",(0,s.jsx)(n.li,{children:"Date and time types: DATE, DATETIME, DATEV2, DATETIMEV2"}),"\n",(0,s.jsx)(n.li,{children:"Boolean type: BOOLEAN"}),"\n",(0,s.jsx)(n.li,{children:"IP types: IPV4, IPV6"}),"\n",(0,s.jsx)(n.li,{children:"Complex types: ARRAY, MAP, STRUCT"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"return-value",children:"Return Value"}),"\n",(0,s.jsx)(n.p,{children:"Return type: BIGINT"}),"\n",(0,s.jsx)(n.p,{children:"Return value meaning:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Returns the position index of the last element in the array that satisfies the lambda expression. The return value starts from 1, not 0. If the found element that satisfies the condition matches the first element in the array, this function returns 1, not 0"}),"\n",(0,s.jsx)(n.li,{children:"0: if the input array is NULL and there is no lambda expression, or the array is empty, or no element satisfies the condition"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Usage notes:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"The number of parameters in the lambda expression must match the number of array parameters"}),"\n",(0,s.jsx)(n.li,{children:"Empty arrays return 0. When the input parameter is a NULL array and there is no lambda expression, returns 0. If the input parameter is a NULL array with a lambda expression, it will error"}),"\n",(0,s.jsx)(n.li,{children:"When there are multiple array parameters, all arrays must have the same length"}),"\n",(0,s.jsx)(n.li,{children:"Lambda can use any scalar expression, but cannot use aggregate functions"}),"\n",(0,s.jsx)(n.li,{children:"Lambda expressions can call other higher-order functions, but the return types must be compatible"}),"\n",(0,s.jsx)(n.li,{children:"For null values in array elements: null elements will be passed to the lambda expression for processing, and lambda can check for null values"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Query Examples:"})}),"\n",(0,s.jsx)(n.p,{children:"Find the position index of the last element greater than or equal to 3 in a floating-point array:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"SELECT array_last_index(x -> x >= 3, [1.1, 2.2, 3.3, 4.4, 5.5]);\n+----------------------------------------------------------+\n| array_last_index(x -> x >= 3, [1.1, 2.2, 3.3, 4.4, 5.5]) |\n+----------------------------------------------------------+\n|                                                        5 |\n+----------------------------------------------------------+\n"})}),"\n",(0,s.jsx)(n.p,{children:"Find the position index of the last element with length greater than 2 in a string array:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"SELECT array_last_index(x -> length(x) > 2, ['a', 'bb', 'ccc', 'dddd', 'eeeee']);\n+---------------------------------------------------------------------------+\n| array_last_index(x -> length(x) > 2, ['a', 'bb', 'ccc', 'dddd', 'eeeee']) |\n+---------------------------------------------------------------------------+\n|                                                                         5 |\n+---------------------------------------------------------------------------+\n"})}),"\n",(0,s.jsx)(n.p,{children:"Empty array returns 0:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"SELECT array_last_index(x -> x > 0, []);\n+----------------------------------------+\n| array_last_index(x -> x > 0, [])     |\n+----------------------------------------+\n| 0                                      |\n+----------------------------------------+\n"})}),"\n",(0,s.jsx)(n.p,{children:"NULL array and lambda expression combination. When there is a lambda expression with NULL, it will error. When there is no lambda expression, it returns 0:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"SELECT array_last_index(NULL);\n+-------------------------+\n| array_last_index(NULL) |\n+-------------------------+\n|                       0 |\n+-------------------------+\n\nSELECT array_last_index(x -> x > 2, NULL);\nERROR 1105 (HY000): errCode = 2, detailMessage = lambda argument must be array but is NULL\n"})}),"\n",(0,s.jsx)(n.p,{children:"Array containing null values, lambda can check for null:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"SELECT array_last_index(x -> x is not null, [null, 1, null, 3, null, 5]);\n+-------------------------------------------------------------------+\n| array_last_index(x -> x is not null, [null, 1, null, 3, null, 5]) |\n+-------------------------------------------------------------------+\n|                                                                 6 |\n+-------------------------------------------------------------------+\n"})}),"\n",(0,s.jsx)(n.p,{children:"Multi-array search, find the position index of the last element where the first array is greater than the second array:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"SELECT array_last_index((x, y) -> x > y, [1, 2, 3, 4, 5], [1.1, 2.2, 3.3, 4.4, 5.5]);\n+-------------------------------------------------------------------------------+\n| array_last_index((x, y) -> x > y, [1, 2, 3, 4, 5], [1.1, 2.2, 3.3, 4.4, 5.5]) |\n+-------------------------------------------------------------------------------+\n|                                                                             0 |\n+-------------------------------------------------------------------------------+\n"})}),"\n",(0,s.jsx)(n.p,{children:"Nested array search, find the position index of the last element where each sub-array length is greater than 2:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"SELECT array_last_index(x -> size(x) > 2, [[1,2],[3,4,5],[6],[7,8,9,10]]);\n+--------------------------------------------------------------------+\n| array_last_index(x -> size(x) > 2, [[1,2],[3,4,5],[6],[7,8,9,10]]) |\n+--------------------------------------------------------------------+\n|                                                                  4 |\n+--------------------------------------------------------------------+\n"})}),"\n",(0,s.jsx)(n.p,{children:"Map type search, find the position index of the last element where the value with key 'a' is greater than 10:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"SELECT array_last_index(x -> x['a'] > 10, [{'a':5}, {'a':15}, {'a':20}]);\n+-------------------------------------------------------------------+\n| array_last_index(x -> x['a'] > 10, [{'a':5}, {'a':15}, {'a':20}]) |\n+-------------------------------------------------------------------+\n|                                                                 3 |\n+-------------------------------------------------------------------+\n"})}),"\n",(0,s.jsx)(n.p,{children:"Error when parameter count is wrong:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"SELECT array_last_index();\nERROR 1105 (HY000): errCode = 2, detailMessage = Can not found function 'array_last_index' which has 0 arity. Candidate functions are: [array_last_index(Expression, Expression...)]\n"})}),"\n",(0,s.jsx)(n.p,{children:"Error when the number of parameters in lambda expression doesn't match the number of array parameters:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"SELECT array_last_index(x -> x > 0, [1,2,3], [4,5,6], [7,8,9]);\nERROR 1105 (HY000): errCode = 2, detailMessage = lambda x -> (x > 0) arguments' size is not equal parameters' size\n"})}),"\n",(0,s.jsx)(n.p,{children:"Error when passing non-array type:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"SELECT array_last_index(x -> x > 0, 'not_an_array');\nERROR 1105 (HY000): errCode = 2, detailMessage = Can not find the compatibility function signature: array_last_index(Expression, VARCHAR(12))\n"})}),"\n",(0,s.jsx)(n.h3,{id:"keywords",children:"Keywords"}),"\n",(0,s.jsx)(n.p,{children:"ARRAY, LAST, INDEX, ARRAY_LAST_INDEX"})]})}function h(e={}){let{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},250065:function(e,n,a){a.d(n,{Z:function(){return l},a:function(){return i}});var r=a(667294);let s={},t=r.createContext(s);function i(e){let n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);