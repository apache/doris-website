"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["838145"],{478285:function(e,n,s){s.r(n),s.d(n,{default:()=>u,frontMatter:()=>c,metadata:()=>l,assets:()=>i,toc:()=>o,contentTitle:()=>r});var l=JSON.parse('{"id":"sql-manual/sql-functions/scalar-functions/json-functions/json-object","title":"JSON_OBJECT","description":"Description","source":"@site/docs/sql-manual/sql-functions/scalar-functions/json-functions/json-object.md","sourceDirName":"sql-manual/sql-functions/scalar-functions/json-functions","slug":"/sql-manual/sql-functions/scalar-functions/json-functions/json-object","permalink":"/docs/dev/sql-manual/sql-functions/scalar-functions/json-functions/json-object","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"JSON_OBJECT","language":"en"},"sidebar":"docs","previous":{"title":"JSON_LENGTH","permalink":"/docs/dev/sql-manual/sql-functions/scalar-functions/json-functions/json-length"},"next":{"title":"JSON_PARSE","permalink":"/docs/dev/sql-manual/sql-functions/scalar-functions/json-functions/json-parse"}}'),a=s("785893"),t=s("250065");let c={title:"JSON_OBJECT",language:"en"},r=void 0,i={},o=[{value:"Description",id:"description",level:2},{value:"Syntax",id:"syntax",level:2},{value:"Parameters",id:"parameters",level:2},{value:"Variable parameters:",id:"variable-parameters",level:3},{value:"Notes",id:"notes",level:2},{value:"Return Value",id:"return-value",level:2},{value:"Examples",id:"examples",level:2}];function d(e){let n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,t.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h2,{id:"description",children:"Description"}),"\n",(0,a.jsx)(n.p,{children:"Generate one JSON object containing specified Key-Value pairs. Returns an error when the Key value is NULL or when an odd number of parameters is passed."}),"\n",(0,a.jsx)(n.h2,{id:"syntax",children:"Syntax"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"JSON_OBJECT (<key>, <value>[, <key>, <value>, ...])\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"JSON_OBJECT(*)\n"})}),"\n",(0,a.jsx)(n.h2,{id:"parameters",children:"Parameters"}),"\n",(0,a.jsx)(n.h3,{id:"variable-parameters",children:"Variable parameters:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"<key>"}),": String type"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"<value>"}),": Multiple types, Doris will automatically convert non-JSON type parameters to JSON type through the ",(0,a.jsx)(n.a,{href:"/docs/dev/sql-manual/sql-functions/scalar-functions/json-functions/to-json",children:(0,a.jsx)(n.code,{children:"TO_JSON"})})," function."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"*"}),": When invoked with an asterisk (wildcard), the OBJECT value is constructed from the specified data using the attribute names as keys and the associated values as values."]}),"\n",(0,a.jsx)(n.p,{children:"When you pass a wildcard to the function, you can qualify the wildcard with the name or alias for the table. For example, to pass in all of the columns from the table named mytable, specify the following:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"(mytable.*)\n"})}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"notes",children:"Notes"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"The number of parameters must be even, can be 0 parameters (returns an empty JSON object)."}),"\n",(0,a.jsx)(n.li,{children:"By convention, the parameter list consists of alternating keys and values."}),"\n",(0,a.jsx)(n.li,{children:"Keys are forcibly converted to text according to JSON definition."}),"\n",(0,a.jsx)(n.li,{children:"If the passed Key is NULL, returns an exception error."}),"\n",(0,a.jsxs)(n.li,{children:["Value parameters are converted in a way that can be converted to JSON, must be types supported by ",(0,a.jsx)(n.a,{href:"/docs/dev/sql-manual/sql-functions/scalar-functions/json-functions/to-json",children:(0,a.jsx)(n.code,{children:"TO_JSON"})}),"."]}),"\n",(0,a.jsx)(n.li,{children:"If the passed Value is NULL, the Value in the returned JSON object for that Key-Value pair will be JSON null value."}),"\n",(0,a.jsx)(n.li,{children:"If you want to support other types as values, you can use CAST to convert them to JSON/String."}),"\n",(0,a.jsxs)(n.li,{children:["Doris currently does not deduplicate JSON objects, which means duplicate keys are allowed. However, duplicate keys may cause unexpected results:\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"Other systems may drop values corresponding to duplicate keys, or report errors."}),"\n",(0,a.jsxs)(n.li,{children:["The result returned by ",(0,a.jsx)(n.a,{href:"/docs/dev/sql-manual/sql-functions/scalar-functions/json-functions/json-extract",children:(0,a.jsx)(n.code,{children:"JSON_EXTRACT"})})," is uncertain."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"return-value",children:"Return Value"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.a,{href:"/docs/dev/sql-manual/basic-element/sql-data-types/semi-structured/JSON",children:(0,a.jsx)(n.code,{children:"JSON"})}),": Returns a JSON object composed of the parameter list."]}),"\n",(0,a.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Case with no parameters"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"select json_object();\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"+---------------+\n| json_object() |\n+---------------+\n| {}            |\n+---------------+\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Unsupported value types"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"select json_object('time',curtime());\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"ERROR 1105 (HY000): errCode = 2, detailMessage = Can not find the compatibility function signature: to_json(TIMEV2(0))\n"})}),"\n",(0,a.jsx)(n.p,{children:"Can be converted to String through cast"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"select json_object('time', cast(curtime() as string));\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:'+------------------------------------------------+\n| json_object(\'time\', cast(curtime() as string)) |\n+------------------------------------------------+\n| {"time":"17:09:42"}                            |\n+------------------------------------------------+\n'})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Non-String type keys will be converted to String"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"SELECT json_object(123, 456);\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:'+-----------------------+\n| json_object(123, 456) |\n+-----------------------+\n| {"123":456}           |\n+-----------------------+\n'})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Null cannot be used as key"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"select json_object(null, 456);\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"ERROR 1105 (HY000): errCode = 2, detailMessage = json_object key can't be NULL: json_object(NULL, 456)\n"})}),"\n",(0,a.jsx)(n.p,{children:"Null can be used as value"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"select json_object('key', null);\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"+--------------------------+\n| json_object('key', null) |\n+--------------------------+\n| {\"key\":null}             |\n+--------------------------+\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["JSON strings can be parsed into JSON objects via ",(0,a.jsx)(n.a,{href:"/docs/dev/sql-manual/sql-functions/scalar-functions/json-functions/json-parse",children:(0,a.jsx)(n.code,{children:"JSON_PARSE"})})," before being passed to ",(0,a.jsx)(n.code,{children:"JSON_OBJECT"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:'select json_object(123, json_parse(\'{"key": "value"}\'));\n'})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:'+--------------------------------------------------+\n| json_object(123, json_parse(\'{"key": "value"}\')) |\n+--------------------------------------------------+\n| {"123":{"key":"value"}}                          |\n+--------------------------------------------------+\n'})}),"\n",(0,a.jsx)(n.p,{children:"Otherwise it will be treated as a string"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:'select json_object(123,\'{"key": "value"}\');\n'})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:'+-------------------------------------+\n| json_object(123,\'{"key": "value"}\') |\n+-------------------------------------+\n| {"123":"{\\"key\\": \\"value\\"}"}      |\n+-------------------------------------+\n'})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Types not supported by ",(0,a.jsx)(n.a,{href:"/docs/dev/sql-manual/sql-functions/scalar-functions/json-functions/to-json",children:(0,a.jsx)(n.code,{children:"TO_JSON"})})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"select json_object('key', map('abc', 'efg'));\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"ERROR 1105 (HY000): errCode = 2, detailMessage = Can not find the compatibility function signature: to_json(MAP<VARCHAR(3),VARCHAR(3)>)\n"})}),"\n",(0,a.jsx)(n.p,{children:"Can be converted to JSON via CAST statement before passing in:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"select json_object('key', cast(map('abc', 'efg') as json));\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"+-----------------------------------------------------+\n| json_object('key', cast(map('abc', 'efg') as json)) |\n+-----------------------------------------------------+\n| {\"key\":{\"abc\":\"efg\"}}                               |\n+-----------------------------------------------------+\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Case with duplicate keys"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"select\n    json_object('key', 123, 'key', 4556) v1\n    , jsonb_extract(json_object('key', 123, 'key', 4556), '$.key') v2\n    , jsonb_extract(json_object('key', 123, 'key', 4556), '$.*') v3;\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:'+------------------------+------+------------+\n| v1                     | v2   | v3         |\n+------------------------+------+------------+\n| {"key":123,"key":4556} | 123  | [123,4556] |\n+------------------------+------+------------+\n'})}),"\n"]}),"\n"]})]})}function u(e={}){let{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},250065:function(e,n,s){s.d(n,{Z:function(){return r},a:function(){return c}});var l=s(667294);let a={},t=l.createContext(a);function c(e){let n=l.useContext(t);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:c(e.components),l.createElement(t.Provider,{value:n},e.children)}}}]);