"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["786701"],{439404:function(e,n,l){l.r(n),l.d(n,{default:()=>m,frontMatter:()=>o,metadata:()=>a,assets:()=>r,toc:()=>c,contentTitle:()=>s});var a=JSON.parse('{"id":"sql-manual/sql-reference/Data-Definition-Statements/Alter/ALTER-TABLE-COLUMN","title":"ALTER-TABLE-COLUMN","description":"ALTER-TABLE-COLUMN","source":"@site/versioned_docs/version-2.0/sql-manual/sql-reference/Data-Definition-Statements/Alter/ALTER-TABLE-COLUMN.md","sourceDirName":"sql-manual/sql-reference/Data-Definition-Statements/Alter","slug":"/sql-manual/sql-reference/Data-Definition-Statements/Alter/ALTER-TABLE-COLUMN","permalink":"/docs/2.0/sql-manual/sql-reference/Data-Definition-Statements/Alter/ALTER-TABLE-COLUMN","draft":false,"unlisted":false,"tags":[],"version":"2.0","frontMatter":{"title":"ALTER-TABLE-COLUMN","language":"en"},"sidebar":"docs","previous":{"title":"ALTER-DATABASE","permalink":"/docs/2.0/sql-manual/sql-reference/Data-Definition-Statements/Alter/ALTER-DATABASE"},"next":{"title":"ALTER-TABLE-PARTITION","permalink":"/docs/2.0/sql-manual/sql-reference/Data-Definition-Statements/Alter/ALTER-TABLE-PARTITION"}}'),i=l("785893"),t=l("250065");let o={title:"ALTER-TABLE-COLUMN",language:"en"},s=void 0,r={},c=[{value:"ALTER-TABLE-COLUMN",id:"alter-table-column",level:2},{value:"Name",id:"name",level:3},{value:"Description",id:"description",level:3},{value:"Example",id:"example",level:3},{value:"Keywords",id:"keywords",level:3},{value:"Best Practice",id:"best-practice",level:3}];function d(e){let n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,t.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"alter-table-column",children:"ALTER-TABLE-COLUMN"}),"\n",(0,i.jsx)(n.h3,{id:"name",children:"Name"}),"\n",(0,i.jsx)(n.p,{children:"ALTER TABLE COLUMN"}),"\n",(0,i.jsx)(n.h3,{id:"description",children:"Description"}),"\n",(0,i.jsxs)(n.p,{children:["This statement is used to perform a schema change operation on an existing table. The schema change is asynchronous, and the task is returned when the task is submitted successfully. After that, you can use the ",(0,i.jsx)(n.a,{href:"/docs/2.0/sql-manual/sql-reference/Show-Statements/SHOW-ALTER",children:"SHOW ALTER TABLE COLUMN"})," command to view the progress."]}),"\n",(0,i.jsx)(n.p,{children:"grammar:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"ALTER TABLE [database.]table alter_clause;\n"})}),"\n",(0,i.jsx)(n.p,{children:"The alter_clause of schema change supports the following modification methods:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Add a column to the specified position at the specified index"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"grammar:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:'ADD COLUMN column_name column_type [KEY | agg_type] [DEFAULT "default_value"]\n[AFTER column_name|FIRST]\n[TO rollup_index_name]\n[PROPERTIES ("key"="value", ...)]\n'})}),"\n",(0,i.jsx)(n.p,{children:"Notice:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"If you add a value column to the aggregation model, you need to specify agg_type"}),"\n",(0,i.jsx)(n.li,{children:"For non-aggregated models (such as DUPLICATE KEY), if you add a key column, you need to specify the KEY keyword"}),"\n",(0,i.jsx)(n.li,{children:"You cannot add columns that already exist in the base index to the rollup index (you can recreate a rollup index if necessary)"}),"\n"]}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsx)(n.li,{children:"Add multiple columns to the specified index"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"grammar:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:'ADD COLUMN (column_name1 column_type [KEY | agg_type] DEFAULT "default_value", ...)\n[TO rollup_index_name]\n[PROPERTIES ("key"="value", ...)]\n'})}),"\n",(0,i.jsx)(n.p,{children:"Notice:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"If you add a value column to the aggregation model, you need to specify agg_type"}),"\n",(0,i.jsx)(n.li,{children:"If you add a key column to the aggregation model, you need to specify the KEY keyword"}),"\n",(0,i.jsx)(n.li,{children:"You cannot add columns that already exist in the base index to the rollup index (you can recreate a rollup index if necessary)"}),"\n"]}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsx)(n.li,{children:"Delete a column from the specified index"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"grammar:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"DROP COLUMN column_name\n[FROM rollup_index_name]\n"})}),"\n",(0,i.jsx)(n.p,{children:"Notice:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Cannot drop partition column"}),"\n",(0,i.jsx)(n.li,{children:"If the column is removed from the base index, it will also be removed if it is included in the rollup index"}),"\n"]}),"\n",(0,i.jsxs)(n.ol,{start:"4",children:["\n",(0,i.jsx)(n.li,{children:"Modify the column type and column position of the specified index"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"grammar:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:'MODIFY COLUMN column_name column_type [KEY | agg_type] [NULL | NOT NULL] [DEFAULT "default_value"]\n[AFTER column_name|FIRST]\n[FROM rollup_index_name]\n[PROPERTIES ("key"="value", ...)]\n'})}),"\n",(0,i.jsx)(n.p,{children:"Notice:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"If you modify the value column in the aggregation model, you need to specify agg_type"}),"\n",(0,i.jsx)(n.li,{children:"If you modify the key column for non-aggregate types, you need to specify the KEY keyword"}),"\n",(0,i.jsx)(n.li,{children:"Only the type of the column can be modified, and other attributes of the column remain as they are (that is, other attributes need to be explicitly written in the statement according to the original attributes, see example 8)"}),"\n",(0,i.jsx)(n.li,{children:"Partitioning and bucketing columns cannot be modified in any way"}),"\n",(0,i.jsxs)(n.li,{children:["The following types of conversions are currently supported (loss of precision is guaranteed by the user)\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Conversion of TINYINT/SMALLINT/INT/BIGINT/LARGEINT/FLOAT/DOUBLE types to larger numeric types"}),"\n",(0,i.jsx)(n.li,{children:"Convert TINTINT/SMALLINT/INT/BIGINT/LARGEINT/FLOAT/DOUBLE/DECIMAL to VARCHAR"}),"\n",(0,i.jsx)(n.li,{children:"VARCHAR supports modifying the maximum length"}),"\n",(0,i.jsx)(n.li,{children:"VARCHAR/CHAR converted to TINTINT/SMALLINT/INT/BIGINT/LARGEINT/FLOAT/DOUBLE"}),"\n",(0,i.jsx)(n.li,{children:'Convert VARCHAR/CHAR to DATE (currently supports "%Y-%m-%d", "%y-%m-%d", "%Y%m%d", "%y%m%d", "%Y/%m/%d, "%y/%m/%d" six formats)'}),"\n",(0,i.jsxs)(n.li,{children:["Convert DATETIME to DATE (only keep year-month-day information, for example: ",(0,i.jsx)(n.code,{children:"2019-12-09 21:47:05"})," <--\x3e ",(0,i.jsx)(n.code,{children:"2019-12-09"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:["DATE is converted to DATETIME (hours, minutes and seconds are automatically filled with zeros, for example: ",(0,i.jsx)(n.code,{children:"2019-12-09"})," <--\x3e ",(0,i.jsx)(n.code,{children:"2019-12-09 00:00:00"}),")"]}),"\n",(0,i.jsx)(n.li,{children:"Convert FLOAT to DOUBLE"}),"\n",(0,i.jsx)(n.li,{children:"INT is converted to DATE (if the INT type data is illegal, the conversion fails, and the original data remains unchanged)"}),"\n",(0,i.jsx)(n.li,{children:"All can be converted to STRING except DATE and DATETIME, but STRING cannot be converted to any other type"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.ol,{start:"5",children:["\n",(0,i.jsx)(n.li,{children:"Reorder the column at the specified index"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"grammar:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:'ORDER BY (column_name1, column_name2, ...)\n[FROM rollup_index_name]\n[PROPERTIES ("key"="value", ...)]\n'})}),"\n",(0,i.jsx)(n.p,{children:"Notice:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"All columns in index are written out"}),"\n",(0,i.jsx)(n.li,{children:"the value column comes after the key column"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"example",children:"Example"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Add a key column new_col after col1 of example_rollup_index (non-aggregated model)"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:'ALTER TABLE example_db.my_table\nADD COLUMN new_col INT KEY DEFAULT "0" AFTER col1\nTO example_rollup_index;\n'})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsx)(n.li,{children:"Add a value column new_col after col1 of example_rollup_index (non-aggregation model)"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:'ALTER TABLE example_db.my_table\nADD COLUMN new_col INT DEFAULT "0" AFTER col1\nTO example_rollup_index;\n'})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsx)(n.li,{children:"Add a key column new_col (aggregation model) after col1 of example_rollup_index"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:'ALTER TABLE example_db.my_table\nADD COLUMN new_col INT DEFAULT "0" AFTER col1\nTO example_rollup_index;\n'})}),"\n",(0,i.jsxs)(n.ol,{start:"4",children:["\n",(0,i.jsx)(n.li,{children:"Add a value column new_col SUM aggregation type (aggregation model) after col1 of example_rollup_index"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:'ALTER TABLE example_db.my_table\nADD COLUMN new_col INT SUM DEFAULT "0" AFTER col1\nTO example_rollup_index;\n'})}),"\n",(0,i.jsxs)(n.ol,{start:"5",children:["\n",(0,i.jsx)(n.li,{children:"Add multiple columns to example_rollup_index (aggregation model)"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:'ALTER TABLE example_db.my_table\nADD COLUMN (col1 INT DEFAULT "1", col2 FLOAT SUM DEFAULT "2.3")\nTO example_rollup_index;\n'})}),"\n",(0,i.jsxs)(n.ol,{start:"6",children:["\n",(0,i.jsx)(n.li,{children:"Remove a column from example_rollup_index"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"ALTER TABLE example_db.my_table\nDROP COLUMN col2\nFROM example_rollup_index;\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"7",children:["\n",(0,i.jsx)(n.li,{children:"Modify the type of the key column col1 of the base index to BIGINT and move it to the back of the col2 column."}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:'ALTER TABLE example_db.my_table\nMODIFY COLUMN col1 BIGINT KEY DEFAULT "1" AFTER col2;\n'})}),"\n",(0,i.jsx)(n.p,{children:"Note: Whether you modify the key column or the value column, you need to declare complete column information"}),"\n",(0,i.jsxs)(n.ol,{start:"8",children:["\n",(0,i.jsx)(n.li,{children:'Modify the maximum length of the val1 column of base index. The original val1 is (val1 VARCHAR(32) REPLACE DEFAULT "abc")'}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:'ALTER TABLE example_db.my_table\nMODIFY COLUMN val1 VARCHAR(64) REPLACE DEFAULT "abc";\n'})}),"\n",(0,i.jsx)(n.p,{children:"Note: You can only modify the column's data type; other attributes of the column must remain unchanged."}),"\n",(0,i.jsxs)(n.ol,{start:"9",children:["\n",(0,i.jsx)(n.li,{children:"Reorder the columns in example_rollup_index (set the original column order as: k1,k2,k3,v1,v2)"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"ALTER TABLE example_db.my_table\nORDER BY (k3,k1,k2,v2,v1)\nFROM example_rollup_index;\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"10",children:["\n",(0,i.jsx)(n.li,{children:"Do Two Actions Simultaneously"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:'ALTER TABLE example_db.my_table\nADD COLUMN v2 INT MAX DEFAULT "0" AFTER k2 TO example_rollup_index,\nORDER BY (k3,k1,k2,v2,v1) FROM example_rollup_index;\n'})}),"\n",(0,i.jsxs)(n.ol,{start:"11",children:["\n",(0,i.jsx)(n.li,{children:"Modify the length of a field in the Key column of the Duplicate key table"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"alter table example_tbl modify column k3 varchar(50) key null comment 'to 50'\n"})}),"\n",(0,i.jsx)(n.h3,{id:"keywords",children:"Keywords"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"ALTER, TABLE, COLUMN, ALTER TABLE\n"})}),"\n",(0,i.jsx)(n.h3,{id:"best-practice",children:"Best Practice"})]})}function m(e={}){let{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},250065:function(e,n,l){l.d(n,{Z:function(){return s},a:function(){return o}});var a=l(667294);let i={},t=a.createContext(i);function o(e){let n=a.useContext(t);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),a.createElement(t.Provider,{value:n},e.children)}}}]);