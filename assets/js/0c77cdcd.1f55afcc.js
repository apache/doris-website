"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["814709"],{547422:function(e,n,t){t.r(n),t.d(n,{default:()=>h,frontMatter:()=>l,metadata:()=>s,assets:()=>a,toc:()=>d,contentTitle:()=>o});var s=JSON.parse('{"id":"compute-storage-decoupled/compilation-and-deployment","title":"Compilation and Deployment","description":"This document details the compilation and deployment process of Doris in a decoupled storage-compute model,","source":"@site/docs/compute-storage-decoupled/compilation-and-deployment.md","sourceDirName":"compute-storage-decoupled","slug":"/compute-storage-decoupled/compilation-and-deployment","permalink":"/docs/dev/compute-storage-decoupled/compilation-and-deployment","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1770477659000,"frontMatter":{"title":"Compilation and Deployment","language":"en","description":"This document details the compilation and deployment process of Doris in a decoupled storage-compute model,"},"sidebar":"docs","previous":{"title":"Doris Compute-Storage Decoupled Deployment Preparation","permalink":"/docs/dev/compute-storage-decoupled/before-deployment"},"next":{"title":"Managing Storage Vault","permalink":"/docs/dev/compute-storage-decoupled/managing-storage-vault"}}'),i=t("785893"),r=t("250065");let l={title:"Compilation and Deployment",language:"en",description:"This document details the compilation and deployment process of Doris in a decoupled storage-compute model,"},o=void 0,a={},d=[{value:"1. Overview",id:"1-overview",level:2},{value:"2. Obtaining Binaries",id:"2-obtaining-binaries",level:2},{value:"2.1 Direct Download",id:"21-direct-download",level:3},{value:"2.2 Compilation Output (Optional)",id:"22-compilation-output-optional",level:3},{value:"3. Meta Service Deployment",id:"3-meta-service-deployment",level:2},{value:"3.1 Configuration",id:"31-configuration",level:3},{value:"3.2 Start and Stop",id:"32-start-and-stop",level:3},{value:"4. Independent Deployment of Data Recycling Function (Optional)",id:"4-independent-deployment-of-data-recycling-function-optional",level:2},{value:"5. Startup Process for FE and BE",id:"5-startup-process-for-fe-and-be",level:2},{value:"5.1 Startup Order",id:"51-startup-order",level:3},{value:"5.2 Start the MASTER Role FE",id:"52-start-the-master-role-fe",level:3},{value:"5.2.1 Configure fe.conf",id:"521-configure-feconf",level:4},{value:"5.2.2 Start FE",id:"522-start-fe",level:4},{value:"5.3 Add Other FE Nodes",id:"53-add-other-fe-nodes",level:3},{value:"5.4 Add BE Nodes",id:"54-add-be-nodes",level:3},{value:"5.4.1 Configure be.conf",id:"541-configure-beconf",level:4},{value:"5.4.1 Start and Add BE",id:"541-start-and-add-be",level:4},{value:"6. Create Storage Vault",id:"6-create-storage-vault",level:2},{value:"6.1 Create HDFS Storage Vault",id:"61-create-hdfs-storage-vault",level:3},{value:"6.2 Create S3 Storage Vault",id:"62-create-s3-storage-vault",level:3},{value:"6.3 Set Default Storage Vault",id:"63-set-default-storage-vault",level:3},{value:"7. Notes",id:"7-notes",level:2}];function c(e){let n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"1-overview",children:"1. Overview"}),"\n",(0,i.jsx)(n.p,{children:"This document details the compilation and deployment process of Doris in a decoupled storage-compute model, highlighting the differences from the integrated storage-compute model, especially the compilation, configuration, and management of the newly added Meta Service (MS) module."}),"\n",(0,i.jsx)(n.h2,{id:"2-obtaining-binaries",children:"2. Obtaining Binaries"}),"\n",(0,i.jsx)(n.h3,{id:"21-direct-download",children:"2.1 Direct Download"}),"\n",(0,i.jsxs)(n.p,{children:["Compiled binaries (including all Doris modules) can be obtained from the ",(0,i.jsx)(n.a,{href:"https://doris.apache.org/download/",children:"Doris Download Page"})," (select version 3.0.2 or higher)."]}),"\n",(0,i.jsx)(n.h3,{id:"22-compilation-output-optional",children:"2.2 Compilation Output (Optional)"}),"\n",(0,i.jsxs)(n.p,{children:["Compile using the ",(0,i.jsx)(n.code,{children:"build.sh"})," script provided in the codebase. The new MS module is compiled with the ",(0,i.jsx)(n.code,{children:"--cloud"})," parameter."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"sh build.sh --fe --be --cloud \n"})}),"\n",(0,i.jsxs)(n.p,{children:["After compilation, a new ",(0,i.jsx)(n.code,{children:"ms"})," directory will be added in the ",(0,i.jsx)(n.code,{children:"output"})," directory:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"output\n\u251C\u2500\u2500 be\n\u251C\u2500\u2500 fe\n\u2514\u2500\u2500 ms\n    \u251C\u2500\u2500 bin\n    \u251C\u2500\u2500 conf\n    \u2514\u2500\u2500 lib\n"})}),"\n",(0,i.jsx)(n.h2,{id:"3-meta-service-deployment",children:"3. Meta Service Deployment"}),"\n",(0,i.jsx)(n.h3,{id:"31-configuration",children:"3.1 Configuration"}),"\n",(0,i.jsxs)(n.p,{children:["In the ",(0,i.jsx)(n.code,{children:"./conf/doris_cloud.conf"})," file, you mainly need to modify the following two parameters:"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"brpc_listen_port"}),": The listening port for the Meta Service, default is 5000."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"fdb_cluster"}),": Connection information for the FoundationDB cluster, which can be obtained when deploying FoundationDB. (If using the ",(0,i.jsx)(n.code,{children:"fdb_ctl.sh"})," provided by Doris for deployment, this value can be found in the ",(0,i.jsx)(n.code,{children:"$FDB_HOME/conf/fdb.cluster"})," file.)"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Example configuration:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-Shell",children:"brpc_listen_port = 5000\nfdb_cluster = xxx:yyy@127.0.0.1:4500\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Note: The value of ",(0,i.jsx)(n.code,{children:"fdb_cluster"})," should match the content of the ",(0,i.jsx)(n.code,{children:"/etc/foundationdb/fdb.cluster"})," file on the FoundationDB deployment machine. (If using the ",(0,i.jsx)(n.code,{children:"fdb_ctl.sh"})," provided by Doris for deployment, this value can be found in the ",(0,i.jsx)(n.code,{children:"$FDB_HOME/conf/fdb.cluster"})," file.)"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example: The last line of the file is the value to fill in the doris_cloud.conf for the fdb_cluster field"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"cat /etc/foundationdb/fdb.cluster\n\n# DO NOT EDIT!\n# This file is auto-generated, it is not to be edited by hand.\ncloud_ssb:A83c8Y1S3ZbqHLL4P4HHNTTw0A83CuHj@127.0.0.1:4500\n"})}),"\n",(0,i.jsx)(n.h3,{id:"32-start-and-stop",children:"3.2 Start and Stop"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Environment Requirements"})}),"\n",(0,i.jsxs)(n.p,{children:["Ensure that the ",(0,i.jsx)(n.code,{children:"JAVA_HOME"})," environment variable is correctly set to point to OpenJDK 17, and navigate to the ",(0,i.jsx)(n.code,{children:"ms"})," directory."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Start Command"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-Shell",children:"export JAVA_HOME=${path_to_jdk_17}\nbin/start.sh --daemon\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"LIBHDFS3_CONF=\nstarts doris_cloud with args: --meta-service\nwait and check doris_cloud start successfully\nsuccessfully started brpc listening on port=5000 time_elapsed_ms=11\ndoris_cloud start successfully\n"})}),"\n",(0,i.jsx)(n.p,{children:"The startup script returns a value of 0 to indicate that the startup was successful; otherwise, the startup fails."}),"\n",(0,i.jsxs)(n.admonition,{type:"info",children:[(0,i.jsx)(n.p,{children:"In 3.0.4, the startup script will output more information:"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:'2024-12-26 15:31:53 start with args: --meta-service\nwait and check MetaService and Recycler start successfully\nprocess working directory: "/mnt/disk1/doris/ms"\npid=1666015 written to file=./bin/doris_cloud.pid\nversion:{doris-3.0.4-release} code_version:{commit=fd44740fadabebfedb5da201d7ce427a5dd47c44 time=2025-01-16 18:53:00 +0800} build_info: ...\n\nMetaService has been started successfully\nsuccessfully started service listening on port=5000 time_elapsed_ms=19\n'})})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Stop Command"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"bin/stop.sh\n"})}),"\n",(0,i.jsx)(n.p,{children:"For production environment, please ensure that the total number of Meta Service is at least three."}),"\n",(0,i.jsx)(n.h2,{id:"4-independent-deployment-of-data-recycling-function-optional",children:"4. Independent Deployment of Data Recycling Function (Optional)"}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsx)(n.p,{children:"The Meta Service itself has metadata management and recycling functions, which can be deployed independently. If you want to deploy them independently, you can refer to this section."})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Preparation Work"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Create a new working directory (e.g., ",(0,i.jsx)(n.code,{children:"recycler"}),")."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Copy the contents of the ",(0,i.jsx)(n.code,{children:"ms"})," directory to the new directory:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"cp -r ms recycler\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Configuration"})}),"\n",(0,i.jsxs)(n.p,{children:["Modify the BRPC listening port ",(0,i.jsx)(n.code,{children:"brpc_listen_port"})," and the value of ",(0,i.jsx)(n.code,{children:"fdb_cluster"})," in the configuration file of the new directory."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Start Data Recycling Function"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-Shell",children:"export JAVA_HOME=${path_to_jdk_17}\nbin/start.sh --recycler --daemon\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Start Only Metadata Operation Function"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-Shell",children:"export JAVA_HOME=${path_to_jdk_17}\nbin/start.sh --meta-service --daemon\n"})}),"\n",(0,i.jsx)(n.h2,{id:"5-startup-process-for-fe-and-be",children:"5. Startup Process for FE and BE"}),"\n",(0,i.jsx)(n.p,{children:"This section details the steps to start FE (Frontend) and BE (Backend) in a decoupled storage-compute architecture."}),"\n",(0,i.jsx)(n.h3,{id:"51-startup-order",children:"5.1 Startup Order"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Start the first FE instance with the MASTER role."}),"\n",(0,i.jsx)(n.li,{children:"Add other FE and BE instances to the cluster."}),"\n",(0,i.jsx)(n.li,{children:"Add the first Storage Vault."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"52-start-the-master-role-fe",children:"5.2 Start the MASTER Role FE"}),"\n",(0,i.jsx)(n.h4,{id:"521-configure-feconf",children:"5.2.1 Configure fe.conf"}),"\n",(0,i.jsxs)(n.p,{children:["In the ",(0,i.jsx)(n.code,{children:"fe.conf"})," file, the following key parameters need to be configured:"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"deploy_mode"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Description: Specifies the Doris startup mode."}),"\n",(0,i.jsxs)(n.li,{children:["Format: ",(0,i.jsx)(n.code,{children:"cloud"})," indicates the decoupled storage-compute mode; others indicate the integrated storage-compute mode."]}),"\n",(0,i.jsxs)(n.li,{children:["Example: ",(0,i.jsx)(n.code,{children:"cloud"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"cluster_id"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Description: A unique identifier for the cluster in the decoupled storage-compute architecture. Each cluster must have a distinct cluster_id to avoid conflicts."}),"\n",(0,i.jsx)(n.li,{children:"Format: Integer (int type)."}),"\n",(0,i.jsxs)(n.li,{children:["Example: A random ",(0,i.jsx)(n.code,{children:"cluster_id"})," can be generated using the following shell command.\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"echo $(($((RANDOM << 15)) | $RANDOM))\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"caution",children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Each cluster must have a distinct cluster_id to avoid conflicts"})})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"meta_service_endpoint"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Description: The address and port of the Meta Service."}),"\n",(0,i.jsxs)(n.li,{children:["Format: ",(0,i.jsx)(n.code,{children:"IP address:port number"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Example: ",(0,i.jsx)(n.code,{children:"127.0.0.1:5000"}),", multiple meta services can be configured separated by commas."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"522-start-fe",children:"5.2.2 Start FE"}),"\n",(0,i.jsx)(n.p,{children:"Example start command:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"bin/start_fe.sh --daemon\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The first FE process initializes the cluster and operates in the FOLLOWER role. Use a MySQL client to connect to the FE and use ",(0,i.jsx)(n.code,{children:"show frontends"})," to confirm that the recently started FE is the master."]}),"\n",(0,i.jsx)(n.h3,{id:"53-add-other-fe-nodes",children:"5.3 Add Other FE Nodes"}),"\n",(0,i.jsx)(n.p,{children:"Other nodes should also modify the configuration file and start according to the above steps. Use a MySQL client to connect to the FE with the MASTER role and use the following SQL command to add additional FE nodes:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:'ALTER SYSTEM ADD FOLLOWER "host:port";\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Replace ",(0,i.jsx)(n.code,{children:"host:port"})," with the actual address and editlog port of the FE node. More information refer to ",(0,i.jsx)(n.a,{href:"../sql-manual/sql-statements/cluster-management/instance-management/ADD-FOLLOWER",children:"ADD FOLLOWER"})," and ",(0,i.jsx)(n.a,{href:"../sql-manual/sql-statements/cluster-management/instance-management/ADD-OBSERVER",children:"ADD OBSERVER"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"For production environment, please ensure that the total number of Frontend (FE) nodes in the FOLLOWER role, including the first FE, remains an odd number. In general, three FOLLOWERS are sufficient. Frontend nodes in the OBSERVER role can be any number."}),"\n",(0,i.jsx)(n.h3,{id:"54-add-be-nodes",children:"5.4 Add BE Nodes"}),"\n",(0,i.jsx)(n.p,{children:"To add Backend nodes to the cluster, perform the following steps for each Backend:"}),"\n",(0,i.jsx)(n.h4,{id:"541-configure-beconf",children:"5.4.1 Configure be.conf"}),"\n",(0,i.jsxs)(n.p,{children:["In the ",(0,i.jsx)(n.code,{children:"be.conf"})," file, the following key parameters need to be configured:"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"deploy_mode"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Description: Specifies the Doris startup mode."}),"\n",(0,i.jsxs)(n.li,{children:["Format: ",(0,i.jsx)(n.code,{children:"cloud"})," indicates the decoupled storage-compute mode; others indicate the integrated storage-compute mode."]}),"\n",(0,i.jsxs)(n.li,{children:["Example: ",(0,i.jsx)(n.code,{children:"cloud"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"file_cache_path"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Description: The disk paths and other parameters used for file cache, represented as an array, with one entry for each disk. The ",(0,i.jsx)(n.code,{children:"path"})," specifies the disk path, and ",(0,i.jsx)(n.code,{children:"total_size"})," limits the size of the cache; -1 or 0 will use the entire disk space."]}),"\n",(0,i.jsx)(n.li,{children:'format: [{"path":"/path/to/file_cache","total_size":21474836480},{"path":"/path/to/file_cache2","total_size":21474836480}]'}),"\n",(0,i.jsx)(n.li,{children:'Example: [{"path":"/path/to/file_cache","total_size":21474836480},{"path":"/path/to/file_cache2","total_size":21474836480}]'}),"\n",(0,i.jsx)(n.li,{children:'Default: [{"path":"${DORIS_HOME}/file_cache"}]'}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"541-start-and-add-be",children:"5.4.1 Start and Add BE"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Start the Backend:"}),"\n",(0,i.jsx)(n.p,{children:"Use the following command to start the Backend:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"bin/start_be.sh --daemon\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Add the Backend to the cluster:"}),"\n",(0,i.jsx)(n.p,{children:"Connect to any Frontend using a MySQL client and execute:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:'ALTER SYSTEM ADD BACKEND "<ip>:<heartbeat_service_port>" [PROPERTIES properties];\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Replace ",(0,i.jsx)(n.code,{children:"<ip>"})," with the IP address of the new Backend and ",(0,i.jsx)(n.code,{children:"<heartbeat_service_port>"})," with its configured heartbeat service port (default is 9050)."]}),"\n",(0,i.jsx)(n.p,{children:"You can set the computing group for the BE using PROPERTIES."}),"\n",(0,i.jsxs)(n.p,{children:["For more detailed usage, please refer to ",(0,i.jsx)(n.a,{href:"../sql-manual/sql-statements/cluster-management/instance-management/ADD-BACKEND",children:"ADD BACKEND"})," and ",(0,i.jsx)(n.a,{href:"../sql-manual/sql-statements/cluster-management/instance-management/DROP-BACKEND",children:"REMOVE BACKEND"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Verify Backend Status:"}),"\n",(0,i.jsxs)(n.p,{children:["Check the Backend log file (",(0,i.jsx)(n.code,{children:"be.log"}),") to ensure it has successfully started and joined the cluster."]}),"\n",(0,i.jsx)(n.p,{children:"You can also use the following SQL command to check the Backend status:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"SHOW BACKENDS;\n"})}),"\n",(0,i.jsx)(n.p,{children:"This will display all Backends in the cluster and their current status."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"6-create-storage-vault",children:"6. Create Storage Vault"}),"\n",(0,i.jsx)(n.p,{children:"Storage Vault is an important component in the Doris decoupled storage and computing architecture. They represent a shared storage layer for storing data. You can create one or more Storage Vaults using HDFS or S3-compatible object storage. One Storage Vault can be set as the default Storage Vault, and system tables and tables without a specified Storage Vault will be stored in this default Storage Vault. The default Storage Vault cannot be deleted. Here are the methods to create a Storage Vault for your Doris cluster:"}),"\n",(0,i.jsx)(n.h3,{id:"61-create-hdfs-storage-vault",children:"6.1 Create HDFS Storage Vault"}),"\n",(0,i.jsx)(n.p,{children:"To create a Storage Vault using SQL, connect to your Doris cluster using a MySQL client."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:'CREATE STORAGE VAULT IF NOT EXISTS hdfs_vault\n    PROPERTIES (\n    "type"="hdfs",\n    "fs.defaultFS"="hdfs://127.0.0.1:8020"\n    );\n'})}),"\n",(0,i.jsx)(n.h3,{id:"62-create-s3-storage-vault",children:"6.2 Create S3 Storage Vault"}),"\n",(0,i.jsx)(n.p,{children:"To create a Storage Vault using S3-compatible object storage, follow these steps:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Connect to your Doris cluster using a MySQL client."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Execute the following SQL command to create an S3 Storage Vault:"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:'CREATE STORAGE VAULT IF NOT EXISTS s3_vault\n    PROPERTIES (\n    "type"="S3",\n    "s3.endpoint"="s3.us-east-1.amazonaws.com",\n    "s3.access_key" = "ak",\n    "s3.secret_key" = "sk",\n    "s3.region" = "us-east-1",\n    "s3.root.path" = "ssb_sf1_p2_s3",\n    "s3.bucket" = "doris-build-1308700295",\n    "provider" = "S3"\n    );\n'})}),"\n",(0,i.jsxs)(n.p,{children:["To create a Storage Vault on other object storage, please refer to ",(0,i.jsx)(n.a,{href:"../sql-manual/sql-statements/cluster-management/storage-management/CREATE-STORAGE-VAULT",children:"Create Storage Vault"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"63-set-default-storage-vault",children:"6.3 Set Default Storage Vault"}),"\n",(0,i.jsx)(n.p,{children:"Use the following SQL statement to set a default Storage Vault."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"SET <storage_vault_name> AS DEFAULT STORAGE VAULT\n"})}),"\n",(0,i.jsx)(n.h2,{id:"7-notes",children:"7. Notes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Only the Meta Service process for metadata operations should be configured as the ",(0,i.jsx)(n.code,{children:"meta_service_endpoint"})," target for FE and BE."]}),"\n",(0,i.jsxs)(n.li,{children:["The data recycling function process should not be configured as the ",(0,i.jsx)(n.code,{children:"meta_service_endpoint"})," target."]}),"\n"]})]})}function h(e={}){let{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},250065:function(e,n,t){t.d(n,{Z:function(){return o},a:function(){return l}});var s=t(667294);let i={},r=s.createContext(i);function l(e){let n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);