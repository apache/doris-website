"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["419549"],{518194:function(e,a,t){t.r(a),t.d(a,{default:()=>h,frontMatter:()=>l,metadata:()=>n,assets:()=>o,toc:()=>c,contentTitle:()=>r});var n=JSON.parse('{"id":"lakehouse/catalog-overview","title":"Data Catalog Overview","description":"A Data Catalog is used to describe the attributes of a data source.","source":"@site/versioned_docs/version-2.1/lakehouse/catalog-overview.md","sourceDirName":"lakehouse","slug":"/lakehouse/catalog-overview","permalink":"/docs/2.1/lakehouse/catalog-overview","draft":false,"unlisted":false,"tags":[],"version":"2.1","frontMatter":{"title":"Data Catalog Overview","language":"en"},"sidebar":"docs","previous":{"title":"Lakehouse Overview","permalink":"/docs/2.1/lakehouse/lakehouse-overview"},"next":{"title":"Hive Catalog","permalink":"/docs/2.1/lakehouse/catalogs/hive-catalog"}}'),s=t("785893"),i=t("250065");let l={title:"Data Catalog Overview",language:"en"},r=void 0,o={},c=[{value:"Creating Catalog",id:"creating-catalog",level:2},{value:"Common Properties",id:"common-properties",level:3},{value:"Column Type Mapping",id:"column-type-mapping",level:3},{value:"Nullable Attribute",id:"nullable-attribute",level:3},{value:"Using Catalog",id:"using-catalog",level:2},{value:"Viewing Catalog",id:"viewing-catalog",level:3},{value:"Switching Catalog",id:"switching-catalog",level:3},{value:"Default Catalog",id:"default-catalog",level:3},{value:"Simple Query",id:"simple-query",level:3},{value:"Cross-Catalog Query",id:"cross-catalog-query",level:3},{value:"Data Import",id:"data-import",level:3},{value:"Data Write-Back",id:"data-write-back",level:3},{value:"Refreshing Catalog",id:"refreshing-catalog",level:2},{value:"Modifying Catalog",id:"modifying-catalog",level:2},{value:"Deleting Catalog",id:"deleting-catalog",level:2},{value:"Permission Management",id:"permission-management",level:2}];function d(e){let a={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.p,{children:"A Data Catalog is used to describe the attributes of a data source."}),"\n",(0,s.jsx)(a.p,{children:"In Doris, multiple catalogs can be created to point to different data sources (such as Hive, Iceberg, MySQL). Doris will automatically obtain the databases, tables, columns, partitions, data locations, etc. of the corresponding data sources through the catalogs. Users can access these catalogs for data analysis through standard SQL statements and can conduct join queries on the data from multiple catalogs."}),"\n",(0,s.jsx)(a.p,{children:"There are two types of catalogs in Doris:"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(a.table,{children:[(0,s.jsx)(a.thead,{children:(0,s.jsxs)(a.tr,{children:[(0,s.jsx)(a.th,{children:"Type"}),(0,s.jsx)(a.th,{children:"Description"})]})}),(0,s.jsxs)(a.tbody,{children:[(0,s.jsxs)(a.tr,{children:[(0,s.jsx)(a.td,{children:"Internal Catalog"}),(0,s.jsxs)(a.td,{children:["The built-in catalog, named ",(0,s.jsx)(a.code,{children:"internal"}),", used to store Doris internal table data. It cannot be created, modified, or deleted."]})]}),(0,s.jsxs)(a.tr,{children:[(0,s.jsx)(a.td,{children:"External Catalog"}),(0,s.jsx)(a.td,{children:"External catalogs refer to all catalogs other than the Internal Catalog. Users can create, modify, and delete external catalogs."})]})]})]}),"\n",(0,s.jsx)(a.p,{children:"Catalogs are mainly applicable to the following three scenarios, but different catalogs are suitable for different scenarios. For details, see the documentation for the corresponding catalog."}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(a.table,{children:[(0,s.jsx)(a.thead,{children:(0,s.jsxs)(a.tr,{children:[(0,s.jsx)(a.th,{children:"Scenario"}),(0,s.jsx)(a.th,{children:"Description"})]})}),(0,s.jsxs)(a.tbody,{children:[(0,s.jsxs)(a.tr,{children:[(0,s.jsx)(a.td,{children:"Query Acceleration"}),(0,s.jsx)(a.td,{children:"Direct query acceleration for data lakes such as Hive, Iceberg, Paimon, etc."})]}),(0,s.jsxs)(a.tr,{children:[(0,s.jsx)(a.td,{children:"Data Integration"}),(0,s.jsx)(a.td,{children:"ZeroETL solution, directly accessing different data sources to generate result data, or facilitating data flow between different data sources."})]}),(0,s.jsxs)(a.tr,{children:[(0,s.jsx)(a.td,{children:"Data Write-back"}),(0,s.jsx)(a.td,{children:"After data processing via Doris, write back to external data sources."})]})]})]}),"\n",(0,s.jsxs)(a.p,{children:["This document uses ",(0,s.jsx)(a.a,{href:"./catalogs/iceberg-catalog.md",children:"Iceberg Catalog"})," as an example to focus on the basic operations of catalogs. For detailed descriptions of different catalogs, please refer to the documentation of the corresponding catalog."]}),"\n",(0,s.jsx)(a.h2,{id:"creating-catalog",children:"Creating Catalog"}),"\n",(0,s.jsxs)(a.p,{children:["Create an Iceberg Catalog using the ",(0,s.jsx)(a.code,{children:"CREATE CATALOG"})," statement."]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-sql",children:"CREATE CATALOG iceberg_catalog PROPERTIES (\n    'type' = 'iceberg',\n    'iceberg.catalog.type' = 'hadoop',\n    'warehouse' = 's3://bucket/dir/key',\n    's3.endpoint' = 's3.us-east-1.amazonaws.com',\n    's3.access_key' = 'ak',\n    's3.secret_key' = 'sk'\n);\n"})}),"\n",(0,s.jsx)(a.p,{children:'Essentially, a catalog created in Doris acts as a "proxy" to access the metadata services (such as Hive Metastore) and storage services (such as HDFS/S3) of the corresponding data source. Doris only stores connection properties and other information of the catalog, not the actual metadata and data of the corresponding data source.'}),"\n",(0,s.jsx)(a.h3,{id:"common-properties",children:"Common Properties"}),"\n",(0,s.jsxs)(a.p,{children:["In addition to the set of properties specific to each catalog, here are the common properties for all catalogs ",(0,s.jsx)(a.code,{children:"{CommonProperties}"}),"."]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(a.table,{children:[(0,s.jsx)(a.thead,{children:(0,s.jsxs)(a.tr,{children:[(0,s.jsx)(a.th,{children:"Property Name"}),(0,s.jsx)(a.th,{children:"Description"}),(0,s.jsx)(a.th,{children:"Example"})]})}),(0,s.jsxs)(a.tbody,{children:[(0,s.jsxs)(a.tr,{children:[(0,s.jsx)(a.td,{children:(0,s.jsx)(a.code,{children:"include_database_list"})}),(0,s.jsxs)(a.td,{children:["Supports synchronizing only specified Databases, separated by ",(0,s.jsx)(a.code,{children:","}),". By default, all Databases are synchronized. Database names are case-sensitive. Use this parameter when there are many Databases in the external data source but only a few need to be accessed, to avoid synchronizing a large amount of metadata."]}),(0,s.jsx)(a.td,{children:(0,s.jsx)(a.code,{children:"'include_database_list' = 'db1,db2'"})})]}),(0,s.jsxs)(a.tr,{children:[(0,s.jsx)(a.td,{children:(0,s.jsx)(a.code,{children:"exclude_database_list"})}),(0,s.jsxs)(a.td,{children:["Supports specifying multiple Databases that do not need to be synchronized, separated by ",(0,s.jsx)(a.code,{children:","}),". By default, no filtering is applied, and all Databases are synchronized. Database names are case-sensitive. This is used in the same scenario as above, to exclude databases that do not need to be accessed. If there is a conflict, ",(0,s.jsx)(a.code,{children:"exclude"})," takes precedence over ",(0,s.jsx)(a.code,{children:"include"}),"."]}),(0,s.jsx)(a.td,{children:(0,s.jsx)(a.code,{children:"'exclude_database_list' = 'db1,db2'"})})]})]})]}),"\n",(0,s.jsx)(a.h3,{id:"column-type-mapping",children:"Column Type Mapping"}),"\n",(0,s.jsx)(a.p,{children:"After a user creates a catalog, Doris automatically synchronizes the databases, tables, and columns of the catalog. For column type mapping rules of different catalogs, please refer to the documentation of the corresponding catalog."}),"\n",(0,s.jsxs)(a.p,{children:["For external data types that cannot currently be mapped to Doris column types, such as ",(0,s.jsx)(a.code,{children:"UNION"}),", ",(0,s.jsx)(a.code,{children:"INTERVAL"}),", etc., Doris will map the column type to ",(0,s.jsx)(a.code,{children:"UNSUPPORTED"}),". For queries involving ",(0,s.jsx)(a.code,{children:"UNSUPPORTED"})," types, see the example below:"]}),"\n",(0,s.jsx)(a.p,{children:"Assume the synchronized table schema is:"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-text",children:"k1 INT,\nk2 INT,\nk3 UNSUPPORTED,\nk4 INT\n"})}),"\n",(0,s.jsx)(a.p,{children:"The query behavior is as follows:"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-sql",children:"SELECT * FROM table;                -- Error: Unsupported type 'UNSUPPORTED_TYPE' in 'k3'\nSELECT * EXCEPT(k3) FROM table;     -- Query OK.\nSELECT k1, k3 FROM table;           -- Error: Unsupported type 'UNSUPPORTED_TYPE' in 'k3'\nSELECT k1, k4 FROM table;           -- Query OK.\n"})}),"\n",(0,s.jsx)(a.h3,{id:"nullable-attribute",children:"Nullable Attribute"}),"\n",(0,s.jsx)(a.p,{children:"Doris currently has special restrictions on the Nullable attribute support for external table columns, with specific behaviors as follows:"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(a.table,{children:[(0,s.jsx)(a.thead,{children:(0,s.jsxs)(a.tr,{children:[(0,s.jsx)(a.th,{children:"Source Type"}),(0,s.jsx)(a.th,{children:"Doris Read Behavior"}),(0,s.jsx)(a.th,{children:"Doris Write Behavior"})]})}),(0,s.jsxs)(a.tbody,{children:[(0,s.jsxs)(a.tr,{children:[(0,s.jsx)(a.td,{children:"Nullable"}),(0,s.jsx)(a.td,{children:"Nullable"}),(0,s.jsx)(a.td,{children:"Allow writing Null values"})]}),(0,s.jsxs)(a.tr,{children:[(0,s.jsx)(a.td,{children:"Not Null"}),(0,s.jsx)(a.td,{children:"Nullable, i.e., still treated as columns that allow NULL during reading"}),(0,s.jsx)(a.td,{children:"Allow writing Null values, i.e., no strict checking for Null values. Users need to ensure data integrity and consistency themselves."})]})]})]}),"\n",(0,s.jsx)(a.h2,{id:"using-catalog",children:"Using Catalog"}),"\n",(0,s.jsx)(a.h3,{id:"viewing-catalog",children:"Viewing Catalog"}),"\n",(0,s.jsxs)(a.p,{children:["After creation, you can view the catalog using the ",(0,s.jsx)(a.code,{children:"SHOW CATALOGS"})," command:"]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-text",children:"mysql> SHOW CATALOGS;\n+-----------+-----------------+----------+-----------+-------------------------+---------------------+------------------------+\n| CatalogId | CatalogName     | Type     | IsCurrent | CreateTime              | LastUpdateTime      | Comment                |\n+-----------+-----------------+----------+-----------+-------------------------+---------------------+------------------------+\n|     10024 | iceberg_catalog | hms      | yes       | 2023-12-25 16:11:41.687 | 2023-12-25 20:43:18 | NULL                   |\n|         0 | internal        | internal |           | NULL                    | NULL                | Doris internal catalog |\n+-----------+-----------------+----------+-----------+-------------------------+---------------------+------------------------+\n"})}),"\n",(0,s.jsxs)(a.p,{children:["You can view the statement to create a catalog using ",(0,s.jsx)(a.a,{href:"../sql-manual/sql-statements/catalog/SHOW-CREATE-CATALOG",children:"SHOW CREATE CATALOG"}),"."]}),"\n",(0,s.jsx)(a.h3,{id:"switching-catalog",children:"Switching Catalog"}),"\n",(0,s.jsxs)(a.p,{children:["Doris provides the ",(0,s.jsx)(a.code,{children:"SWITCH"})," statement to switch the connection session context to the corresponding catalog. This is similar to using the ",(0,s.jsx)(a.code,{children:"USE"})," statement to switch databases."]}),"\n",(0,s.jsxs)(a.p,{children:["After switching to a catalog, you can use the ",(0,s.jsx)(a.code,{children:"USE"})," statement to continue switching to a specified database, or use ",(0,s.jsx)(a.code,{children:"SHOW DATABASES"})," to view the databases under the current catalog."]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-sql",children:"SWITCH iceberg_catalog;\n\nSHOW DATABASES;\n+--------------------+\n| Database           |\n+--------------------+\n| information_schema |\n| mysql              |\n| test               |\n| iceberg_db         |\n+--------------------+\n\nUSE iceberg_db;\n"})}),"\n",(0,s.jsxs)(a.p,{children:["You can also use the ",(0,s.jsx)(a.code,{children:"USE"})," statement with the fully qualified name ",(0,s.jsx)(a.code,{children:"catalog_name.database_name"})," to switch directly to a specified database within a specified catalog:"]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-sql",children:"USE iceberg_catalog.iceberg_db;\n"})}),"\n",(0,s.jsx)(a.p,{children:"Fully qualified names can also be used in MySQL command line or JDBC connection strings to be compatible with the MySQL connection protocol."}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-sql",children:"# Command line tool\nmysql -h host -P9030 -uroot -Diceberg_catalog.iceberg_db\n\n# JDBC url\njdbc:mysql://host:9030/iceberg_catalog.iceberg_db\n"})}),"\n",(0,s.jsxs)(a.p,{children:["The fixed name for the built-in catalog is ",(0,s.jsx)(a.code,{children:"internal"}),". The switching method is the same as for external catalogs."]}),"\n",(0,s.jsx)(a.h3,{id:"default-catalog",children:"Default Catalog"}),"\n",(0,s.jsxs)(a.p,{children:["The user attribute ",(0,s.jsx)(a.code,{children:"default_init_catalog"})," is used to set the default catalog for a specific user. Once set, when the specified user connects to Doris, they will automatically switch to the set catalog."]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-sql",children:"SET PROPERTY default_init_catalog=hive_catalog;\n"})}),"\n",(0,s.jsxs)(a.p,{children:["Note 1: If the catalog has been explicitly specified in the MySQL command line or JDBC connection strings, then the specified catalog will be used, and the ",(0,s.jsx)(a.code,{children:"default_init_catalog"})," user attribute will not take effect.\nNote 2: If the catalog set by the user attribute ",(0,s.jsx)(a.code,{children:"default_init_catalog"})," no longer exists, it will automatically switch to the default ",(0,s.jsx)(a.code,{children:"internal"})," catalog.\nNote 3: This feature takes effect starting from version v3.1.x."]}),"\n",(0,s.jsx)(a.h3,{id:"simple-query",children:"Simple Query"}),"\n",(0,s.jsx)(a.p,{children:"You can query tables in external catalogs using any SQL statement supported by Doris."}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-sql",children:"SELECT id, SUM(cost) FROM iceberg_db.table1\nGROUP BY id ORDER BY id;\n"})}),"\n",(0,s.jsx)(a.h3,{id:"cross-catalog-query",children:"Cross-Catalog Query"}),"\n",(0,s.jsx)(a.p,{children:"Doris supports join queries across different catalogs."}),"\n",(0,s.jsx)(a.p,{children:"Here, let's create another MySQL Catalog:"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-sql",children:"CREATE CATALOG mysql_catalog properties(\n    'type' = 'jdbc',\n    'user' = 'root',\n    'password' = '123456',\n    'jdbc_url' = 'jdbc:mysql://host:3306/mysql_db',\n    'driver_url' = 'mysql-connector-java-8.0.25.jar',\n    'driver_class' = 'com.mysql.cj.jdbc.Driver'\n);\n"})}),"\n",(0,s.jsx)(a.p,{children:"Then, perform a join query between Iceberg tables and MySQL tables using SQL:"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-sql",children:"SELECT * FROM FROM\niceberg_catalog.iceberg_db.table1 tbl1 JOIN mysql_catalog.mysql_db.dim_table tbl2\nON tbl1.id = tbl2.id;\n"})}),"\n",(0,s.jsx)(a.h3,{id:"data-import",children:"Data Import"}),"\n",(0,s.jsxs)(a.p,{children:["You can import data from a data source into Doris using the ",(0,s.jsx)(a.code,{children:"INSERT"})," command."]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-sql",children:"INSERT INTO internal.doris_db.tbl1\nSELECT * FROM iceberg_catalog.iceberg_db.table1;\n"})}),"\n",(0,s.jsxs)(a.p,{children:["You can also use the ",(0,s.jsx)(a.code,{children:"CTAS (Create Table As Select)"})," statement to create an internal Doris table from an external data source and import the data:"]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-sql",children:"CREATE TABLE internal.doris_db.tbl1\nPROPERTIES('replication_num' = '1')\nAS\nSELECT * FROM iceberg_catalog.iceberg_db.table1;\n"})}),"\n",(0,s.jsx)(a.h3,{id:"data-write-back",children:"Data Write-Back"}),"\n",(0,s.jsxs)(a.p,{children:["Doris supports writing data back to external data sources using the ",(0,s.jsx)(a.code,{children:"INSERT"})," statement. For more details, refer to:"]}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsx)(a.li,{children:(0,s.jsx)(a.a,{href:"./catalogs/hive-catalog.md",children:"Hive Catalog"})}),"\n",(0,s.jsx)(a.li,{children:(0,s.jsx)(a.a,{href:"./catalogs/iceberg-catalog.md",children:"Iceberg Catalog"})}),"\n",(0,s.jsx)(a.li,{children:(0,s.jsx)(a.a,{href:"/docs/2.1/lakehouse/catalogs/jdbc-catalog-overview",children:"JDBC Catalog"})}),"\n"]}),"\n",(0,s.jsx)(a.h2,{id:"refreshing-catalog",children:"Refreshing Catalog"}),"\n",(0,s.jsx)(a.p,{children:'Catalogs created in Doris act as "proxy" to access the metadata services of corresponding data sources. Doris caches some metadata to improve access performance and reduce frequent cross-network requests. However, the cache has a validity period, and without refreshing, you cannot access the latest metadata. Therefore, Doris provides several ways to refresh catalogs.'}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-sql",children:"-- Refresh catalog\nREFRESH CATALOG catalog_name;\n\n-- Refresh specified database\nREFRESH DATABASE catalog_name.db_name;\n\n-- Refresh specified table\nREFRESH TABLE catalog_name.db_name.table_name;\n"})}),"\n",(0,s.jsx)(a.p,{children:"Doris also supports disabling metadata caching to access the latest metadata in real-time."}),"\n",(0,s.jsxs)(a.p,{children:["For detailed information and configuration of metadata caching, please refer to: ",(0,s.jsx)(a.a,{href:"/docs/2.1/lakehouse/meta-cache",children:"Metadata Cache"})]}),"\n",(0,s.jsx)(a.h2,{id:"modifying-catalog",children:"Modifying Catalog"}),"\n",(0,s.jsxs)(a.p,{children:["You can modify the properties or name of a catalog using the ",(0,s.jsx)(a.code,{children:"ALTER CATALOG"})," statement:"]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-sql",children:"-- Rename a catalog\nALTER CATALOG iceberg_catalog RENAME iceberg_catalog2;\n\n-- Modify properties of a catalog\nALTER CATALOG iceberg_catalog SET PROPERTIES ('key1' = 'value1' [, 'key' = 'value2']); \n\n-- Modify the comment of a catalog\nALTER CATALOG iceberg_catalog MODIFY COMMENT 'my iceberg catalog';\n"})}),"\n",(0,s.jsx)(a.h2,{id:"deleting-catalog",children:"Deleting Catalog"}),"\n",(0,s.jsxs)(a.p,{children:["You can delete a specified external catalog using the ",(0,s.jsx)(a.code,{children:"DROP CATALOG"})," statement."]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-sql",children:"DROP CATALOG [IF EXISTS] iceberg_catalog;\n"})}),"\n",(0,s.jsx)(a.p,{children:"Deleting an external catalog from Doris does not remove the actual data; it only deletes the mapping relationship stored in Doris."}),"\n",(0,s.jsx)(a.h2,{id:"permission-management",children:"Permission Management"}),"\n",(0,s.jsxs)(a.p,{children:["The permission management for databases and tables in an external catalog is the same as for internal tables. For details, refer to the ",(0,s.jsx)(a.a,{href:"/docs/2.1/admin-manual/auth/authentication-and-authorization",children:"Authentication and Authorization"})," documentation."]})]})}function h(e={}){let{wrapper:a}={...(0,i.a)(),...e.components};return a?(0,s.jsx)(a,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},250065:function(e,a,t){t.d(a,{Z:function(){return r},a:function(){return l}});var n=t(667294);let s={},i=n.createContext(s);function l(e){let a=n.useContext(i);return n.useMemo(function(){return"function"==typeof e?e(a):{...a,...e}},[a,e])}function r(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),n.createElement(i.Provider,{value:a},e.children)}}}]);