"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["416739"],{631774:function(e,n,t){t.r(n),t.d(n,{default:()=>u,frontMatter:()=>r,metadata:()=>a,assets:()=>l,toc:()=>d,contentTitle:()=>o});var a=JSON.parse('{"id":"table-design/data-model/duplicate","title":"Duplicate Key Table","description":"The Duplicate Key Table in Doris is the default table type, designed to store individual raw data records.","source":"@site/versioned_docs/version-3.x/table-design/data-model/duplicate.md","sourceDirName":"table-design/data-model","slug":"/table-design/data-model/duplicate","permalink":"/docs/3.x/table-design/data-model/duplicate","draft":false,"unlisted":false,"tags":[],"version":"3.x","lastUpdatedAt":1770477659000,"frontMatter":{"title":"Duplicate Key Table","language":"en","description":"The Duplicate Key Table in Doris is the default table type, designed to store individual raw data records."},"sidebar":"docs","previous":{"title":"Table Type Overview","permalink":"/docs/3.x/table-design/data-model/overview"},"next":{"title":"Unique Key Table","permalink":"/docs/3.x/table-design/data-model/unique"}}'),i=t("785893"),s=t("250065");let r={title:"Duplicate Key Table",language:"en",description:"The Duplicate Key Table in Doris is the default table type, designed to store individual raw data records."},o=void 0,l={},d=[{value:"Use Cases",id:"use-cases",level:2},{value:"Table Creation Instructions",id:"table-creation-instructions",level:2},{value:"Data Insertion and Storage",id:"data-insertion-and-storage",level:2}];function c(e){let n={a:"a",code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.strong,{children:"Duplicate Key Table"})," in Doris is the default table type, designed to store individual raw data records. The ",(0,i.jsx)(n.code,{children:"Duplicate Key"})," specified during table creation determines the columns for sorting and storage, optimizing common queries. It is recommended to choose no more than three columns as the sort key. For more specific selection guidelines, refer to ",(0,i.jsx)(n.a,{href:"../index/prefix-index",children:"Sort Key"}),". The Duplicate Key Table has the following characteristics:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Preserving Raw Data"}),": The Duplicate Key Table retains all original data, making it ideal for storing and querying raw data. It is recommended for use cases requiring detailed data analysis to avoid data loss."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"No Deduplication or Aggregation"}),": Unlike the Aggregate and Primary Key tables, the Duplicate Key Table does not perform deduplication or aggregation, fully retaining identical records."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Flexible Data Querying"}),": The Duplicate Key Table retains all original data, enabling detailed extraction and aggregation across any dimension for metadata auditing and fine-grained analysis."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"use-cases",children:"Use Cases"}),"\n",(0,i.jsx)(n.p,{children:"In the Duplicate Key Table, data is generally only appended, and old data is not updated. The Duplicate Key Table is ideal for scenarios that require full raw data:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Log Storage"}),": Used for storing various types of application logs, such as access logs, error logs, etc. Each piece of data needs to be detailed for future auditing and analysis."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"User Behavior Data"}),": When analyzing user behavior, such as click data or user access paths, it is necessary to retain detailed user actions. This helps in building user profiles and conducting detailed analysis of behavior patterns."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Transaction Data"}),": For storing transaction or order data, once a transaction is completed, there is typically no need for data changes..."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"table-creation-instructions",children:"Table Creation Instructions"}),"\n",(0,i.jsxs)(n.p,{children:["When creating a table, the ",(0,i.jsx)(n.strong,{children:"DUPLICATE KEY"})," keyword can be used to specify the Duplicate Key Table. The Duplicate Key table must specify the Key columns, which are used to sort the data during storage. In the following example, the Duplicate Key table stores log information and sorts the data based on the ",(0,i.jsx)(n.code,{children:"log_time"}),", ",(0,i.jsx)(n.code,{children:"log_type"}),", and ",(0,i.jsx)(n.code,{children:"error_code"})," columns:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE IF NOT EXISTS example_tbl_duplicate\n(\n    log_time        DATETIME       NOT NULL,\n    log_type        INT            NOT NULL,\n    error_code      INT,\n    error_msg       VARCHAR(1024),\n    op_id           BIGINT,\n    op_time         DATETIME\n)\nDUPLICATE KEY(log_time, log_type, error_code)\nDISTRIBUTED BY HASH(log_type) BUCKETS 10;\n"})}),"\n",(0,i.jsx)(n.h2,{id:"data-insertion-and-storage",children:"Data Insertion and Storage"}),"\n",(0,i.jsx)(n.p,{children:"In a Duplicate Key table, data is not deduplicated or aggregated; inserting data directly stores it. The Key columns in the Duplicate Key Table are used for sorting."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"columnar_storage",src:t(345281).Z+"",width:"5508",height:"1576"})}),"\n",(0,i.jsx)(n.p,{children:"In the example above, after inserting 2 rows into the initial 4 rows, the data is appended, resulting in a total of 6 rows."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"-- 4 rows raw data\nINSERT INTO example_tbl_duplicate VALUES\n('2024-11-01 00:00:00', 2, 2, 'timeout', 12, '2024-11-01 01:00:00'),\n('2024-11-02 00:00:00', 1, 2, 'success', 13, '2024-11-02 01:00:00'),\n('2024-11-03 00:00:00', 2, 2, 'unknown', 13, '2024-11-03 01:00:00'),\n('2024-11-04 00:00:00', 2, 2, 'unknown', 12, '2024-11-04 01:00:00');\n\n-- insert into 2 rows\nINSERT INTO example_tbl_duplicate VALUES\n('2024-11-01 00:00:00', 2, 2, 'timeout', 12, '2024-11-01 01:00:00'),\n('2024-11-01 00:00:00', 2, 2, 'unknown', 13, '2024-11-01 01:00:00');\n\n-- check the rows of table\nSELECT * FROM example_tbl_duplicate;\n+---------------------+----------+------------+-----------+-------+---------------------+\n| log_time            | log_type | error_code | error_msg | op_id | op_time             |\n+---------------------+----------+------------+-----------+-------+---------------------+\n| 2024-11-02 00:00:00 |        1 |          2 | success   |    13 | 2024-11-02 01:00:00 |\n| 2024-11-01 00:00:00 |        2 |          2 | timeout   |    12 | 2024-11-01 01:00:00 |\n| 2024-11-03 00:00:00 |        2 |          2 | unknown   |    13 | 2024-11-03 01:00:00 |\n| 2024-11-04 00:00:00 |        2 |          2 | unknown   |    12 | 2024-11-04 01:00:00 |\n| 2024-11-01 00:00:00 |        2 |          2 | unknown   |    13 | 2024-11-01 01:00:00 |\n| 2024-11-01 00:00:00 |        2 |          2 | timeout   |    12 | 2024-11-01 01:00:00 |\n+---------------------+----------+------------+-----------+-------+---------------------+\n"})})]})}function u(e={}){let{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},345281:function(e,n,t){t.d(n,{Z:function(){return a}});let a=t.p+"assets/images/duplicate-table-insert-663b9ee1dbe7b93b28123e2eeb1c435d.png"},250065:function(e,n,t){t.d(n,{Z:function(){return o},a:function(){return r}});var a=t(667294);let i={},s=a.createContext(i);function r(e){let n=a.useContext(s);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);