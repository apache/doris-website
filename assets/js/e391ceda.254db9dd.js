"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["34358"],{823790:function(e,n,a){a.r(n),a.d(n,{default:()=>h,frontMatter:()=>i,metadata:()=>s,assets:()=>o,toc:()=>d,contentTitle:()=>r});var s=JSON.parse('{"id":"sql-manual/sql-functions/table-functions/explode-map","title":"EXPLODE_MAP","description":"The explodemap function takes a map (mapping type) and expands it into multiple rows, with each row containing a key-value pair.","source":"@site/versioned_docs/version-3.x/sql-manual/sql-functions/table-functions/explode-map.md","sourceDirName":"sql-manual/sql-functions/table-functions","slug":"/sql-manual/sql-functions/table-functions/explode-map","permalink":"/docs/3.x/sql-manual/sql-functions/table-functions/explode-map","draft":false,"unlisted":false,"tags":[],"version":"3.x","lastUpdatedAt":1770477659000,"frontMatter":{"title":"EXPLODE_MAP","language":"en","description":"The explodemap function takes a map (mapping type) and expands it into multiple rows, with each row containing a key-value pair."},"sidebar":"docs","previous":{"title":"EXPLODE_JSON_OBJECT","permalink":"/docs/3.x/sql-manual/sql-functions/table-functions/explode-json-object"},"next":{"title":"EXPLODE_NUMBERS","permalink":"/docs/3.x/sql-manual/sql-functions/table-functions/explode-numbers"}}'),l=a("785893"),t=a("250065");let i={title:"EXPLODE_MAP",language:"en",description:"The explodemap function takes a map (mapping type) and expands it into multiple rows, with each row containing a key-value pair."},r=void 0,o={},d=[{value:"Description",id:"description",level:2},{value:"Syntax",id:"syntax",level:2},{value:"Parameters",id:"parameters",level:2},{value:"Return Value",id:"return-value",level:2},{value:"Examples",id:"examples",level:2}];function c(e){let n={code:"code",h2:"h2",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,t.a)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.h2,{id:"description",children:"Description"}),"\n",(0,l.jsxs)(n.p,{children:["The ",(0,l.jsx)(n.code,{children:"explode_map"})," function takes a map (mapping type) and expands it into multiple rows, with each row containing a key-value pair. It is typically used in conjunction with LATERAL VIEW and can support multiple lateral views. It is supported only by the new optimizer."]}),"\n",(0,l.jsxs)(n.p,{children:["The main difference between ",(0,l.jsx)(n.code,{children:"explode_map"})," and ",(0,l.jsx)(n.code,{children:"explode_map_outer"})," lies in the handling of null values."]}),"\n",(0,l.jsx)(n.h2,{id:"syntax",children:"Syntax"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"EXPLODE_MAP(map<k,v>)\nEXPLODE_MAP_OUTER(map<k,v>)\n"})}),"\n",(0,l.jsx)(n.h2,{id:"parameters",children:"Parameters"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Parameter"}),(0,l.jsx)(n.th,{children:"Description"})]})}),(0,l.jsx)(n.tbody,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"map<k,v>"})}),(0,l.jsx)(n.td,{children:"map type"})]})})]}),"\n",(0,l.jsx)(n.h2,{id:"return-value",children:"Return Value"}),"\n",(0,l.jsxs)(n.p,{children:["When the map is not empty or NULL, the return values of ",(0,l.jsx)(n.code,{children:"explode_map"})," and ",(0,l.jsx)(n.code,{children:"explode_map_outer"})," are the same."]}),"\n",(0,l.jsx)(n.p,{children:"When the data is empty or NULL:"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"explode_map"})," Only processes non-empty map types. If the map is empty or NULL, ",(0,l.jsx)(n.code,{children:"explode_map"})," will not return any rows.\n",(0,l.jsx)(n.code,{children:"explode_map_outer"})," If the map is empty or NULL, explode_map_outer will retain the record with the empty or NULL map and return a row with NULL values."]}),"\n",(0,l.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"SET enable_nereids_planner=true\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"SET enable_fallback_to_original_planner=false\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:'CREATE TABLE IF NOT EXISTS `sdu`(\n                   `id` INT NULL,\n                   `name` TEXT NULL,\n                   `score` MAP<TEXT,INT> NULL\n                 ) ENGINE=OLAP\n                 DUPLICATE KEY(`id`)\n                 COMMENT \'OLAP\'\n                 DISTRIBUTED BY HASH(`id`) BUCKETS 1\n                 PROPERTIES ("replication_allocation" = "tag.location.default: 1");\nQuery OK, 0 rows affected (0.15 sec)\n'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:'insert into sdu values (0, "zhangsan", {"Chinese":"80","Math":"60","English":"90"}), (1, "lisi", {"null":null}), (2, "wangwu", {"Chinese":"88","Math":"90","English":"96"}), (3, "lisi2", {null:null}), (4, "amory", NULL);\nQuery OK, 5 rows affected (0.23 sec)\n{\'label\':\'label_9b35d9d9d59147f5_bffb974881ed2133\', \'status\':\'VISIBLE\', \'txnId\':\'4005\'}\n'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"select * from sdu order by id;\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-text",children:'+------+----------+-----------------------------------------+\n| id   | name     | score                                   |\n+------+----------+-----------------------------------------+\n|    0 | zhangsan | {"Chinese":80, "Math":60, "English":90} |\n|    1 | lisi     | {"null":null}                           |\n|    2 | wangwu   | {"Chinese":88, "Math":90, "English":96} |\n|    3 | lisi2    | {null:null}                             |\n|    4 | amory    | NULL                                    |\n+------+----------+-----------------------------------------+\n'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"select name, k,v from sdu lateral view explode_map(score) tmp as k,v;\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-text",children:"+----------+---------+------+\n| name     | k       | v    |\n+----------+---------+------+\n| zhangsan | Chinese |   80 |\n| zhangsan | Math    |   60 |\n| zhangsan | English |   90 |\n| lisi     | null    | NULL |\n| wangwu   | Chinese |   88 |\n| wangwu   | Math    |   90 |\n| wangwu   | English |   96 |\n| lisi2    | NULL    | NULL |\n+----------+---------+------+\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"select name, k,v from sdu lateral view explode_map_outer(score) tmp as k,v;\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-text",children:"+----------+---------+------+\n| name     | k       | v    |\n+----------+---------+------+\n| zhangsan | Chinese |   80 |\n| zhangsan | Math    |   60 |\n| zhangsan | English |   90 |\n| lisi     | null    | NULL |\n| wangwu   | Chinese |   88 |\n| wangwu   | Math    |   90 |\n| wangwu   | English |   96 |\n| lisi2    | NULL    | NULL |\n| amory    | NULL    | NULL |\n+----------+---------+------+\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"select name, k,v,k1,v1 from sdu lateral view explode_map_outer(score) tmp as k,v lateral view explode_map(score) tmp2 as k1,v1;\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-text",children:"+----------+---------+------+---------+------+\n| name     | k       | v    | k1      | v1   |\n+----------+---------+------+---------+------+\n| zhangsan | Chinese |   80 | Chinese |   80 |\n| zhangsan | Chinese |   80 | Math    |   60 |\n| zhangsan | Chinese |   80 | English |   90 |\n| zhangsan | Math    |   60 | Chinese |   80 |\n| zhangsan | Math    |   60 | Math    |   60 |\n| zhangsan | Math    |   60 | English |   90 |\n| zhangsan | English |   90 | Chinese |   80 |\n| zhangsan | English |   90 | Math    |   60 |\n| zhangsan | English |   90 | English |   90 |\n| lisi     | null    | NULL | null    | NULL |\n| wangwu   | Chinese |   88 | Chinese |   88 |\n| wangwu   | Chinese |   88 | Math    |   90 |\n| wangwu   | Chinese |   88 | English |   96 |\n| wangwu   | Math    |   90 | Chinese |   88 |\n| wangwu   | Math    |   90 | Math    |   90 |\n| wangwu   | Math    |   90 | English |   96 |\n| wangwu   | English |   96 | Chinese |   88 |\n| wangwu   | English |   96 | Math    |   90 |\n| wangwu   | English |   96 | English |   96 |\n| lisi2    | NULL    | NULL | NULL    | NULL |\n+----------+---------+------+---------+------+\n"})})]})}function h(e={}){let{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}},250065:function(e,n,a){a.d(n,{Z:function(){return r},a:function(){return i}});var s=a(667294);let l={},t=s.createContext(l);function i(e){let n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:i(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);