"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["711122"],{135144:function(e,s,n){n.r(s),n.d(s,{default:()=>h,frontMatter:()=>t,metadata:()=>i,assets:()=>l,toc:()=>d,contentTitle:()=>a});var i=JSON.parse('{"id":"admin-manual/auth/authentication-and-authorization","title":"Authentication and Authorization","description":"The Doris permission management system is modeled after the MySQL permission management mechanism. It supports fine-grained permission control at the row and column level, role-based access control, and also supports a whitelist mechanism.","source":"@site/docs/admin-manual/auth/authentication-and-authorization.md","sourceDirName":"admin-manual/auth","slug":"/admin-manual/auth/authentication-and-authorization","permalink":"/docs/dev/admin-manual/auth/authentication-and-authorization","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Authentication and Authorization","language":"en"},"sidebar":"docs","previous":{"title":"Security Overview","permalink":"/docs/dev/admin-manual/auth/security-overview"},"next":{"title":"Built-in Authentication","permalink":"/docs/dev/admin-manual/auth/authentication/internal"}}'),r=n("785893"),o=n("250065");let t={title:"Authentication and Authorization",language:"en"},a=void 0,l={},d=[{value:"Glossary",id:"glossary",level:2},{value:"Authentication and Authorization Framework",id:"authentication-and-authorization-framework",level:2},{value:"Authentication",id:"authentication",level:2},{value:"Doris Built-in Authentication Scheme",id:"doris-built-in-authentication-scheme",level:3},{value:"Password Policy",id:"password-policy",level:4},{value:"LDAP-based Authentication Scheme",id:"ldap-based-authentication-scheme",level:3},{value:"Authorization",id:"authorization",level:2},{value:"Permission Operations",id:"permission-operations",level:3},{value:"Types of Permissions",id:"types-of-permissions",level:3},{value:"Permission Levels",id:"permission-levels",level:3},{value:"Global Permissions",id:"global-permissions",level:4},{value:"Catalog Permissions",id:"catalog-permissions",level:4},{value:"Database Permissions",id:"database-permissions",level:4},{value:"Table Permissions",id:"table-permissions",level:4},{value:"Column Permissions",id:"column-permissions",level:4},{value:"Row-Level Permissions",id:"row-level-permissions",level:4},{value:"Usage Permissions",id:"usage-permissions",level:4},{value:"Data Masking",id:"data-masking",level:3},{value:"Doris Built-in Authorization Scheme",id:"doris-built-in-authorization-scheme",level:3},{value:"Authorization Scheme Based on Apache Ranger",id:"authorization-scheme-based-on-apache-ranger",level:3},{value:"Common Questions",id:"common-questions",level:2},{value:"Explanation of Permissions",id:"explanation-of-permissions",level:3},{value:"Additional Information",id:"additional-information",level:3},{value:"Best Practices",id:"best-practices",level:2}];function c(e){let s={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.p,{children:"The Doris permission management system is modeled after the MySQL permission management mechanism. It supports fine-grained permission control at the row and column level, role-based access control, and also supports a whitelist mechanism."}),"\n",(0,r.jsx)(s.h2,{id:"glossary",children:"Glossary"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"User Identity"}),"\n",(0,r.jsxs)(s.p,{children:["Within a permission system, a user is identified as a User Identity. A User Identity consists of two parts: ",(0,r.jsx)(s.code,{children:"username"})," and ",(0,r.jsx)(s.code,{children:"host"}),". The ",(0,r.jsx)(s.code,{children:"username"})," is the user's name, consisting of English letters (both uppercase and lowercase). ",(0,r.jsx)(s.code,{children:"host"})," represents the IP from which the user connection originates. User Identity is represented as ",(0,r.jsx)(s.code,{children:"username@'host'"}),", indicating ",(0,r.jsx)(s.code,{children:"username"})," from ",(0,r.jsx)(s.code,{children:"host"}),"."]}),"\n",(0,r.jsxs)(s.p,{children:["Another representation of User Identity is ",(0,r.jsx)(s.code,{children:"username@['domain']"}),", where ",(0,r.jsx)(s.code,{children:"domain"})," refers to a domain name that can be resolved into a set of IPs through DNS. Eventually, this is represented as a set of ",(0,r.jsx)(s.code,{children:"username@'host'"}),", hence moving forward, we uniformly use ",(0,r.jsx)(s.code,{children:"username@'host'"})," to denote it."]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"Privilege"}),"\n",(0,r.jsx)(s.p,{children:"Privileges apply to nodes, data directories, databases, or tables. Different privileges represent different operation permissions."}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"Role"}),"\n",(0,r.jsx)(s.p,{children:"Doris allows the creation of custom-named roles. A role can be viewed as a collection of privileges. Newly created users can be assigned a role, automatically inheriting the privileges of that role. Subsequent changes to the role's privileges will also reflect on the permissions of all users associated with that role."}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"User Property"}),"\n",(0,r.jsxs)(s.p,{children:["User properties are directly affiliated with a user, not the User Identity. Meaning, both ",(0,r.jsx)(s.code,{children:"user@'192.%'"})," and ",(0,r.jsx)(s.code,{children:"user@['domain']"})," share the same set of user properties, which belong to the user ",(0,r.jsx)(s.code,{children:"user"}),", not to ",(0,r.jsx)(s.code,{children:"user@'192.%'"})," or ",(0,r.jsx)(s.code,{children:"user@['domain']"}),"."]}),"\n",(0,r.jsx)(s.p,{children:"User properties include but are not limited to: maximum number of user connections, import cluster configurations, etc."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"authentication-and-authorization-framework",children:"Authentication and Authorization Framework"}),"\n",(0,r.jsxs)(s.p,{children:["The process of a user logging into Apache Doris is divided into two parts: ",(0,r.jsx)(s.strong,{children:"Authentication"})," and ",(0,r.jsx)(s.strong,{children:"Authorization"}),"."]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Authentication: Identity verification is conducted based on the credentials provided by the user (such as username, client IP, password). Once verified, the individual user is mapped to a system-defined User Identity."}),"\n",(0,r.jsx)(s.li,{children:"Authorization: Based on the acquired User Identity, it checks whether the user has the necessary permissions for the intended operations, according to the privileges associated with that User Identity."}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"authentication",children:"Authentication"}),"\n",(0,r.jsx)(s.p,{children:"Doris supports built-in authentication schemes as well as LDAP authentication."}),"\n",(0,r.jsx)(s.h3,{id:"doris-built-in-authentication-scheme",children:"Doris Built-in Authentication Scheme"}),"\n",(0,r.jsx)(s.p,{children:"Authentication is based on usernames, passwords, and other information stored within Doris itself."}),"\n",(0,r.jsxs)(s.p,{children:["Administrators create users with the ",(0,r.jsx)(s.code,{children:"CREATE USER"})," command and view all created users with the ",(0,r.jsx)(s.code,{children:"SHOW ALL GRANTS"})," command."]}),"\n",(0,r.jsx)(s.p,{children:"When a user logs in, the system verifies whether the username, password, and client IP address are correct."}),"\n",(0,r.jsx)(s.h4,{id:"password-policy",children:"Password Policy"}),"\n",(0,r.jsx)(s.p,{children:"Doris supports the following password policies to assist users in better password management."}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.code,{children:"PASSWORD_HISTORY"})}),"\n",(0,r.jsxs)(s.p,{children:["Determines whether a user can reuse a historical password when resetting their current password. For example, ",(0,r.jsx)(s.code,{children:"PASSWORD_HISTORY 10"})," means the last 10 passwords cannot be reused as a new password. Setting ",(0,r.jsx)(s.code,{children:"PASSWORD_HISTORY DEFAULT"})," will use the value from the global variable ",(0,r.jsx)(s.code,{children:"PASSWORD_HISTORY"}),". A setting of 0 disables this feature. The default is 0."]}),"\n",(0,r.jsx)(s.p,{children:"Examples:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Set a global variable: ",(0,r.jsx)(s.code,{children:"SET GLOBAL password_history = 10"})]}),"\n",(0,r.jsxs)(s.li,{children:["Set for a user: ",(0,r.jsx)(s.code,{children:"ALTER USER user1@'ip' PASSWORD_HISTORY 10"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.code,{children:"PASSWORD_EXPIRE"})}),"\n",(0,r.jsxs)(s.p,{children:["Sets the expiration time for the current user's password. For instance, ",(0,r.jsx)(s.code,{children:"PASSWORD_EXPIRE INTERVAL 10 DAY"})," means the password will expire after 10 days. ",(0,r.jsx)(s.code,{children:"PASSWORD_EXPIRE NEVER"})," indicates the password never expires. Setting ",(0,r.jsx)(s.code,{children:"PASSWORD_EXPIRE DEFAULT"})," will use the value from the global variable ",(0,r.jsx)(s.code,{children:"default_password_lifetime"})," (in days). The default is NEVER (or 0), indicating it does not expire."]}),"\n",(0,r.jsx)(s.p,{children:"Examples:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Set a global variable: ",(0,r.jsx)(s.code,{children:"SET GLOBAL default_password_lifetime = 1"})]}),"\n",(0,r.jsxs)(s.li,{children:["Set for a user: ",(0,r.jsx)(s.code,{children:"ALTER USER user1@'ip' PASSWORD_EXPIRE INTERVAL 10 DAY"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"FAILED_LOGIN_ATTEMPTS"})," and ",(0,r.jsx)(s.code,{children:"PASSWORD_LOCK_TIME"})]}),"\n",(0,r.jsxs)(s.p,{children:["Configures the number of incorrect password attempts after which the user account will be locked and sets the lock duration. For example, ",(0,r.jsx)(s.code,{children:"FAILED_LOGIN_ATTEMPTS 3 PASSWORD_LOCK_TIME 1 DAY"})," means if there are 3 incorrect logins, the account will be locked for one day. Administrators can unlock the account using the ",(0,r.jsx)(s.code,{children:"ALTER USER"})," statement."]}),"\n",(0,r.jsx)(s.p,{children:"Example:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Set for a user: ",(0,r.jsx)(s.code,{children:"ALTER USER user1@'ip' FAILED_LOGIN_ATTEMPTS 3 PASSWORD_LOCK_TIME 1 DAY"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"Password Strength"}),"\n",(0,r.jsxs)(s.p,{children:["This is controlled by the global variable ",(0,r.jsx)(s.code,{children:"validate_password_policy"}),". The default is ",(0,r.jsx)(s.code,{children:"NONE/0"}),", which means no password strength checking. If set to ",(0,r.jsx)(s.code,{children:"STRONG/2"}),", the password must include at least three of the following: uppercase letters, lowercase letters, numbers, and special characters, and must be at least 8 characters long."]}),"\n",(0,r.jsx)(s.p,{children:"Example:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"SET validate_password_policy=STRONG"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["For more help, please refer to ",(0,r.jsx)(s.a,{href:"/docs/dev/sql-manual/sql-statements/account-management/ALTER-USER",children:"ALTER USER"}),"."]}),"\n",(0,r.jsx)(s.h3,{id:"ldap-based-authentication-scheme",children:"LDAP-based Authentication Scheme"}),"\n",(0,r.jsxs)(s.p,{children:["Please refer to ",(0,r.jsx)(s.a,{href:"/docs/dev/admin-manual/auth/ldap",children:"LDAP-based Authentication Scheme"}),"."]}),"\n",(0,r.jsx)(s.h2,{id:"authorization",children:"Authorization"}),"\n",(0,r.jsx)(s.h3,{id:"permission-operations",children:"Permission Operations"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Create user: ",(0,r.jsx)(s.a,{href:"../../sql-manual/sql-statements/account-management/CREATE-USER",children:"CREATE USER"})]}),"\n",(0,r.jsxs)(s.li,{children:["Modify user: ",(0,r.jsx)(s.a,{href:"/docs/dev/sql-manual/sql-statements/account-management/ALTER-USER",children:"ALTER USER"})]}),"\n",(0,r.jsxs)(s.li,{children:["Delete user: ",(0,r.jsx)(s.a,{href:"/docs/dev/sql-manual/sql-statements/account-management/DROP-USER",children:"DROP USER"})]}),"\n",(0,r.jsxs)(s.li,{children:["Grant/Assign role: ",(0,r.jsx)(s.a,{href:"../../sql-manual/sql-statements/account-management/GRANT-TO",children:"GRANT"})]}),"\n",(0,r.jsxs)(s.li,{children:["Revoke/Withdraw role: ",(0,r.jsx)(s.a,{href:"/docs/dev/sql-manual/sql-statements/account-management/REVOKE-FROM",children:"REVOKE"})]}),"\n",(0,r.jsxs)(s.li,{children:["Create role: ",(0,r.jsx)(s.a,{href:"/docs/dev/sql-manual/sql-statements/account-management/CREATE-ROLE",children:"CREATE ROLE"})]}),"\n",(0,r.jsxs)(s.li,{children:["Delete role: ",(0,r.jsx)(s.a,{href:"/docs/dev/sql-manual/sql-statements/account-management/DROP-ROLE",children:"DROP ROLE"})]}),"\n",(0,r.jsxs)(s.li,{children:["Modify role: ",(0,r.jsx)(s.a,{href:"/docs/dev/sql-manual/sql-statements/account-management/ALTER-ROLE",children:"ALTER ROLE"})]}),"\n",(0,r.jsxs)(s.li,{children:["View current user's permissions and roles: ",(0,r.jsx)(s.a,{href:"/docs/dev/sql-manual/sql-statements/account-management/SHOW-GRANTS",children:"SHOW GRANTS"})]}),"\n",(0,r.jsxs)(s.li,{children:["View all users' permissions and roles: ",(0,r.jsx)(s.a,{href:"/docs/dev/sql-manual/sql-statements/account-management/SHOW-GRANTS",children:"SHOW ALL GRANTS"})]}),"\n",(0,r.jsxs)(s.li,{children:["View created roles: ",(0,r.jsx)(s.a,{href:"/docs/dev/sql-manual/sql-statements/account-management/SHOW-ROLES",children:"SHOW ROLES"})]}),"\n",(0,r.jsxs)(s.li,{children:["Set user property: ",(0,r.jsx)(s.a,{href:"/docs/dev/sql-manual/sql-statements/account-management/SET-PROPERTY",children:"SET PROPERTY"})]}),"\n",(0,r.jsxs)(s.li,{children:["View user property: ",(0,r.jsx)(s.a,{href:"/docs/dev/sql-manual/sql-statements/account-management/SHOW-PROPERTY",children:"SHOW PROPERTY"})]}),"\n",(0,r.jsxs)(s.li,{children:["Change password: ",(0,r.jsx)(s.a,{href:"/docs/dev/sql-manual/sql-statements/account-management/SET-PASSWORD",children:"SET PASSWORD"})]}),"\n",(0,r.jsx)(s.li,{children:"View all supported privileges: [SHOW PRIVILEGES]"}),"\n",(0,r.jsx)(s.li,{children:"View row policy: [SHOW ROW POLICY]"}),"\n",(0,r.jsx)(s.li,{children:"Create row policy: [CREATE ROW POLICY]"}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"types-of-permissions",children:"Types of Permissions"}),"\n",(0,r.jsx)(s.p,{children:"Doris currently supports the following permissions:"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.code,{children:"Node_priv"})}),"\n",(0,r.jsx)(s.p,{children:"Node modification permission. Includes adding, deleting, and offlining FE, BE, BROKER nodes."}),"\n",(0,r.jsxs)(s.p,{children:["Root users have this permission by default. Users who possess both ",(0,r.jsx)(s.code,{children:"Grant_priv"})," and ",(0,r.jsx)(s.code,{children:"Node_priv"})," can grant this permission to other users."]}),"\n",(0,r.jsx)(s.p,{children:"This permission can only be granted at the Global level."}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.code,{children:"Grant_priv"})}),"\n",(0,r.jsx)(s.p,{children:"Permission modification authority. Allows execution of operations including granting, revoking, adding/deleting/modifying users/roles."}),"\n",(0,r.jsxs)(s.p,{children:["Before version 2.1.2, when granting permissions to other users/roles, the current user only needed the respective level's ",(0,r.jsx)(s.code,{children:"Grant_priv"})," permission. After version 2.1.2, the current user also needs permission for the resource they wish to grant."]}),"\n",(0,r.jsxs)(s.p,{children:["When assigning roles to other users, Global level ",(0,r.jsx)(s.code,{children:"Grant_priv"})," permission is required."]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.code,{children:"Select_priv"})}),"\n",(0,r.jsx)(s.p,{children:"Read-only permission for data directories, databases, and tables."}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.code,{children:"Load_priv"})}),"\n",(0,r.jsx)(s.p,{children:"Write permission for data directories, databases, and tables. Includes Load, Insert, Delete, etc."}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.code,{children:"Alter_priv"})}),"\n",(0,r.jsx)(s.p,{children:"Alteration permissions for data directories, databases, and tables. Includes renaming libraries/tables, adding/deleting/modifying columns, adding/deleting partitions, etc."}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.code,{children:"Create_priv"})}),"\n",(0,r.jsx)(s.p,{children:"Permission to create data directories, databases, tables, and views."}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.code,{children:"Drop_priv"})}),"\n",(0,r.jsx)(s.p,{children:"Permission to delete data directories, databases, tables, and views."}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.code,{children:"Usage_priv"})}),"\n",(0,r.jsx)(s.p,{children:"Usage permissions for Resources and Workload Groups."}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.code,{children:"Show_view_priv"})}),"\n",(0,r.jsxs)(s.p,{children:["Permission to execute ",(0,r.jsx)(s.code,{children:"SHOW CREATE VIEW"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"permission-levels",children:"Permission Levels"}),"\n",(0,r.jsx)(s.h4,{id:"global-permissions",children:"Global Permissions"}),"\n",(0,r.jsxs)(s.p,{children:["Permissions granted through the GRANT statement with ",(0,r.jsx)(s.code,{children:"*.*.*"})," scope. These permissions apply to any table within any catalog."]}),"\n",(0,r.jsx)(s.h4,{id:"catalog-permissions",children:"Catalog Permissions"}),"\n",(0,r.jsxs)(s.p,{children:["Permissions granted through the GRANT statement with ",(0,r.jsx)(s.code,{children:"ctl.*.*"})," scope. These permissions apply to any table within the specified catalog."]}),"\n",(0,r.jsx)(s.h4,{id:"database-permissions",children:"Database Permissions"}),"\n",(0,r.jsxs)(s.p,{children:["Permissions granted through the GRANT statement with ",(0,r.jsx)(s.code,{children:"ctl.db.*"})," scope. These permissions apply to any table within the specified database."]}),"\n",(0,r.jsx)(s.h4,{id:"table-permissions",children:"Table Permissions"}),"\n",(0,r.jsxs)(s.p,{children:["Permissions granted through the GRANT statement with ",(0,r.jsx)(s.code,{children:"ctl.db.tbl"})," scope. These permissions apply to any column within the specified table."]}),"\n",(0,r.jsx)(s.h4,{id:"column-permissions",children:"Column Permissions"}),"\n",(0,r.jsx)(s.p,{children:"Column permissions are primarily used to restrict user access to certain columns within a table. Specifically, column permissions allow administrators to set viewing, editing, and other rights for certain columns, controlling user access and manipulation of specific column data."}),"\n",(0,r.jsxs)(s.p,{children:["Permissions for specific columns of a table can be granted with ",(0,r.jsx)(s.code,{children:"GRANT Select_priv(col1,col2) ON ctl.db.tbl TO user1"}),"."]}),"\n",(0,r.jsxs)(s.p,{children:["Currently, column permissions support only ",(0,r.jsx)(s.code,{children:"Select_priv"}),"."]}),"\n",(0,r.jsx)(s.h4,{id:"row-level-permissions",children:"Row-Level Permissions"}),"\n",(0,r.jsx)(s.p,{children:"Row Policies enable administrators to define access policies based on fields within the data, controlling which users can access which rows."}),"\n",(0,r.jsx)(s.p,{children:"Specifically, Row Policies allow administrators to create rules that can filter or restrict user access to rows based on actual values stored in the data."}),"\n",(0,r.jsxs)(s.p,{children:["From version 1.2, row-level permissions can be created with the ",(0,r.jsx)(s.code,{children:"CREATE ROW POLICY"})," command."]}),"\n",(0,r.jsxs)(s.p,{children:["From version 2.1.2, support for setting row-level permissions through Apache Ranger's ",(0,r.jsx)(s.code,{children:"Row Level Filter"})," is available."]}),"\n",(0,r.jsx)(s.h4,{id:"usage-permissions",children:"Usage Permissions"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"Resource Permissions"}),"\n",(0,r.jsxs)(s.p,{children:["Resource permissions are set specifically for Resources, unrelated to permissions for databases or tables, and can only assign ",(0,r.jsx)(s.code,{children:"Usage_priv"})," and ",(0,r.jsx)(s.code,{children:"Grant_priv"}),"."]}),"\n",(0,r.jsxs)(s.p,{children:["Permissions for all Resources can be granted with the ",(0,r.jsx)(s.code,{children:"GRANT USAGE_PRIV ON RESOURCE '%' TO user1"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"Workload Group Permissions"}),"\n",(0,r.jsxs)(s.p,{children:["Workload Group permissions are set specifically for Workload Groups, unrelated to permissions for databases or tables, and can only assign ",(0,r.jsx)(s.code,{children:"Usage_priv"})," and ",(0,r.jsx)(s.code,{children:"Grant_priv"}),"."]}),"\n",(0,r.jsxs)(s.p,{children:["Permissions for all Workload Groups can be granted with ",(0,r.jsx)(s.code,{children:"GRANT USAGE_PRIV ON WORKLOAD GROUP '%' TO user1"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"data-masking",children:"Data Masking"}),"\n",(0,r.jsx)(s.p,{children:"Data masking is a method to protect sensitive data by modifying, replacing, or hiding the original data, such that the masked data retains certain formats and characteristics while no longer containing sensitive information."}),"\n",(0,r.jsxs)(s.p,{children:["For example, administrators may choose to replace part or all of the digits of sensitive fields like credit card numbers or ID numbers with asterisks ",(0,r.jsx)(s.code,{children:"*"})," or other characters, or replace real names with pseudonyms."]}),"\n",(0,r.jsxs)(s.p,{children:["From version 2.1.2, support for setting data masking policies for certain columns through Apache Ranger's Data Masking is available, currently only configurable via ",(0,r.jsx)(s.a,{href:"/docs/dev/admin-manual/auth/ranger",children:"Apache Ranger"}),"."]}),"\n",(0,r.jsx)(s.h3,{id:"doris-built-in-authorization-scheme",children:"Doris Built-in Authorization Scheme"}),"\n",(0,r.jsx)(s.p,{children:"Doris's permission design is based on the RBAC (Role-Based Access Control) model, where users are associated with roles, and roles are associated with permissions. Users are indirectly linked to permissions through their roles."}),"\n",(0,r.jsx)(s.p,{children:"When a role is deleted, users automatically lose all permissions associated with that role."}),"\n",(0,r.jsx)(s.p,{children:"When a user is disassociated from a role, they automatically lose all permissions of that role."}),"\n",(0,r.jsx)(s.p,{children:"When permissions are added to or removed from a role, the permissions of the users associated with that role change accordingly."}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"\u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510        \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  user1 \u251C\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u25BA  role1 \u251C\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u25BA  priv1 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n              \u2502                 \u2502\n              \u2502                 \u2502\n              \u2502   \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n              \u2502   \u2502  role2 \u251C\u2500\u2500\u2500\u2500\u2524\n\u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502    \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  user2 \u251C\u2500\u2500\u2500\u2500\u2518                 \u2502  \u250C\u2500\u25BA  priv2 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                      \u2502  \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                  \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502  \u2502\n           \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u25BA  role3 \u251C\u2500\u2500\u2500\u2500\u2518  \u2502\n           \u2502      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518       \u2502\n           \u2502                       \u2502\n           \u2502                       \u2502\n\u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502      \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u2502 \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  userN \u251C\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u25BA  roleN \u251C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u25BA  privN \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(s.p,{children:"As shown above:"}),"\n",(0,r.jsxs)(s.p,{children:["User1 and user2 both have permission ",(0,r.jsx)(s.code,{children:"priv1"})," through ",(0,r.jsx)(s.code,{children:"role1"}),"."]}),"\n",(0,r.jsxs)(s.p,{children:["UserN has permission ",(0,r.jsx)(s.code,{children:"priv1"})," through ",(0,r.jsx)(s.code,{children:"role3"}),", and permissions ",(0,r.jsx)(s.code,{children:"priv2"})," and ",(0,r.jsx)(s.code,{children:"privN"})," through ",(0,r.jsx)(s.code,{children:"roleN"}),". Thus, userN has permissions ",(0,r.jsx)(s.code,{children:"priv1"}),", ",(0,r.jsx)(s.code,{children:"priv2"}),", and ",(0,r.jsx)(s.code,{children:"privN"})," simultaneously."]}),"\n",(0,r.jsx)(s.p,{children:"For ease of user operations, it is possible to directly grant permissions to a user. Internally, a unique default role is created for each user. When permissions are granted to a user, it is essentially granting permissions to the user's default role."}),"\n",(0,r.jsx)(s.p,{children:"The default role cannot be deleted, nor can it be assigned to someone else. When a user is deleted, their default role is automatically deleted as well."}),"\n",(0,r.jsx)(s.h3,{id:"authorization-scheme-based-on-apache-ranger",children:"Authorization Scheme Based on Apache Ranger"}),"\n",(0,r.jsxs)(s.p,{children:["Please refer to ",(0,r.jsx)(s.a,{href:"/docs/dev/admin-manual/auth/ranger",children:"Authorization Scheme Based on Apache Ranger"}),"."]}),"\n",(0,r.jsx)(s.h2,{id:"common-questions",children:"Common Questions"}),"\n",(0,r.jsx)(s.h3,{id:"explanation-of-permissions",children:"Explanation of Permissions"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"Users with ADMIN privileges or GRANT privileges at the GLOBAL level can perform the following operations:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"CREATE USER"}),"\n",(0,r.jsx)(s.li,{children:"DROP USER"}),"\n",(0,r.jsx)(s.li,{children:"ALTER USER"}),"\n",(0,r.jsx)(s.li,{children:"SHOW GRANTS"}),"\n",(0,r.jsx)(s.li,{children:"CREATE ROLE"}),"\n",(0,r.jsx)(s.li,{children:"DROP ROLE"}),"\n",(0,r.jsx)(s.li,{children:"ALTER ROLE"}),"\n",(0,r.jsx)(s.li,{children:"SHOW ROLES"}),"\n",(0,r.jsx)(s.li,{children:"SHOW PROPERTY FOR USER"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"GRANT/REVOKE"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Users with ADMIN privileges can grant or revoke permissions for any user."}),"\n",(0,r.jsx)(s.li,{children:"Users with ADMIN or GLOBAL level GRANT privileges can assign roles to users."}),"\n",(0,r.jsx)(s.li,{children:"Users who have the corresponding level of GRANT privilege and the permissions to be assigned can distribute those permissions to users/roles."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"SET PASSWORD"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Users with ADMIN privileges or GLOBAL level GRANT privileges can set passwords for non-root users."}),"\n",(0,r.jsxs)(s.li,{children:["Ordinary users can set the password for their corresponding User Identity. Their corresponding User Identity can be viewed with the ",(0,r.jsx)(s.code,{children:"SELECT CURRENT_USER()"})," command."]}),"\n",(0,r.jsx)(s.li,{children:"ROOT users can change their own password."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"additional-information",children:"Additional Information"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"When Doris is initialized, the following users and roles are automatically created:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["operator role: This role has ",(0,r.jsx)(s.code,{children:"Node_priv"})," and ",(0,r.jsx)(s.code,{children:"Admin_priv"}),", i.e., all permissions in Doris."]}),"\n",(0,r.jsxs)(s.li,{children:["admin role: This role has ",(0,r.jsx)(s.code,{children:"Admin_priv"}),", i.e., all permissions except for node changes."]}),"\n",(0,r.jsx)(s.li,{children:"root@'%': root user, allowed to log in from any node, with the operator role."}),"\n",(0,r.jsx)(s.li,{children:"admin@'%': admin user, allowed to log in from any node, with the admin role."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"Deleting or altering the permissions of default created users, roles, or users is not supported."}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Deleting the users root@'%' and admin@'%' is not supported, but creating and deleting root@'xxx' and admin@'xxx' users (where xxx refers to any host except %) is allowed (Doris treats these users as regular users)."}),"\n",(0,r.jsx)(s.li,{children:"Revoking the default roles of root@'%' and admin@'%' is not supported."}),"\n",(0,r.jsx)(s.li,{children:"Deleting the roles operator and admin is not supported."}),"\n",(0,r.jsx)(s.li,{children:"Modifying the permissions of the roles operator and admin is not supported."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"There is only one user with the operator role, which is Root. There can be multiple users with the admin role."}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"Some potentially conflicting operations are explained as follows:"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"Domain and IP conflict:"}),"\n",(0,r.jsx)(s.p,{children:"Suppose the following user is created:"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.code,{children:"CREATE USER user1@['domain'];"})}),"\n",(0,r.jsx)(s.p,{children:"And granted:"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.code,{children:"GRANT SELECT_PRIV ON *.* TO user1@['domain']"})}),"\n",(0,r.jsx)(s.p,{children:"This domain is resolved to two IPs: ip1 and ip2."}),"\n",(0,r.jsxs)(s.p,{children:["Suppose later, we grant a separate permission to ",(0,r.jsx)(s.code,{children:"user1@'ip1'"}),":"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.code,{children:"GRANT ALTER_PRIV ON . TO user1@'ip1';"})}),"\n",(0,r.jsxs)(s.p,{children:["Then ",(0,r.jsx)(s.code,{children:"user1@'ip1'"})," will have permissions for both Select_priv and Alter_priv. And when we change the permissions for ",(0,r.jsx)(s.code,{children:"user1@['domain']"})," again, ",(0,r.jsx)(s.code,{children:"user1@'ip1'"})," will not follow the change."]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"Duplicate IP conflict:"}),"\n",(0,r.jsx)(s.p,{children:"Suppose the following users are created:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"CREATE USER user1@'%' IDENTIFIED BY \"12345\";\nCREATE USER user1@'192.%' IDENTIFIED BY \"abcde\";\n"})}),"\n",(0,r.jsxs)(s.p,{children:["In terms of priority, ",(0,r.jsx)(s.code,{children:"'192.%'"})," takes precedence over ",(0,r.jsx)(s.code,{children:"'%'"}),", so when user ",(0,r.jsx)(s.code,{children:"user1"})," from machine ",(0,r.jsx)(s.code,{children:"192.168.1.1"})," tries to log into Doris using password ",(0,r.jsx)(s.code,{children:"'12345'"}),", access will be denied."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"Forgotten Password"}),"\n",(0,r.jsxs)(s.p,{children:["If you forget the password and cannot log into Doris, you can add ",(0,r.jsx)(s.code,{children:"skip_localhost_auth_check=true"})," to the FE's config file and restart the FE, thus logging into Doris as root without a password from the local machine."]}),"\n",(0,r.jsxs)(s.p,{children:["After logging in, you can reset the password using the ",(0,r.jsx)(s.code,{children:"SET PASSWORD"})," command."]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"No user can reset the root user's password except for the root user themselves."}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"Admin_priv"})," permissions can only be granted or revoked at the GLOBAL level."]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"current_user()"})," and ",(0,r.jsx)(s.code,{children:"user()"})]}),"\n",(0,r.jsxs)(s.p,{children:["Users can view their ",(0,r.jsx)(s.code,{children:"current_user"})," and ",(0,r.jsx)(s.code,{children:"user"})," by executing ",(0,r.jsx)(s.code,{children:"SELECT current_user()"})," and ",(0,r.jsx)(s.code,{children:"SELECT user()"})," respectively. Here, ",(0,r.jsx)(s.code,{children:"current_user"})," indicates the identity the user authenticated with, while ",(0,r.jsx)(s.code,{children:"user"})," is the actual User Identity at the moment."]}),"\n",(0,r.jsx)(s.p,{children:"For example:"}),"\n",(0,r.jsxs)(s.p,{children:["Suppose ",(0,r.jsx)(s.code,{children:"user1@'192.%'"})," is created, and then user ",(0,r.jsx)(s.code,{children:"user1"})," logs in from ",(0,r.jsx)(s.code,{children:"192.168.10.1"}),", then the ",(0,r.jsx)(s.code,{children:"current_user"})," would be ",(0,r.jsx)(s.code,{children:"user1@'192.%'"}),", and ",(0,r.jsx)(s.code,{children:"user"})," would be ",(0,r.jsx)(s.code,{children:"user1@'192.168.10.1'"}),"."]}),"\n",(0,r.jsxs)(s.p,{children:["All permissions are granted to a specific ",(0,r.jsx)(s.code,{children:"current_user"}),", and the real user has all the permissions of the corresponding ",(0,r.jsx)(s.code,{children:"current_user"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsx)(s.p,{children:"Here are some examples of use cases for the Doris permission system."}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"Scenario 1"}),"\n",(0,r.jsx)(s.p,{children:"Users of the Doris cluster are divided into administrators (Admin), development engineers (RD), and users (Client). Administrators have all permissions over the entire cluster, primarily responsible for cluster setup and node management. Development engineers are responsible for business modeling, including creating databases and tables, importing, and modifying data. Users access different databases and tables to retrieve data."}),"\n",(0,r.jsx)(s.p,{children:"In this scenario, administrators can be granted ADMIN or GRANT privileges. RDs can be granted CREATE, DROP, ALTER, LOAD, and SELECT permissions for any or specific databases and tables. Clients can be granted SELECT permissions for any or specific databases and tables. Additionally, different roles can be created to simplify the authorization process for multiple users."}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"Scenario 2"}),"\n",(0,r.jsx)(s.p,{children:"A cluster may contain multiple businesses, each potentially using one or more datasets. Each business needs to manage its users. In this scenario, an administrative user can create a user with DATABASE-level GRANT privileges for each database. This user can only authorize users for the specified database."}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"Blacklist"}),"\n",(0,r.jsxs)(s.p,{children:["Doris itself does not support a blacklist, only a whitelist, but we can simulate a blacklist through certain means. Suppose a user named ",(0,r.jsx)(s.code,{children:"user@'192.%'"})," is created, allowing users from ",(0,r.jsx)(s.code,{children:"192.*"})," to log in. If you want to prohibit a user from ",(0,r.jsx)(s.code,{children:"192.168.10.1"})," from logging in, you can create another user ",(0,r.jsx)(s.code,{children:"cmy@'192.168.10.1'"})," with a new password. Since ",(0,r.jsx)(s.code,{children:"192.168.10.1"})," has higher priority than ",(0,r.jsx)(s.code,{children:"192.%"}),", the user from ",(0,r.jsx)(s.code,{children:"192.168.10.1"})," will no longer be able to log in with the old password."]}),"\n"]}),"\n"]})]})}function h(e={}){let{wrapper:s}={...(0,o.a)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},250065:function(e,s,n){n.d(s,{Z:function(){return a},a:function(){return t}});var i=n(667294);let r={},o=i.createContext(r);function t(e){let s=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(o.Provider,{value:s},e.children)}}}]);