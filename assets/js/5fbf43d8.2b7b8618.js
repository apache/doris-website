"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["264023"],{593953:function(e,n,t){t.r(n),t.d(n,{default:()=>u,frontMatter:()=>l,metadata:()=>s,assets:()=>c,toc:()=>d,contentTitle:()=>i});var s=JSON.parse('{"id":"sql-manual/sql-functions/aggregate-functions/avg-weighted","title":"AVG_WEIGHTED","description":"Description","source":"@site/docs/sql-manual/sql-functions/aggregate-functions/avg-weighted.md","sourceDirName":"sql-manual/sql-functions/aggregate-functions","slug":"/sql-manual/sql-functions/aggregate-functions/avg-weighted","permalink":"/docs/dev/sql-manual/sql-functions/aggregate-functions/avg-weighted","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"AVG_WEIGHTED","language":"en"},"sidebar":"docs","previous":{"title":"AVG","permalink":"/docs/dev/sql-manual/sql-functions/aggregate-functions/avg"},"next":{"title":"BITMAP_AGG","permalink":"/docs/dev/sql-manual/sql-functions/aggregate-functions/bitmap-agg"}}'),a=t("785893"),r=t("250065");let l={title:"AVG_WEIGHTED",language:"en"},i=void 0,c={},d=[{value:"Description",id:"description",level:2},{value:"Syntax",id:"syntax",level:2},{value:"Parameters",id:"parameters",level:2},{value:"Return Value",id:"return-value",level:2},{value:"Example",id:"example",level:2}];function o(e){let n={code:"code",em:"em",h2:"h2",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h2,{id:"description",children:"Description"}),"\n",(0,a.jsx)(n.p,{children:"Calculates the weighted arithmetic mean, i.e., the result is the sum of the products of corresponding values and weights, divided by the total sum of weights. If the total sum of weights is 0, it will return NaN. The calculation is always performed using Double type."}),"\n",(0,a.jsx)(n.h2,{id:"syntax",children:"Syntax"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"AVG_WEIGHTED(<x>, <weight>)\n"})}),"\n",(0,a.jsx)(n.h2,{id:"parameters",children:"Parameters"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Parameter"}),(0,a.jsx)(n.th,{children:"Description"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"<x>"})}),(0,a.jsx)(n.td,{children:"It is the numeric expression for which the average needs to be calculated, and can be a column name, constant, or a complex numeric expression. Supported type is Double."})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"<weight>"})}),(0,a.jsx)(n.td,{children:"It is a numeric expression, typically a column name, constant, or the result of another numeric calculation. Supported type is Double."})]})]})]}),"\n",(0,a.jsx)(n.h2,{id:"return-value",children:"Return Value"}),"\n",(0,a.jsx)(n.p,{children:"The sum of the products of corresponding values and weights is accumulated, divided by the total sum of weights. If the total sum of weights equals 0, NaN will be returned.\nThe return type is always Double."}),"\n",(0,a.jsx)(n.h2,{id:"example",children:"Example"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"-- setup\ncreate table t1(\n        k1 int,\n        k2 int,\n        k3 decimal(10, 2),\n        k4 double,\n        category varchar(50)\n) distributed by hash (k1) buckets 1\nproperties (\"replication_num\"=\"1\");\ninsert into t1 values \n    (10, 100, 5.5, 1.0, 'A'),\n    (20, 200, 10.0, 2.0, 'A'),\n    (30, 300, 15.5, 3.0, 'B'),\n    (40, 400, 20.0, 4.0, 'B'),\n    (50, 0, 25.0, 0.0, 'C'),\n    (60, 600, 30.0, 5.0, 'C');\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"select avg_weighted(k2, k1) from t1;\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Calculate the weighted average of all records: (100",(0,a.jsx)(n.em,{children:"10 + 200"}),"20 + 300",(0,a.jsx)(n.em,{children:"30 + 400"}),"40 + 0",(0,a.jsx)(n.em,{children:"50 + 600"}),"60) / (10+20+30+40+50+60) \u2248 314.2857"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"+----------------------+\n| avg_weighted(k2, k1) |\n+----------------------+\n|    314.2857142857143 |\n+----------------------+\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"select category, avg_weighted(k2, k1) from t1 group by category;\n"})}),"\n",(0,a.jsx)(n.p,{children:"Group by category and calculate the weighted average for each group."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"+----------+----------------------+\n| category | avg_weighted(k2, k1) |\n+----------+----------------------+\n| A        |   166.66666666666666 |\n| B        |   357.14285714285717 |\n| C        |   327.27272727272725 |\n+----------+----------------------+\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"select avg_weighted(k2, 0) from t1;\n"})}),"\n",(0,a.jsx)(n.p,{children:"When all weights are 0, returns NaN."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"+---------------------+\n| avg_weighted(k2, 0) |\n+---------------------+\n|                 NaN |\n+---------------------+\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"select avg_weighted(k2, k1) from t1 where k1 > 100;\n"})}),"\n",(0,a.jsx)(n.p,{children:"When the query result is empty, returns NULL."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"+----------------------+\n| avg_weighted(k2, k1) |\n+----------------------+\n|                 NULL |\n+----------------------+\n"})})]})}function u(e={}){let{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(o,{...e})}):o(e)}},250065:function(e,n,t){t.d(n,{Z:function(){return i},a:function(){return l}});var s=t(667294);let a={},r=s.createContext(a);function l(e){let n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);