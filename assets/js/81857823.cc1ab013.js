"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["884381"],{86487:function(e,t,n){n.r(t),n.d(t,{default:()=>h,frontMatter:()=>a,metadata:()=>r,assets:()=>l,toc:()=>c,contentTitle:()=>o});var r=JSON.parse('{"id":"faq/sql-faq","title":"SQL Error","description":"This happens because the corresponding tablet does not find a copy that can be queried, usually because the BE is down, the copy is missing, etc.","source":"@site/docs/faq/sql-faq.md","sourceDirName":"faq","slug":"/faq/sql-faq","permalink":"/docs/dev/faq/sql-faq","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1770477659000,"frontMatter":{"title":"SQL Error","language":"en","description":"This happens because the corresponding tablet does not find a copy that can be queried, usually because the BE is down, the copy is missing, etc."},"sidebar":"docs","previous":{"title":"Data Operation Error","permalink":"/docs/dev/faq/data-faq"},"next":{"title":"Data Lakehouse FAQ","permalink":"/docs/dev/faq/lakehouse-faq"}}'),s=n("785893"),i=n("250065");let a={title:"SQL Error",language:"en",description:"This happens because the corresponding tablet does not find a copy that can be queried, usually because the BE is down, the copy is missing, etc."},o="SQL Error",l={},c=[{value:"Q1. Query error: Failed to get scan range, no queryable replica found in tablet: xxxx",id:"q1-query-error-failed-to-get-scan-range-no-queryable-replica-found-in-tablet-xxxx",level:3},{value:"Q2. Show backends/frontends The information viewed is incomplete",id:"q2-show-backendsfrontends-the-information-viewed-is-incomplete",level:3},{value:"Q3. invalid cluster id: xxxx",id:"q3-invalid-cluster-id-xxxx",level:3},{value:"Q4. Unique Key model query results are inconsistent",id:"q4-unique-key-model-query-results-are-inconsistent",level:3},{value:"Q5. The problem of querying bitmap/hll type data returns NULL",id:"q5-the-problem-of-querying-bitmaphll-type-data-returns-null",level:3},{value:"Q5. The problem of querying bitmap/hll type data returns NULL",id:"q5-the-problem-of-querying-bitmaphll-type-data-returns-null-1",level:3},{value:"Q6. Error when accessing object storage: curl 77: Problem with the SSL CA cert",id:"q6-error-when-accessing-object-storage-curl-77-problem-with-the-ssl-ca-cert",level:3},{value:"Q7. import error:&quot;Message&quot;: &quot;[INTERNAL_ERROR]single replica load is disabled on BE.&quot;",id:"q7-import-errormessage-internal_errorsingle-replica-load-is-disabled-on-be",level:3}];function d(e){let t={a:"a",code:"code",h1:"h1",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,i.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"sql-error",children:"SQL Error"})}),"\n",(0,s.jsx)(t.h3,{id:"q1-query-error-failed-to-get-scan-range-no-queryable-replica-found-in-tablet-xxxx",children:"Q1. Query error: Failed to get scan range, no queryable replica found in tablet: xxxx"}),"\n",(0,s.jsxs)(t.p,{children:["This happens because the corresponding tablet does not find a copy that can be queried, usually because the BE is down, the copy is missing, etc. You can first pass the ",(0,s.jsx)(t.code,{children:"show tablet tablet_id"})," statement and then execute the following ",(0,s.jsx)(t.code,{children:"show proc"})," statement to view the replica information corresponding to this tablet and check whether the replica is complete. At the same time, you can also query the progress of replica scheduling and repair in the cluster through ",(0,s.jsx)(t.code,{children:'show proc "/cluster_balance"'})," information."]}),"\n",(0,s.jsxs)(t.p,{children:["For commands related to data copy management, please refer to ",(0,s.jsx)(t.a,{href:"/docs/dev/admin-manual/maint-monitor/tablet-repair-and-balance",children:"Data Copy Management"}),"."]}),"\n",(0,s.jsx)(t.h3,{id:"q2-show-backendsfrontends-the-information-viewed-is-incomplete",children:"Q2. Show backends/frontends The information viewed is incomplete"}),"\n",(0,s.jsxs)(t.p,{children:["After executing certain statements such as ",(0,s.jsx)(t.code,{children:"show backends/frontends"}),", some columns may be found to be incomplete in the results. For example, the disk capacity information cannot be seen in the show backends result."]}),"\n",(0,s.jsx)(t.p,{children:"Usually this problem occurs when the cluster has multiple FEs. If users connect to non-Master FE nodes to execute these statements, they will see incomplete information. This is because some information exists only on the Master FE node. For example, BE's disk usage information, etc. Therefore, complete information can only be obtained after a direct connection to the Master FE."}),"\n",(0,s.jsxs)(t.p,{children:["Of course, users can also execute ",(0,s.jsx)(t.code,{children:"set forward_to_master=true;"})," before executing these statements. After the session variable is set to true, some information viewing statements executed subsequently will be automatically forwarded to the Master FE to obtain the results. In this way, no matter which FE the user is connected to, the complete result can be obtained."]}),"\n",(0,s.jsx)(t.h3,{id:"q3-invalid-cluster-id-xxxx",children:"Q3. invalid cluster id: xxxx"}),"\n",(0,s.jsx)(t.p,{children:"This error may appear in the results of the show backends or show frontends commands. Usually appears in the error message column of an FE or BE node. The meaning of this error is that after the Master FE sends the heartbeat information to the node, the node finds that the cluster id carried in the heartbeat information is different from the cluster id stored locally, so it refuses to respond to the heartbeat."}),"\n",(0,s.jsx)(t.p,{children:"The Master FE node of Doris will actively send heartbeats to each FE or BE node, and will carry a cluster_id in the heartbeat information. cluster_id is the unique cluster ID generated by the Master FE when a cluster is initialized. When the FE or BE receives the heartbeat information for the first time, the cluster_id will be saved locally in the form of a file. The file of FE is in the image/ directory of the metadata directory, and the BE has a cluster_id file in all data directories. After that, each time the node receives the heartbeat, it will compare the content of the local cluster_id with the content in the heartbeat. If it is inconsistent, it will refuse to respond to the heartbeat."}),"\n",(0,s.jsx)(t.p,{children:"This mechanism is a node authentication mechanism to prevent receiving false heartbeat messages sent by nodes outside the cluster."}),"\n",(0,s.jsx)(t.p,{children:"If needed to recover from this error. The first thing to do is to make sure that all the nodes are in the correct cluster. After that, for the FE node, you can try to modify the cluster_id value in the image/VERSION file in the metadata directory and restart the FE. For the BE node, you can delete all the cluster_id files in the data directory and restart the BE."}),"\n",(0,s.jsx)(t.h3,{id:"q4-unique-key-model-query-results-are-inconsistent",children:"Q4. Unique Key model query results are inconsistent"}),"\n",(0,s.jsx)(t.p,{children:"In some cases, when a user uses the same SQL to query a table with a Unique Key model, the results of multiple queries may be inconsistent. And the query results always change between 2-3 kinds."}),"\n",(0,s.jsx)(t.p,{children:"This may be because, in the same batch of imported data, there are data with the same key but different values, which will lead to inconsistent results between different replicas due to the uncertainty of the sequence of data overwriting."}),"\n",(0,s.jsx)(t.p,{children:"For example, the table is defined as k1, v1. A batch of imported data is as follows:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-text",children:'1, "abc"\n1, "def"\n'})}),"\n",(0,s.jsxs)(t.p,{children:["Then maybe the result of copy 1 is ",(0,s.jsx)(t.code,{children:'1, "abc"'}),", and the result of copy 2 is ",(0,s.jsx)(t.code,{children:'1, "def"'}),". As a result, the query results are inconsistent."]}),"\n",(0,s.jsxs)(t.p,{children:["To ensure that the data sequence between different replicas is unique, you can refer to the ",(0,s.jsx)(t.a,{href:"/docs/dev/data-operate/update/update-of-unique-model",children:"Sequence Column"})," function."]}),"\n",(0,s.jsx)(t.h3,{id:"q5-the-problem-of-querying-bitmaphll-type-data-returns-null",children:"Q5. The problem of querying bitmap/hll type data returns NULL"}),"\n",(0,s.jsx)(t.p,{children:"In version 1.1.x, when vectorization is enabled, and the bitmap type field in the query data table returns a NULL result,"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["First you have to ",(0,s.jsx)(t.code,{children:"set return_object_data_as_binary=true;"})]}),"\n",(0,s.jsxs)(t.li,{children:["Turn off vectorization ",(0,s.jsx)(t.code,{children:"set enable_vectorized_engine=false;"})]}),"\n",(0,s.jsxs)(t.li,{children:["Turn off SQL cache ",(0,s.jsx)(t.code,{children:"set [global] enable_sql_cache = false;"})]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"This is because the bitmap / hll type is in the vectorized execution engine: the input is all NULL, and the output result is also NULL instead of 0"}),"\n",(0,s.jsx)(t.h3,{id:"q5-the-problem-of-querying-bitmaphll-type-data-returns-null-1",children:"Q5. The problem of querying bitmap/hll type data returns NULL"}),"\n",(0,s.jsx)(t.p,{children:"In version 1.1.x, when vectorization is turned on, and the bitmp type field in the query data table returns a NULL result,"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["First you have to ",(0,s.jsx)(t.code,{children:"set return_object_data_as_binary=true;"})]}),"\n",(0,s.jsxs)(t.li,{children:["Turn off vectorization ",(0,s.jsx)(t.code,{children:"set enable_vectorized_engine=false;"})]}),"\n",(0,s.jsxs)(t.li,{children:["Turn off SQL cache ",(0,s.jsx)(t.code,{children:"set [global] enable_sql_cache = false;"})]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"This is because the bitmap/hll type is in the vectorized execution engine: the input is all NULL, and the output result is also NULL instead of 0"}),"\n",(0,s.jsx)(t.h3,{id:"q6-error-when-accessing-object-storage-curl-77-problem-with-the-ssl-ca-cert",children:"Q6. Error when accessing object storage: curl 77: Problem with the SSL CA cert"}),"\n",(0,s.jsxs)(t.p,{children:["If the ",(0,s.jsx)(t.code,{children:"curl 77: Problem with the SSL CA cert"})," error appears in the be.INFO log. You can try to solve it in the following ways:"]}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["Download the certificate at ",(0,s.jsx)(t.a,{href:"https://curl.se/docs/caextract.html",children:"https://curl.se/docs/caextract.html"}),": cacert.pem"]}),"\n",(0,s.jsxs)(t.li,{children:["Copy the certificate to the specified location: ",(0,s.jsx)(t.code,{children:"sudo cp /tmp/cacert.pem /etc/ssl/certs/ca-certificates.crt"})]}),"\n",(0,s.jsx)(t.li,{children:"Restart the BE node."}),"\n"]}),"\n",(0,s.jsx)(t.h3,{id:"q7-import-errormessage-internal_errorsingle-replica-load-is-disabled-on-be",children:'Q7. import error:"Message": "[INTERNAL_ERROR]single replica load is disabled on BE."'}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["Make sure this parameters ",(0,s.jsx)(t.code,{children:"enable_single_replica_load"})," in be.conf is set true"]}),"\n",(0,s.jsx)(t.li,{children:"Restart the BE node."}),"\n"]})]})}function h(e={}){let{wrapper:t}={...(0,i.a)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},250065:function(e,t,n){n.d(t,{Z:function(){return o},a:function(){return a}});var r=n(667294);let s={},i=r.createContext(s);function a(e){let t=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(i.Provider,{value:t},e.children)}}}]);