"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["906701"],{621426:function(e,n,a){a.r(n),a.d(n,{default:()=>m,frontMatter:()=>o,metadata:()=>i,assets:()=>s,toc:()=>c,contentTitle:()=>r});var i=JSON.parse('{"id":"data-operate/import/min-load-replica-num","title":"Minimum Number of Replicas Loading","description":"Importing data requires more than half of the replicas to be written successfully. However, it is not flexible enough and may cause inconvenience in some scenarios.","source":"@site/versioned_docs/version-2.0/data-operate/import/min-load-replica-num.md","sourceDirName":"data-operate/import","slug":"/data-operate/import/min-load-replica-num","permalink":"/docs/2.0/data-operate/import/min-load-replica-num","draft":false,"unlisted":false,"tags":[],"version":"2.0","frontMatter":{"title":"Minimum Number of Replicas Loading","language":"en"},"sidebar":"docs","previous":{"title":"Converting Source Data","permalink":"/docs/2.0/data-operate/import/load-data-convert"},"next":{"title":"Loading Strict Mode","permalink":"/docs/2.0/data-operate/import/load-strict-mode"}}'),t=a("785893"),l=a("250065");let o={title:"Minimum Number of Replicas Loading",language:"en"},r=void 0,s={},c=[{value:"Usage",id:"usage",level:2},{value:"Min load replica num for single table",id:"min-load-replica-num-for-single-table",level:3},{value:"Global min load replica num for all tables",id:"global-min-load-replica-num-for-all-tables",level:3},{value:"Other cases",id:"other-cases",level:3}];function d(e){let n={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,l.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"Importing data requires more than half of the replicas to be written successfully. However, it is not flexible enough and may cause inconvenience in some scenarios."}),"\n",(0,t.jsx)(n.p,{children:"For example, in the case of two replicas, to import data, both replicas need to be written successfully. This means that no replica is allowed to be unavailable during the data import process. This greatly affects the availability of the cluster."}),"\n",(0,t.jsx)(n.p,{children:"In order to solve the above problems, Doris allows users to set the minimum number of write replicas. For the task of importing data, when the number of replicas it successfully writes is greater than or equal to the minimum number of replicas written, the import is successful."}),"\n",(0,t.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,t.jsx)(n.h3,{id:"min-load-replica-num-for-single-table",children:"Min load replica num for single table"}),"\n",(0,t.jsxs)(n.p,{children:["You can set the table property ",(0,t.jsx)(n.code,{children:"min_load_replica_num"})," for a single olap table. The valid value of this property must be greater than 0 and not exceed ",(0,t.jsx)(n.code,{children:"replication_num"}),"\uFF08the number of replicas of the table\uFF09. Its default value is -1, indicating that the property is not enabled."]}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"min_load_replica_num"})," of the table can be set when creating the table."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE test_table1\n(\n    k1 INT,\n    k2 INT\n)\nDUPLICATE KEY(k1)\nDISTRIBUTED BY HASH(k1) BUCKETS 5\nPROPERTIES\n(\n    'replication_num' = '2',\n    'min_load_replica_num' = '1'\n);\n"})}),"\n",(0,t.jsxs)(n.p,{children:["For an existing table, you can use ",(0,t.jsx)(n.code,{children:"ALTER TABLE"})," to modify its ",(0,t.jsx)(n.code,{children:"min_load_replica_num"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"ALTER TABLE test_table1\nSET ( 'min_load_replica_num' = '1');\n"})}),"\n",(0,t.jsxs)(n.p,{children:["You can use ",(0,t.jsx)(n.code,{children:"SHOW CREATE TABLE"})," to view the table property ",(0,t.jsx)(n.code,{children:"min_load_replica_num"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"SHOW CREATE TABLE test_table1;\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The PROPERTIES of the output will contain ",(0,t.jsx)(n.code,{children:"min_load_replica_num"}),". e.g."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:'Create Table: CREATE TABLE `test_table1` (\n  `k1` int(11) NULL,\n  `k2` int(11) NULL\n) ENGINE=OLAP\nDUPLICATE KEY(`k1`)\nCOMMENT \'OLAP\'\nDISTRIBUTED BY HASH(`k1`) BUCKETS 5\nPROPERTIES (\n"replication_allocation" = "tag.location.default: 2",\n"min_load_replica_num" = "1",\n"storage_format" = "V2",\n"light_schema_change" = "true",\n"disable_auto_compaction" = "false",\n"enable_single_replica_compaction" = "false"\n);\n'})}),"\n",(0,t.jsx)(n.h3,{id:"global-min-load-replica-num-for-all-tables",children:"Global min load replica num for all tables"}),"\n",(0,t.jsxs)(n.p,{children:["You can set FE configuration item ",(0,t.jsx)(n.code,{children:"min_load_replica_num"})," for all olap tables. The valid value of this configuration item must be greater than 0. Its default value is -1, which means that the global minimum number of load replicas is not enabled."]}),"\n",(0,t.jsxs)(n.p,{children:["For a table, if the table property ",(0,t.jsx)(n.code,{children:"min_load_replica_num"})," is valid (>0), then the table will ignore the global configuration ",(0,t.jsx)(n.code,{children:"min_load_replica_num"}),". Otherwise, if the global configuration ",(0,t.jsx)(n.code,{children:"min_load_replica_num"})," is valid (>0), then the minimum number of load replicas for the table will be equal to ",(0,t.jsx)(n.code,{children:"min(FE.conf.min_load_replica_num, table.replication_num/2 + 1)"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["For viewing and modification of FE configuration items, you can refer to ",(0,t.jsx)(n.a,{href:"/docs/2.0/admin-manual/config/fe-config",children:"here"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"other-cases",children:"Other cases"}),"\n",(0,t.jsxs)(n.p,{children:["If the table property ",(0,t.jsx)(n.code,{children:"min_load_replica_num"})," is not enabled (<=0), and the global configuration ",(0,t.jsx)(n.code,{children:"min_load_replica_num"})," is not enabled(<=0), then the data import still needs to be successfully written to the majority replica. At this point, the minimum number of write replicas for the table is equal to ",(0,t.jsx)(n.code,{children:"table.replication_num/2 + 1"}),"."]})]})}function m(e={}){let{wrapper:n}={...(0,l.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},250065:function(e,n,a){a.d(n,{Z:function(){return r},a:function(){return o}});var i=a(667294);let t={},l=i.createContext(t);function o(e){let n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);