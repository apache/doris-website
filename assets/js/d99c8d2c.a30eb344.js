"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["111249"],{432628:function(e,s,r){r.r(s),r.d(s,{default:()=>c,frontMatter:()=>i,metadata:()=>n,assets:()=>h,toc:()=>d,contentTitle:()=>o});var n=JSON.parse('{"id":"release-and-verify/release-doris-shade","title":"Release Doris Shade","description":"\x3c!--","source":"@site/community/release-and-verify/release-doris-shade.md","sourceDirName":"release-and-verify","slug":"/release-and-verify/release-doris-shade","permalink":"/community/release-and-verify/release-doris-shade","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Release Doris Shade","language":"en"},"sidebar":"community","previous":{"title":"Release Doris Connectors","permalink":"/community/release-and-verify/release-doris-connectors"},"next":{"title":"Release Doris SDK","permalink":"/community/release-and-verify/release-doris-sdk"}}'),a=r("785893"),t=r("250065");let i={title:"Release Doris Shade",language:"en"},o="Release Doris Shade",h={},d=[{value:"Preparing for release",id:"preparing-for-release",level:2},{value:"Releasing to Maven",id:"releasing-to-maven",level:2},{value:"1. Prepare the branch",id:"1-prepare-the-branch",level:3},{value:"2. Release to Maven staging",id:"2-release-to-maven-staging",level:3},{value:"3. Prepare svn",id:"3-prepare-svn",level:3},{value:"4. Voting",id:"4-voting",level:3},{value:"Completing the release",id:"completing-the-release",level:2},{value:"APPENDIX: Releasing TO SNAPSHOT",id:"appendix-releasing-to-snapshot",level:2}];function l(e){let s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,t.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.header,{children:(0,a.jsx)(s.h1,{id:"release-doris-shade",children:"Release Doris Shade"})}),"\n",(0,a.jsx)(s.p,{children:"Its code base is independent of the main Doris code base, located at:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"https://github.com/apache/doris-shade",children:"https://github.com/apache/doris-shade"})}),"\n"]}),"\n",(0,a.jsx)(s.h2,{id:"preparing-for-release",children:"Preparing for release"}),"\n",(0,a.jsxs)(s.p,{children:["First, please refer to the ",(0,a.jsx)(s.a,{href:"/community/release-and-verify/release-prepare",children:"release preparation"})," document to prepare for the release."]}),"\n",(0,a.jsx)(s.h2,{id:"releasing-to-maven",children:"Releasing to Maven"}),"\n",(0,a.jsx)(s.p,{children:"Let's take the release of Doris Shade v1.0.0 as an example."}),"\n",(0,a.jsx)(s.h3,{id:"1-prepare-the-branch",children:"1. Prepare the branch"}),"\n",(0,a.jsx)(s.p,{children:"Create a branch in the code base: 1.0.0-release, and checkout to this branch."}),"\n",(0,a.jsx)(s.h3,{id:"2-release-to-maven-staging",children:"2. Release to Maven staging"}),"\n",(0,a.jsx)(s.p,{children:"Execute the following command to start generating release tags:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-shell",children:"mvn release:clean\nmvn release:prepare -DpushChanges=false\n"})}),"\n",(0,a.jsxs)(s.p,{children:["Among them, ",(0,a.jsx)(s.code,{children:"-DpushChanges=false"})," means that during the execution process, the newly generated branches and tags will not be pushed to the code base."]}),"\n",(0,a.jsxs)(s.p,{children:["After executing the ",(0,a.jsx)(s.code,{children:"release:prepare"})," command, the following three pieces of information will be requested:"]}),"\n",(0,a.jsxs)(s.ol,{children:["\n",(0,a.jsxs)(s.li,{children:["Version information of Doris Shade: We can use the default, you can directly press Enter or enter the version you want. The version format is ",(0,a.jsx)(s.code,{children:"{shade.version}"}),", such as ",(0,a.jsx)(s.code,{children:"1.0.0"}),"."]}),"\n",(0,a.jsxs)(s.li,{children:["Release tag of Doris Shade: The release process will generate a tag locally. We can use the default tag name, such as ",(0,a.jsx)(s.code,{children:"1.0.0"}),"."]}),"\n",(0,a.jsxs)(s.li,{children:["The version number of the next version of Doris Shade: this version number is only used when generating local branches, and has no practical significance. We can fill in one according to the rules. For example, the current version to be released is: ",(0,a.jsx)(s.code,{children:"1.0.0"}),", then fill in ",(0,a.jsx)(s.code,{children:"1.0.1-SNAPSHOT"})," for the next version number."]}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.code,{children:"mvn release:prepare"})," may ask for a GPG passphrase. If there is ",(0,a.jsx)(s.code,{children:"gpg: no valid OpenPGP data found"})," error, you can execute ",(0,a.jsx)(s.code,{children:"export GPG_TTY=$(tty)"})," and try again."]}),"\n",(0,a.jsxs)(s.p,{children:["After ",(0,a.jsx)(s.code,{children:"mvn release:prepare"})," is executed successfully, a tag and a branch will be generated locally. And the current branch will add two commits. The first commit corresponds to the newly generated tag, and the second is the next version of the branch. It can be viewed through ",(0,a.jsx)(s.code,{children:"git log"}),"."]}),"\n",(0,a.jsx)(s.p,{children:"After the local tag is confirmed to be correct, the tag needs to be pushed to the code base:"}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.code,{children:"git push upstream --tags"})}),"\n",(0,a.jsxs)(s.p,{children:["Where upstream points to the ",(0,a.jsx)(s.code,{children:"apache/doris-shade"})," codebase."]}),"\n",(0,a.jsx)(s.p,{children:"Finally, execute perform:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{children:"mvn release:perform\n"})}),"\n",(0,a.jsxs)(s.p,{children:["After successful execution, you can find the newly released version in ",(0,a.jsx)(s.a,{href:"https://repository.apache.org/#stagingRepositories",children:"https://repository.apache.org/#stagingRepositories"}),":"]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{src:r(197249).Z+"",width:"1057",height:"955"})}),"\n",(0,a.jsxs)(s.p,{children:["**Note that the ",(0,a.jsx)(s.code,{children:".asc"})," signature file needs to be included. **"]}),"\n",(0,a.jsx)(s.p,{children:"If the operation is wrong. It is necessary to delete the local tag, the tag in the code base, and the two newly generated commits locally. And drop staging. Then perform the above steps again."}),"\n",(0,a.jsxs)(s.p,{children:["After checking, click the ",(0,a.jsx)(s.code,{children:"close"})," button in the figure to complete the staging release."]}),"\n",(0,a.jsx)(s.h3,{id:"3-prepare-svn",children:"3. Prepare svn"}),"\n",(0,a.jsx)(s.p,{children:"Check out the svn repository:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{children:"svn co https://dist.apache.org/repos/dist/dev/doris/\n"})}),"\n",(0,a.jsxs)(s.p,{children:["Package tag source code, and generate signature file and sha256 verification file. Here we take ",(0,a.jsx)(s.code,{children:"1.0.0"})," as an example. Other tag operations are the same"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{children:"git archive --format=tar 1.14_2.12-1.0.0 --prefix=apache-doris-shade-1.0.0-src/ | gzip > apache-doris-shade-1.0.0-src.tar.gz\ngpg -u xxx@apache.org --armor --output apache-doris-shade-1.0.0-src.tar.gz.asc --detach-sign apache-doris-shade-1.0.0-src.tar. gz\nsha512sum apache-doris-shade-1.14_2.12-1.0.0-src.tar.gz > apache-doris-shade-1.0.0-src.tar.gz.sha512\n\nMac:\nshasum -a 512 apache-doris-shade-1.0.0-src.tar.gz > apache-doris-shade-1.0.0-src.tar.gz.sha512\n"})}),"\n",(0,a.jsx)(s.p,{children:"You end up with three files:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{children:"apache-doris-shade-1.0.0-src.tar.gz\napache-doris-shade-1.0.0-src.tar.gz.asc\napache-doris-shade-1.0.0-src.tar.gz.sha512\n"})}),"\n",(0,a.jsx)(s.p,{children:"Move these three files to the svn directory:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{children:"doris/doris-shade/1.0.0/\n"})}),"\n",(0,a.jsx)(s.p,{children:"The final svn directory structure is similar to:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{children:"\u251C\u2500\u2500 1.2.3-rc01\n\u2502 \u251C\u2500\u2500 apache-doris-1.2.3-src.tar.gz\n\u2502 \u251C\u2500\u2500 apache-doris-1.2.3-src.tar.gz.asc\n\u2502 \u251C\u2500\u2500 apache-doris-1.2.3-src.tar.gz.sha512\n...\n\u251C\u2500\u2500 KEYS\n\u251C\u2500\u2500 doris-shade\n\u2502 \u2514\u2500\u2500 1.0.0\n\u2502 \u251C\u2500\u2500 apache-doris-shade-1.0.0-src.tar.gz\n\u2502 \u251C\u2500\u2500 apache-doris-shade-1.0.0-src.tar.gz.asc\n\u2502 \u2514\u2500\u2500 apache-doris-shade-1.0.0-src.tar.gz.sha512\n"})}),"\n",(0,a.jsxs)(s.p,{children:["Among them, 1.2.3-rc01 is the directory of Doris main code, and ",(0,a.jsx)(s.code,{children:"doris-shade/1.0.0"})," is the content of this release."]}),"\n",(0,a.jsxs)(s.p,{children:["Note, for the preparation of the KEYS file, please refer to the introduction in ",(0,a.jsx)(s.a,{href:"/community/release-and-verify/release-prepare",children:"Release Preparation"}),"."]}),"\n",(0,a.jsx)(s.h3,{id:"4-voting",children:"4. Voting"}),"\n",(0,a.jsx)(s.p,{children:"Initiate a vote in the dev@doris mail group, the template is as follows:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{children:"Hi all,\n\nThis is a call for the vote to release Apache Doris-Shade 1.0.0\n\nThe git tag for the release:\nhttps://github.com/apache/doris-shade/releases/tag/doris-shade-1.0.0\n\nRelease Notes are here:\nhttps://github.com/apache/doris-shade/blob/doris-shade-1.0.0/CHANGE-LOG.txt\n\nThanks to everyone who has contributed to this release.\n\nThe release candidates:\nhttps://dist.apache.org/repos/dist/dev/doris/doris-shade/\n\nKEYS file is available here:\nhttps://downloads.apache.org/doris/KEYS\n\nTo verify and build, you can refer to the following link:\nhttps://doris.apache.org/community/release-and-verify/release-verify\n\nThe vote will be open for at least 72 hours.\n\n[ ] +1 Approve the release\n[ ] +0 No opinion\n[ ] -1 Do not release this package because ...\n"})}),"\n",(0,a.jsx)(s.h2,{id:"completing-the-release",children:"Completing the release"}),"\n",(0,a.jsxs)(s.p,{children:["Please refer to the ",(0,a.jsx)(s.a,{href:"/community/release-and-verify/release-complete",children:"Complete Release"})," document to complete the entire release process."]}),"\n",(0,a.jsx)(s.h2,{id:"appendix-releasing-to-snapshot",children:"APPENDIX: Releasing TO SNAPSHOT"}),"\n",(0,a.jsx)(s.p,{children:"Snapshot is not an Apache Release version, it is only used for preview before release. After being discussed and approved by the PMC, the Snapshot version can be released"}),"\n",(0,a.jsx)(s.p,{children:"Change to the doris shade directory"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{children:"mvn deploy\n"})}),"\n",(0,a.jsx)(s.p,{children:"Afterwards you can see the snapshot version here:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{children:"https://repository.apache.org/content/repositories/snapshots/org/apache/doris/doris-shade/\n"})})]})}function c(e={}){let{wrapper:s}={...(0,t.a)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},197249:function(e,s,r){r.d(s,{Z:function(){return n}});let n=r.p+"assets/images/staging-repositories-4c394e1094a6aa8ac05d6bfea6b48627.png"},250065:function(e,s,r){r.d(s,{Z:function(){return o},a:function(){return i}});var n=r(667294);let a={},t=n.createContext(a);function i(e){let s=n.useContext(t);return n.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),n.createElement(t.Provider,{value:s},e.children)}}}]);