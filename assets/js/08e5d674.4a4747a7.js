"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["231825"],{651593:function(e,n,s){s.r(n),s.d(n,{default:()=>p,frontMatter:()=>o,metadata:()=>t,assets:()=>l,toc:()=>c,contentTitle:()=>a});var t=JSON.parse('{"id":"install/deploy-on-kubernetes/separating-storage-compute/config-fe","title":"Config FE","description":"FE is primarily responsible for query parsing, planning, and related tasks in decoupled storage and compute mode.","source":"@site/docs/install/deploy-on-kubernetes/separating-storage-compute/config-fe.md","sourceDirName":"install/deploy-on-kubernetes/separating-storage-compute","slug":"/install/deploy-on-kubernetes/separating-storage-compute/config-fe","permalink":"/docs/dev/install/deploy-on-kubernetes/separating-storage-compute/config-fe","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1770477659000,"frontMatter":{"title":"Config FE","language":"en","description":"FE is primarily responsible for query parsing, planning, and related tasks in decoupled storage and compute mode."},"sidebar":"docs","previous":{"title":"Config MetaService","permalink":"/docs/dev/install/deploy-on-kubernetes/separating-storage-compute/config-ms"},"next":{"title":"Config ComputeGroups","permalink":"/docs/dev/install/deploy-on-kubernetes/separating-storage-compute/config-cg"}}'),r=s("785893"),i=s("250065");let o={title:"Config FE",language:"en",description:"FE is primarily responsible for query parsing, planning, and related tasks in decoupled storage and compute mode."},a=void 0,l={},c=[{value:"Configuring Compute Resources",id:"configuring-compute-resources",level:2},{value:"Configuring the Number of Follower Nodes",id:"configuring-the-number-of-follower-nodes",level:2},{value:"Custom Startup Configuration",id:"custom-startup-configuration",level:2},{value:"Access Configuration",id:"access-configuration",level:2},{value:"ClusterIP Mode",id:"clusterip-mode",level:3},{value:"Step 1: Configure ClusterIP Mode",id:"step-1-configure-clusterip-mode",level:4},{value:"Step 2: Obtain the Service Access Address",id:"step-2-obtain-the-service-access-address",level:4},{value:"Step 3: Access Doris from Within a Container",id:"step-3-access-doris-from-within-a-container",level:4},{value:"NodePort Mode",id:"nodeport-mode",level:3},{value:"Step 1: Configure FE NodePort",id:"step-1-configure-fe-nodeport",level:4},{value:"Step 2: Obtain the Service",id:"step-2-obtain-the-service",level:4},{value:"Step 3: Accessing Doris Using NodePort",id:"step-3-accessing-doris-using-nodeport",level:4},{value:"LoadBalancer Mode",id:"loadbalancer-mode",level:3},{value:"Step 1: Configure LoadBalancer Mode",id:"step-1-configure-loadbalancer-mode",level:4},{value:"Step 2: Obtain the Service",id:"step-2-obtain-the-service-1",level:4},{value:"Step 3: Accessing Doris Using LoadBalancer",id:"step-3-accessing-doris-using-loadbalancer",level:4},{value:"Persistent Storage",id:"persistent-storage",level:2},{value:"Automatically Generating Persistent Storage Using a Storage Template",id:"automatically-generating-persistent-storage-using-a-storage-template",level:3},{value:"Custom Mount Point Configuration",id:"custom-mount-point-configuration",level:3},{value:"Disable Log Persistence",id:"disable-log-persistence",level:3}];function d(e){let n={a:"a",admonition:"admonition",br:"br",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"FE is primarily responsible for query parsing, planning, and related tasks in decoupled storage and compute mode."}),"\n",(0,r.jsx)(n.h2,{id:"configuring-compute-resources",children:"Configuring Compute Resources"}),"\n",(0,r.jsxs)(n.p,{children:["In the deployment sample provided in the ",(0,r.jsx)(n.a,{href:"https://github.com/apache/doris-operator/blob/master/doc/examples/disaggregated/cluster/ddc-sample.yaml",children:"Doris Operator repository"}),", the FE service has no resource restrictions by default. CPU and memory resources for the service can be configured using Kubernetes ",(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/",children:"requests and limits"}),". For example, to allocate 8 CPU cores and 8Gi of memory for FE, use the following configuration:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"spec:\n  feSpec:\n    requests:\n      cpu: 8\n      memory: 8Gi\n    limits:\n      cpu: 8\n      memory: 8Gi\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Update the above configuration in the ",(0,r.jsx)(n.a,{href:"/docs/dev/install/deploy-on-kubernetes/separating-storage-compute/install-doris-cluster#step-3-deploy-the-compute-storage-decoupled-cluster",children:"DorisDisaggregatedCluster resource"})," that you intend to deploy."]}),"\n",(0,r.jsx)(n.h2,{id:"configuring-the-number-of-follower-nodes",children:"Configuring the Number of Follower Nodes"}),"\n",(0,r.jsx)(n.p,{children:"In a Doris Frontend (FE) service, there are two types of roles: Follower and Observer. Follower nodes are responsible for SQL parsing, metadata management, and storage. Observer nodes primarily handle SQL parsing to offload query and write traffic from Followers. Doris uses the bdbje storage system for metadata management, which implements an algorithm similar to the Paxos protocol."}),"\n",(0,r.jsx)(n.p,{children:"In a distributed deployment, multiple Follower nodes must be configured to participate in metadata management within the distributed environment."}),"\n",(0,r.jsxs)(n.p,{children:["When deploying a compute-storage disaggregated Doris cluster using the ",(0,r.jsx)(n.code,{children:"DorisDisaggregatedCluster"})," resource, the default number of Follower nodes is set to 1. You can configure the number of Followers using the following setting. The example below configures three Follower nodes:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"spec:\n  feSpec:\n    electionNumber: 3\n"})}),"\n",(0,r.jsx)(n.admonition,{title:"Note",type:"tip",children:(0,r.jsxs)(n.p,{children:["Once the disaggregated cluster is deployed, the ",(0,r.jsx)(n.code,{children:"electionNumber"})," setting cannot be modified."]})}),"\n",(0,r.jsx)(n.h2,{id:"custom-startup-configuration",children:"Custom Startup Configuration"}),"\n",(0,r.jsx)(n.p,{children:"The Doris Operator mounts the FE startup configuration using a Kubernetes ConfigMap. Follow these steps to configure it:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Create a Custom ConfigMap Containing the FE Startup Configuration",(0,r.jsx)(n.br,{}),"\nIn the default deployment, each FE service starts with a default configuration file embedded in the image. You can override this by creating a custom ConfigMap. For example:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: fe-configmap\n  namespace: default\n  labels:\n    app.kubernetes.io/component: fe\ndata:\n  fe.conf: |\n    CUR_DATE=`date +%Y%m%d-%H%M%S`\n    # Log dir\n    LOG_DIR = ${DORIS_HOME}/log\n    # For jdk 17, this JAVA_OPTS will be used as default JVM options\n    JAVA_OPTS_FOR_JDK_17="-Djavax.security.auth.useSubjectCredsOnly=false -Xmx8192m -Xms8192m -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=$LOG_DIR -Xlog:gc*:$LOG_DIR/fe.gc.log.$CUR_DATE:time,uptime:filecount=10,filesize=50M --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens java.base/jdk.internal.ref=ALL-UNNAMED"\n    # INFO, WARN, ERROR, FATAL\n    sys_log_level = INFO\n    # NORMAL, BRIEF, ASYNC\n    sys_log_mode = NORMAL\n    # Default dirs to put jdbc drivers,default value is ${DORIS_HOME}/jdbc_drivers\n    # jdbc_drivers_dir = ${DORIS_HOME}/jdbc_drivers\n    http_port = 8030\n    rpc_port = 9020\n    query_port = 9030\n    edit_log_port = 9010\n    enable_fqdn_mode=true\n    deploy_mode = cloud\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Deploy the ConfigMap",(0,r.jsx)(n.br,{}),"\nDeploy the custom ConfigMap to the namespace where the DorisDisaggregatedCluster resource resides by executing:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"kubectl apply -n ${namespace} -f ${feConfigMapName}.yaml\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Here, ",(0,r.jsx)(n.code,{children:"${namespace}"})," is the namespace of the ",(0,r.jsx)(n.code,{children:"DorisDisaggregatedCluster"})," resource, and ",(0,r.jsx)(n.code,{children:"${feConfigMapName}"})," is the filename of the ConfigMap."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Update the ",(0,r.jsx)(n.code,{children:"DorisDisaggregatedCluster"})," Resource to Use the ConfigMap",(0,r.jsx)(n.br,{}),"\nIn the ",(0,r.jsx)(n.code,{children:"DorisDisaggregatedCluster"})," resource, mount the ConfigMap using the ",(0,r.jsx)(n.code,{children:"feSpec.configMaps"})," array, as shown below:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"spec:\n  feSpec:\n    replicas: 2\n    configMaps:\n    - name: fe-configmap\n"})}),"\n",(0,r.jsxs)(n.p,{children:["In the ",(0,r.jsx)(n.code,{children:"DorisDisaggregatedCluster"})," resource, the ",(0,r.jsx)(n.code,{children:"configMaps"})," field is an array, with each element's ",(0,r.jsx)(n.code,{children:"name"})," representing the name of the ConfigMap in the current namespace."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{title:"Tip",type:"tip",children:(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["In Kubernetes deployments, it is not necessary to include ",(0,r.jsx)(n.code,{children:"meta_service_endpoint"})," or ",(0,r.jsx)(n.code,{children:"cluster_id"})," in the startup configuration, as the Doris Operator will automatically add this information."]}),"\n",(0,r.jsxs)(n.li,{children:["When customizing the startup configuration, ",(0,r.jsx)(n.code,{children:"enable_fqdn_mode"})," must be set to true."]}),"\n"]})}),"\n",(0,r.jsx)(n.h2,{id:"access-configuration",children:"Access Configuration"}),"\n",(0,r.jsxs)(n.p,{children:["The Doris Operator uses Kubernetes Services to provide VIP and load balancing capabilities, supporting three exposure modes: ",(0,r.jsx)(n.code,{children:"ClusterIP"}),", ",(0,r.jsx)(n.code,{children:"NodePort"}),", and ",(0,r.jsx)(n.code,{children:"LoadBalancer"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"clusterip-mode",children:"ClusterIP Mode"}),"\n",(0,r.jsxs)(n.p,{children:["Kubernetes uses the ",(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/services-networking/service/#type-clusterip",children:(0,r.jsx)(n.code,{children:"ClusterIP service type"})})," by default. This mode provides an internal address within the Kubernetes cluster."]}),"\n",(0,r.jsx)(n.h4,{id:"step-1-configure-clusterip-mode",children:"Step 1: Configure ClusterIP Mode"}),"\n",(0,r.jsx)(n.p,{children:"By default, Doris is configured to use ClusterIP mode on Kubernetes; no additional configuration is required."}),"\n",(0,r.jsx)(n.h4,{id:"step-2-obtain-the-service-access-address",children:"Step 2: Obtain the Service Access Address"}),"\n",(0,r.jsx)(n.p,{children:"After deploying the cluster, view the FE service by running:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"kubectl -n doris get svc\n"})}),"\n",(0,r.jsx)(n.p,{children:"A sample output is:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"NAME                              TYPE        CLUSTER-IP    EXTERNAL-IP   PORT(S)                               AGE\ndoriscluster-sample-fe-internal   ClusterIP   None          <none>        9030/TCP                              14m\ndoriscluster-sample-fe            ClusterIP   10.1.118.16   <none>        8030/TCP,9020/TCP,9030/TCP,9010/TCP   14m\n"})}),"\n",(0,r.jsx)(n.p,{children:'In the output above, the service with the suffix "internal" is used solely for internal communication (e.g., heartbeat, data exchange) and is not exposed externally. The service without the "internal" suffix is used for external access to the FE service.'}),"\n",(0,r.jsx)(n.h4,{id:"step-3-access-doris-from-within-a-container",children:"Step 3: Access Doris from Within a Container"}),"\n",(0,r.jsx)(n.p,{children:"Create a Pod with the MySQL client in the current Kubernetes cluster by running:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"kubectl run mysql-client --image=mysql:5.7 -it --rm --restart=Never --namespace=doris -- /bin/bash\n"})}),"\n",(0,r.jsx)(n.p,{children:'Within the Pod, connect to the Doris cluster by using the Service name that does not have the "internal" suffix:'}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"mysql -uroot -P9030 -hdoriscluster-sample-fe-service\n"})}),"\n",(0,r.jsx)(n.h3,{id:"nodeport-mode",children:"NodePort Mode"}),"\n",(0,r.jsxs)(n.p,{children:["To access Doris from outside the Kubernetes cluster, you can use the ",(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/services-networking/service/#type-nodeport",children:"NodePort service type"}),". NodePort mode supports two configuration methods: static host port assignment and dynamic host port assignment."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Dynamic Host Port Assignment:\nIf no explicit port mapping is provided, Kubernetes automatically assigns an unused host port (default range: 30000\u201332767) when the pod is created."}),"\n",(0,r.jsx)(n.li,{children:"Static Host Port Assignment:\nIf a port mapping is explicitly specified and the host port is available and conflict-free, Kubernetes will allocate that port. For static assignment, you must plan the port mappings. Doris provides the following ports for external interactions:"}),"\n"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Port Name"}),(0,r.jsx)(n.th,{children:"Default Port"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Query Port"}),(0,r.jsx)(n.td,{children:"9030"}),(0,r.jsx)(n.td,{children:"Used to access the Doris cluster via the MySQL protocol."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"HTTP Port"}),(0,r.jsx)(n.td,{children:"8030"}),(0,r.jsx)(n.td,{children:"The HTTP server port on FE, used to view FE information."})]})]})]}),"\n",(0,r.jsx)(n.h4,{id:"step-1-configure-fe-nodeport",children:"Step 1: Configure FE NodePort"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Dynamic Assignment Configuration:\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"spec:\n  feSpec:\n    service:\n      type: NodePort\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Static Assignment Configuration Example:\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"spec:\n  feSpec:\n    service:\n      type: NodePort\n      portMaps:\n      - nodePort: 31001\n        targetPort: 8030\n      - nodePort: 31002\n        targetPort: 9030\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"step-2-obtain-the-service",children:"Step 2: Obtain the Service"}),"\n",(0,r.jsx)(n.p,{children:"After the cluster is deployed, run the following command to view the Service:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"kubectl get service\n"})}),"\n",(0,r.jsx)(n.p,{children:"A sample output is:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"NAME                              TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)                                                       AGE\nkubernetes                        ClusterIP   10.152.183.1     <none>        443/TCP                                                       169d\ndoriscluster-sample-fe-internal   ClusterIP   None             <none>        9030/TCP                                                      2d\ndoriscluster-sample-fe            NodePort    10.152.183.58    <none>        8030:31041/TCP,9020:30783/TCP,9030:31545/TCP,9010:31610/TCP   2d\n"})}),"\n",(0,r.jsx)(n.h4,{id:"step-3-accessing-doris-using-nodeport",children:"Step 3: Accessing Doris Using NodePort"}),"\n",(0,r.jsxs)(n.p,{children:["For example, if Doris' ",(0,r.jsx)(n.code,{children:"Query Port"})," is mapped to host port 31545, first obtain the IP address of one node in the Kubernetes cluster by running:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"kubectl get nodes -o wide\n"})}),"\n",(0,r.jsx)(n.p,{children:"A sample output is:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"NAME   STATUS   ROLES           AGE   VERSION   INTERNAL-IP     EXTERNAL-IP   OS-IMAGE          KERNEL-VERSION          CONTAINER-RUNTIME\nr60    Ready    control-plane   14d   v1.28.2   192.168.88.60   <none>        CentOS Stream 8   4.18.0-294.el8.x86_64   containerd://1.6.22\nr61    Ready    <none>          14d   v1.28.2   192.168.88.61   <none>        CentOS Stream 8   4.18.0-294.el8.x86_64   containerd://1.6.22\nr62    Ready    <none>          14d   v1.28.2   192.168.88.62   <none>        CentOS Stream 8   4.18.0-294.el8.x86_64   containerd://1.6.22\nr63    Ready    <none>          14d   v1.28.2   192.168.88.63   <none>        CentOS Stream 8   4.18.0-294.el8.x86_64   containerd://1.6.22\n"})}),"\n",(0,r.jsx)(n.p,{children:"Using any of these node IPs (for example, 192.168.88.62), connect to the Doris cluster with:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"mysql -h 192.168.88.62 -P31545 -uroot\n"})}),"\n",(0,r.jsx)(n.h3,{id:"loadbalancer-mode",children:"LoadBalancer Mode"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/services-networking/service/#loadbalancer",children:"LoadBalancer service"})," type is applicable in cloud-based Kubernetes environments and is provided by the cloud provider's load balancer."]}),"\n",(0,r.jsx)(n.h4,{id:"step-1-configure-loadbalancer-mode",children:"Step 1: Configure LoadBalancer Mode"}),"\n",(0,r.jsxs)(n.p,{children:["Set the ",(0,r.jsx)(n.code,{children:"feSpec.service"})," type to LoadBalancer, as shown:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'spec:\n  feSpec:\n    service:\n      type: LoadBalancer\n      annotations:\n        service.beta.kubernetes.io/load-balancer-type: "external"\n'})}),"\n",(0,r.jsx)(n.h4,{id:"step-2-obtain-the-service-1",children:"Step 2: Obtain the Service"}),"\n",(0,r.jsx)(n.p,{children:"After deploying the cluster, view the Service by running:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"kubectl get service\n"})}),"\n",(0,r.jsx)(n.p,{children:"A sample output is:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"NAME                              TYPE           CLUSTER-IP       EXTERNAL-IP                                                                     PORT(S)                                                       AGE\nkubernetes                        ClusterIP      10.152.183.1     <none>                                                                          443/TCP                                                       169d\ndoriscluster-sample-fe-internal   ClusterIP      None             <none>                                                                          9030/TCP                                                      2d\ndoriscluster-sample-fe            LoadBalancer   10.152.183.58    ac4828493dgrftb884g67wg4tb68gyut-1137856348.us-east-1.elb.amazonaws.com         8030:31041/TCP,9020:30783/TCP,9030:31545/TCP,9010:31610/TCP   2d\n"})}),"\n",(0,r.jsx)(n.h4,{id:"step-3-accessing-doris-using-loadbalancer",children:"Step 3: Accessing Doris Using LoadBalancer"}),"\n",(0,r.jsx)(n.p,{children:"For example, if Doris' Query Port listens on port 9030, connect using:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"mysql -h ac4828493dgrftb884g67wg4tb68gyut-1137856348.us-east-1.elb.amazonaws.com -P9030 -uroot\n"})}),"\n",(0,r.jsx)(n.h2,{id:"persistent-storage",children:"Persistent Storage"}),"\n",(0,r.jsxs)(n.p,{children:["In the default deployment, the FE service uses Kubernetes ",(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/storage/volumes/#emptydir",children:"EmptyDir"})," as its metadata storage mode. Since EmptyDir is non-persistent, metadata will be lost after a service restart. To ensure that FE metadata is preserved after restarts, persistent storage must be configured."]}),"\n",(0,r.jsx)(n.h3,{id:"automatically-generating-persistent-storage-using-a-storage-template",children:"Automatically Generating Persistent Storage Using a Storage Template"}),"\n",(0,r.jsx)(n.p,{children:"Configure persistent storage for logs and metadata using a storage template, as shown below:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"spec:\n  feSpec:\n    persistentVolumes:\n    - persistentVolumeClaimSpec:\n      # storageClassName: ${storageclass_name}\n        accessModes:\n          - ReadWriteOnce\n        resources:\n          requests:\n            storage: 200Gi\n"})}),"\n",(0,r.jsxs)(n.p,{children:["When deployed with the above configuration, the Doris Operator automatically mounts persistent storage for the log directory (default ",(0,r.jsx)(n.code,{children:"/opt/apache-doris/fe/log"}),") and the metadata directory (default ",(0,r.jsx)(n.code,{children:"/opt/apache-doris/fe/doris-meta"}),"). If the log or metadata directory is explicitly specified in the ",(0,r.jsx)(n.a,{href:"#custom-startup-configuration",children:"custom startup configuration"}),", the Doris Operator will parse and mount the persistent storage accordingly. Persistent storage is implemented using the ",(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/storage/storage-classes/",children:"StorageClass mechanism"}),", which allows specifying the required StorageClass via the ",(0,r.jsx)(n.code,{children:"storageClassName"})," field."]}),"\n",(0,r.jsx)(n.h3,{id:"custom-mount-point-configuration",children:"Custom Mount Point Configuration"}),"\n",(0,r.jsx)(n.p,{children:"The Doris Operator supports customized storage configurations for mount points. The following example mounts 300Gi of storage for the log directory using a custom configuration and 200Gi for the metadata directory using the storage template:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"spec:\n  feSpec:\n    persistentVolumes:\n    - mountPaths:\n      - /opt/apache-doris/fe/log\n      persistentVolumeClaimSpec:\n      # storageClassName: ${storageclass_name}\n        accessModes:\n          - ReadWriteOnce\n        resources:\n          requests:\n            storage: 300Gi\n    - persistentVolumeClaimSpec:\n      # storageClassName: ${storageclass_name}\n        accessModes:\n          - ReadWriteOnce\n        resources:\n          requests:\n            storage: 200Gi\n"})}),"\n",(0,r.jsx)(n.admonition,{title:"Tip",type:"tip",children:(0,r.jsxs)(n.p,{children:["If the ",(0,r.jsx)(n.code,{children:"mountPaths"})," array is empty, it indicates that the current storage configuration is using the template configuration."]})}),"\n",(0,r.jsx)(n.h3,{id:"disable-log-persistence",children:"Disable Log Persistence"}),"\n",(0,r.jsx)(n.p,{children:"If log persistence is not desired and logs should only be output to the standard output, configure as follows:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"spec:\n  feSpec:\n    logNotStore: true\n"})})]})}function p(e={}){let{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},250065:function(e,n,s){s.d(n,{Z:function(){return a},a:function(){return o}});var t=s(667294);let r={},i=t.createContext(r);function o(e){let n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);