"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["862326"],{37097:function(e,n,s){s.r(n),s.d(n,{default:()=>h,frontMatter:()=>l,metadata:()=>i,assets:()=>d,toc:()=>o,contentTitle:()=>t});var i=JSON.parse('{"id":"query-acceleration/materialized-view/async-materialized-view/use-advice","title":"Use Advice","description":"Overview","source":"@site/versioned_docs/version-2.1/query-acceleration/materialized-view/async-materialized-view/use-advice.md","sourceDirName":"query-acceleration/materialized-view/async-materialized-view","slug":"/query-acceleration/materialized-view/async-materialized-view/use-advice","permalink":"/docs/2.1/query-acceleration/materialized-view/async-materialized-view/use-advice","draft":false,"unlisted":false,"tags":[],"version":"2.1","frontMatter":{"title":"Use Advice","language":"en"},"sidebar":"docs","previous":{"title":"Best Practices","permalink":"/docs/2.1/query-acceleration/materialized-view/async-materialized-view/use-guide"},"next":{"title":"FAQ","permalink":"/docs/2.1/query-acceleration/materialized-view/async-materialized-view/faq"}}'),r=s("785893"),a=s("250065");let l={title:"Use Advice",language:"en"},t=void 0,d={},o=[{value:"Overview",id:"overview",level:2},{value:"Recommended Usage Scenarios",id:"recommended-usage-scenarios",level:2},{value:"Recommended Scenarios",id:"recommended-scenarios",level:3},{value:"Complex Aggregation Queries",id:"complex-aggregation-queries",level:4},{value:"Reporting",id:"reporting",level:4},{value:"Computation-Intensive Analysis",id:"computation-intensive-analysis",level:4},{value:"Star/Snowflake Schemas in Data Warehouses",id:"starsnowflake-schemas-in-data-warehouses",level:4},{value:"Data Lake Acceleration",id:"data-lake-acceleration",level:4},{value:"Data Warehouse Layering",id:"data-warehouse-layering",level:4},{value:"Not Recommended Scenarios",id:"not-recommended-scenarios",level:3},{value:"Frequently Updated Base Tables",id:"frequently-updated-base-tables",level:4},{value:"Simple Queries",id:"simple-queries",level:4},{value:"Scenarios Requiring Real-Time (1\u20135 Minute Freshness) Data",id:"scenarios-requiring-real-time-15-minute-freshness-data",level:4},{value:"Small Source Tables",id:"small-source-tables",level:4},{value:"Refresh Strategy Recommendations",id:"refresh-strategy-recommendations",level:2},{value:"Detailed Refresh Strategies",id:"detailed-refresh-strategies",level:3},{value:"Manual Refresh",id:"manual-refresh",level:4},{value:"Scheduled Refresh",id:"scheduled-refresh",level:4},{value:"Trigger-Based Refresh",id:"trigger-based-refresh",level:4},{value:"Combined Refresh Strategy Recommendations",id:"combined-refresh-strategy-recommendations",level:3},{value:"Layered Strategy",id:"layered-strategy",level:4},{value:"Business Criticality Tiering",id:"business-criticality-tiering",level:4},{value:"Data Change Frequency Adaptation",id:"data-change-frequency-adaptation",level:4},{value:"Refresh Frequency Recommendations",id:"refresh-frequency-recommendations",level:3},{value:"Key Considerations for Asynchronous Materialized Views",id:"key-considerations-for-asynchronous-materialized-views",level:2}];function c(e){let n={a:"a",br:"br",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(n.p,{children:["Asynchronous materialized views improve query performance by precomputing and storing query results, but each refresh may incur significant overhead. This document provides usage recommendations for asynchronous materialized views.",(0,r.jsx)(n.br,{}),"\nFor the refresh principles of materialized views, refer to: ",(0,r.jsx)(n.a,{href:"/docs/2.1/query-acceleration/materialized-view/overview",children:"Refresh Principles"})]}),"\n",(0,r.jsx)(n.h2,{id:"recommended-usage-scenarios",children:"Recommended Usage Scenarios"}),"\n",(0,r.jsx)(n.h3,{id:"recommended-scenarios",children:"Recommended Scenarios"}),"\n",(0,r.jsx)(n.h4,{id:"complex-aggregation-queries",children:"Complex Aggregation Queries"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scenario"}),": Queries involving multi-table joins, complex aggregate functions (e.g., SUM, AVG, COUNT), or window functions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Advantage"}),": Avoids recomputing complex logic during each execution"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"reporting",children:"Reporting"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scenario"}),": Reports requiring consistent snapshots at fixed time points (e.g., daily midnight)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Advantage"}),": Ensures all users see data from the same point in time"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"computation-intensive-analysis",children:"Computation-Intensive Analysis"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scenario"}),": Analytical queries involving complex mathematical calculations or data transformations, such as customer lifetime value calculations or predictive modeling"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Advantage"}),": Precomputes results to reduce runtime resource consumption"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"starsnowflake-schemas-in-data-warehouses",children:"Star/Snowflake Schemas in Data Warehouses"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scenario"}),": Fact tables joined with multiple dimension tables, e.g., sales fact tables joined with product, time, and region dimension tables"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Advantage"}),": Pre-materializes join results to accelerate analytical queries"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"data-lake-acceleration",children:"Data Lake Acceleration"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scenario"}),": Queries on data lakes may slow down due to network latency and object storage throughput limitations"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Advantage"}),": Leverages Doris's local storage advantages to accelerate data lake analysis"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"data-warehouse-layering",children:"Data Warehouse Layering"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scenario"}),": Base tables contain large amounts of raw data, and queries require complex ETL operations"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Advantage"}),": Implements data warehouse layering by building multi-level asynchronous materialized views"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"not-recommended-scenarios",children:"Not Recommended Scenarios"}),"\n",(0,r.jsx)(n.h4,{id:"frequently-updated-base-tables",children:"Frequently Updated Base Tables"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scenario"}),": Source table data changes very frequently (e.g., multiple updates per minute)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Issue"}),": Asynchronous materialized views struggle to stay synchronized, and refresh costs are too high. Consider periodic refreshes instead."]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"simple-queries",children:"Simple Queries"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scenario"}),": Queries involving only single-table scans or simple filtering"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Issue"}),": The benefits of asynchronous materialized views cannot offset the refresh costs"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"scenarios-requiring-real-time-15-minute-freshness-data",children:"Scenarios Requiring Real-Time (1\u20135 Minute Freshness) Data"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scenario"}),": Business requirements demand the latest data"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Issue"}),": Asynchronous materialized views introduce data latency"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"small-source-tables",children:"Small Source Tables"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scenario"}),": Base tables contain only a small number of records (e.g., a few hundred rows)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Issue"}),": The optimization effect of asynchronous materialized views is negligible"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"refresh-strategy-recommendations",children:"Refresh Strategy Recommendations"}),"\n",(0,r.jsx)(n.p,{children:"Asynchronous materialized views offer three primary refresh strategies, each suited to different business scenarios and data characteristics. Choosing the right strategy is critical for balancing data freshness and system performance."}),"\n",(0,r.jsx)(n.h3,{id:"detailed-refresh-strategies",children:"Detailed Refresh Strategies"}),"\n",(0,r.jsx)(n.h4,{id:"manual-refresh",children:"Manual Refresh"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"How It Works"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Triggered explicitly by user commands or external system scheduling"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Applicable Scenarios"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Reporting systems with low real-time data requirements"}),"\n",(0,r.jsx)(n.li,{children:"Historical data analysis in data warehouses"}),"\n",(0,r.jsx)(n.li,{children:"Scenarios requiring synchronization with specific business processes"}),"\n",(0,r.jsx)(n.li,{children:"Large-scale data refreshes requiring coordinated system resources"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Pros and Cons"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Pros: Full control over refresh timing, avoiding peak business hours"}),"\n",(0,r.jsx)(n.li,{children:"Cons: Requires additional scheduling management and fault tolerance to prevent external loops from continuously triggering refreshes"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"scheduled-refresh",children:"Scheduled Refresh"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"How It Works"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Automatically refreshes at fixed intervals"}),"\n",(0,r.jsx)(n.li,{children:"Minimum time unit: minutes"}),"\n",(0,r.jsx)(n.li,{children:"Can specify the start time for the first task run"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Applicable Scenarios"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Periodic business metric monitoring"}),"\n",(0,r.jsx)(n.li,{children:"Tiered data pipelines"}),"\n",(0,r.jsx)(n.li,{children:"Time-sensitive reporting systems"}),"\n",(0,r.jsx)(n.li,{children:"Source data with regular fluctuations"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Pros and Cons"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Pros: Scheduled data processing with predictable data latency"}),"\n",(0,r.jsx)(n.li,{children:"Cons: Limited data freshness; refresh sequences for related views require manual orchestration"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Configuration Constraints"}),":",(0,r.jsx)(n.br,{}),"\nAvoid configuring all materialized views for high-frequency scheduled refreshes to achieve near-real-time results, as this may:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Continuously occupy system resources"}),"\n",(0,r.jsx)(n.li,{children:"Cause refresh jobs to compete for resources"}),"\n",(0,r.jsx)(n.li,{children:"Frequent partition/tablet operations may impose heavy pressure on BEs"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"trigger-based-refresh",children:"Trigger-Based Refresh"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"How It Works"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Automatically triggers refreshes when base table data changes"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Applicable Scenarios"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Upper-layer views in a multi-level materialized view architecture"}),"\n",(0,r.jsx)(n.li,{children:"Scenarios where base tables change infrequently"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Pros and Cons"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Pros: High data freshness and automation"}),"\n",(0,r.jsx)(n.li,{children:"Cons: May cause refresh storms and unpredictable system load"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Configuration Constraints"}),":",(0,r.jsx)(n.br,{}),"\nAvoid using trigger-based refreshes for foundational materialized views unless:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Base table refresh frequency is known to be low (e.g., changes every few tens of minutes)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"combined-refresh-strategy-recommendations",children:"Combined Refresh Strategy Recommendations"}),"\n",(0,r.jsx)(n.h4,{id:"layered-strategy",children:"Layered Strategy"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Foundation Layer"}),": Scheduled refresh (e.g., hourly)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Intermediate Layer"}),": Scheduled or trigger-based refresh"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Presentation Layer"}),": Trigger-based or manual refresh"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"business-criticality-tiering",children:"Business Criticality Tiering"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Critical Real-Time Business Data"}),": Not recommended for asynchronous materialized views"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Regular Analytical Data"}),": Scheduled refresh (daily/hourly)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Historical/Archived Data"}),": Manual refresh"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"data-change-frequency-adaptation",children:"Data Change Frequency Adaptation"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"High-Frequency Changes"}),": Scheduled refresh (longer intervals) or manual refresh"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Low-Frequency Changes"}),": Trigger-based refresh or short-interval scheduled refresh"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Bulk Changes"}),": Manual refresh after changes"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"refresh-frequency-recommendations",children:"Refresh Frequency Recommendations"}),"\n",(0,r.jsx)(n.p,{children:"These are general guidelines; actual settings should consider system resources, the number of materialized views, and other business resource usage."}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Actual Refresh Time"}),(0,r.jsx)(n.th,{children:"Recommended Refresh Frequency"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"< 15s"}),(0,r.jsx)(n.td,{children:"\u2265 5 minutes"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"< 10 minutes"}),(0,r.jsx)(n.td,{children:"\u2265 1 hour"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"< 1 hour"}),(0,r.jsx)(n.td,{children:"\u2265 1 day"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"key-considerations-for-asynchronous-materialized-views",children:"Key Considerations for Asynchronous Materialized Views"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Monitoring"}),": After deploying materialized views, monitor system performance via ",(0,r.jsx)(n.a,{href:"/docs/2.1/admin-manual/maint-monitor/metrics",children:"metrics"}),". Additional metrics for asynchronous materialized views will be exposed in the future. Currently, use ",(0,r.jsx)(n.a,{href:"/docs/2.1/sql-manual/sql-functions/table-valued-functions/tasks",children:"tasks"})," to check task count, execution status, and duration."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Planning"}),': Plan the number of materialized views, refresh frequency, and the cluster\'s maximum computational capacity. Avoid "creating materialized views without maintaining them"\u2014they are essentially enhanced ETL computations and require maintenance like traditional ETL.']}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Resource Isolation"}),": Materialized views are data computation tasks. Implement resource isolation as needed."]}),"\n"]})]})}function h(e={}){let{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},250065:function(e,n,s){s.d(n,{Z:function(){return t},a:function(){return l}});var i=s(667294);let r={},a=i.createContext(r);function l(e){let n=i.useContext(a);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);