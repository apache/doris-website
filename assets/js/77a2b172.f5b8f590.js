"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["331698"],{669262:function(e,n,t){t.r(n),t.d(n,{default:()=>m,frontMatter:()=>o,metadata:()=>s,assets:()=>l,toc:()=>c,contentTitle:()=>r});var s=JSON.parse('{"id":"sql-manual/basic-element/sql-data-types/date-time/TIMESTAMPTZ","title":"TIMESTAMPTZ","description":"TIMESTAMPTZ is the data type in Doris used to store date and time information with time zone awareness,","source":"@site/docs/sql-manual/basic-element/sql-data-types/date-time/TIMESTAMPTZ.md","sourceDirName":"sql-manual/basic-element/sql-data-types/date-time","slug":"/sql-manual/basic-element/sql-data-types/date-time/TIMESTAMPTZ","permalink":"/docs/dev/sql-manual/basic-element/sql-data-types/date-time/TIMESTAMPTZ","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1770477659000,"frontMatter":{"title":"TIMESTAMPTZ","language":"en","description":"TIMESTAMPTZ is the data type in Doris used to store date and time information with time zone awareness,"},"sidebar":"docs","previous":{"title":"DATETIME","permalink":"/docs/dev/sql-manual/basic-element/sql-data-types/date-time/DATETIME"},"next":{"title":"Time Zone","permalink":"/docs/dev/admin-manual/cluster-management/time-zone"}}'),i=t("785893"),a=t("250065");let o={title:"TIMESTAMPTZ",language:"en",description:"TIMESTAMPTZ is the data type in Doris used to store date and time information with time zone awareness,"},r=void 0,l={},c=[{value:"Description",id:"description",level:2},{value:"Working Principle",id:"working-principle",level:3},{value:"Time Zone Handling Rules",id:"time-zone-handling-rules",level:3},{value:"Storage and Usage",id:"storage-and-usage",level:3},{value:"Examples",id:"examples",level:2}];function d(e){let n={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,a.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"description",children:"Description"}),"\n",(0,i.jsx)(n.p,{children:"TIMESTAMPTZ is the data type in Doris used to store date and time information with time zone awareness, corresponding to TIMESTAMP WITH TIME ZONE in standard SQL."}),"\n",(0,i.jsx)(n.p,{children:"In different database systems, time zone-aware timestamp types have various naming conventions:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"PostgreSQL and Oracle use TIMESTAMP WITH TIME ZONE"}),"\n",(0,i.jsx)(n.li,{children:"SQL Server uses DATETIMEOFFSET"}),"\n",(0,i.jsx)(n.li,{children:"Some other databases use TIMESTAMP WITH LOCAL TIME ZONE"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"According to SQL standards, the standalone TIMESTAMP type should not carry time zone information (equivalent to TIMESTAMP WITHOUT TIME ZONE). Considering user habits and ease of use, Doris chose the more concise name TIMESTAMPTZ to represent the timestamp type with time zone. Note that currently Doris does not have a separate TIMESTAMP type, as users can effectively use DATETIME to store time information."}),"\n",(0,i.jsxs)(n.p,{children:["The range of TIMESTAMPTZ is the same as DATETIME, being ",(0,i.jsx)(n.code,{children:"[0000-01-01 00:00:00.000000, 9999-12-31 23:59:59.999999]"}),".\nTIMESTAMPTZ supports specifying precision in the format TIMESTAMPTZ(p), where ",(0,i.jsx)(n.code,{children:"p"})," represents the precision and can range from ",(0,i.jsx)(n.code,{children:"[0, 6]"}),", with a default value of 0. In other words, TIMESTAMPTZ is equivalent to TIMESTAMPTZ(0). The default output format is ",(0,i.jsx)(n.code,{children:"'yyyy-MM-dd HH:mm:ss.SSSSSS +XX:XX'"}),", where ",(0,i.jsx)(n.code,{children:"+XX:XX"})," represents the time zone offset (note that the number of digits in ",(0,i.jsx)(n.code,{children:"SSSSSS"})," is determined by the precision ",(0,i.jsx)(n.code,{children:"p"}),")."]}),"\n",(0,i.jsx)(n.p,{children:"The TIMESTAMPTZ type can be used as a primary key, partitioning column, and bucketing column."}),"\n",(0,i.jsx)(n.h3,{id:"working-principle",children:"Working Principle"}),"\n",(0,i.jsx)(n.p,{children:"TIMESTAMPTZ implementation does not store time zone information with each row of data, but instead adopts the following mechanism:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"During storage: All input time values are converted to UTC (Coordinated Universal Time)."}),"\n",(0,i.jsxs)(n.li,{children:["During query: Based on the session's time zone setting (specified via the ",(0,i.jsx)(n.code,{children:"time_zone"})," variable), UTC time is automatically converted to the corresponding time zone for display."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Therefore, TIMESTAMPTZ can be understood as a DATETIME type with time zone conversion functionality, where Doris automatically handles time zone conversions internally."}),"\n",(0,i.jsx)(n.h3,{id:"time-zone-handling-rules",children:"Time Zone Handling Rules"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["When input strings contain time zone information (e.g., ",(0,i.jsx)(n.code,{children:'"2020-01-01 00:00:00 +03:00"'}),"), Doris uses that time zone information for conversion."]}),"\n",(0,i.jsxs)(n.li,{children:["When input strings do not contain time zone information (e.g., ",(0,i.jsx)(n.code,{children:'"2020-01-01 00:00:00"'}),"), Doris uses the current session's time zone setting for conversion."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"storage-and-usage",children:"Storage and Usage"}),"\n",(0,i.jsx)(n.p,{children:"In Doris, a TIMESTAMPTZ type field occupies 8 bytes of storage space."}),"\n",(0,i.jsx)(n.p,{children:"TIMESTAMPTZ and DATETIME types support mutual conversion, with appropriate time zone adjustments during conversion. TIMESTAMPTZ supports implicit conversion to DATETIME, allowing functions that do not directly support TIMESTAMPTZ to process this type of data."}),"\n",(0,i.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:'-- Using the current time zone (assuming +08:00) to convert a time string without time zone information\nselect cast("2020-01-01 00:00:00" as timestamptz);\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:'+--------------------------------------------+\n| cast("2020-01-01 00:00:00" as timestamptz) |\n+--------------------------------------------+\n| 2020-01-01 00:00:00 +08:00                 |\n+--------------------------------------------+\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:'-- TIMESTAMPTZ supports microseconds\nselect cast("2020-01-01 00:00:00.123456" as timestamptz(5));\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:'+------------------------------------------------------+\n| cast("2020-01-01 00:00:00.123456" as timestamptz(5)) |\n+------------------------------------------------------+\n| 2020-01-01 00:00:00.12345 +08:00                     |\n+------------------------------------------------------+\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:'-- Using a time string with time zone information\nselect cast("2020-01-01 00:00:00 +03:00" as timestamptz);\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:'+---------------------------------------------------+\n| cast("2020-01-01 00:00:00 +03:00" as timestamptz) |\n+---------------------------------------------------+\n| 2020-01-01 05:00:00 +08:00                        |\n+---------------------------------------------------+\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:'-- Converting TIMESTAMPTZ to DATETIME (with time zone conversion based on current time zone)\nselect cast(cast("2020-01-01 00:00:00 +03:00" as timestamptz) as datetime);\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:'+---------------------------------------------------------------------+\n| cast(cast("2020-01-01 00:00:00 +03:00" as timestamptz) as datetime) |\n+---------------------------------------------------------------------+\n| 2020-01-01 05:00:00                                                 |\n+---------------------------------------------------------------------+\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"-- Converting DATETIME to TIMESTAMPTZ\nselect cast(cast('2023-01-02 01:00:00' as datetime) as timestamptz);\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"+--------------------------------------------------------------+\n| cast(cast('2023-01-02 01:00:00' as datetime) as timestamptz) |\n+--------------------------------------------------------------+\n| 2023-01-02 01:00:00 +08:00                                   |\n+--------------------------------------------------------------+\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:'-- Using TIMESTAMPTZ in functions\nselect HOUR(cast("2020-01-01 00:00:00 +03:00" as timestamptz));\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:'+---------------------------------------------------------+\n| HOUR(cast("2020-01-01 00:00:00 +03:00" as timestamptz)) |\n+---------------------------------------------------------+\n|                                                       5 |\n+---------------------------------------------------------+\n'})})]})}function m(e={}){let{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},250065:function(e,n,t){t.d(n,{Z:function(){return r},a:function(){return o}});var s=t(667294);let i={},a=s.createContext(i);function o(e){let n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);