"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["248857"],{589244:function(e,n,t){t.r(n),t.d(n,{default:()=>d,frontMatter:()=>i,metadata:()=>s,assets:()=>u,toc:()=>c,contentTitle:()=>l});var s=JSON.parse('{"id":"sql-manual/sql-functions/aggregate-functions/histogram","title":"HISTOGRAM","description":"The histogram function is used to describe the distribution of the data. It uses an \\"equal height\\" bucking strategy,","source":"@site/versioned_docs/version-4.x/sql-manual/sql-functions/aggregate-functions/histogram.md","sourceDirName":"sql-manual/sql-functions/aggregate-functions","slug":"/sql-manual/sql-functions/aggregate-functions/histogram","permalink":"/docs/4.x/sql-manual/sql-functions/aggregate-functions/histogram","draft":false,"unlisted":false,"tags":[],"version":"4.x","lastUpdatedAt":1770477659000,"frontMatter":{"title":"HISTOGRAM","language":"en","description":"The histogram function is used to describe the distribution of the data. It uses an \\"equal height\\" bucking strategy,"},"sidebar":"docs","previous":{"title":"GROUP_CONCAT","permalink":"/docs/4.x/sql-manual/sql-functions/aggregate-functions/group-concat"},"next":{"title":"HLL_RAW_AGG","permalink":"/docs/4.x/sql-manual/sql-functions/aggregate-functions/hll-raw-agg"}}'),r=t("785893"),a=t("250065");let i={title:"HISTOGRAM",language:"en",description:'The histogram function is used to describe the distribution of the data. It uses an "equal height" bucking strategy,'},l=void 0,u={},c=[{value:"Description",id:"description",level:2},{value:"Alias",id:"alias",level:2},{value:"Syntax",id:"syntax",level:2},{value:"Parameters",id:"parameters",level:2},{value:"Return Value",id:"return-value",level:2},{value:"Example",id:"example",level:2}];function o(e){let n={code:"code",h2:"h2",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,a.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"description",children:"Description"}),"\n",(0,r.jsx)(n.p,{children:'The histogram function is used to describe the distribution of the data. It uses an "equal height" bucking strategy, and divides the data into buckets according to the value of the data. It describes each bucket with some simple data, such as the number of values that fall in the bucket. Only non-NULL data is counted.'}),"\n",(0,r.jsx)(n.h2,{id:"alias",children:"Alias"}),"\n",(0,r.jsx)(n.p,{children:"HIST"}),"\n",(0,r.jsx)(n.h2,{id:"syntax",children:"Syntax"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"HISTOGRAM(<expr>[, <num_buckets>])\nHIST(<expr>[, <num_buckets>])\n"})}),"\n",(0,r.jsx)(n.h2,{id:"parameters",children:"Parameters"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Parameters"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"expr"})}),(0,r.jsx)(n.td,{children:"The expression to be calculated. Supported types: TinyInt, SmallInt, Integer, BigInt, LargeInt, Float, Double, Decimal, String."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"num_buckets"})}),(0,r.jsx)(n.td,{children:"Optional. Limit the number of histogram buckets. The default value is 128. Supported type: Integer."})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"return-value",children:"Return Value"}),"\n",(0,r.jsx)(n.p,{children:"Returns a value of JSON type after histogram estimation. If all data in the group is NULL, returns NULL. If there is no valid data, returns a result with num_buckets = 0."}),"\n",(0,r.jsx)(n.h2,{id:"example",children:"Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- setup\nCREATE TABLE histogram_test (\n    c_int INT,\n    c_float FLOAT,\n    c_string VARCHAR(20)\n) DISTRIBUTED BY HASH(c_int) BUCKETS 1\nPROPERTIES (\"replication_num\"=\"1\");\n\nINSERT INTO histogram_test VALUES\n    (1, 0.1, 'str1'),\n    (2, 0.2, 'str2'),\n    (3, 0.8, 'str3'),\n    (4, 0.9, 'str4'),\n    (5, 1.0, 'str5'),\n    (6, 1.0, 'str6'),\n    (NULL, NULL, 'str7');\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT histogram(c_float) FROM histogram_test;\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:'+-------------------------------------------------------------------------------------------------------------------------------------+\n| histogram(c_float)                                                                                                                  |\n+-------------------------------------------------------------------------------------------------------------------------------------+\n| {"num_buckets":5,"buckets":[{"lower":"0.1","upper":"0.1","ndv":1,"count":1,"pre_sum":0},{"lower":"0.2","upper":"0.2","ndv":1,"count":1,"pre_sum":1},{"lower":"0.8","upper":"0.8","ndv":1,"count":1,"pre_sum":2},{"lower":"0.9","upper":"0.9","ndv":1,"count":1,"pre_sum":3},{"lower":"1","upper":"1","ndv":1,"count":2,"pre_sum":4}]} |\n+-------------------------------------------------------------------------------------------------------------------------------------+\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT histogram(c_string, 2) FROM histogram_test;\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:'+-----------------------------------------------------------------------------------------------------------------------------------------------------------+\n| histogram(c_string, 2)                                                                                                                                    |\n+-----------------------------------------------------------------------------------------------------------------------------------------------------------+\n| {"num_buckets":2,"buckets":[{"lower":"str1","upper":"str4","ndv":4,"count":4,"pre_sum":0},{"lower":"str5","upper":"str7","ndv":3,"count":3,"pre_sum":4}]} |\n+-----------------------------------------------------------------------------------------------------------------------------------------------------------+\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- NULL case\nSELECT histogram(c_float) FROM histogram_test WHERE c_float IS NULL;\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:'+--------------------------------+\n| histogram(c_float)             |\n+--------------------------------+\n| {"num_buckets":0,"buckets":[]} |\n+--------------------------------+\n'})}),"\n",(0,r.jsx)(n.p,{children:"Query result description:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n    "num_buckets": 3, \n    "buckets": [\n        {\n            "lower": "0.1", \n            "upper": "0.2", \n            "count": 2, \n            "pre_sum": 0, \n            "ndv": 2\n        }, \n        {\n            "lower": "0.8", \n            "upper": "0.9", \n            "count": 2, \n            "pre_sum": 2, \n            "ndv": 2\n        }, \n        {\n            "lower": "1.0", \n            "upper": "1.0", \n            "count": 2, \n            "pre_sum": 4, \n            "ndv": 1\n        }\n    ]\n}\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"Field description:\n- num_buckets: The number of buckets\n- buckets: All buckets\n    - lower: Upper bound of the bucket\n    - upper: Lower bound of the bucket\n    - count: The number of elements contained in the bucket\n    - pre_sum: The total number of elements in the front bucket\n    - ndv: The number of different values in the bucket\n\n> Total number of elements in the histogram = count of the last bucket + pre_sum of the last bucket.\n"})})]})}function d(e={}){let{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},250065:function(e,n,t){t.d(n,{Z:function(){return l},a:function(){return i}});var s=t(667294);let r={},a=s.createContext(r);function i(e){let n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);