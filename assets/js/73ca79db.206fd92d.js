"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["869663"],{207827:function(e,r,n){n.r(r),n.d(r,{default:()=>d,frontMatter:()=>o,metadata:()=>s,assets:()=>c,toc:()=>l,contentTitle:()=>t});var s=JSON.parse('{"id":"release-and-verify/release-doris-connectors","title":"Release Doris Connectors","description":"\x3c!--","source":"@site/community/release-and-verify/release-doris-connectors.md","sourceDirName":"release-and-verify","slug":"/release-and-verify/release-doris-connectors","permalink":"/community/release-and-verify/release-doris-connectors","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Release Doris Connectors","language":"en"},"sidebar":"community","previous":{"title":"Release Doris Core","permalink":"/community/release-and-verify/release-doris-core"},"next":{"title":"Release Doris Shade","permalink":"/community/release-and-verify/release-doris-shade"}}'),a=n("785893"),i=n("250065");let o={title:"Release Doris Connectors",language:"en"},t="Releases Doris Connectors",c={},l=[{value:"Preparing for release",id:"preparing-for-release",level:2},{value:"Releasing to Maven",id:"releasing-to-maven",level:2},{value:"1. Prepare branch and tag",id:"1-prepare-branch-and-tag",level:3},{value:"2. Release to Maven staging",id:"2-release-to-maven-staging",level:3},{value:"3. Prepare svn",id:"3-prepare-svn",level:3},{value:"4. Voting",id:"4-voting",level:3},{value:"Finish publishing",id:"finish-publishing",level:2},{value:"APPENDIX: Releasing TO SNAPSHOT",id:"appendix-releasing-to-snapshot",level:2}];function h(e){let r={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.header,{children:(0,a.jsx)(r.h1,{id:"releases-doris-connectors",children:"Releases Doris Connectors"})}),"\n",(0,a.jsx)(r.p,{children:"Doris Connectors currently contains:"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:"Flink Doris Connector"}),"\n",(0,a.jsx)(r.li,{children:"Spark Doris Connector"}),"\n"]}),"\n",(0,a.jsx)(r.p,{children:"The code base is separate from the main Doris code base and is located at:"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:(0,a.jsx)(r.a,{href:"https://github.com/apache/doris-flink-connector",children:"https://github.com/apache/doris-flink-connector"})}),"\n",(0,a.jsx)(r.li,{children:(0,a.jsx)(r.a,{href:"https://github.com/apache/doris-spark-connector",children:"https://github.com/apache/doris-spark-connector"})}),"\n"]}),"\n",(0,a.jsx)(r.h2,{id:"preparing-for-release",children:"Preparing for release"}),"\n",(0,a.jsxs)(r.p,{children:["First, see the ",(0,a.jsx)(r.a,{href:"/community/release-and-verify/release-prepare",children:"release preparation"})," documentation to prepare for the release."]}),"\n",(0,a.jsx)(r.h2,{id:"releasing-to-maven",children:"Releasing to Maven"}),"\n",(0,a.jsx)(r.p,{children:"Let's take the release of Spark Connector 1.2.0 as an example."}),"\n",(0,a.jsx)(r.h3,{id:"1-prepare-branch-and-tag",children:"1. Prepare branch and tag"}),"\n",(0,a.jsx)(r.p,{children:"Create a branch in the code base: release-1.2.0, and checkout to this branch."}),"\n",(0,a.jsx)(r.p,{children:"Modify the version revision in the pom to the version number to be released, which is 1.2.0. And submit this modification, for example:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{children:'git commit -a -m "Commit for release 1.2.0"\n'})}),"\n",(0,a.jsx)(r.p,{children:"Create tag and push"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{children:"git tag 1.2.0\ngit push origin 1.2.0\n"})}),"\n",(0,a.jsx)(r.h3,{id:"2-release-to-maven-staging",children:"2. Release to Maven staging"}),"\n",(0,a.jsx)(r.p,{children:"Because Spark Connector releases different releases for different Spark versions (such as 2.3, 3.1, 3.2), we need to process each version separately at compile time."}),"\n",(0,a.jsx)(r.p,{children:"Let's take Spark version 2.3 and scala version 2.11 as examples:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{children:"mvn clean install \\\n-Dspark.version=2.3.0 \\\n-Dscala.version=2.11 \\\n-Dspark.major.version=2.3\n"})}),"\n",(0,a.jsxs)(r.blockquote,{children:["\n",(0,a.jsx)(r.p,{children:"Note: For related parameters, please refer to the compilation command in the build.sh script, and revision is the version number to be released this time."}),"\n"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{children:"mvn deploy \\\n-Papache-release \\\n-Dspark.version=2.3.0 \\\n-Dscala.version=2.11 \\\n-Dspark.major.version=2.3 \n"})}),"\n",(0,a.jsxs)(r.p,{children:["After successful execution, you can find the newly released version in ",(0,a.jsx)(r.a,{href:"https://repository.apache.org/#stagingRepositories",children:"https://repository.apache.org/#stagingRepositories"}),":"]}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.img,{src:n(197249).Z+"",width:"1057",height:"955"})}),"\n",(0,a.jsxs)(r.p,{children:["**Note that the ",(0,a.jsx)(r.code,{children:".asc"})," signature file needs to be included. **"]}),"\n",(0,a.jsx)(r.p,{children:"If the operation is wrong, you need to drop the staging. Then perform the above steps again."}),"\n",(0,a.jsxs)(r.p,{children:["After checking, click the ",(0,a.jsx)(r.code,{children:"close"})," button in the figure to complete the staging release."]}),"\n",(0,a.jsx)(r.h3,{id:"3-prepare-svn",children:"3. Prepare svn"}),"\n",(0,a.jsx)(r.p,{children:"Check out the svn repository:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{children:"svn co https://dist.apache.org/repos/dist/dev/doris/\n"})}),"\n",(0,a.jsxs)(r.p,{children:["Package tag source code, and generate signature file and sha256 verification file. Here we take ",(0,a.jsx)(r.code,{children:"1.14_2.12-1.0.0"})," as an example. Other tag operations are the same"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{children:"git archive --format=tar release-1.2.0 --prefix=apache-doris-spark-connector-1.2.0-src/ | gzip > apache-doris-spark-connector-1.2.0-src.tar.gz\n\ngpg -u xxx@apache.org --armor --output apache-doris-spark-connector-1.2.0-src.tar.gz.asc --detach-sign apache-doris-spark-connector-1.2.0- src.tar.gz\nsha512sum apache-doris-spark-connector-1.2.0-src.tar.gz > apache-doris-spark-connector-1.2.0-src.tar.gz.sha512\n\nMac:\nshasum -a 512 apache-doris-spark-connector-1.2.0-src.tar.gz > apache-doris-spark-connector-1.2.0-src.tar.gz.sha512\n"})}),"\n",(0,a.jsx)(r.p,{children:"You end up with three files:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{children:"apache-doris-spark-connector-1.2.0-src.tar.gz\napache-doris-spark-connector-1.2.0-src.tar.gz.asc\napache-doris-spark-connector-1.2.0-src.tar.gz.sha512\n"})}),"\n",(0,a.jsx)(r.p,{children:"Move these three files to the svn directory:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{children:"doris/spark-connector/1.2.0/\n"})}),"\n",(0,a.jsx)(r.p,{children:"The final svn directory structure is similar to:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{children:"|____0.15\n| |____0.15.0-rc04\n| | |____apache-doris-0.15.0-incubating-src.tar.gz.sha512\n| | |____apache-doris-0.15.0-incubating-src.tar.gz.asc\n| | |____apache-doris-0.15.0-incubating-src.tar.gz\n|____KEYS\n|____spark-connector\n| |____1.2.0\n| | |____apache-doris-spark-connector-1.2.0-src.tar.gz\n| | |____apache-doris-spark-connector-1.2.0-src.tar.gz.asc\n| | |____apache-doris-spark-connector-1.2.0-src.tar.gz.sha512\n"})}),"\n",(0,a.jsxs)(r.p,{children:["Among them, 0.15 is the directory of Doris main code, and ",(0,a.jsx)(r.code,{children:"spark-connector/1.2.0"})," is the content of this release."]}),"\n",(0,a.jsxs)(r.p,{children:["Note, for the preparation of the KEYS file, please refer to the introduction in ",(0,a.jsx)(r.a,{href:"/community/release-and-verify/release-prepare",children:"Release Preparation"}),"."]}),"\n",(0,a.jsx)(r.h3,{id:"4-voting",children:"4. Voting"}),"\n",(0,a.jsx)(r.p,{children:"Initiate a vote in the dev@doris mail group, the template is as follows:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{children:"Hi all,\n\nThis is a call for the vote to release Apache Doris Spark Connector 1.2.0\n\nThe git tag for the release:\nhttps://github.com/apache/doris-spark-connector/releases/tag/1.2.0\n\nRelease Notes are here:\nhttps://github.com/apache/doris-spark-connector/issues/109\n\nThanks to everyone who has contributed to this release.\n\nThe release candidates:\nhttps://dist.apache.org/repos/dist/dev/doris/spark-connector/1.2.0/\n\nMaven 2 staging repository:\nhttps://repository.apache.org/content/repositories/orgapachedoris-1031\n\n\nKEYS file is available here:\nhttps://downloads.apache.org/doris/KEYS\n\nTo verify and build, you can refer to the following link:\nhttps://doris.apache.org/community/release-and-verify/release-verify\n\nThe vote will be open for at least 72 hours.\n\n[ ] +1 Approve the release\n[ ] +0 No opinion\n[ ] -1 Do not release this package because ...\n"})}),"\n",(0,a.jsx)(r.h2,{id:"finish-publishing",children:"Finish publishing"}),"\n",(0,a.jsxs)(r.p,{children:["Please refer to the ",(0,a.jsx)(r.a,{href:"/community/release-and-verify/release-complete",children:"Complete Release"})," document to complete the entire release process."]}),"\n",(0,a.jsx)(r.h2,{id:"appendix-releasing-to-snapshot",children:"APPENDIX: Releasing TO SNAPSHOT"}),"\n",(0,a.jsx)(r.p,{children:"Snapshot is not an Apache Release version, it is only used for preview before release. After being discussed and approved by the PMC, the Snapshot version can be released"}),"\n",(0,a.jsx)(r.p,{children:"Switch to the spark connector directory, we take spark version 2.3, scala 2.11 as an example"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{children:"cd spark-doris-connector\nmvn deploy \\\n-Dspark.version=2.3.0 \\\n-Dscala.version=2.11 \\\n-Dspark.major.version=2.3 \\\n"})}),"\n",(0,a.jsx)(r.p,{children:"Afterwards you can see the snapshot version here:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{children:"https://repository.apache.org/content/repositories/snapshots/org/apache/doris/doris-spark-connector/\n"})})]})}function d(e={}){let{wrapper:r}={...(0,i.a)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},197249:function(e,r,n){n.d(r,{Z:function(){return s}});let s=n.p+"assets/images/staging-repositories-4c394e1094a6aa8ac05d6bfea6b48627.png"},250065:function(e,r,n){n.d(r,{Z:function(){return t},a:function(){return o}});var s=n(667294);let a={},i=s.createContext(a);function o(e){let r=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function t(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),s.createElement(i.Provider,{value:r},e.children)}}}]);